,db_id,original_sql,rewritten_sql,activated_rules,original_logical_plan
0,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 20 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 20 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-07' and l_shipdate > date '1995-03-07' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t1.l_orderkey, SUM(t1.l_extendedprice * (1 - t1.l_discount)) AS revenue, t0.o_orderdate, t0.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-07') AS t0 ON t.c_custkey = t0.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-07') AS t1 ON t0.o_orderkey = t1.l_orderkey GROUP BY t1.l_orderkey, t0.o_orderdate, t0.o_shippriority ORDER BY SUM(t1.l_extendedprice * (1 - t1.l_discount)) DESC, t0.o_orderdate;",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
2,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and o_orderdate >= date '1994-01-01' and o_orderdate < date '1994-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation.n_name, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-01-01' AND o_orderdate < (DATE '1994-01-01' + INTERVAL '1' YEAR)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN lineitem ON t.o_orderkey = lineitem.l_orderkey INNER JOIN supplier ON lineitem.l_suppkey = supplier.s_suppkey AND customer.c_nationkey = supplier.s_nationkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t0 ON nation.n_regionkey = t0.r_regionkey GROUP BY nation.n_name ORDER BY SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) DESC;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
3,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE POLISHED STEEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
4,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%olive%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation100.n_name AS nation, EXTRACT(YEAR FROM orders100.o_orderdate) AS o_year, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount) - partsupp100.ps_supplycost * lineitem100.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%olive%') AS t591 CROSS JOIN supplier AS supplier100 INNER JOIN lineitem AS lineitem100 ON supplier100.s_suppkey = lineitem100.l_suppkey AND t591.p_partkey = lineitem100.l_partkey INNER JOIN partsupp AS partsupp100 ON lineitem100.l_suppkey = partsupp100.ps_suppkey AND lineitem100.l_partkey = partsupp100.ps_partkey INNER JOIN orders AS orders100 ON lineitem100.l_orderkey = orders100.o_orderkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey GROUP BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) ORDER BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
5,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-10-01' and o_orderdate < date '1993-10-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","SELECT t742.c_custkey, t742.c_name, SUM(t742.l_extendedprice * (1 - t742.l_discount)) AS revenue, t742.c_acctbal, nation100.n_name, t742.c_address, t742.c_phone, t742.c_comment FROM (SELECT * FROM (SELECT * FROM customer AS customer100, (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-10-01' AND o_orderdate < (DATE '1993-10-01' + INTERVAL '3' MONTH)) AS t739 WHERE customer100.c_custkey = t739.o_custkey) AS t740, (SELECT * FROM lineitem WHERE l_returnflag = 'R') AS t741 WHERE t741.l_orderkey = t740.o_orderkey) AS t742, nation AS nation100 WHERE t742.c_nationkey = nation100.n_nationkey GROUP BY t742.c_custkey, t742.c_name, t742.c_acctbal, t742.c_phone, nation100.n_name, t742.c_address, t742.c_comment ORDER BY SUM(t742.l_extendedprice * (1 - t742.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
6,tpch,"select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from customer, orders, lineitem where o_orderkey in ( select l_orderkey from lineitem group by l_orderkey having sum(l_quantity) > 313 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate;","SELECT t95.c_name, t95.c_custkey, t95.o_orderkey, t95.o_orderdate, t95.o_totalprice, t95.f8 FROM (SELECT t93.c_custkey, t93.c_name, t93.o_orderkey, t93.o_totalprice, t93.o_orderdate, t93.f8 * t94.EXPR5 AS f8 FROM (SELECT t91.c_custkey, t91.c_name, t92.o_orderkey, t92.o_totalprice, t92.o_orderdate, t91.f2 * t92.f4 AS f8 FROM (SELECT c_custkey, c_name, COUNT(*) AS f2 FROM customer GROUP BY c_custkey, c_name) AS t91 INNER JOIN (SELECT o_orderkey, o_custkey, o_totalprice, o_orderdate, COUNT(*) AS f4 FROM orders GROUP BY o_orderkey, o_custkey, o_totalprice, o_orderdate) AS t92 ON t91.c_custkey = t92.o_custkey) AS t93 INNER JOIN (SELECT l_orderkey, SUM(l_quantity) AS EXPR5 FROM lineitem GROUP BY l_orderkey) AS t94 ON t93.o_orderkey = t94.l_orderkey) AS t95 INNER JOIN (SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING SUM(l_quantity) > 313) AS t98 ON t95.o_orderkey = t98.l_orderkey ORDER BY t95.o_totalprice DESC, t95.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalAggregate', 'LogicalProject', 'LogicalTableScan']]]]]]]]"
7,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'MOROCCO' group by s_name order by numwait desc, s_name;",,['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
8,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '24', '36', '34', '32', '42', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '24', '36', '34', '32', '42', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '26'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '26')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
9,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 43 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 43 AND p_type LIKE '%NICKEL') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
10,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-01' and l_shipdate > date '1995-03-01' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t793.l_orderkey, SUM(t793.l_extendedprice * (1 - t793.l_discount)) AS revenue, t792.o_orderdate, t792.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t790, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-01') AS t791 WHERE t790.c_custkey = t791.o_custkey) AS t792, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-01') AS t793 WHERE t793.l_orderkey = t792.o_orderkey GROUP BY t793.l_orderkey, t792.o_orderdate, t792.o_shippriority ORDER BY SUM(t793.l_extendedprice * (1 - t793.l_discount)) DESC, t792.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
11,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-02-01' and o_orderdate < date '1993-02-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t0.o_orderpriority, COALESCE(SUM(t0.order_count * t3.order_count), 0) AS order_count FROM (SELECT o_orderkey, o_orderpriority, COUNT(*) AS order_count FROM orders WHERE o_orderdate >= DATE '1993-02-01' AND o_orderdate < (DATE '1993-02-01' + INTERVAL '3' MONTH) GROUP BY o_orderkey, o_orderpriority) AS t0 INNER JOIN (SELECT l_orderkey, COUNT(*) AS order_count FROM lineitem WHERE l_commitdate < l_receiptdate GROUP BY l_orderkey) AS t3 ON t0.o_orderkey = t3.l_orderkey GROUP BY t0.o_orderpriority ORDER BY t0.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
12,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(4)) = 'PERU' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'STANDARD ANODIZED NICKEL') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
13,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%antique%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation99.n_name AS nation, EXTRACT(YEAR FROM orders99.o_orderdate) AS o_year, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount) - partsupp99.ps_supplycost * lineitem99.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%antique%') AS t583 CROSS JOIN supplier AS supplier99 INNER JOIN lineitem AS lineitem99 ON supplier99.s_suppkey = lineitem99.l_suppkey AND t583.p_partkey = lineitem99.l_partkey INNER JOIN partsupp AS partsupp99 ON lineitem99.l_suppkey = partsupp99.ps_suppkey AND lineitem99.l_partkey = partsupp99.ps_partkey INNER JOIN orders AS orders99 ON lineitem99.l_orderkey = orders99.o_orderkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey GROUP BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) ORDER BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
14,tpch,"select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from customer, orders, lineitem where o_orderkey in ( select l_orderkey from lineitem group by l_orderkey having sum(l_quantity) > 312 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate;","SELECT t157.c_name, t157.c_custkey, t157.o_orderkey, t157.o_orderdate, t157.o_totalprice, t157.f8 FROM (SELECT t155.c_custkey, t155.c_name, t155.o_orderkey, t155.o_totalprice, t155.o_orderdate, t155.f8 * t156.EXPR5 AS f8 FROM (SELECT t153.c_custkey, t153.c_name, t154.o_orderkey, t154.o_totalprice, t154.o_orderdate, t153.f2 * t154.f4 AS f8 FROM (SELECT c_custkey, c_name, COUNT(*) AS f2 FROM customer GROUP BY c_custkey, c_name) AS t153 INNER JOIN (SELECT o_orderkey, o_custkey, o_totalprice, o_orderdate, COUNT(*) AS f4 FROM orders GROUP BY o_orderkey, o_custkey, o_totalprice, o_orderdate) AS t154 ON t153.c_custkey = t154.o_custkey) AS t155 INNER JOIN (SELECT l_orderkey, SUM(l_quantity) AS EXPR5 FROM lineitem GROUP BY l_orderkey) AS t156 ON t155.o_orderkey = t156.l_orderkey) AS t157 INNER JOIN (SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING SUM(l_quantity) > 312) AS t160 ON t157.o_orderkey = t160.l_orderkey ORDER BY t157.o_totalprice DESC, t157.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalAggregate', 'LogicalProject', 'LogicalTableScan']]]]]]]]"
15,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'JAPAN' group by s_name order by numwait desc, s_name;","SELECT t784.s_name, COUNT(*) AS numwait FROM (SELECT supplier191.s_suppkey, supplier191.s_name, supplier191.s_address, supplier191.s_nationkey, supplier191.s_phone, supplier191.s_acctbal, supplier191.s_comment, t779.l_orderkey, t779.l_partkey, t779.l_suppkey, t779.l_linenumber, t779.l_quantity, t779.l_extendedprice, t779.l_discount, t779.l_tax, t779.l_returnflag, t779.l_linestatus, t779.l_shipdate, t779.l_commitdate, t779.l_receiptdate, t779.l_shipinstruct, t779.l_shipmode, t779.l_comment, t780.o_orderkey, t780.o_custkey, t780.o_orderstatus, t780.o_totalprice, t780.o_orderdate, t780.o_orderpriority, t780.o_clerk, t780.o_shippriority, t780.o_comment, t781.n_nationkey, t781.n_name, t781.n_regionkey, t781.n_comment, CAST(t783.f0 AS BOOLEAN) AS f0 FROM supplier AS supplier191 INNER JOIN (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t779 ON supplier191.s_suppkey = t779.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t780 ON t779.l_orderkey = t780.o_orderkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'JAPAN') AS t781 ON supplier191.s_nationkey = t781.n_nationkey INNER JOIN (SELECT t782.l_orderkey AS l_orderkey0, t782.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem336 INNER JOIN (SELECT lineitem337.l_orderkey, lineitem337.l_suppkey FROM supplier AS supplier192, lineitem AS lineitem337, orders AS orders192, nation AS nation192) AS t782 ON lineitem336.l_orderkey = t782.l_orderkey AND lineitem336.l_suppkey <> t782.l_suppkey) AS t783 ON t779.l_orderkey = t783.l_orderkey0 AND t779.l_suppkey = t783.l_suppkey0) AS t784 LEFT JOIN (SELECT t791.l_orderkey AS l_orderkey0, t791.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t785 INNER JOIN (SELECT t786.l_orderkey, t786.l_suppkey FROM supplier AS supplier193 INNER JOIN (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t786 ON supplier193.s_suppkey = t786.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t787 ON t786.l_orderkey = t787.o_orderkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'JAPAN') AS t788 ON supplier193.s_nationkey = t788.n_nationkey INNER JOIN (SELECT t789.l_orderkey AS l_orderkey0, t789.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem340 INNER JOIN (SELECT lineitem341.l_orderkey, lineitem341.l_suppkey FROM supplier AS supplier194, lineitem AS lineitem341, orders AS orders194, nation AS nation194) AS t789 ON lineitem340.l_orderkey = t789.l_orderkey AND lineitem340.l_suppkey <> t789.l_suppkey) AS t790 ON t786.l_orderkey = t790.l_orderkey0 AND t786.l_suppkey = t790.l_suppkey0) AS t791 ON t785.l_orderkey = t791.l_orderkey AND t785.l_suppkey <> t791.l_suppkey) AS t792 ON t784.l_orderkey = t792.l_orderkey0 AND t784.l_suppkey = t792.l_suppkey0 WHERE t792.f0 IS NULL GROUP BY t784.s_name ORDER BY COUNT(*) DESC, t784.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
16,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '34', '21', '31', '41', '44', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '34', '21', '31', '41', '44', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
17,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 37 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 37 AND p_type LIKE '%STEEL') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
18,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-31' and l_shipdate > date '1995-03-31' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t800.l_orderkey, SUM(t800.l_extendedprice * (1 - t800.l_discount)) AS revenue, t799.o_orderdate, t799.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t797, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-31') AS t798 WHERE t797.c_custkey = t798.o_custkey) AS t799, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-31') AS t800 WHERE t800.l_orderkey = t799.o_orderkey GROUP BY t800.l_orderkey, t799.o_orderdate, t799.o_shippriority ORDER BY SUM(t800.l_extendedprice * (1 - t800.l_discount)) DESC, t799.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
19,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and o_orderdate >= date '1997-01-01' and o_orderdate < date '1997-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation103.n_name, SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount)) AS revenue FROM customer AS customer103 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1997-01-01' AND o_orderdate < (DATE '1997-01-01' + INTERVAL '1' YEAR)) AS t765 ON customer103.c_custkey = t765.o_custkey INNER JOIN lineitem AS lineitem103 ON t765.o_orderkey = lineitem103.l_orderkey INNER JOIN supplier AS supplier103 ON lineitem103.l_suppkey = supplier103.s_suppkey AND customer103.c_nationkey = supplier103.s_nationkey INNER JOIN nation AS nation103 ON supplier103.s_nationkey = nation103.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t766 ON nation103.n_regionkey = t766.r_regionkey GROUP BY nation103.n_name ORDER BY SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
20,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(5)) = 'JAPAN' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED COPPER') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'ASIA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
21,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'CANADA' group by s_name order by numwait desc, s_name;",,['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
22,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '22', '43', '26', '42', '27', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '22', '43', '26', '42', '27', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
23,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 50 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 50 AND p_type LIKE '%NICKEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
24,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and o_orderdate >= date '1996-01-01' and o_orderdate < date '1996-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation103.n_name, SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount)) AS revenue FROM customer AS customer103 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1996-01-01' AND o_orderdate < (DATE '1996-01-01' + INTERVAL '1' YEAR)) AS t765 ON customer103.c_custkey = t765.o_custkey INNER JOIN lineitem AS lineitem103 ON t765.o_orderkey = lineitem103.l_orderkey INNER JOIN supplier AS supplier103 ON lineitem103.l_suppkey = supplier103.s_suppkey AND customer103.c_nationkey = supplier103.s_nationkey INNER JOIN nation AS nation103 ON supplier103.s_nationkey = nation103.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t766 ON nation103.n_regionkey = t766.r_regionkey GROUP BY nation103.n_name ORDER BY SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
25,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(6)) = 'FRANCE' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED STEEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
26,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'KENYA' group by s_name order by numwait desc, s_name;","SELECT t2093.s_name, COUNT(*) AS numwait FROM (SELECT supplier403.s_suppkey, supplier403.s_name, supplier403.s_address, supplier403.s_nationkey, supplier403.s_phone, supplier403.s_acctbal, supplier403.s_comment, t2088.l_orderkey, t2088.l_partkey, t2088.l_suppkey, t2088.l_linenumber, t2088.l_quantity, t2088.l_extendedprice, t2088.l_discount, t2088.l_tax, t2088.l_returnflag, t2088.l_linestatus, t2088.l_shipdate, t2088.l_commitdate, t2088.l_receiptdate, t2088.l_shipinstruct, t2088.l_shipmode, t2088.l_comment, t2089.o_orderkey, t2089.o_custkey, t2089.o_orderstatus, t2089.o_totalprice, t2089.o_orderdate, t2089.o_orderpriority, t2089.o_clerk, t2089.o_shippriority, t2089.o_comment, t2090.n_nationkey, t2090.n_name, t2090.n_regionkey, t2090.n_comment, CAST(t2092.f0 AS BOOLEAN) AS f0 FROM supplier AS supplier403 INNER JOIN (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t2088 ON supplier403.s_suppkey = t2088.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t2089 ON t2088.l_orderkey = t2089.o_orderkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'KENYA') AS t2090 ON supplier403.s_nationkey = t2090.n_nationkey INNER JOIN (SELECT t2091.l_orderkey AS l_orderkey0, t2091.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem707 INNER JOIN (SELECT lineitem708.l_orderkey, lineitem708.l_suppkey FROM supplier AS supplier404, lineitem AS lineitem708, orders AS orders404, nation AS nation404) AS t2091 ON lineitem707.l_orderkey = t2091.l_orderkey AND lineitem707.l_suppkey <> t2091.l_suppkey) AS t2092 ON t2088.l_orderkey = t2092.l_orderkey0 AND t2088.l_suppkey = t2092.l_suppkey0) AS t2093 LEFT JOIN (SELECT t2100.l_orderkey AS l_orderkey0, t2100.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t2094 INNER JOIN (SELECT t2095.l_orderkey, t2095.l_suppkey FROM supplier AS supplier405 INNER JOIN (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t2095 ON supplier405.s_suppkey = t2095.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t2096 ON t2095.l_orderkey = t2096.o_orderkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'KENYA') AS t2097 ON supplier405.s_nationkey = t2097.n_nationkey INNER JOIN (SELECT t2098.l_orderkey AS l_orderkey0, t2098.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem711 INNER JOIN (SELECT lineitem712.l_orderkey, lineitem712.l_suppkey FROM supplier AS supplier406, lineitem AS lineitem712, orders AS orders406, nation AS nation406) AS t2098 ON lineitem711.l_orderkey = t2098.l_orderkey AND lineitem711.l_suppkey <> t2098.l_suppkey) AS t2099 ON t2095.l_orderkey = t2099.l_orderkey0 AND t2095.l_suppkey = t2099.l_suppkey0) AS t2100 ON t2094.l_orderkey = t2100.l_orderkey AND t2094.l_suppkey <> t2100.l_suppkey) AS t2101 ON t2093.l_orderkey = t2101.l_orderkey0 AND t2093.l_suppkey = t2101.l_suppkey0 WHERE t2101.f0 IS NULL GROUP BY t2093.s_name ORDER BY COUNT(*) DESC, t2093.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
27,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '29', '25', '42', '36', '32', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '29', '25', '42', '36', '32', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '33'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '33')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
28,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 22 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 22 AND p_type LIKE '%NICKEL') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
29,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-05' and l_shipdate > date '1995-03-05' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t807.l_orderkey, SUM(t807.l_extendedprice * (1 - t807.l_discount)) AS revenue, t806.o_orderdate, t806.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'HOUSEHOLD') AS t804, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-05') AS t805 WHERE t804.c_custkey = t805.o_custkey) AS t806, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-05') AS t807 WHERE t807.l_orderkey = t806.o_orderkey GROUP BY t807.l_orderkey, t806.o_orderdate, t806.o_shippriority ORDER BY SUM(t807.l_extendedprice * (1 - t807.l_discount)) DESC, t806.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
30,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-09-01' and o_orderdate < date '1993-09-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t8.o_orderpriority, COALESCE(SUM(t8.order_count * t10.order_count), 0) AS order_count FROM (SELECT o_orderkey, o_orderpriority, COUNT(*) AS order_count FROM orders WHERE o_orderdate >= DATE '1993-09-01' AND o_orderdate < (DATE '1993-09-01' + INTERVAL '3' MONTH) GROUP BY o_orderkey, o_orderpriority) AS t8 INNER JOIN (SELECT l_orderkey, COUNT(*) AS order_count FROM lineitem WHERE l_commitdate < l_receiptdate GROUP BY l_orderkey) AS t10 ON t8.o_orderkey = t10.l_orderkey GROUP BY t8.o_orderpriority ORDER BY t8.o_orderpriority",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
31,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and o_orderdate >= date '1995-01-01' and o_orderdate < date '1995-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation99.n_name, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount)) AS revenue FROM customer AS customer99 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate < (DATE '1995-01-01' + INTERVAL '1' YEAR)) AS t725 ON customer99.c_custkey = t725.o_custkey INNER JOIN lineitem AS lineitem99 ON t725.o_orderkey = lineitem99.l_orderkey INNER JOIN supplier AS supplier99 ON lineitem99.l_suppkey = supplier99.s_suppkey AND customer99.c_nationkey = supplier99.s_nationkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t726 ON nation99.n_regionkey = t726.r_regionkey GROUP BY nation99.n_name ORDER BY SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
32,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'ALGERIA') or (n1.n_name = 'ALGERIA' and n2.n_name = 'SAUDI ARABIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation207.n_name AS supp_nation, nation208.n_name AS cust_nation, EXTRACT(YEAR FROM t665.l_shipdate) AS l_year, SUM(t665.l_extendedprice * (1 - t665.l_discount)) AS revenue FROM supplier AS supplier103 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t665 ON supplier103.s_suppkey = t665.l_suppkey INNER JOIN orders AS orders103 ON t665.l_orderkey = orders103.o_orderkey INNER JOIN customer AS customer103 ON orders103.o_custkey = customer103.c_custkey INNER JOIN nation AS nation207 ON supplier103.s_nationkey = nation207.n_nationkey INNER JOIN nation AS nation208 ON customer103.c_nationkey = nation208.n_nationkey AND (nation207.n_name = 'SAUDI ARABIA' AND nation208.n_name = 'ALGERIA' OR nation207.n_name = 'ALGERIA' AND nation208.n_name = 'SAUDI ARABIA') GROUP BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate) ORDER BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
33,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'ALGERIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED BRASS') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
34,tpch,"select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from customer, orders, lineitem where o_orderkey in ( select l_orderkey from lineitem group by l_orderkey having sum(l_quantity) > 315 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate;","SELECT t866.c_name, t866.c_custkey, t866.o_orderkey, t866.o_orderdate, t866.o_totalprice, t866.f8 FROM (SELECT t864.c_custkey, t864.c_name, t864.o_orderkey, t864.o_totalprice, t864.o_orderdate, t864.f8 * t865.EXPR5 AS f8 FROM (SELECT t862.c_custkey, t862.c_name, t863.o_orderkey, t863.o_totalprice, t863.o_orderdate, t862.f2 * t863.f4 AS f8 FROM (SELECT c_custkey, c_name, COUNT(*) AS f2 FROM customer GROUP BY c_custkey, c_name) AS t862 INNER JOIN (SELECT o_orderkey, o_custkey, o_totalprice, o_orderdate, COUNT(*) AS f4 FROM orders GROUP BY o_orderkey, o_custkey, o_totalprice, o_orderdate) AS t863 ON t862.c_custkey = t863.o_custkey) AS t864 INNER JOIN (SELECT l_orderkey, SUM(l_quantity) AS EXPR5 FROM lineitem GROUP BY l_orderkey) AS t865 ON t864.o_orderkey = t865.l_orderkey) AS t866 INNER JOIN (SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING SUM(l_quantity) > 315) AS t869 ON t866.o_orderkey = t869.l_orderkey ORDER BY t866.o_totalprice DESC, t866.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalAggregate', 'LogicalProject', 'LogicalTableScan']]]]]]]]"
35,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '40', '36', '30', '42', '20', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '40', '36', '30', '42', '20', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
36,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 43 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t315.s_acctbal, t315.s_name, t315.n_name, t315.p_partkey, t315.p_mfgr, t315.s_address, t315.s_phone, t315.s_comment FROM (SELECT t304.p_partkey, t304.p_name, t304.p_mfgr, t304.p_brand, t304.p_type, t304.p_size, t304.p_container, t304.p_retailprice, t304.p_comment, supplier41.s_suppkey, supplier41.s_name, supplier41.s_address, supplier41.s_nationkey, supplier41.s_phone, supplier41.s_acctbal, supplier41.s_comment, partsupp41.ps_partkey, partsupp41.ps_suppkey, partsupp41.ps_availqty, partsupp41.ps_supplycost, partsupp41.ps_comment, nation41.n_nationkey, nation41.n_name, nation41.n_regionkey, nation41.n_comment, t305.r_regionkey, t305.r_name, t305.r_comment, CAST(t313.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t313.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 43 AND p_type LIKE '%STEEL') AS t304 CROSS JOIN supplier AS supplier41 INNER JOIN partsupp AS partsupp41 ON t304.p_partkey = partsupp41.ps_partkey AND supplier41.s_suppkey = partsupp41.ps_suppkey INNER JOIN nation AS nation41 ON supplier41.s_nationkey = nation41.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t305 ON nation41.n_regionkey = t305.r_regionkey INNER JOIN (SELECT t310.ps_partkey, MIN(t310.EXPR0) AS EXPR0 FROM (SELECT t308.ps_partkey, t309.n_regionkey, MIN(t308.EXPR0) AS EXPR0 FROM (SELECT t306.ps_partkey, t307.s_nationkey, MIN(t306.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t306 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t307 ON t306.ps_suppkey = t307.s_suppkey GROUP BY t306.ps_partkey, t307.s_nationkey) AS t308 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t309 ON t308.s_nationkey = t309.n_nationkey GROUP BY t308.ps_partkey, t309.n_regionkey) AS t310 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t312 ON t310.n_regionkey = t312.r_regionkey GROUP BY t310.ps_partkey) AS t313 ON t304.p_partkey = t313.ps_partkey AND partsupp41.ps_supplycost = t313.EXPR0 ORDER BY supplier41.s_acctbal DESC, nation41.n_name, supplier41.s_name, t304.p_partkey) AS t315",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
37,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-21' and l_shipdate > date '1995-03-21' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t1.l_orderkey, SUM(t1.l_extendedprice * (1 - t1.l_discount)) AS revenue, t0.o_orderdate, t0.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'BUILDING') AS t INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-21') AS t0 ON t.c_custkey = t0.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-21') AS t1 ON t0.o_orderkey = t1.l_orderkey GROUP BY t1.l_orderkey, t0.o_orderdate, t0.o_shippriority ORDER BY SUM(t1.l_extendedprice * (1 - t1.l_discount)) DESC, t0.o_orderdate;",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
38,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and o_orderdate >= date '1996-01-01' and o_orderdate < date '1996-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation100.n_name, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount)) AS revenue FROM customer AS customer100 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1996-01-01' AND o_orderdate < (DATE '1996-01-01' + INTERVAL '1' YEAR)) AS t735 ON customer100.c_custkey = t735.o_custkey INNER JOIN lineitem AS lineitem100 ON t735.o_orderkey = lineitem100.l_orderkey INNER JOIN supplier AS supplier100 ON lineitem100.l_suppkey = supplier100.s_suppkey AND customer100.c_nationkey = supplier100.s_nationkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t736 ON nation100.n_regionkey = t736.r_regionkey GROUP BY nation100.n_name ORDER BY SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
39,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t5.o_orderdate) AS o_year, SUM(CASE WHEN t5.n_name0 = 'JAPAN' THEN t5.l_extendedprice * (1 - t5.l_discount) ELSE 0 END) / SUM(t5.l_extendedprice * (1 - t5.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED COPPER') AS t, supplier, lineitem WHERE t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey) AS t0, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t1 WHERE t0.l_orderkey = t1.o_orderkey) AS t2, customer WHERE t2.o_custkey = customer.c_custkey) AS t3, nation WHERE t3.c_nationkey = nation.n_nationkey) AS t4, nation AS nation0 WHERE t4.s_nationkey = nation0.n_nationkey) AS t5, (SELECT * FROM region WHERE r_name = 'ASIA') AS t6 WHERE t5.n_regionkey = t6.r_regionkey GROUP BY EXTRACT(YEAR FROM t5.o_orderdate) ORDER BY EXTRACT(YEAR FROM t5.o_orderdate);",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
40,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%rose%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation102.n_name AS nation, EXTRACT(YEAR FROM orders102.o_orderdate) AS o_year, SUM(lineitem102.l_extendedprice * (1 - lineitem102.l_discount) - partsupp102.ps_supplycost * lineitem102.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%rose%') AS t607 CROSS JOIN supplier AS supplier102 INNER JOIN lineitem AS lineitem102 ON supplier102.s_suppkey = lineitem102.l_suppkey AND t607.p_partkey = lineitem102.l_partkey INNER JOIN partsupp AS partsupp102 ON lineitem102.l_suppkey = partsupp102.ps_suppkey AND lineitem102.l_partkey = partsupp102.ps_partkey INNER JOIN orders AS orders102 ON lineitem102.l_orderkey = orders102.o_orderkey INNER JOIN nation AS nation102 ON supplier102.s_nationkey = nation102.n_nationkey GROUP BY nation102.n_name, EXTRACT(YEAR FROM orders102.o_orderdate) ORDER BY nation102.n_name, EXTRACT(YEAR FROM orders102.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
41,tpch,"select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from customer, orders, lineitem where o_orderkey in ( select l_orderkey from lineitem group by l_orderkey having sum(l_quantity) > 314 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate;","SELECT t157.c_name, t157.c_custkey, t157.o_orderkey, t157.o_orderdate, t157.o_totalprice, t157.f8 FROM (SELECT t155.c_custkey, t155.c_name, t155.o_orderkey, t155.o_totalprice, t155.o_orderdate, t155.f8 * t156.EXPR5 AS f8 FROM (SELECT t153.c_custkey, t153.c_name, t154.o_orderkey, t154.o_totalprice, t154.o_orderdate, t153.f2 * t154.f4 AS f8 FROM (SELECT c_custkey, c_name, COUNT(*) AS f2 FROM customer GROUP BY c_custkey, c_name) AS t153 INNER JOIN (SELECT o_orderkey, o_custkey, o_totalprice, o_orderdate, COUNT(*) AS f4 FROM orders GROUP BY o_orderkey, o_custkey, o_totalprice, o_orderdate) AS t154 ON t153.c_custkey = t154.o_custkey) AS t155 INNER JOIN (SELECT l_orderkey, SUM(l_quantity) AS EXPR5 FROM lineitem GROUP BY l_orderkey) AS t156 ON t155.o_orderkey = t156.l_orderkey) AS t157 INNER JOIN (SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING SUM(l_quantity) > 314) AS t160 ON t157.o_orderkey = t160.l_orderkey ORDER BY t157.o_totalprice DESC, t157.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalAggregate', 'LogicalProject', 'LogicalTableScan']]]]]]]]"
42,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'UNITED STATES' group by s_name order by numwait desc, s_name;","SELECT t2.s_name, COUNT(*) AS numwait FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t0.f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t.l_orderkey AS l_orderkey0, t.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem0 INNER JOIN (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0) AS t ON lineitem0.l_orderkey = t.l_orderkey AND lineitem0.l_suppkey <> t.l_suppkey) AS t0 ON lineitem.l_orderkey = t0.l_orderkey0 AND lineitem.l_suppkey = t0.l_suppkey0 WHERE supplier.s_suppkey = lineitem.l_suppkey AND (orders.o_orderkey = lineitem.l_orderkey AND orders.o_orderstatus = 'F') AND (lineitem.l_receiptdate > lineitem.l_commitdate AND supplier.s_nationkey = nation.n_nationkey AND (nation.n_name = 'UNITED STATES' AND t0.f0 IS NOT NULL))) AS t2 LEFT JOIN (SELECT t8.l_orderkey AS l_orderkey0, t8.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t3 INNER JOIN (SELECT lineitem3.l_orderkey, lineitem3.l_suppkey FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t4.l_orderkey AS l_orderkey0, t4.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem4 INNER JOIN (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2) AS t4 ON lineitem4.l_orderkey = t4.l_orderkey AND lineitem4.l_suppkey <> t4.l_suppkey) AS t5 ON lineitem3.l_orderkey = t5.l_orderkey0 AND lineitem3.l_suppkey = t5.l_suppkey0 WHERE supplier1.s_suppkey = lineitem3.l_suppkey AND (orders1.o_orderkey = lineitem3.l_orderkey AND orders1.o_orderstatus = 'F') AND (lineitem3.l_receiptdate > lineitem3.l_commitdate AND supplier1.s_nationkey = nation1.n_nationkey AND (nation1.n_name = 'UNITED STATES' AND t5.f0 IS NOT NULL))) AS t8 ON t3.l_orderkey = t8.l_orderkey AND t3.l_suppkey <> t8.l_suppkey) AS t9 ON t2.l_orderkey = t9.l_orderkey0 AND t2.l_suppkey = t9.l_suppkey0 WHERE t9.f0 IS NULL GROUP BY t2.s_name ORDER BY COUNT(*) DESC, t2.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
43,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '40', '39', '44', '36', '21', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '40', '39', '44', '36', '21', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
44,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 23 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 23 AND p_type LIKE '%STEEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
45,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-16' and l_shipdate > date '1995-03-16' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t800.l_orderkey, SUM(t800.l_extendedprice * (1 - t800.l_discount)) AS revenue, t799.o_orderdate, t799.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t797, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-16') AS t798 WHERE t797.c_custkey = t798.o_custkey) AS t799, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-16') AS t800 WHERE t800.l_orderkey = t799.o_orderkey GROUP BY t800.l_orderkey, t799.o_orderdate, t799.o_shippriority ORDER BY SUM(t800.l_extendedprice * (1 - t800.l_discount)) DESC, t799.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
46,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(5)) = 'EGYPT' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD PLATED BRASS') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
47,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'IRAQ' group by s_name order by numwait desc, s_name;","SELECT t38.s_name, COUNT(*) AS numwait FROM (SELECT supplier7.s_suppkey, supplier7.s_name, supplier7.s_address, supplier7.s_nationkey, supplier7.s_phone, supplier7.s_acctbal, supplier7.s_comment, lineitem13.l_orderkey, lineitem13.l_partkey, lineitem13.l_suppkey, lineitem13.l_linenumber, lineitem13.l_quantity, lineitem13.l_extendedprice, lineitem13.l_discount, lineitem13.l_tax, lineitem13.l_returnflag, lineitem13.l_linestatus, lineitem13.l_shipdate, lineitem13.l_commitdate, lineitem13.l_receiptdate, lineitem13.l_shipinstruct, lineitem13.l_shipmode, lineitem13.l_comment, orders7.o_orderkey, orders7.o_custkey, orders7.o_orderstatus, orders7.o_totalprice, orders7.o_orderdate, orders7.o_orderpriority, orders7.o_clerk, orders7.o_shippriority, orders7.o_comment, nation7.n_nationkey, nation7.n_name, nation7.n_regionkey, nation7.n_comment, t36.f0 FROM supplier AS supplier7 CROSS JOIN lineitem AS lineitem13 CROSS JOIN orders AS orders7 CROSS JOIN nation AS nation7 LEFT JOIN (SELECT t35.l_orderkey AS l_orderkey0, t35.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem14 INNER JOIN (SELECT lineitem15.l_orderkey, lineitem15.l_suppkey FROM supplier AS supplier8, lineitem AS lineitem15, orders AS orders8, nation AS nation8) AS t35 ON lineitem14.l_orderkey = t35.l_orderkey AND lineitem14.l_suppkey <> t35.l_suppkey) AS t36 ON lineitem13.l_orderkey = t36.l_orderkey0 AND lineitem13.l_suppkey = t36.l_suppkey0 WHERE supplier7.s_suppkey = lineitem13.l_suppkey AND (orders7.o_orderkey = lineitem13.l_orderkey AND orders7.o_orderstatus = 'F') AND (lineitem13.l_receiptdate > lineitem13.l_commitdate AND supplier7.s_nationkey = nation7.n_nationkey AND (nation7.n_name = 'IRAQ' AND t36.f0 IS NOT NULL))) AS t38 LEFT JOIN (SELECT t44.l_orderkey AS l_orderkey0, t44.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t39 INNER JOIN (SELECT lineitem17.l_orderkey, lineitem17.l_suppkey FROM supplier AS supplier9 CROSS JOIN lineitem AS lineitem17 CROSS JOIN orders AS orders9 CROSS JOIN nation AS nation9 LEFT JOIN (SELECT t40.l_orderkey AS l_orderkey0, t40.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem18 INNER JOIN (SELECT lineitem19.l_orderkey, lineitem19.l_suppkey FROM supplier AS supplier10, lineitem AS lineitem19, orders AS orders10, nation AS nation10) AS t40 ON lineitem18.l_orderkey = t40.l_orderkey AND lineitem18.l_suppkey <> t40.l_suppkey) AS t41 ON lineitem17.l_orderkey = t41.l_orderkey0 AND lineitem17.l_suppkey = t41.l_suppkey0 WHERE supplier9.s_suppkey = lineitem17.l_suppkey AND (orders9.o_orderkey = lineitem17.l_orderkey AND orders9.o_orderstatus = 'F') AND (lineitem17.l_receiptdate > lineitem17.l_commitdate AND supplier9.s_nationkey = nation9.n_nationkey AND (nation9.n_name = 'IRAQ' AND t41.f0 IS NOT NULL))) AS t44 ON t39.l_orderkey = t44.l_orderkey AND t39.l_suppkey <> t44.l_suppkey) AS t45 ON t38.l_orderkey = t45.l_orderkey0 AND t38.l_suppkey = t45.l_suppkey0 WHERE t45.f0 IS NULL GROUP BY t38.s_name ORDER BY COUNT(*) DESC, t38.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
48,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 14 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 14 AND p_type LIKE '%NICKEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
49,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and o_orderdate >= date '1993-01-01' and o_orderdate < date '1993-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT t3.n_name, SUM(t3.l_extendedprice * (1 - t3.l_discount)) AS revenue FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM customer, (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-01-01' AND o_orderdate < (DATE '1993-01-01' + INTERVAL '1' YEAR)) AS t WHERE customer.c_custkey = t.o_custkey) AS t0, lineitem WHERE lineitem.l_orderkey = t0.o_orderkey) AS t1, supplier WHERE t1.l_suppkey = supplier.s_suppkey AND t1.c_nationkey = supplier.s_nationkey) AS t2, nation WHERE t2.s_nationkey = nation.n_nationkey) AS t3, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t4 WHERE t3.n_regionkey = t4.r_regionkey GROUP BY t3.n_name ORDER BY SUM(t3.l_extendedprice * (1 - t3.l_discount)) DESC;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
50,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(7)) = 'ALGERIA' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED TIN') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
51,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%saddle%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation102.n_name AS nation, EXTRACT(YEAR FROM orders102.o_orderdate) AS o_year, SUM(lineitem102.l_extendedprice * (1 - lineitem102.l_discount) - partsupp102.ps_supplycost * lineitem102.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%saddle%') AS t607 CROSS JOIN supplier AS supplier102 INNER JOIN lineitem AS lineitem102 ON supplier102.s_suppkey = lineitem102.l_suppkey AND t607.p_partkey = lineitem102.l_partkey INNER JOIN partsupp AS partsupp102 ON lineitem102.l_suppkey = partsupp102.ps_suppkey AND lineitem102.l_partkey = partsupp102.ps_partkey INNER JOIN orders AS orders102 ON lineitem102.l_orderkey = orders102.o_orderkey INNER JOIN nation AS nation102 ON supplier102.s_nationkey = nation102.n_nationkey GROUP BY nation102.n_name, EXTRACT(YEAR FROM orders102.o_orderdate) ORDER BY nation102.n_name, EXTRACT(YEAR FROM orders102.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
52,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'ARGENTINA' group by s_name order by numwait desc, s_name;","SELECT t23.s_name, COUNT(*) AS numwait FROM (SELECT supplier3.s_suppkey, supplier3.s_name, supplier3.s_address, supplier3.s_nationkey, supplier3.s_phone, supplier3.s_acctbal, supplier3.s_comment, lineitem6.l_orderkey, lineitem6.l_partkey, lineitem6.l_suppkey, lineitem6.l_linenumber, lineitem6.l_quantity, lineitem6.l_extendedprice, lineitem6.l_discount, lineitem6.l_tax, lineitem6.l_returnflag, lineitem6.l_linestatus, lineitem6.l_shipdate, lineitem6.l_commitdate, lineitem6.l_receiptdate, lineitem6.l_shipinstruct, lineitem6.l_shipmode, lineitem6.l_comment, orders3.o_orderkey, orders3.o_custkey, orders3.o_orderstatus, orders3.o_totalprice, orders3.o_orderdate, orders3.o_orderpriority, orders3.o_clerk, orders3.o_shippriority, orders3.o_comment, nation3.n_nationkey, nation3.n_name, nation3.n_regionkey, nation3.n_comment, t21.f0 FROM supplier AS supplier3 CROSS JOIN lineitem AS lineitem6 CROSS JOIN orders AS orders3 CROSS JOIN nation AS nation3 LEFT JOIN (SELECT t20.l_orderkey AS l_orderkey0, t20.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem7 INNER JOIN (SELECT lineitem8.l_orderkey, lineitem8.l_suppkey FROM supplier AS supplier4, lineitem AS lineitem8, orders AS orders4, nation AS nation4) AS t20 ON lineitem7.l_orderkey = t20.l_orderkey AND lineitem7.l_suppkey <> t20.l_suppkey) AS t21 ON lineitem6.l_orderkey = t21.l_orderkey0 AND lineitem6.l_suppkey = t21.l_suppkey0 WHERE supplier3.s_suppkey = lineitem6.l_suppkey AND (orders3.o_orderkey = lineitem6.l_orderkey AND orders3.o_orderstatus = 'F') AND (lineitem6.l_receiptdate > lineitem6.l_commitdate AND supplier3.s_nationkey = nation3.n_nationkey AND (nation3.n_name = 'ARGENTINA' AND t21.f0 IS NOT NULL))) AS t23 LEFT JOIN (SELECT t29.l_orderkey AS l_orderkey0, t29.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t24 INNER JOIN (SELECT lineitem10.l_orderkey, lineitem10.l_suppkey FROM supplier AS supplier5 CROSS JOIN lineitem AS lineitem10 CROSS JOIN orders AS orders5 CROSS JOIN nation AS nation5 LEFT JOIN (SELECT t25.l_orderkey AS l_orderkey0, t25.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem11 INNER JOIN (SELECT lineitem12.l_orderkey, lineitem12.l_suppkey FROM supplier AS supplier6, lineitem AS lineitem12, orders AS orders6, nation AS nation6) AS t25 ON lineitem11.l_orderkey = t25.l_orderkey AND lineitem11.l_suppkey <> t25.l_suppkey) AS t26 ON lineitem10.l_orderkey = t26.l_orderkey0 AND lineitem10.l_suppkey = t26.l_suppkey0 WHERE supplier5.s_suppkey = lineitem10.l_suppkey AND (orders5.o_orderkey = lineitem10.l_orderkey AND orders5.o_orderstatus = 'F') AND (lineitem10.l_receiptdate > lineitem10.l_commitdate AND supplier5.s_nationkey = nation5.n_nationkey AND (nation5.n_name = 'ARGENTINA' AND t26.f0 IS NOT NULL))) AS t29 ON t24.l_orderkey = t29.l_orderkey AND t24.l_suppkey <> t29.l_suppkey) AS t30 ON t23.l_orderkey = t30.l_orderkey0 AND t23.l_suppkey = t30.l_suppkey0 WHERE t30.f0 IS NULL GROUP BY t23.s_name ORDER BY COUNT(*) DESC, t23.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
53,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '20', '34', '35', '29', '44', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '20', '34', '35', '29', '44', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
54,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 8 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 8 AND p_type LIKE '%BRASS') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
55,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-19' and l_shipdate > date '1995-03-19' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t1.l_orderkey, SUM(t1.l_extendedprice * (1 - t1.l_discount)) AS revenue, t0.o_orderdate, t0.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'FURNITURE') AS t INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-19') AS t0 ON t.c_custkey = t0.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-19') AS t1 ON t0.o_orderkey = t1.l_orderkey GROUP BY t1.l_orderkey, t0.o_orderdate, t0.o_shippriority ORDER BY SUM(t1.l_extendedprice * (1 - t1.l_discount)) DESC, t0.o_orderdate;",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
56,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-01-01' and o_orderdate < date '1996-01-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1996-01-01' AND o_orderdate < (DATE '1996-01-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
57,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and o_orderdate >= date '1997-01-01' and o_orderdate < date '1997-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation100.n_name, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount)) AS revenue FROM customer AS customer100 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1997-01-01' AND o_orderdate < (DATE '1997-01-01' + INTERVAL '1' YEAR)) AS t735 ON customer100.c_custkey = t735.o_custkey INNER JOIN lineitem AS lineitem100 ON t735.o_orderkey = lineitem100.l_orderkey INNER JOIN supplier AS supplier100 ON lineitem100.l_suppkey = supplier100.s_suppkey AND customer100.c_nationkey = supplier100.s_nationkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t736 ON nation100.n_regionkey = t736.r_regionkey GROUP BY nation100.n_name ORDER BY SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
58,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'CANADA' and n2.n_name = 'GERMANY') or (n1.n_name = 'GERMANY' and n2.n_name = 'CANADA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation201.n_name AS supp_nation, nation202.n_name AS cust_nation, EXTRACT(YEAR FROM t638.l_shipdate) AS l_year, SUM(t638.l_extendedprice * (1 - t638.l_discount)) AS revenue FROM supplier AS supplier100 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t638 ON supplier100.s_suppkey = t638.l_suppkey INNER JOIN orders AS orders100 ON t638.l_orderkey = orders100.o_orderkey INNER JOIN customer AS customer100 ON orders100.o_custkey = customer100.c_custkey INNER JOIN nation AS nation201 ON supplier100.s_nationkey = nation201.n_nationkey INNER JOIN nation AS nation202 ON customer100.c_nationkey = nation202.n_nationkey AND (nation201.n_name = 'CANADA' AND nation202.n_name = 'GERMANY' OR nation201.n_name = 'GERMANY' AND nation202.n_name = 'CANADA') GROUP BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate) ORDER BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
59,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'GERMANY' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED COPPER') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
60,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'SAUDI ARABIA' group by s_name order by numwait desc, s_name;","SELECT t1803.s_name, COUNT(*) AS numwait FROM (SELECT supplier379.s_suppkey, supplier379.s_name, supplier379.s_address, supplier379.s_nationkey, supplier379.s_phone, supplier379.s_acctbal, supplier379.s_comment, t1798.l_orderkey, t1798.l_partkey, t1798.l_suppkey, t1798.l_linenumber, t1798.l_quantity, t1798.l_extendedprice, t1798.l_discount, t1798.l_tax, t1798.l_returnflag, t1798.l_linestatus, t1798.l_shipdate, t1798.l_commitdate, t1798.l_receiptdate, t1798.l_shipinstruct, t1798.l_shipmode, t1798.l_comment, t1799.o_orderkey, t1799.o_custkey, t1799.o_orderstatus, t1799.o_totalprice, t1799.o_orderdate, t1799.o_orderpriority, t1799.o_clerk, t1799.o_shippriority, t1799.o_comment, t1800.n_nationkey, t1800.n_name, t1800.n_regionkey, t1800.n_comment, CAST(t1802.f0 AS BOOLEAN) AS f0 FROM supplier AS supplier379 INNER JOIN (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t1798 ON supplier379.s_suppkey = t1798.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t1799 ON t1798.l_orderkey = t1799.o_orderkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'SAUDI ARABIA') AS t1800 ON supplier379.s_nationkey = t1800.n_nationkey INNER JOIN (SELECT t1801.l_orderkey AS l_orderkey0, t1801.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem665 INNER JOIN (SELECT lineitem666.l_orderkey, lineitem666.l_suppkey FROM supplier AS supplier380, lineitem AS lineitem666, orders AS orders380, nation AS nation380) AS t1801 ON lineitem665.l_orderkey = t1801.l_orderkey AND lineitem665.l_suppkey <> t1801.l_suppkey) AS t1802 ON t1798.l_orderkey = t1802.l_orderkey0 AND t1798.l_suppkey = t1802.l_suppkey0) AS t1803 LEFT JOIN (SELECT t1810.l_orderkey AS l_orderkey0, t1810.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t1804 INNER JOIN (SELECT t1805.l_orderkey, t1805.l_suppkey FROM supplier AS supplier381 INNER JOIN (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t1805 ON supplier381.s_suppkey = t1805.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t1806 ON t1805.l_orderkey = t1806.o_orderkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'SAUDI ARABIA') AS t1807 ON supplier381.s_nationkey = t1807.n_nationkey INNER JOIN (SELECT t1808.l_orderkey AS l_orderkey0, t1808.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem669 INNER JOIN (SELECT lineitem670.l_orderkey, lineitem670.l_suppkey FROM supplier AS supplier382, lineitem AS lineitem670, orders AS orders382, nation AS nation382) AS t1808 ON lineitem669.l_orderkey = t1808.l_orderkey AND lineitem669.l_suppkey <> t1808.l_suppkey) AS t1809 ON t1805.l_orderkey = t1809.l_orderkey0 AND t1805.l_suppkey = t1809.l_suppkey0) AS t1810 ON t1804.l_orderkey = t1810.l_orderkey AND t1804.l_suppkey <> t1810.l_suppkey) AS t1811 ON t1803.l_orderkey = t1811.l_orderkey0 AND t1803.l_suppkey = t1811.l_suppkey0 WHERE t1811.f0 IS NULL GROUP BY t1803.s_name ORDER BY COUNT(*) DESC, t1803.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
61,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '31', '41', '20', '27', '38', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '31', '41', '20', '27', '38', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '26'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '26')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
62,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 15 AND p_type LIKE '%STEEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
63,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and o_orderdate >= date '1995-01-01' and o_orderdate < date '1995-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation100.n_name, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount)) AS revenue FROM customer AS customer100 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate < (DATE '1995-01-01' + INTERVAL '1' YEAR)) AS t735 ON customer100.c_custkey = t735.o_custkey INNER JOIN lineitem AS lineitem100 ON t735.o_orderkey = lineitem100.l_orderkey INNER JOIN supplier AS supplier100 ON lineitem100.l_suppkey = supplier100.s_suppkey AND customer100.c_nationkey = supplier100.s_nationkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t736 ON nation100.n_regionkey = t736.r_regionkey GROUP BY nation100.n_name ORDER BY SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
64,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(6)) = 'RUSSIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BRUSHED COPPER') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
65,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%papaya%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation102.n_name AS nation, EXTRACT(YEAR FROM orders102.o_orderdate) AS o_year, SUM(lineitem102.l_extendedprice * (1 - lineitem102.l_discount) - partsupp102.ps_supplycost * lineitem102.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%papaya%') AS t607 CROSS JOIN supplier AS supplier102 INNER JOIN lineitem AS lineitem102 ON supplier102.s_suppkey = lineitem102.l_suppkey AND t607.p_partkey = lineitem102.l_partkey INNER JOIN partsupp AS partsupp102 ON lineitem102.l_suppkey = partsupp102.ps_suppkey AND lineitem102.l_partkey = partsupp102.ps_partkey INNER JOIN orders AS orders102 ON lineitem102.l_orderkey = orders102.o_orderkey INNER JOIN nation AS nation102 ON supplier102.s_nationkey = nation102.n_nationkey GROUP BY nation102.n_name, EXTRACT(YEAR FROM orders102.o_orderdate) ORDER BY nation102.n_name, EXTRACT(YEAR FROM orders102.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
66,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '27', '20', '25', '43', '33', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '27', '20', '25', '43', '33', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
67,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 36 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 36 AND p_type LIKE '%TIN') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
68,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and o_orderdate >= date '1997-01-01' and o_orderdate < date '1997-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation102.n_name, SUM(lineitem102.l_extendedprice * (1 - lineitem102.l_discount)) AS revenue FROM customer AS customer102 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1997-01-01' AND o_orderdate < (DATE '1997-01-01' + INTERVAL '1' YEAR)) AS t755 ON customer102.c_custkey = t755.o_custkey INNER JOIN lineitem AS lineitem102 ON t755.o_orderkey = lineitem102.l_orderkey INNER JOIN supplier AS supplier102 ON lineitem102.l_suppkey = supplier102.s_suppkey AND customer102.c_nationkey = supplier102.s_nationkey INNER JOIN nation AS nation102 ON supplier102.s_nationkey = nation102.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t756 ON nation102.n_regionkey = t756.r_regionkey GROUP BY nation102.n_name ORDER BY SUM(lineitem102.l_extendedprice * (1 - lineitem102.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
69,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(9)) = 'INDONESIA' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'LARGE PLATED NICKEL') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
70,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'ALGERIA' group by s_name order by numwait desc, s_name;","SELECT t34.s_name, COUNT(*) AS numwait FROM (SELECT supplier7.s_suppkey, supplier7.s_name, supplier7.s_address, supplier7.s_nationkey, supplier7.s_phone, supplier7.s_acctbal, supplier7.s_comment, lineitem13.l_orderkey, lineitem13.l_partkey, lineitem13.l_suppkey, lineitem13.l_linenumber, lineitem13.l_quantity, lineitem13.l_extendedprice, lineitem13.l_discount, lineitem13.l_tax, lineitem13.l_returnflag, lineitem13.l_linestatus, lineitem13.l_shipdate, lineitem13.l_commitdate, lineitem13.l_receiptdate, lineitem13.l_shipinstruct, lineitem13.l_shipmode, lineitem13.l_comment, orders7.o_orderkey, orders7.o_custkey, orders7.o_orderstatus, orders7.o_totalprice, orders7.o_orderdate, orders7.o_orderpriority, orders7.o_clerk, orders7.o_shippriority, orders7.o_comment, nation7.n_nationkey, nation7.n_name, nation7.n_regionkey, nation7.n_comment, t32.f0 FROM supplier AS supplier7 CROSS JOIN lineitem AS lineitem13 CROSS JOIN orders AS orders7 CROSS JOIN nation AS nation7 LEFT JOIN (SELECT t31.l_orderkey AS l_orderkey0, t31.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem14 INNER JOIN (SELECT lineitem15.l_orderkey, lineitem15.l_suppkey FROM supplier AS supplier8, lineitem AS lineitem15, orders AS orders8, nation AS nation8) AS t31 ON lineitem14.l_orderkey = t31.l_orderkey AND lineitem14.l_suppkey <> t31.l_suppkey) AS t32 ON lineitem13.l_orderkey = t32.l_orderkey0 AND lineitem13.l_suppkey = t32.l_suppkey0 WHERE supplier7.s_suppkey = lineitem13.l_suppkey AND (orders7.o_orderkey = lineitem13.l_orderkey AND orders7.o_orderstatus = 'F') AND (lineitem13.l_receiptdate > lineitem13.l_commitdate AND supplier7.s_nationkey = nation7.n_nationkey AND (nation7.n_name = 'ALGERIA' AND t32.f0 IS NOT NULL))) AS t34 LEFT JOIN (SELECT t40.l_orderkey AS l_orderkey0, t40.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t35 INNER JOIN (SELECT lineitem17.l_orderkey, lineitem17.l_suppkey FROM supplier AS supplier9 CROSS JOIN lineitem AS lineitem17 CROSS JOIN orders AS orders9 CROSS JOIN nation AS nation9 LEFT JOIN (SELECT t36.l_orderkey AS l_orderkey0, t36.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem18 INNER JOIN (SELECT lineitem19.l_orderkey, lineitem19.l_suppkey FROM supplier AS supplier10, lineitem AS lineitem19, orders AS orders10, nation AS nation10) AS t36 ON lineitem18.l_orderkey = t36.l_orderkey AND lineitem18.l_suppkey <> t36.l_suppkey) AS t37 ON lineitem17.l_orderkey = t37.l_orderkey0 AND lineitem17.l_suppkey = t37.l_suppkey0 WHERE supplier9.s_suppkey = lineitem17.l_suppkey AND (orders9.o_orderkey = lineitem17.l_orderkey AND orders9.o_orderstatus = 'F') AND (lineitem17.l_receiptdate > lineitem17.l_commitdate AND supplier9.s_nationkey = nation9.n_nationkey AND (nation9.n_name = 'ALGERIA' AND t37.f0 IS NOT NULL))) AS t40 ON t35.l_orderkey = t40.l_orderkey AND t35.l_suppkey <> t40.l_suppkey) AS t41 ON t34.l_orderkey = t41.l_orderkey0 AND t34.l_suppkey = t41.l_suppkey0 WHERE t41.f0 IS NULL GROUP BY t34.s_name ORDER BY COUNT(*) DESC, t34.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
71,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '26', '27', '39', '37', '30', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '26', '27', '39', '37', '30', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '36'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '36')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
72,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 12 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 12 AND p_type LIKE '%NICKEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
73,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and o_orderdate >= date '1995-01-01' and o_orderdate < date '1995-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation103.n_name, SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount)) AS revenue FROM customer AS customer103 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate < (DATE '1995-01-01' + INTERVAL '1' YEAR)) AS t765 ON customer103.c_custkey = t765.o_custkey INNER JOIN lineitem AS lineitem103 ON t765.o_orderkey = lineitem103.l_orderkey INNER JOIN supplier AS supplier103 ON lineitem103.l_suppkey = supplier103.s_suppkey AND customer103.c_nationkey = supplier103.s_nationkey INNER JOIN nation AS nation103 ON supplier103.s_nationkey = nation103.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t766 ON nation103.n_regionkey = t766.r_regionkey GROUP BY nation103.n_name ORDER BY SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
74,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'ALGERIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED COPPER') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
75,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-05-01' and o_orderdate < date '1994-05-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","SELECT t742.c_custkey, t742.c_name, SUM(t742.l_extendedprice * (1 - t742.l_discount)) AS revenue, t742.c_acctbal, nation100.n_name, t742.c_address, t742.c_phone, t742.c_comment FROM (SELECT * FROM (SELECT * FROM customer AS customer100, (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-05-01' AND o_orderdate < (DATE '1994-05-01' + INTERVAL '3' MONTH)) AS t739 WHERE customer100.c_custkey = t739.o_custkey) AS t740, (SELECT * FROM lineitem WHERE l_returnflag = 'R') AS t741 WHERE t741.l_orderkey = t740.o_orderkey) AS t742, nation AS nation100 WHERE t742.c_nationkey = nation100.n_nationkey GROUP BY t742.c_custkey, t742.c_name, t742.c_acctbal, t742.c_phone, nation100.n_name, t742.c_address, t742.c_comment ORDER BY SUM(t742.l_extendedprice * (1 - t742.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
76,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '34', '27', '36', '31', '30', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '34', '27', '36', '31', '30', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '25'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '25')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
77,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 41 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 41 AND p_type LIKE '%TIN') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
78,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-24' and l_shipdate > date '1995-03-24' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t775.l_orderkey, SUM(t775.l_extendedprice * (1 - t775.l_discount)) AS revenue, t774.o_orderdate, t774.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'HOUSEHOLD') AS t772, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-24') AS t773 WHERE t772.c_custkey = t773.o_custkey) AS t774, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-24') AS t775 WHERE t775.l_orderkey = t774.o_orderkey GROUP BY t775.l_orderkey, t774.o_orderdate, t774.o_shippriority ORDER BY SUM(t775.l_extendedprice * (1 - t775.l_discount)) DESC, t774.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
79,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-10-01' and o_orderdate < date '1996-10-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1996-10-01' AND o_orderdate < (DATE '1996-10-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
80,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(4)) = 'PERU' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED NICKEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
81,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%lemon%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation100.n_name AS nation, EXTRACT(YEAR FROM orders100.o_orderdate) AS o_year, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount) - partsupp100.ps_supplycost * lineitem100.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%lemon%') AS t591 CROSS JOIN supplier AS supplier100 INNER JOIN lineitem AS lineitem100 ON supplier100.s_suppkey = lineitem100.l_suppkey AND t591.p_partkey = lineitem100.l_partkey INNER JOIN partsupp AS partsupp100 ON lineitem100.l_suppkey = partsupp100.ps_suppkey AND lineitem100.l_partkey = partsupp100.ps_partkey INNER JOIN orders AS orders100 ON lineitem100.l_orderkey = orders100.o_orderkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey GROUP BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) ORDER BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
82,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'BRAZIL' group by s_name order by numwait desc, s_name;","SELECT t2.s_name, COUNT(*) AS numwait FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t0.f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t.l_orderkey AS l_orderkey0, t.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem0 INNER JOIN (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0) AS t ON lineitem0.l_orderkey = t.l_orderkey AND lineitem0.l_suppkey <> t.l_suppkey) AS t0 ON lineitem.l_orderkey = t0.l_orderkey0 AND lineitem.l_suppkey = t0.l_suppkey0 WHERE supplier.s_suppkey = lineitem.l_suppkey AND (orders.o_orderkey = lineitem.l_orderkey AND orders.o_orderstatus = 'F') AND (lineitem.l_receiptdate > lineitem.l_commitdate AND supplier.s_nationkey = nation.n_nationkey AND (nation.n_name = 'BRAZIL' AND t0.f0 IS NOT NULL))) AS t2 LEFT JOIN (SELECT t8.l_orderkey AS l_orderkey0, t8.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t3 INNER JOIN (SELECT lineitem3.l_orderkey, lineitem3.l_suppkey FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t4.l_orderkey AS l_orderkey0, t4.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem4 INNER JOIN (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2) AS t4 ON lineitem4.l_orderkey = t4.l_orderkey AND lineitem4.l_suppkey <> t4.l_suppkey) AS t5 ON lineitem3.l_orderkey = t5.l_orderkey0 AND lineitem3.l_suppkey = t5.l_suppkey0 WHERE supplier1.s_suppkey = lineitem3.l_suppkey AND (orders1.o_orderkey = lineitem3.l_orderkey AND orders1.o_orderstatus = 'F') AND (lineitem3.l_receiptdate > lineitem3.l_commitdate AND supplier1.s_nationkey = nation1.n_nationkey AND (nation1.n_name = 'BRAZIL' AND t5.f0 IS NOT NULL))) AS t8 ON t3.l_orderkey = t8.l_orderkey AND t3.l_suppkey <> t8.l_suppkey) AS t9 ON t2.l_orderkey = t9.l_orderkey0 AND t2.l_suppkey = t9.l_suppkey0 WHERE t9.f0 IS NULL GROUP BY t2.s_name ORDER BY COUNT(*) DESC, t2.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
83,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '26', '37', '32', '44', '31', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '26', '37', '32', '44', '31', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
84,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 12 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 12 AND p_type LIKE '%NICKEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
85,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-10' and l_shipdate > date '1995-03-10' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t814.l_orderkey, SUM(t814.l_extendedprice * (1 - t814.l_discount)) AS revenue, t813.o_orderdate, t813.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'BUILDING') AS t811, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-10') AS t812 WHERE t811.c_custkey = t812.o_custkey) AS t813, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-10') AS t814 WHERE t814.l_orderkey = t813.o_orderkey GROUP BY t814.l_orderkey, t813.o_orderdate, t813.o_shippriority ORDER BY SUM(t814.l_extendedprice * (1 - t814.l_discount)) DESC, t813.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
86,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and o_orderdate >= date '1997-01-01' and o_orderdate < date '1997-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation99.n_name, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount)) AS revenue FROM customer AS customer99 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1997-01-01' AND o_orderdate < (DATE '1997-01-01' + INTERVAL '1' YEAR)) AS t725 ON customer99.c_custkey = t725.o_custkey INNER JOIN lineitem AS lineitem99 ON t725.o_orderkey = lineitem99.l_orderkey INNER JOIN supplier AS supplier99 ON lineitem99.l_suppkey = supplier99.s_suppkey AND customer99.c_nationkey = supplier99.s_nationkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t726 ON nation99.n_regionkey = t726.r_regionkey GROUP BY nation99.n_name ORDER BY SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
87,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%honeydew%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation99.n_name AS nation, EXTRACT(YEAR FROM orders99.o_orderdate) AS o_year, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount) - partsupp99.ps_supplycost * lineitem99.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%honeydew%') AS t583 CROSS JOIN supplier AS supplier99 INNER JOIN lineitem AS lineitem99 ON supplier99.s_suppkey = lineitem99.l_suppkey AND t583.p_partkey = lineitem99.l_partkey INNER JOIN partsupp AS partsupp99 ON lineitem99.l_suppkey = partsupp99.ps_suppkey AND lineitem99.l_partkey = partsupp99.ps_partkey INNER JOIN orders AS orders99 ON lineitem99.l_orderkey = orders99.o_orderkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey GROUP BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) ORDER BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
88,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '26', '41', '24', '38', '28', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '26', '41', '24', '38', '28', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
89,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 39 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 39 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
90,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'UNITED STATES' and n2.n_name = 'BRAZIL') or (n1.n_name = 'BRAZIL' and n2.n_name = 'UNITED STATES') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'UNITED STATES' AND nation0.n_name = 'BRAZIL' OR nation.n_name = 'BRAZIL' AND nation0.n_name = 'UNITED STATES') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
91,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(6)) = 'BRAZIL' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL BRUSHED TIN') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
92,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%floral%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation102.n_name AS nation, EXTRACT(YEAR FROM orders102.o_orderdate) AS o_year, SUM(lineitem102.l_extendedprice * (1 - lineitem102.l_discount) - partsupp102.ps_supplycost * lineitem102.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%floral%') AS t607 CROSS JOIN supplier AS supplier102 INNER JOIN lineitem AS lineitem102 ON supplier102.s_suppkey = lineitem102.l_suppkey AND t607.p_partkey = lineitem102.l_partkey INNER JOIN partsupp AS partsupp102 ON lineitem102.l_suppkey = partsupp102.ps_suppkey AND lineitem102.l_partkey = partsupp102.ps_partkey INNER JOIN orders AS orders102 ON lineitem102.l_orderkey = orders102.o_orderkey INNER JOIN nation AS nation102 ON supplier102.s_nationkey = nation102.n_nationkey GROUP BY nation102.n_name, EXTRACT(YEAR FROM orders102.o_orderdate) ORDER BY nation102.n_name, EXTRACT(YEAR FROM orders102.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
93,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '24', '29', '40', '43', '22', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '24', '29', '40', '43', '22', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
94,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 36 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 36 AND p_type LIKE '%STEEL') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
95,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD PLATED BRASS') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
96,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('AIR', 'SHIP') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1997-01-01' and l_receiptdate < date '1997-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders INNER JOIN (SELECT * FROM lineitem WHERE l_shipmode IN ('AIR', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1997-01-01' AND l_receiptdate < (DATE '1997-01-01' + INTERVAL '1' YEAR)) AS t ON orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]"
97,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'VIETNAM' group by s_name order by numwait desc, s_name;","SELECT t49.s_name, COUNT(*) AS numwait FROM (SELECT supplier11.s_suppkey, supplier11.s_name, supplier11.s_address, supplier11.s_nationkey, supplier11.s_phone, supplier11.s_acctbal, supplier11.s_comment, lineitem20.l_orderkey, lineitem20.l_partkey, lineitem20.l_suppkey, lineitem20.l_linenumber, lineitem20.l_quantity, lineitem20.l_extendedprice, lineitem20.l_discount, lineitem20.l_tax, lineitem20.l_returnflag, lineitem20.l_linestatus, lineitem20.l_shipdate, lineitem20.l_commitdate, lineitem20.l_receiptdate, lineitem20.l_shipinstruct, lineitem20.l_shipmode, lineitem20.l_comment, orders11.o_orderkey, orders11.o_custkey, orders11.o_orderstatus, orders11.o_totalprice, orders11.o_orderdate, orders11.o_orderpriority, orders11.o_clerk, orders11.o_shippriority, orders11.o_comment, nation11.n_nationkey, nation11.n_name, nation11.n_regionkey, nation11.n_comment, t47.f0 FROM supplier AS supplier11 CROSS JOIN lineitem AS lineitem20 CROSS JOIN orders AS orders11 CROSS JOIN nation AS nation11 LEFT JOIN (SELECT t46.l_orderkey AS l_orderkey0, t46.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem21 INNER JOIN (SELECT lineitem22.l_orderkey, lineitem22.l_suppkey FROM supplier AS supplier12, lineitem AS lineitem22, orders AS orders12, nation AS nation12) AS t46 ON lineitem21.l_orderkey = t46.l_orderkey AND lineitem21.l_suppkey <> t46.l_suppkey) AS t47 ON lineitem20.l_orderkey = t47.l_orderkey0 AND lineitem20.l_suppkey = t47.l_suppkey0 WHERE supplier11.s_suppkey = lineitem20.l_suppkey AND (orders11.o_orderkey = lineitem20.l_orderkey AND orders11.o_orderstatus = 'F') AND (lineitem20.l_receiptdate > lineitem20.l_commitdate AND supplier11.s_nationkey = nation11.n_nationkey AND (nation11.n_name = 'VIETNAM' AND t47.f0 IS NOT NULL))) AS t49 LEFT JOIN (SELECT t55.l_orderkey AS l_orderkey0, t55.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t50 INNER JOIN (SELECT lineitem24.l_orderkey, lineitem24.l_suppkey FROM supplier AS supplier13 CROSS JOIN lineitem AS lineitem24 CROSS JOIN orders AS orders13 CROSS JOIN nation AS nation13 LEFT JOIN (SELECT t51.l_orderkey AS l_orderkey0, t51.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem25 INNER JOIN (SELECT lineitem26.l_orderkey, lineitem26.l_suppkey FROM supplier AS supplier14, lineitem AS lineitem26, orders AS orders14, nation AS nation14) AS t51 ON lineitem25.l_orderkey = t51.l_orderkey AND lineitem25.l_suppkey <> t51.l_suppkey) AS t52 ON lineitem24.l_orderkey = t52.l_orderkey0 AND lineitem24.l_suppkey = t52.l_suppkey0 WHERE supplier13.s_suppkey = lineitem24.l_suppkey AND (orders13.o_orderkey = lineitem24.l_orderkey AND orders13.o_orderstatus = 'F') AND (lineitem24.l_receiptdate > lineitem24.l_commitdate AND supplier13.s_nationkey = nation13.n_nationkey AND (nation13.n_name = 'VIETNAM' AND t52.f0 IS NOT NULL))) AS t55 ON t50.l_orderkey = t55.l_orderkey AND t50.l_suppkey <> t55.l_suppkey) AS t56 ON t49.l_orderkey = t56.l_orderkey0 AND t49.l_suppkey = t56.l_suppkey0 WHERE t56.f0 IS NULL GROUP BY t49.s_name ORDER BY COUNT(*) DESC, t49.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
98,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '44', '25', '20', '41', '32', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '44', '25', '20', '41', '32', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '40'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '40')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
99,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 20 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 20 AND p_type LIKE '%STEEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
100,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-08' and l_shipdate > date '1995-03-08' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t800.l_orderkey, SUM(t800.l_extendedprice * (1 - t800.l_discount)) AS revenue, t799.o_orderdate, t799.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t797, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-08') AS t798 WHERE t797.c_custkey = t798.o_custkey) AS t799, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-08') AS t800 WHERE t800.l_orderkey = t799.o_orderkey GROUP BY t800.l_orderkey, t799.o_orderdate, t799.o_shippriority ORDER BY SUM(t800.l_extendedprice * (1 - t800.l_discount)) DESC, t799.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
101,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and o_orderdate >= date '1993-01-01' and o_orderdate < date '1993-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation99.n_name, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount)) AS revenue FROM customer AS customer99 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-01-01' AND o_orderdate < (DATE '1993-01-01' + INTERVAL '1' YEAR)) AS t725 ON customer99.c_custkey = t725.o_custkey INNER JOIN lineitem AS lineitem99 ON t725.o_orderkey = lineitem99.l_orderkey INNER JOIN supplier AS supplier99 ON lineitem99.l_suppkey = supplier99.s_suppkey AND customer99.c_nationkey = supplier99.s_nationkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t726 ON nation99.n_regionkey = t726.r_regionkey GROUP BY nation99.n_name ORDER BY SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
102,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(5)) = 'EGYPT' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BURNISHED STEEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
103,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%midnight%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation99.n_name AS nation, EXTRACT(YEAR FROM orders99.o_orderdate) AS o_year, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount) - partsupp99.ps_supplycost * lineitem99.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%midnight%') AS t583 CROSS JOIN supplier AS supplier99 INNER JOIN lineitem AS lineitem99 ON supplier99.s_suppkey = lineitem99.l_suppkey AND t583.p_partkey = lineitem99.l_partkey INNER JOIN partsupp AS partsupp99 ON lineitem99.l_suppkey = partsupp99.ps_suppkey AND lineitem99.l_partkey = partsupp99.ps_partkey INNER JOIN orders AS orders99 ON lineitem99.l_orderkey = orders99.o_orderkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey GROUP BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) ORDER BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
104,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'PERU' group by s_name order by numwait desc, s_name;","SELECT t2118.s_name, COUNT(*) AS numwait FROM (SELECT supplier399.s_suppkey, supplier399.s_name, supplier399.s_address, supplier399.s_nationkey, supplier399.s_phone, supplier399.s_acctbal, supplier399.s_comment, t2113.l_orderkey, t2113.l_partkey, t2113.l_suppkey, t2113.l_linenumber, t2113.l_quantity, t2113.l_extendedprice, t2113.l_discount, t2113.l_tax, t2113.l_returnflag, t2113.l_linestatus, t2113.l_shipdate, t2113.l_commitdate, t2113.l_receiptdate, t2113.l_shipinstruct, t2113.l_shipmode, t2113.l_comment, t2114.o_orderkey, t2114.o_custkey, t2114.o_orderstatus, t2114.o_totalprice, t2114.o_orderdate, t2114.o_orderpriority, t2114.o_clerk, t2114.o_shippriority, t2114.o_comment, t2115.n_nationkey, t2115.n_name, t2115.n_regionkey, t2115.n_comment, CAST(t2117.f0 AS BOOLEAN) AS f0 FROM supplier AS supplier399 INNER JOIN (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t2113 ON supplier399.s_suppkey = t2113.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t2114 ON t2113.l_orderkey = t2114.o_orderkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'PERU') AS t2115 ON supplier399.s_nationkey = t2115.n_nationkey INNER JOIN (SELECT t2116.l_orderkey AS l_orderkey0, t2116.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem700 INNER JOIN (SELECT lineitem701.l_orderkey, lineitem701.l_suppkey FROM supplier AS supplier400, lineitem AS lineitem701, orders AS orders400, nation AS nation400) AS t2116 ON lineitem700.l_orderkey = t2116.l_orderkey AND lineitem700.l_suppkey <> t2116.l_suppkey) AS t2117 ON t2113.l_orderkey = t2117.l_orderkey0 AND t2113.l_suppkey = t2117.l_suppkey0) AS t2118 LEFT JOIN (SELECT t2125.l_orderkey AS l_orderkey0, t2125.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t2119 INNER JOIN (SELECT t2120.l_orderkey, t2120.l_suppkey FROM supplier AS supplier401 INNER JOIN (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t2120 ON supplier401.s_suppkey = t2120.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t2121 ON t2120.l_orderkey = t2121.o_orderkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'PERU') AS t2122 ON supplier401.s_nationkey = t2122.n_nationkey INNER JOIN (SELECT t2123.l_orderkey AS l_orderkey0, t2123.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem704 INNER JOIN (SELECT lineitem705.l_orderkey, lineitem705.l_suppkey FROM supplier AS supplier402, lineitem AS lineitem705, orders AS orders402, nation AS nation402) AS t2123 ON lineitem704.l_orderkey = t2123.l_orderkey AND lineitem704.l_suppkey <> t2123.l_suppkey) AS t2124 ON t2120.l_orderkey = t2124.l_orderkey0 AND t2120.l_suppkey = t2124.l_suppkey0) AS t2125 ON t2119.l_orderkey = t2125.l_orderkey AND t2119.l_suppkey <> t2125.l_suppkey) AS t2126 ON t2118.l_orderkey = t2126.l_orderkey0 AND t2118.l_suppkey = t2126.l_suppkey0 WHERE t2126.f0 IS NULL GROUP BY t2118.s_name ORDER BY COUNT(*) DESC, t2118.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
105,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '27', '34', '41', '29', '22', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '27', '34', '41', '29', '22', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
106,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 7 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 7 AND p_type LIKE '%BRASS') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
107,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'VIETNAM' and n2.n_name = 'JAPAN') or (n1.n_name = 'JAPAN' and n2.n_name = 'VIETNAM') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation205.n_name AS supp_nation, nation206.n_name AS cust_nation, EXTRACT(YEAR FROM t656.l_shipdate) AS l_year, SUM(t656.l_extendedprice * (1 - t656.l_discount)) AS revenue FROM supplier AS supplier102 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t656 ON supplier102.s_suppkey = t656.l_suppkey INNER JOIN orders AS orders102 ON t656.l_orderkey = orders102.o_orderkey INNER JOIN customer AS customer102 ON orders102.o_custkey = customer102.c_custkey INNER JOIN nation AS nation205 ON supplier102.s_nationkey = nation205.n_nationkey INNER JOIN nation AS nation206 ON customer102.c_nationkey = nation206.n_nationkey AND (nation205.n_name = 'VIETNAM' AND nation206.n_name = 'JAPAN' OR nation205.n_name = 'JAPAN' AND nation206.n_name = 'VIETNAM') GROUP BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate) ORDER BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
108,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'VIETNAM' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED COPPER') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
109,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%lime%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation99.n_name AS nation, EXTRACT(YEAR FROM orders99.o_orderdate) AS o_year, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount) - partsupp99.ps_supplycost * lineitem99.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%lime%') AS t583 CROSS JOIN supplier AS supplier99 INNER JOIN lineitem AS lineitem99 ON supplier99.s_suppkey = lineitem99.l_suppkey AND t583.p_partkey = lineitem99.l_partkey INNER JOIN partsupp AS partsupp99 ON lineitem99.l_suppkey = partsupp99.ps_suppkey AND lineitem99.l_partkey = partsupp99.ps_partkey INNER JOIN orders AS orders99 ON lineitem99.l_orderkey = orders99.o_orderkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey GROUP BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) ORDER BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
110,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'INDONESIA' group by s_name order by numwait desc, s_name;","SELECT t1952.s_name, COUNT(*) AS numwait FROM (SELECT supplier407.s_suppkey, supplier407.s_name, supplier407.s_address, supplier407.s_nationkey, supplier407.s_phone, supplier407.s_acctbal, supplier407.s_comment, t1947.l_orderkey, t1947.l_partkey, t1947.l_suppkey, t1947.l_linenumber, t1947.l_quantity, t1947.l_extendedprice, t1947.l_discount, t1947.l_tax, t1947.l_returnflag, t1947.l_linestatus, t1947.l_shipdate, t1947.l_commitdate, t1947.l_receiptdate, t1947.l_shipinstruct, t1947.l_shipmode, t1947.l_comment, t1948.o_orderkey, t1948.o_custkey, t1948.o_orderstatus, t1948.o_totalprice, t1948.o_orderdate, t1948.o_orderpriority, t1948.o_clerk, t1948.o_shippriority, t1948.o_comment, t1949.n_nationkey, t1949.n_name, t1949.n_regionkey, t1949.n_comment, CAST(t1951.f0 AS BOOLEAN) AS f0 FROM supplier AS supplier407 INNER JOIN (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t1947 ON supplier407.s_suppkey = t1947.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t1948 ON t1947.l_orderkey = t1948.o_orderkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'INDONESIA') AS t1949 ON supplier407.s_nationkey = t1949.n_nationkey INNER JOIN (SELECT t1950.l_orderkey AS l_orderkey0, t1950.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem714 INNER JOIN (SELECT lineitem715.l_orderkey, lineitem715.l_suppkey FROM supplier AS supplier408, lineitem AS lineitem715, orders AS orders408, nation AS nation408) AS t1950 ON lineitem714.l_orderkey = t1950.l_orderkey AND lineitem714.l_suppkey <> t1950.l_suppkey) AS t1951 ON t1947.l_orderkey = t1951.l_orderkey0 AND t1947.l_suppkey = t1951.l_suppkey0) AS t1952 LEFT JOIN (SELECT t1959.l_orderkey AS l_orderkey0, t1959.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t1953 INNER JOIN (SELECT t1954.l_orderkey, t1954.l_suppkey FROM supplier AS supplier409 INNER JOIN (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t1954 ON supplier409.s_suppkey = t1954.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t1955 ON t1954.l_orderkey = t1955.o_orderkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'INDONESIA') AS t1956 ON supplier409.s_nationkey = t1956.n_nationkey INNER JOIN (SELECT t1957.l_orderkey AS l_orderkey0, t1957.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem718 INNER JOIN (SELECT lineitem719.l_orderkey, lineitem719.l_suppkey FROM supplier AS supplier410, lineitem AS lineitem719, orders AS orders410, nation AS nation410) AS t1957 ON lineitem718.l_orderkey = t1957.l_orderkey AND lineitem718.l_suppkey <> t1957.l_suppkey) AS t1958 ON t1954.l_orderkey = t1958.l_orderkey0 AND t1954.l_suppkey = t1958.l_suppkey0) AS t1959 ON t1953.l_orderkey = t1959.l_orderkey AND t1953.l_suppkey <> t1959.l_suppkey) AS t1960 ON t1952.l_orderkey = t1960.l_orderkey0 AND t1952.l_suppkey = t1960.l_suppkey0 WHERE t1960.f0 IS NULL GROUP BY t1952.s_name ORDER BY COUNT(*) DESC, t1952.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
111,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 48 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 48 AND p_type LIKE '%COPPER') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
112,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-04-01' and o_orderdate < date '1995-04-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-04-01' AND o_orderdate < (DATE '1995-04-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
113,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(6)) = 'FRANCE' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BRUSHED BRASS') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
114,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'EGYPT' group by s_name order by numwait desc, s_name;","SELECT t16.s_name, COUNT(*) AS numwait FROM (SELECT supplier3.s_suppkey, supplier3.s_name, supplier3.s_address, supplier3.s_nationkey, supplier3.s_phone, supplier3.s_acctbal, supplier3.s_comment, lineitem6.l_orderkey, lineitem6.l_partkey, lineitem6.l_suppkey, lineitem6.l_linenumber, lineitem6.l_quantity, lineitem6.l_extendedprice, lineitem6.l_discount, lineitem6.l_tax, lineitem6.l_returnflag, lineitem6.l_linestatus, lineitem6.l_shipdate, lineitem6.l_commitdate, lineitem6.l_receiptdate, lineitem6.l_shipinstruct, lineitem6.l_shipmode, lineitem6.l_comment, orders3.o_orderkey, orders3.o_custkey, orders3.o_orderstatus, orders3.o_totalprice, orders3.o_orderdate, orders3.o_orderpriority, orders3.o_clerk, orders3.o_shippriority, orders3.o_comment, nation3.n_nationkey, nation3.n_name, nation3.n_regionkey, nation3.n_comment, t14.f0 FROM supplier AS supplier3 CROSS JOIN lineitem AS lineitem6 CROSS JOIN orders AS orders3 CROSS JOIN nation AS nation3 LEFT JOIN (SELECT t13.l_orderkey AS l_orderkey0, t13.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem7 INNER JOIN (SELECT lineitem8.l_orderkey, lineitem8.l_suppkey FROM supplier AS supplier4, lineitem AS lineitem8, orders AS orders4, nation AS nation4) AS t13 ON lineitem7.l_orderkey = t13.l_orderkey AND lineitem7.l_suppkey <> t13.l_suppkey) AS t14 ON lineitem6.l_orderkey = t14.l_orderkey0 AND lineitem6.l_suppkey = t14.l_suppkey0 WHERE supplier3.s_suppkey = lineitem6.l_suppkey AND (orders3.o_orderkey = lineitem6.l_orderkey AND orders3.o_orderstatus = 'F') AND (lineitem6.l_receiptdate > lineitem6.l_commitdate AND supplier3.s_nationkey = nation3.n_nationkey AND (nation3.n_name = 'EGYPT' AND t14.f0 IS NOT NULL))) AS t16 LEFT JOIN (SELECT t22.l_orderkey AS l_orderkey0, t22.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t17 INNER JOIN (SELECT lineitem10.l_orderkey, lineitem10.l_suppkey FROM supplier AS supplier5 CROSS JOIN lineitem AS lineitem10 CROSS JOIN orders AS orders5 CROSS JOIN nation AS nation5 LEFT JOIN (SELECT t18.l_orderkey AS l_orderkey0, t18.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem11 INNER JOIN (SELECT lineitem12.l_orderkey, lineitem12.l_suppkey FROM supplier AS supplier6, lineitem AS lineitem12, orders AS orders6, nation AS nation6) AS t18 ON lineitem11.l_orderkey = t18.l_orderkey AND lineitem11.l_suppkey <> t18.l_suppkey) AS t19 ON lineitem10.l_orderkey = t19.l_orderkey0 AND lineitem10.l_suppkey = t19.l_suppkey0 WHERE supplier5.s_suppkey = lineitem10.l_suppkey AND (orders5.o_orderkey = lineitem10.l_orderkey AND orders5.o_orderstatus = 'F') AND (lineitem10.l_receiptdate > lineitem10.l_commitdate AND supplier5.s_nationkey = nation5.n_nationkey AND (nation5.n_name = 'EGYPT' AND t19.f0 IS NOT NULL))) AS t22 ON t17.l_orderkey = t22.l_orderkey AND t17.l_suppkey <> t22.l_suppkey) AS t23 ON t16.l_orderkey = t23.l_orderkey0 AND t16.l_suppkey = t23.l_suppkey0 WHERE t23.f0 IS NULL GROUP BY t16.s_name ORDER BY COUNT(*) DESC, t16.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
115,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '22', '29', '20', '39', '24', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '22', '29', '20', '39', '24', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
116,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 1 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 1 AND p_type LIKE '%TIN') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
117,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'GERMANY' and n2.n_name = 'IRAN') or (n1.n_name = 'IRAN' and n2.n_name = 'GERMANY') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation201.n_name AS supp_nation, nation202.n_name AS cust_nation, EXTRACT(YEAR FROM t638.l_shipdate) AS l_year, SUM(t638.l_extendedprice * (1 - t638.l_discount)) AS revenue FROM supplier AS supplier100 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t638 ON supplier100.s_suppkey = t638.l_suppkey INNER JOIN orders AS orders100 ON t638.l_orderkey = orders100.o_orderkey INNER JOIN customer AS customer100 ON orders100.o_custkey = customer100.c_custkey INNER JOIN nation AS nation201 ON supplier100.s_nationkey = nation201.n_nationkey INNER JOIN nation AS nation202 ON customer100.c_nationkey = nation202.n_nationkey AND (nation201.n_name = 'GERMANY' AND nation202.n_name = 'IRAN' OR nation201.n_name = 'IRAN' AND nation202.n_name = 'GERMANY') GROUP BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate) ORDER BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
118,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(4)) = 'IRAN' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BURNISHED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
119,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%green%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation100.n_name AS nation, EXTRACT(YEAR FROM orders100.o_orderdate) AS o_year, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount) - partsupp100.ps_supplycost * lineitem100.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%green%') AS t591 CROSS JOIN supplier AS supplier100 INNER JOIN lineitem AS lineitem100 ON supplier100.s_suppkey = lineitem100.l_suppkey AND t591.p_partkey = lineitem100.l_partkey INNER JOIN partsupp AS partsupp100 ON lineitem100.l_suppkey = partsupp100.ps_suppkey AND lineitem100.l_partkey = partsupp100.ps_partkey INNER JOIN orders AS orders100 ON lineitem100.l_orderkey = orders100.o_orderkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey GROUP BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) ORDER BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
120,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'IRAN' group by s_name order by numwait desc, s_name;","SELECT t2151.s_name, COUNT(*) AS numwait FROM (SELECT t2146.s_suppkey, t2146.s_name, t2146.s_address, t2146.s_nationkey, t2146.s_phone, t2146.s_acctbal, t2146.s_comment, t2146.l_orderkey, t2146.l_partkey, t2146.l_suppkey, t2146.l_linenumber, t2146.l_quantity, t2146.l_extendedprice, t2146.l_discount, t2146.l_tax, t2146.l_returnflag, t2146.l_linestatus, t2146.l_shipdate, t2146.l_commitdate, t2146.l_receiptdate, t2146.l_shipinstruct, t2146.l_shipmode, t2146.l_comment, t2146.o_orderkey, t2146.o_custkey, t2146.o_orderstatus, t2146.o_totalprice, t2146.o_orderdate, t2146.o_orderpriority, t2146.o_clerk, t2146.o_shippriority, t2146.o_comment, t2146.n_nationkey, t2146.n_name, t2146.n_regionkey, t2146.n_comment, CAST(t2149.f0 AS BOOLEAN) AS f0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM supplier AS supplier407, (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t2141 WHERE supplier407.s_suppkey = t2141.l_suppkey) AS t2142, (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t2143 WHERE t2143.o_orderkey = t2142.l_orderkey) AS t2144, (SELECT * FROM nation WHERE n_name = 'IRAN') AS t2145 WHERE t2144.s_nationkey = t2145.n_nationkey) AS t2146, (SELECT t2147.l_orderkey AS l_orderkey0, t2147.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem714, (SELECT lineitem715.l_orderkey, lineitem715.l_suppkey FROM supplier AS supplier408, lineitem AS lineitem715, orders AS orders408, nation AS nation408) AS t2147 WHERE lineitem714.l_orderkey = t2147.l_orderkey AND lineitem714.l_suppkey <> t2147.l_suppkey) AS t2149 WHERE t2146.l_orderkey = t2149.l_orderkey0 AND t2146.l_suppkey = t2149.l_suppkey0) AS t2151 LEFT JOIN (SELECT t2163.l_orderkey AS l_orderkey0, t2163.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t2152, (SELECT t2158.l_orderkey, t2158.l_suppkey FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM supplier AS supplier409, (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t2153 WHERE supplier409.s_suppkey = t2153.l_suppkey) AS t2154, (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t2155 WHERE t2155.o_orderkey = t2154.l_orderkey) AS t2156, (SELECT * FROM nation WHERE n_name = 'IRAN') AS t2157 WHERE t2156.s_nationkey = t2157.n_nationkey) AS t2158, (SELECT t2159.l_orderkey AS l_orderkey0, t2159.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem718, (SELECT lineitem719.l_orderkey, lineitem719.l_suppkey FROM supplier AS supplier410, lineitem AS lineitem719, orders AS orders410, nation AS nation410) AS t2159 WHERE lineitem718.l_orderkey = t2159.l_orderkey AND lineitem718.l_suppkey <> t2159.l_suppkey) AS t2161 WHERE t2158.l_orderkey = t2161.l_orderkey0 AND t2158.l_suppkey = t2161.l_suppkey0) AS t2163 WHERE t2152.l_orderkey = t2163.l_orderkey AND t2152.l_suppkey <> t2163.l_suppkey) AS t2165 ON t2151.l_orderkey = t2165.l_orderkey0 AND t2151.l_suppkey = t2165.l_suppkey0 WHERE t2165.f0 IS NULL GROUP BY t2151.s_name ORDER BY COUNT(*) DESC, t2151.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
121,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '26', '32', '28', '41', '36', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '26', '32', '28', '41', '36', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '22'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '22')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
122,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 49 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 49 AND p_type LIKE '%TIN') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
123,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'VIETNAM') or (n1.n_name = 'VIETNAM' and n2.n_name = 'SAUDI ARABIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation205.n_name AS supp_nation, nation206.n_name AS cust_nation, EXTRACT(YEAR FROM t656.l_shipdate) AS l_year, SUM(t656.l_extendedprice * (1 - t656.l_discount)) AS revenue FROM supplier AS supplier102 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t656 ON supplier102.s_suppkey = t656.l_suppkey INNER JOIN orders AS orders102 ON t656.l_orderkey = orders102.o_orderkey INNER JOIN customer AS customer102 ON orders102.o_custkey = customer102.c_custkey INNER JOIN nation AS nation205 ON supplier102.s_nationkey = nation205.n_nationkey INNER JOIN nation AS nation206 ON customer102.c_nationkey = nation206.n_nationkey AND (nation205.n_name = 'SAUDI ARABIA' AND nation206.n_name = 'VIETNAM' OR nation205.n_name = 'VIETNAM' AND nation206.n_name = 'SAUDI ARABIA') GROUP BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate) ORDER BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
124,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(7)) = 'VIETNAM' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL BRUSHED STEEL') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
125,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '24', '37', '36', '40', '41', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '24', '37', '36', '40', '41', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
126,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 28 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 28 AND p_type LIKE '%STEEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
127,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(9)) = 'INDONESIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM PLATED NICKEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'ASIA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
128,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'ROMANIA' group by s_name order by numwait desc, s_name;","SELECT t49.s_name, COUNT(*) AS numwait FROM (SELECT supplier11.s_suppkey, supplier11.s_name, supplier11.s_address, supplier11.s_nationkey, supplier11.s_phone, supplier11.s_acctbal, supplier11.s_comment, lineitem20.l_orderkey, lineitem20.l_partkey, lineitem20.l_suppkey, lineitem20.l_linenumber, lineitem20.l_quantity, lineitem20.l_extendedprice, lineitem20.l_discount, lineitem20.l_tax, lineitem20.l_returnflag, lineitem20.l_linestatus, lineitem20.l_shipdate, lineitem20.l_commitdate, lineitem20.l_receiptdate, lineitem20.l_shipinstruct, lineitem20.l_shipmode, lineitem20.l_comment, orders11.o_orderkey, orders11.o_custkey, orders11.o_orderstatus, orders11.o_totalprice, orders11.o_orderdate, orders11.o_orderpriority, orders11.o_clerk, orders11.o_shippriority, orders11.o_comment, nation11.n_nationkey, nation11.n_name, nation11.n_regionkey, nation11.n_comment, t47.f0 FROM supplier AS supplier11 CROSS JOIN lineitem AS lineitem20 CROSS JOIN orders AS orders11 CROSS JOIN nation AS nation11 LEFT JOIN (SELECT t46.l_orderkey AS l_orderkey0, t46.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem21 INNER JOIN (SELECT lineitem22.l_orderkey, lineitem22.l_suppkey FROM supplier AS supplier12, lineitem AS lineitem22, orders AS orders12, nation AS nation12) AS t46 ON lineitem21.l_orderkey = t46.l_orderkey AND lineitem21.l_suppkey <> t46.l_suppkey) AS t47 ON lineitem20.l_orderkey = t47.l_orderkey0 AND lineitem20.l_suppkey = t47.l_suppkey0 WHERE supplier11.s_suppkey = lineitem20.l_suppkey AND (orders11.o_orderkey = lineitem20.l_orderkey AND orders11.o_orderstatus = 'F') AND (lineitem20.l_receiptdate > lineitem20.l_commitdate AND supplier11.s_nationkey = nation11.n_nationkey AND (nation11.n_name = 'ROMANIA' AND t47.f0 IS NOT NULL))) AS t49 LEFT JOIN (SELECT t55.l_orderkey AS l_orderkey0, t55.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t50 INNER JOIN (SELECT lineitem24.l_orderkey, lineitem24.l_suppkey FROM supplier AS supplier13 CROSS JOIN lineitem AS lineitem24 CROSS JOIN orders AS orders13 CROSS JOIN nation AS nation13 LEFT JOIN (SELECT t51.l_orderkey AS l_orderkey0, t51.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem25 INNER JOIN (SELECT lineitem26.l_orderkey, lineitem26.l_suppkey FROM supplier AS supplier14, lineitem AS lineitem26, orders AS orders14, nation AS nation14) AS t51 ON lineitem25.l_orderkey = t51.l_orderkey AND lineitem25.l_suppkey <> t51.l_suppkey) AS t52 ON lineitem24.l_orderkey = t52.l_orderkey0 AND lineitem24.l_suppkey = t52.l_suppkey0 WHERE supplier13.s_suppkey = lineitem24.l_suppkey AND (orders13.o_orderkey = lineitem24.l_orderkey AND orders13.o_orderstatus = 'F') AND (lineitem24.l_receiptdate > lineitem24.l_commitdate AND supplier13.s_nationkey = nation13.n_nationkey AND (nation13.n_name = 'ROMANIA' AND t52.f0 IS NOT NULL))) AS t55 ON t50.l_orderkey = t55.l_orderkey AND t50.l_suppkey <> t55.l_suppkey) AS t56 ON t49.l_orderkey = t56.l_orderkey0 AND t49.l_suppkey = t56.l_suppkey0 WHERE t56.f0 IS NULL GROUP BY t49.s_name ORDER BY COUNT(*) DESC, t49.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
129,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '25', '34', '44', '21', '23', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '25', '34', '44', '21', '23', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '42'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '42')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
130,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 24 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 24 AND p_type LIKE '%BRASS') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
131,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-21' and l_shipdate > date '1995-03-21' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t168.l_orderkey, SUM(t168.l_extendedprice * (1 - t168.l_discount)) AS revenue, t167.o_orderdate, t167.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t166 INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-21') AS t167 ON t166.c_custkey = t167.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-21') AS t168 ON t167.o_orderkey = t168.l_orderkey GROUP BY t168.l_orderkey, t167.o_orderdate, t167.o_shippriority ORDER BY SUM(t168.l_extendedprice * (1 - t168.l_discount)) DESC, t167.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
132,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-03-01' and o_orderdate < date '1996-03-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1996-03-01' AND o_orderdate < (DATE '1996-03-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
133,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ETHIOPIA' and n2.n_name = 'INDIA') or (n1.n_name = 'INDIA' and n2.n_name = 'ETHIOPIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT t3.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t3.l_shipdate) AS l_year, SUM(t3.l_extendedprice * (1 - t3.l_discount)) AS revenue FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM supplier, (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t WHERE supplier.s_suppkey = t.l_suppkey) AS t0, orders WHERE orders.o_orderkey = t0.l_orderkey) AS t1, customer WHERE customer.c_custkey = t1.o_custkey) AS t2, nation WHERE t2.s_nationkey = nation.n_nationkey) AS t3, nation AS nation0 WHERE t3.c_nationkey = nation0.n_nationkey AND (t3.n_name = 'ETHIOPIA' AND nation0.n_name = 'INDIA' OR t3.n_name = 'INDIA' AND nation0.n_name = 'ETHIOPIA') GROUP BY t3.n_name, nation0.n_name, EXTRACT(YEAR FROM t3.l_shipdate) ORDER BY t3.n_name, nation0.n_name, EXTRACT(YEAR FROM t3.l_shipdate);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
134,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(5)) = 'INDIA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED STEEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'ASIA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
135,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'GERMANY' group by s_name order by numwait desc, s_name;","SELECT t2.s_name, COUNT(*) AS numwait FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t0.f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t.l_orderkey AS l_orderkey0, t.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem0 INNER JOIN (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0) AS t ON lineitem0.l_orderkey = t.l_orderkey AND lineitem0.l_suppkey <> t.l_suppkey) AS t0 ON lineitem.l_orderkey = t0.l_orderkey0 AND lineitem.l_suppkey = t0.l_suppkey0 WHERE supplier.s_suppkey = lineitem.l_suppkey AND (orders.o_orderkey = lineitem.l_orderkey AND orders.o_orderstatus = 'F') AND (lineitem.l_receiptdate > lineitem.l_commitdate AND supplier.s_nationkey = nation.n_nationkey AND (nation.n_name = 'GERMANY' AND t0.f0 IS NOT NULL))) AS t2 LEFT JOIN (SELECT t8.l_orderkey AS l_orderkey0, t8.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t3 INNER JOIN (SELECT lineitem3.l_orderkey, lineitem3.l_suppkey FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t4.l_orderkey AS l_orderkey0, t4.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem4 INNER JOIN (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2) AS t4 ON lineitem4.l_orderkey = t4.l_orderkey AND lineitem4.l_suppkey <> t4.l_suppkey) AS t5 ON lineitem3.l_orderkey = t5.l_orderkey0 AND lineitem3.l_suppkey = t5.l_suppkey0 WHERE supplier1.s_suppkey = lineitem3.l_suppkey AND (orders1.o_orderkey = lineitem3.l_orderkey AND orders1.o_orderstatus = 'F') AND (lineitem3.l_receiptdate > lineitem3.l_commitdate AND supplier1.s_nationkey = nation1.n_nationkey AND (nation1.n_name = 'GERMANY' AND t5.f0 IS NOT NULL))) AS t8 ON t3.l_orderkey = t8.l_orderkey AND t3.l_suppkey <> t8.l_suppkey) AS t9 ON t2.l_orderkey = t9.l_orderkey0 AND t2.l_suppkey = t9.l_suppkey0 WHERE t9.f0 IS NULL GROUP BY t2.s_name ORDER BY COUNT(*) DESC, t2.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
136,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '36', '30', '25', '29', '37', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '36', '30', '25', '29', '37', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
137,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 48 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 48 AND p_type LIKE '%NICKEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
138,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(4)) = 'PERU' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BRUSHED NICKEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
139,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%orchid%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation100.n_name AS nation, EXTRACT(YEAR FROM orders100.o_orderdate) AS o_year, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount) - partsupp100.ps_supplycost * lineitem100.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%orchid%') AS t591 CROSS JOIN supplier AS supplier100 INNER JOIN lineitem AS lineitem100 ON supplier100.s_suppkey = lineitem100.l_suppkey AND t591.p_partkey = lineitem100.l_partkey INNER JOIN partsupp AS partsupp100 ON lineitem100.l_suppkey = partsupp100.ps_suppkey AND lineitem100.l_partkey = partsupp100.ps_partkey INNER JOIN orders AS orders100 ON lineitem100.l_orderkey = orders100.o_orderkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey GROUP BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) ORDER BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
140,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 27 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 27 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
141,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-05' and l_shipdate > date '1995-03-05' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t800.l_orderkey, SUM(t800.l_extendedprice * (1 - t800.l_discount)) AS revenue, t799.o_orderdate, t799.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t797, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-05') AS t798 WHERE t797.c_custkey = t798.o_custkey) AS t799, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-05') AS t800 WHERE t800.l_orderkey = t799.o_orderkey GROUP BY t800.l_orderkey, t799.o_orderdate, t799.o_shippriority ORDER BY SUM(t800.l_extendedprice * (1 - t800.l_discount)) DESC, t799.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
142,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'EGYPT' and n2.n_name = 'ETHIOPIA') or (n1.n_name = 'ETHIOPIA' and n2.n_name = 'EGYPT') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation207.n_name AS supp_nation, nation208.n_name AS cust_nation, EXTRACT(YEAR FROM t665.l_shipdate) AS l_year, SUM(t665.l_extendedprice * (1 - t665.l_discount)) AS revenue FROM supplier AS supplier103 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t665 ON supplier103.s_suppkey = t665.l_suppkey INNER JOIN orders AS orders103 ON t665.l_orderkey = orders103.o_orderkey INNER JOIN customer AS customer103 ON orders103.o_custkey = customer103.c_custkey INNER JOIN nation AS nation207 ON supplier103.s_nationkey = nation207.n_nationkey INNER JOIN nation AS nation208 ON customer103.c_nationkey = nation208.n_nationkey AND (nation207.n_name = 'EGYPT' AND nation208.n_name = 'ETHIOPIA' OR nation207.n_name = 'ETHIOPIA' AND nation208.n_name = 'EGYPT') GROUP BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate) ORDER BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
143,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(8)) = 'ETHIOPIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BURNISHED COPPER') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
144,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%puff%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation100.n_name AS nation, EXTRACT(YEAR FROM orders100.o_orderdate) AS o_year, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount) - partsupp100.ps_supplycost * lineitem100.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%puff%') AS t591 CROSS JOIN supplier AS supplier100 INNER JOIN lineitem AS lineitem100 ON supplier100.s_suppkey = lineitem100.l_suppkey AND t591.p_partkey = lineitem100.l_partkey INNER JOIN partsupp AS partsupp100 ON lineitem100.l_suppkey = partsupp100.ps_suppkey AND lineitem100.l_partkey = partsupp100.ps_partkey INNER JOIN orders AS orders100 ON lineitem100.l_orderkey = orders100.o_orderkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey GROUP BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) ORDER BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
145,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'UNITED KINGDOM' group by s_name order by numwait desc, s_name;","SELECT t2235.s_name, COUNT(*) AS numwait FROM (SELECT t2230.s_suppkey, t2230.s_name, t2230.s_address, t2230.s_nationkey, t2230.s_phone, t2230.s_acctbal, t2230.s_comment, t2230.l_orderkey, t2230.l_partkey, t2230.l_suppkey, t2230.l_linenumber, t2230.l_quantity, t2230.l_extendedprice, t2230.l_discount, t2230.l_tax, t2230.l_returnflag, t2230.l_linestatus, t2230.l_shipdate, t2230.l_commitdate, t2230.l_receiptdate, t2230.l_shipinstruct, t2230.l_shipmode, t2230.l_comment, t2230.o_orderkey, t2230.o_custkey, t2230.o_orderstatus, t2230.o_totalprice, t2230.o_orderdate, t2230.o_orderpriority, t2230.o_clerk, t2230.o_shippriority, t2230.o_comment, t2230.n_nationkey, t2230.n_name, t2230.n_regionkey, t2230.n_comment, CAST(t2233.f0 AS BOOLEAN) AS f0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM supplier AS supplier407, (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t2225 WHERE supplier407.s_suppkey = t2225.l_suppkey) AS t2226, (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t2227 WHERE t2227.o_orderkey = t2226.l_orderkey) AS t2228, (SELECT * FROM nation WHERE n_name = 'UNITED KINGDOM') AS t2229 WHERE t2228.s_nationkey = t2229.n_nationkey) AS t2230, (SELECT t2231.l_orderkey AS l_orderkey0, t2231.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem714, (SELECT lineitem715.l_orderkey, lineitem715.l_suppkey FROM supplier AS supplier408, lineitem AS lineitem715, orders AS orders408, nation AS nation408) AS t2231 WHERE lineitem714.l_orderkey = t2231.l_orderkey AND lineitem714.l_suppkey <> t2231.l_suppkey) AS t2233 WHERE t2230.l_orderkey = t2233.l_orderkey0 AND t2230.l_suppkey = t2233.l_suppkey0) AS t2235 LEFT JOIN (SELECT t2247.l_orderkey AS l_orderkey0, t2247.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t2236, (SELECT t2242.l_orderkey, t2242.l_suppkey FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM supplier AS supplier409, (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t2237 WHERE supplier409.s_suppkey = t2237.l_suppkey) AS t2238, (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t2239 WHERE t2239.o_orderkey = t2238.l_orderkey) AS t2240, (SELECT * FROM nation WHERE n_name = 'UNITED KINGDOM') AS t2241 WHERE t2240.s_nationkey = t2241.n_nationkey) AS t2242, (SELECT t2243.l_orderkey AS l_orderkey0, t2243.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem718, (SELECT lineitem719.l_orderkey, lineitem719.l_suppkey FROM supplier AS supplier410, lineitem AS lineitem719, orders AS orders410, nation AS nation410) AS t2243 WHERE lineitem718.l_orderkey = t2243.l_orderkey AND lineitem718.l_suppkey <> t2243.l_suppkey) AS t2245 WHERE t2242.l_orderkey = t2245.l_orderkey0 AND t2242.l_suppkey = t2245.l_suppkey0) AS t2247 WHERE t2236.l_orderkey = t2247.l_orderkey AND t2236.l_suppkey <> t2247.l_suppkey) AS t2249 ON t2235.l_orderkey = t2249.l_orderkey0 AND t2235.l_suppkey = t2249.l_suppkey0 WHERE t2249.f0 IS NULL GROUP BY t2235.s_name ORDER BY COUNT(*) DESC, t2235.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
146,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '28', '27', '35', '41', '40', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '28', '27', '35', '41', '40', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
147,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 26 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 26 AND p_type LIKE '%BRASS') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
148,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-03' and l_shipdate > date '1995-03-03' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t793.l_orderkey, SUM(t793.l_extendedprice * (1 - t793.l_discount)) AS revenue, t792.o_orderdate, t792.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t790, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-03') AS t791 WHERE t790.c_custkey = t791.o_custkey) AS t792, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-03') AS t793 WHERE t793.l_orderkey = t792.o_orderkey GROUP BY t793.l_orderkey, t792.o_orderdate, t792.o_shippriority ORDER BY SUM(t793.l_extendedprice * (1 - t793.l_discount)) DESC, t792.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
149,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'INDIA' and n2.n_name = 'VIETNAM') or (n1.n_name = 'VIETNAM' and n2.n_name = 'INDIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation205.n_name AS supp_nation, nation206.n_name AS cust_nation, EXTRACT(YEAR FROM t656.l_shipdate) AS l_year, SUM(t656.l_extendedprice * (1 - t656.l_discount)) AS revenue FROM supplier AS supplier102 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t656 ON supplier102.s_suppkey = t656.l_suppkey INNER JOIN orders AS orders102 ON t656.l_orderkey = orders102.o_orderkey INNER JOIN customer AS customer102 ON orders102.o_custkey = customer102.c_custkey INNER JOIN nation AS nation205 ON supplier102.s_nationkey = nation205.n_nationkey INNER JOIN nation AS nation206 ON customer102.c_nationkey = nation206.n_nationkey AND (nation205.n_name = 'INDIA' AND nation206.n_name = 'VIETNAM' OR nation205.n_name = 'VIETNAM' AND nation206.n_name = 'INDIA') GROUP BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate) ORDER BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
150,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(5)) = 'INDIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BURNISHED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'ASIA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
151,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-08-01' and o_orderdate < date '1994-08-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","SELECT customer21.c_custkey, customer21.c_name, SUM(t149.l_extendedprice * (1 - t149.l_discount)) AS revenue, customer21.c_acctbal, nation21.n_name, customer21.c_address, customer21.c_phone, customer21.c_comment FROM customer AS customer21 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-08-01' AND o_orderdate < (DATE '1994-08-01' + INTERVAL '3' MONTH)) AS t148 ON customer21.c_custkey = t148.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_returnflag = 'R') AS t149 ON t148.o_orderkey = t149.l_orderkey INNER JOIN nation AS nation21 ON customer21.c_nationkey = nation21.n_nationkey GROUP BY customer21.c_custkey, customer21.c_name, customer21.c_acctbal, customer21.c_phone, nation21.n_name, customer21.c_address, customer21.c_comment ORDER BY SUM(t149.l_extendedprice * (1 - t149.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
152,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 20 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 20 AND p_type LIKE '%STEEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
153,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-06-01' and o_orderdate < date '1993-06-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-06-01' AND o_orderdate < (DATE '1993-06-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
154,tpch,"select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(7)) = 'MOROCCO' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO PLATED STEEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
155,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 5 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 5 AND p_type LIKE '%COPPER') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
156,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-05' and l_shipdate > date '1995-03-05' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t800.l_orderkey, SUM(t800.l_extendedprice * (1 - t800.l_discount)) AS revenue, t799.o_orderdate, t799.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t797, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-05') AS t798 WHERE t797.c_custkey = t798.o_custkey) AS t799, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-05') AS t800 WHERE t800.l_orderkey = t799.o_orderkey GROUP BY t800.l_orderkey, t799.o_orderdate, t799.o_shippriority ORDER BY SUM(t800.l_extendedprice * (1 - t800.l_discount)) DESC, t799.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
157,tpch,"select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(12)) = 'SAUDI ARABIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED COPPER') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
158,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%seashell%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation100.n_name AS nation, EXTRACT(YEAR FROM orders100.o_orderdate) AS o_year, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount) - partsupp100.ps_supplycost * lineitem100.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%seashell%') AS t591 CROSS JOIN supplier AS supplier100 INNER JOIN lineitem AS lineitem100 ON supplier100.s_suppkey = lineitem100.l_suppkey AND t591.p_partkey = lineitem100.l_partkey INNER JOIN partsupp AS partsupp100 ON lineitem100.l_suppkey = partsupp100.ps_suppkey AND lineitem100.l_partkey = partsupp100.ps_partkey INNER JOIN orders AS orders100 ON lineitem100.l_orderkey = orders100.o_orderkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey GROUP BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) ORDER BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
159,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '41', '43', '32', '34', '27', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '41', '43', '32', '34', '27', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
160,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 36 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 36 AND p_type LIKE '%COPPER') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
161,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and o_orderdate >= date '1994-01-01' and o_orderdate < date '1994-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation100.n_name, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount)) AS revenue FROM customer AS customer100 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-01-01' AND o_orderdate < (DATE '1994-01-01' + INTERVAL '1' YEAR)) AS t735 ON customer100.c_custkey = t735.o_custkey INNER JOIN lineitem AS lineitem100 ON t735.o_orderkey = lineitem100.l_orderkey INNER JOIN supplier AS supplier100 ON lineitem100.l_suppkey = supplier100.s_suppkey AND customer100.c_nationkey = supplier100.s_nationkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t736 ON nation100.n_regionkey = t736.r_regionkey GROUP BY nation100.n_name ORDER BY SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
162,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'INDONESIA' and n2.n_name = 'JAPAN') or (n1.n_name = 'JAPAN' and n2.n_name = 'INDONESIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation207.n_name AS supp_nation, nation208.n_name AS cust_nation, EXTRACT(YEAR FROM t665.l_shipdate) AS l_year, SUM(t665.l_extendedprice * (1 - t665.l_discount)) AS revenue FROM supplier AS supplier103 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t665 ON supplier103.s_suppkey = t665.l_suppkey INNER JOIN orders AS orders103 ON t665.l_orderkey = orders103.o_orderkey INNER JOIN customer AS customer103 ON orders103.o_custkey = customer103.c_custkey INNER JOIN nation AS nation207 ON supplier103.s_nationkey = nation207.n_nationkey INNER JOIN nation AS nation208 ON customer103.c_nationkey = nation208.n_nationkey AND (nation207.n_name = 'INDONESIA' AND nation208.n_name = 'JAPAN' OR nation207.n_name = 'JAPAN' AND nation208.n_name = 'INDONESIA') GROUP BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate) ORDER BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
163,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '41', '27', '22', '44', '40', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '41', '27', '22', '44', '40', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
164,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 12 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 12 AND p_type LIKE '%BRASS') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
165,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-11-01' and o_orderdate < date '1994-11-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","SELECT t760.c_custkey, t760.c_name, SUM(t760.l_extendedprice * (1 - t760.l_discount)) AS revenue, t760.c_acctbal, nation103.n_name, t760.c_address, t760.c_phone, t760.c_comment FROM (SELECT * FROM (SELECT * FROM customer AS customer103, (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-11-01' AND o_orderdate < (DATE '1994-11-01' + INTERVAL '3' MONTH)) AS t757 WHERE customer103.c_custkey = t757.o_custkey) AS t758, (SELECT * FROM lineitem WHERE l_returnflag = 'R') AS t759 WHERE t759.l_orderkey = t758.o_orderkey) AS t760, nation AS nation103 WHERE t760.c_nationkey = nation103.n_nationkey GROUP BY t760.c_custkey, t760.c_name, t760.c_acctbal, t760.c_phone, nation103.n_name, t760.c_address, t760.c_comment ORDER BY SUM(t760.l_extendedprice * (1 - t760.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
166,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'RUSSIA' group by s_name order by numwait desc, s_name;","SELECT t2.s_name, COUNT(*) AS numwait FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t0.f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t.l_orderkey AS l_orderkey0, t.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem0 INNER JOIN (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0) AS t ON lineitem0.l_orderkey = t.l_orderkey AND lineitem0.l_suppkey <> t.l_suppkey) AS t0 ON lineitem.l_orderkey = t0.l_orderkey0 AND lineitem.l_suppkey = t0.l_suppkey0 WHERE supplier.s_suppkey = lineitem.l_suppkey AND (orders.o_orderkey = lineitem.l_orderkey AND orders.o_orderstatus = 'F') AND (lineitem.l_receiptdate > lineitem.l_commitdate AND supplier.s_nationkey = nation.n_nationkey AND (nation.n_name = 'RUSSIA' AND t0.f0 IS NOT NULL))) AS t2 LEFT JOIN (SELECT t8.l_orderkey AS l_orderkey0, t8.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t3 INNER JOIN (SELECT lineitem3.l_orderkey, lineitem3.l_suppkey FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t4.l_orderkey AS l_orderkey0, t4.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem4 INNER JOIN (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2) AS t4 ON lineitem4.l_orderkey = t4.l_orderkey AND lineitem4.l_suppkey <> t4.l_suppkey) AS t5 ON lineitem3.l_orderkey = t5.l_orderkey0 AND lineitem3.l_suppkey = t5.l_suppkey0 WHERE supplier1.s_suppkey = lineitem3.l_suppkey AND (orders1.o_orderkey = lineitem3.l_orderkey AND orders1.o_orderstatus = 'F') AND (lineitem3.l_receiptdate > lineitem3.l_commitdate AND supplier1.s_nationkey = nation1.n_nationkey AND (nation1.n_name = 'RUSSIA' AND t5.f0 IS NOT NULL))) AS t8 ON t3.l_orderkey = t8.l_orderkey AND t3.l_suppkey <> t8.l_suppkey) AS t9 ON t2.l_orderkey = t9.l_orderkey0 AND t2.l_suppkey = t9.l_suppkey0 WHERE t9.f0 IS NULL GROUP BY t2.s_name ORDER BY COUNT(*) DESC, t2.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
167,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '31', '29', '30', '20', '39', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '31', '29', '30', '20', '39', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
168,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 34 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 34 AND p_type LIKE '%BRASS') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
169,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'CANADA' and n2.n_name = 'INDIA') or (n1.n_name = 'INDIA' and n2.n_name = 'CANADA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation201.n_name AS supp_nation, nation202.n_name AS cust_nation, EXTRACT(YEAR FROM t638.l_shipdate) AS l_year, SUM(t638.l_extendedprice * (1 - t638.l_discount)) AS revenue FROM supplier AS supplier100 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t638 ON supplier100.s_suppkey = t638.l_suppkey INNER JOIN orders AS orders100 ON t638.l_orderkey = orders100.o_orderkey INNER JOIN customer AS customer100 ON orders100.o_custkey = customer100.c_custkey INNER JOIN nation AS nation201 ON supplier100.s_nationkey = nation201.n_nationkey INNER JOIN nation AS nation202 ON customer100.c_nationkey = nation202.n_nationkey AND (nation201.n_name = 'CANADA' AND nation202.n_name = 'INDIA' OR nation201.n_name = 'INDIA' AND nation202.n_name = 'CANADA') GROUP BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate) ORDER BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
170,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(5)) = 'INDIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO PLATED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'ASIA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
171,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%tan%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation99.n_name AS nation, EXTRACT(YEAR FROM orders99.o_orderdate) AS o_year, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount) - partsupp99.ps_supplycost * lineitem99.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%tan%') AS t583 CROSS JOIN supplier AS supplier99 INNER JOIN lineitem AS lineitem99 ON supplier99.s_suppkey = lineitem99.l_suppkey AND t583.p_partkey = lineitem99.l_partkey INNER JOIN partsupp AS partsupp99 ON lineitem99.l_suppkey = partsupp99.ps_suppkey AND lineitem99.l_partkey = partsupp99.ps_partkey INNER JOIN orders AS orders99 ON lineitem99.l_orderkey = orders99.o_orderkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey GROUP BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) ORDER BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
172,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 25 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 25 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
173,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-08-01' and o_orderdate < date '1995-08-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-08-01' AND o_orderdate < (DATE '1995-08-01' + INTERVAL '3' MONTH)) AS t, (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 WHERE t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
174,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and o_orderdate >= date '1993-01-01' and o_orderdate < date '1993-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation100.n_name, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount)) AS revenue FROM customer AS customer100 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-01-01' AND o_orderdate < (DATE '1993-01-01' + INTERVAL '1' YEAR)) AS t735 ON customer100.c_custkey = t735.o_custkey INNER JOIN lineitem AS lineitem100 ON t735.o_orderkey = lineitem100.l_orderkey INNER JOIN supplier AS supplier100 ON lineitem100.l_suppkey = supplier100.s_suppkey AND customer100.c_nationkey = supplier100.s_nationkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t736 ON nation100.n_regionkey = t736.r_regionkey GROUP BY nation100.n_name ORDER BY SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
175,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-02-01' and o_orderdate < date '1994-02-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","SELECT customer22.c_custkey, customer22.c_name, SUM(t155.l_extendedprice * (1 - t155.l_discount)) AS revenue, customer22.c_acctbal, nation22.n_name, customer22.c_address, customer22.c_phone, customer22.c_comment FROM customer AS customer22 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-02-01' AND o_orderdate < (DATE '1994-02-01' + INTERVAL '3' MONTH)) AS t154 ON customer22.c_custkey = t154.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_returnflag = 'R') AS t155 ON t154.o_orderkey = t155.l_orderkey INNER JOIN nation AS nation22 ON customer22.c_nationkey = nation22.n_nationkey GROUP BY customer22.c_custkey, customer22.c_name, customer22.c_acctbal, customer22.c_phone, nation22.n_name, customer22.c_address, customer22.c_comment ORDER BY SUM(t155.l_extendedprice * (1 - t155.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
176,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 5 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 5 AND p_type LIKE '%BRASS') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
177,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-15' and l_shipdate > date '1995-03-15' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t161.l_orderkey, SUM(t161.l_extendedprice * (1 - t161.l_discount)) AS revenue, t160.o_orderdate, t160.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'HOUSEHOLD') AS t159 INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-15') AS t160 ON t159.c_custkey = t160.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-15') AS t161 ON t160.o_orderkey = t161.l_orderkey GROUP BY t161.l_orderkey, t160.o_orderdate, t160.o_shippriority ORDER BY SUM(t161.l_extendedprice * (1 - t161.l_discount)) DESC, t160.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
178,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'UNITED KINGDOM' and n2.n_name = 'ALGERIA') or (n1.n_name = 'ALGERIA' and n2.n_name = 'UNITED KINGDOM') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation205.n_name AS supp_nation, nation206.n_name AS cust_nation, EXTRACT(YEAR FROM t656.l_shipdate) AS l_year, SUM(t656.l_extendedprice * (1 - t656.l_discount)) AS revenue FROM supplier AS supplier102 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t656 ON supplier102.s_suppkey = t656.l_suppkey INNER JOIN orders AS orders102 ON t656.l_orderkey = orders102.o_orderkey INNER JOIN customer AS customer102 ON orders102.o_custkey = customer102.c_custkey INNER JOIN nation AS nation205 ON supplier102.s_nationkey = nation205.n_nationkey INNER JOIN nation AS nation206 ON customer102.c_nationkey = nation206.n_nationkey AND (nation205.n_name = 'UNITED KINGDOM' AND nation206.n_name = 'ALGERIA' OR nation205.n_name = 'ALGERIA' AND nation206.n_name = 'UNITED KINGDOM') GROUP BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate) ORDER BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
179,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'ALGERIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD PLATED NICKEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
180,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 32 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 32 AND p_type LIKE '%TIN') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
181,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ALGERIA' and n2.n_name = 'BRAZIL') or (n1.n_name = 'BRAZIL' and n2.n_name = 'ALGERIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'ALGERIA' AND nation0.n_name = 'BRAZIL' OR nation.n_name = 'BRAZIL' AND nation0.n_name = 'ALGERIA') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
182,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(6)) = 'BRAZIL' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED BRASS') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
183,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '26', '39', '23', '30', '29', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '26', '39', '23', '30', '29', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '37'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '37')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
184,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 30 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 30 AND p_type LIKE '%COPPER') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
185,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-13' and l_shipdate > date '1995-03-13' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t793.l_orderkey, SUM(t793.l_extendedprice * (1 - t793.l_discount)) AS revenue, t792.o_orderdate, t792.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'HOUSEHOLD') AS t790, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-13') AS t791 WHERE t790.c_custkey = t791.o_custkey) AS t792, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-13') AS t793 WHERE t793.l_orderkey = t792.o_orderkey GROUP BY t793.l_orderkey, t792.o_orderdate, t792.o_shippriority ORDER BY SUM(t793.l_extendedprice * (1 - t793.l_discount)) DESC, t792.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
186,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-01-01' and o_orderdate < date '1995-01-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate < (DATE '1995-01-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
187,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'MOROCCO' and n2.n_name = 'MOZAMBIQUE') or (n1.n_name = 'MOZAMBIQUE' and n2.n_name = 'MOROCCO') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation201.n_name AS supp_nation, nation202.n_name AS cust_nation, EXTRACT(YEAR FROM t638.l_shipdate) AS l_year, SUM(t638.l_extendedprice * (1 - t638.l_discount)) AS revenue FROM supplier AS supplier100 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t638 ON supplier100.s_suppkey = t638.l_suppkey INNER JOIN orders AS orders100 ON t638.l_orderkey = orders100.o_orderkey INNER JOIN customer AS customer100 ON orders100.o_custkey = customer100.c_custkey INNER JOIN nation AS nation201 ON supplier100.s_nationkey = nation201.n_nationkey INNER JOIN nation AS nation202 ON customer100.c_nationkey = nation202.n_nationkey AND (nation201.n_name = 'MOROCCO' AND nation202.n_name = 'MOZAMBIQUE' OR nation201.n_name = 'MOZAMBIQUE' AND nation202.n_name = 'MOROCCO') GROUP BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate) ORDER BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
188,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(10)) = 'MOZAMBIQUE' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL BURNISHED NICKEL') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
189,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%cream%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation99.n_name AS nation, EXTRACT(YEAR FROM orders99.o_orderdate) AS o_year, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount) - partsupp99.ps_supplycost * lineitem99.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%cream%') AS t583 CROSS JOIN supplier AS supplier99 INNER JOIN lineitem AS lineitem99 ON supplier99.s_suppkey = lineitem99.l_suppkey AND t583.p_partkey = lineitem99.l_partkey INNER JOIN partsupp AS partsupp99 ON lineitem99.l_suppkey = partsupp99.ps_suppkey AND lineitem99.l_partkey = partsupp99.ps_partkey INNER JOIN orders AS orders99 ON lineitem99.l_orderkey = orders99.o_orderkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey GROUP BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) ORDER BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
190,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '39', '22', '40', '35', '25', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '39', '22', '40', '35', '25', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
191,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 6 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 6 AND p_type LIKE '%BRASS') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
192,tpch,"select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(5)) = 'CHINA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED BRASS') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
193,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%sandy%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation101.n_name AS nation, EXTRACT(YEAR FROM orders101.o_orderdate) AS o_year, SUM(lineitem101.l_extendedprice * (1 - lineitem101.l_discount) - partsupp101.ps_supplycost * lineitem101.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%sandy%') AS t599 CROSS JOIN supplier AS supplier101 INNER JOIN lineitem AS lineitem101 ON supplier101.s_suppkey = lineitem101.l_suppkey AND t599.p_partkey = lineitem101.l_partkey INNER JOIN partsupp AS partsupp101 ON lineitem101.l_suppkey = partsupp101.ps_suppkey AND lineitem101.l_partkey = partsupp101.ps_partkey INNER JOIN orders AS orders101 ON lineitem101.l_orderkey = orders101.o_orderkey INNER JOIN nation AS nation101 ON supplier101.s_nationkey = nation101.n_nationkey GROUP BY nation101.n_name, EXTRACT(YEAR FROM orders101.o_orderdate) ORDER BY nation101.n_name, EXTRACT(YEAR FROM orders101.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
194,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'JORDAN' group by s_name order by numwait desc, s_name;","SELECT t2.s_name, COUNT(*) AS numwait FROM (SELECT * FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t0.f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t.l_orderkey AS l_orderkey0, t.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem0 INNER JOIN (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0) AS t ON lineitem0.l_orderkey = t.l_orderkey AND lineitem0.l_suppkey <> t.l_suppkey) AS t0 ON lineitem.l_orderkey = t0.l_orderkey0 AND lineitem.l_suppkey = t0.l_suppkey0) AS t1 WHERE t1.s_suppkey = t1.l_suppkey AND (t1.o_orderkey = t1.l_orderkey AND t1.o_orderstatus = 'F') AND (t1.l_receiptdate > t1.l_commitdate AND t1.s_nationkey = t1.n_nationkey AND (t1.n_name = 'JORDAN' AND t1.f0 IS NOT NULL))) AS t2 LEFT JOIN (SELECT t8.l_orderkey AS l_orderkey0, t8.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t3 INNER JOIN (SELECT l_orderkey, l_suppkey FROM (SELECT supplier1.s_suppkey, supplier1.s_name, supplier1.s_address, supplier1.s_nationkey, supplier1.s_phone, supplier1.s_acctbal, supplier1.s_comment, lineitem3.l_orderkey, lineitem3.l_partkey, lineitem3.l_suppkey, lineitem3.l_linenumber, lineitem3.l_quantity, lineitem3.l_extendedprice, lineitem3.l_discount, lineitem3.l_tax, lineitem3.l_returnflag, lineitem3.l_linestatus, lineitem3.l_shipdate, lineitem3.l_commitdate, lineitem3.l_receiptdate, lineitem3.l_shipinstruct, lineitem3.l_shipmode, lineitem3.l_comment, orders1.o_orderkey, orders1.o_custkey, orders1.o_orderstatus, orders1.o_totalprice, orders1.o_orderdate, orders1.o_orderpriority, orders1.o_clerk, orders1.o_shippriority, orders1.o_comment, nation1.n_nationkey, nation1.n_name, nation1.n_regionkey, nation1.n_comment, t5.f0 FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t4.l_orderkey AS l_orderkey0, t4.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem4 INNER JOIN (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2) AS t4 ON lineitem4.l_orderkey = t4.l_orderkey AND lineitem4.l_suppkey <> t4.l_suppkey) AS t5 ON lineitem3.l_orderkey = t5.l_orderkey0 AND lineitem3.l_suppkey = t5.l_suppkey0) AS t6 WHERE t6.s_suppkey = t6.l_suppkey AND (t6.o_orderkey = t6.l_orderkey AND t6.o_orderstatus = 'F') AND (t6.l_receiptdate > t6.l_commitdate AND t6.s_nationkey = t6.n_nationkey AND (t6.n_name = 'JORDAN' AND t6.f0 IS NOT NULL))) AS t8 ON t3.l_orderkey = t8.l_orderkey AND t3.l_suppkey <> t8.l_suppkey) AS t9 ON t2.l_orderkey = t9.l_orderkey0 AND t2.l_suppkey = t9.l_suppkey0 WHERE t9.f0 IS NULL GROUP BY t2.s_name ORDER BY COUNT(*) DESC, t2.s_name;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
195,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '29', '23', '44', '26', '43', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '29', '23', '44', '26', '43', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '40'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '40')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
196,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 14 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 14 AND p_type LIKE '%COPPER') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
197,tpch,"select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(5)) = 'CHINA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BRUSHED STEEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'ASIA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
198,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 11 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 11 AND p_type LIKE '%BRASS') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
199,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-03-01' and o_orderdate < date '1993-03-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-03-01' AND o_orderdate < (DATE '1993-03-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
200,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(7)) = 'VIETNAM' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD ANODIZED BRASS') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'ASIA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
201,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '38', '43', '28', '26', '24', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '38', '43', '28', '26', '24', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
202,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 29 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 29 AND p_type LIKE '%NICKEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
203,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'FRANCE' and n2.n_name = 'IRAQ') or (n1.n_name = 'IRAQ' and n2.n_name = 'FRANCE') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation201.n_name AS supp_nation, nation202.n_name AS cust_nation, EXTRACT(YEAR FROM t638.l_shipdate) AS l_year, SUM(t638.l_extendedprice * (1 - t638.l_discount)) AS revenue FROM supplier AS supplier100 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t638 ON supplier100.s_suppkey = t638.l_suppkey INNER JOIN orders AS orders100 ON t638.l_orderkey = orders100.o_orderkey INNER JOIN customer AS customer100 ON orders100.o_custkey = customer100.c_custkey INNER JOIN nation AS nation201 ON supplier100.s_nationkey = nation201.n_nationkey INNER JOIN nation AS nation202 ON customer100.c_nationkey = nation202.n_nationkey AND (nation201.n_name = 'FRANCE' AND nation202.n_name = 'IRAQ' OR nation201.n_name = 'IRAQ' AND nation202.n_name = 'FRANCE') GROUP BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate) ORDER BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
204,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-11-01' and o_orderdate < date '1993-11-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","SELECT customer21.c_custkey, customer21.c_name, SUM(t149.l_extendedprice * (1 - t149.l_discount)) AS revenue, customer21.c_acctbal, nation21.n_name, customer21.c_address, customer21.c_phone, customer21.c_comment FROM customer AS customer21 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-11-01' AND o_orderdate < (DATE '1993-11-01' + INTERVAL '3' MONTH)) AS t148 ON customer21.c_custkey = t148.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_returnflag = 'R') AS t149 ON t148.o_orderkey = t149.l_orderkey INNER JOIN nation AS nation21 ON customer21.c_nationkey = nation21.n_nationkey GROUP BY customer21.c_custkey, customer21.c_name, customer21.c_acctbal, customer21.c_phone, nation21.n_name, customer21.c_address, customer21.c_comment ORDER BY SUM(t149.l_extendedprice * (1 - t149.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
205,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '21', '27', '31', '30', '41', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '21', '27', '31', '30', '41', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
206,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 8 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 8 AND p_type LIKE '%TIN') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
207,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ROMANIA' and n2.n_name = 'UNITED STATES') or (n1.n_name = 'UNITED STATES' and n2.n_name = 'ROMANIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation201.n_name AS supp_nation, nation202.n_name AS cust_nation, EXTRACT(YEAR FROM t638.l_shipdate) AS l_year, SUM(t638.l_extendedprice * (1 - t638.l_discount)) AS revenue FROM supplier AS supplier100 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t638 ON supplier100.s_suppkey = t638.l_suppkey INNER JOIN orders AS orders100 ON t638.l_orderkey = orders100.o_orderkey INNER JOIN customer AS customer100 ON orders100.o_custkey = customer100.c_custkey INNER JOIN nation AS nation201 ON supplier100.s_nationkey = nation201.n_nationkey INNER JOIN nation AS nation202 ON customer100.c_nationkey = nation202.n_nationkey AND (nation201.n_name = 'ROMANIA' AND nation202.n_name = 'UNITED STATES' OR nation201.n_name = 'UNITED STATES' AND nation202.n_name = 'ROMANIA') GROUP BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate) ORDER BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
208,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%beige%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation100.n_name AS nation, EXTRACT(YEAR FROM orders100.o_orderdate) AS o_year, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount) - partsupp100.ps_supplycost * lineitem100.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%beige%') AS t591 CROSS JOIN supplier AS supplier100 INNER JOIN lineitem AS lineitem100 ON supplier100.s_suppkey = lineitem100.l_suppkey AND t591.p_partkey = lineitem100.l_partkey INNER JOIN partsupp AS partsupp100 ON lineitem100.l_suppkey = partsupp100.ps_suppkey AND lineitem100.l_partkey = partsupp100.ps_partkey INNER JOIN orders AS orders100 ON lineitem100.l_orderkey = orders100.o_orderkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey GROUP BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) ORDER BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
209,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '21', '23', '39', '36', '44', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '21', '23', '39', '36', '44', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
210,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 38 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 38 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
211,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE POLISHED STEEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
212,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#23' and p_type not like 'LARGE POLISHED%' and p_size in (43, 14, 16, 39, 18, 6, 24, 37) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT p_brand, p_type, p_size, COUNT(ps_suppkey) AS supplier_cnt FROM (SELECT ps_suppkey, p_brand, p_type, p_size FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0, t0.s_suppkey, t0.f1 FROM partsupp CROSS JOIN part LEFT JOIN (SELECT s_suppkey, TRUE AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') AS t0 ON partsupp.ps_suppkey = t0.s_suppkey) AS t1 WHERE t1.p_partkey = t1.ps_partkey AND t1.p_brand <> 'Brand#23' AND t1.p_type NOT LIKE 'LARGE POLISHED%' AND (t1.p_size = 43 OR t1.p_size = 14 OR (t1.p_size = 16 OR t1.p_size = 39) OR (t1.p_size = 18 OR t1.p_size = 6 OR (t1.p_size = 24 OR t1.p_size = 37))) AND NOT (t1.f1 IS TRUE AND t1.ps_suppkey0 IS NOT NULL) GROUP BY ps_suppkey, p_brand, p_type, p_size) AS t3 GROUP BY p_brand, p_type, p_size ORDER BY COUNT(ps_suppkey) DESC, p_brand, p_type, p_size;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
213,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'FRANCE' group by s_name order by numwait desc, s_name;","SELECT t34.s_name, COUNT(*) AS numwait FROM (SELECT supplier7.s_suppkey, supplier7.s_name, supplier7.s_address, supplier7.s_nationkey, supplier7.s_phone, supplier7.s_acctbal, supplier7.s_comment, lineitem13.l_orderkey, lineitem13.l_partkey, lineitem13.l_suppkey, lineitem13.l_linenumber, lineitem13.l_quantity, lineitem13.l_extendedprice, lineitem13.l_discount, lineitem13.l_tax, lineitem13.l_returnflag, lineitem13.l_linestatus, lineitem13.l_shipdate, lineitem13.l_commitdate, lineitem13.l_receiptdate, lineitem13.l_shipinstruct, lineitem13.l_shipmode, lineitem13.l_comment, orders7.o_orderkey, orders7.o_custkey, orders7.o_orderstatus, orders7.o_totalprice, orders7.o_orderdate, orders7.o_orderpriority, orders7.o_clerk, orders7.o_shippriority, orders7.o_comment, nation7.n_nationkey, nation7.n_name, nation7.n_regionkey, nation7.n_comment, t32.f0 FROM supplier AS supplier7 CROSS JOIN lineitem AS lineitem13 CROSS JOIN orders AS orders7 CROSS JOIN nation AS nation7 LEFT JOIN (SELECT t31.l_orderkey AS l_orderkey0, t31.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem14 INNER JOIN (SELECT lineitem15.l_orderkey, lineitem15.l_suppkey FROM supplier AS supplier8, lineitem AS lineitem15, orders AS orders8, nation AS nation8) AS t31 ON lineitem14.l_orderkey = t31.l_orderkey AND lineitem14.l_suppkey <> t31.l_suppkey) AS t32 ON lineitem13.l_orderkey = t32.l_orderkey0 AND lineitem13.l_suppkey = t32.l_suppkey0 WHERE supplier7.s_suppkey = lineitem13.l_suppkey AND (orders7.o_orderkey = lineitem13.l_orderkey AND orders7.o_orderstatus = 'F') AND (lineitem13.l_receiptdate > lineitem13.l_commitdate AND supplier7.s_nationkey = nation7.n_nationkey AND (nation7.n_name = 'FRANCE' AND t32.f0 IS NOT NULL))) AS t34 LEFT JOIN (SELECT t40.l_orderkey AS l_orderkey0, t40.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t35 INNER JOIN (SELECT lineitem17.l_orderkey, lineitem17.l_suppkey FROM supplier AS supplier9 CROSS JOIN lineitem AS lineitem17 CROSS JOIN orders AS orders9 CROSS JOIN nation AS nation9 LEFT JOIN (SELECT t36.l_orderkey AS l_orderkey0, t36.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem18 INNER JOIN (SELECT lineitem19.l_orderkey, lineitem19.l_suppkey FROM supplier AS supplier10, lineitem AS lineitem19, orders AS orders10, nation AS nation10) AS t36 ON lineitem18.l_orderkey = t36.l_orderkey AND lineitem18.l_suppkey <> t36.l_suppkey) AS t37 ON lineitem17.l_orderkey = t37.l_orderkey0 AND lineitem17.l_suppkey = t37.l_suppkey0 WHERE supplier9.s_suppkey = lineitem17.l_suppkey AND (orders9.o_orderkey = lineitem17.l_orderkey AND orders9.o_orderstatus = 'F') AND (lineitem17.l_receiptdate > lineitem17.l_commitdate AND supplier9.s_nationkey = nation9.n_nationkey AND (nation9.n_name = 'FRANCE' AND t37.f0 IS NOT NULL))) AS t40 ON t35.l_orderkey = t40.l_orderkey AND t35.l_suppkey <> t40.l_suppkey) AS t41 ON t34.l_orderkey = t41.l_orderkey0 AND t34.l_suppkey = t41.l_suppkey0 WHERE t41.f0 IS NULL GROUP BY t34.s_name ORDER BY COUNT(*) DESC, t34.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
214,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '28', '22', '31', '38', '25', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '28', '22', '31', '38', '25', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
215,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 26 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 26 AND p_type LIKE '%NICKEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
216,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'MOZAMBIQUE' group by s_name order by numwait desc, s_name;","SELECT t70.s_name, COUNT(*) AS numwait FROM (SELECT supplier15.s_suppkey, supplier15.s_name, supplier15.s_address, supplier15.s_nationkey, supplier15.s_phone, supplier15.s_acctbal, supplier15.s_comment, lineitem27.l_orderkey, lineitem27.l_partkey, lineitem27.l_suppkey, lineitem27.l_linenumber, lineitem27.l_quantity, lineitem27.l_extendedprice, lineitem27.l_discount, lineitem27.l_tax, lineitem27.l_returnflag, lineitem27.l_linestatus, lineitem27.l_shipdate, lineitem27.l_commitdate, lineitem27.l_receiptdate, lineitem27.l_shipinstruct, lineitem27.l_shipmode, lineitem27.l_comment, orders15.o_orderkey, orders15.o_custkey, orders15.o_orderstatus, orders15.o_totalprice, orders15.o_orderdate, orders15.o_orderpriority, orders15.o_clerk, orders15.o_shippriority, orders15.o_comment, nation15.n_nationkey, nation15.n_name, nation15.n_regionkey, nation15.n_comment, t68.f0 FROM supplier AS supplier15 CROSS JOIN lineitem AS lineitem27 CROSS JOIN orders AS orders15 CROSS JOIN nation AS nation15 LEFT JOIN (SELECT t67.l_orderkey AS l_orderkey0, t67.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem28 INNER JOIN (SELECT lineitem29.l_orderkey, lineitem29.l_suppkey FROM supplier AS supplier16, lineitem AS lineitem29, orders AS orders16, nation AS nation16) AS t67 ON lineitem28.l_orderkey = t67.l_orderkey AND lineitem28.l_suppkey <> t67.l_suppkey) AS t68 ON lineitem27.l_orderkey = t68.l_orderkey0 AND lineitem27.l_suppkey = t68.l_suppkey0 WHERE supplier15.s_suppkey = lineitem27.l_suppkey AND (orders15.o_orderkey = lineitem27.l_orderkey AND orders15.o_orderstatus = 'F') AND (lineitem27.l_receiptdate > lineitem27.l_commitdate AND supplier15.s_nationkey = nation15.n_nationkey AND (nation15.n_name = 'MOZAMBIQUE' AND t68.f0 IS NOT NULL))) AS t70 LEFT JOIN (SELECT t76.l_orderkey AS l_orderkey0, t76.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t71 INNER JOIN (SELECT lineitem31.l_orderkey, lineitem31.l_suppkey FROM supplier AS supplier17 CROSS JOIN lineitem AS lineitem31 CROSS JOIN orders AS orders17 CROSS JOIN nation AS nation17 LEFT JOIN (SELECT t72.l_orderkey AS l_orderkey0, t72.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem32 INNER JOIN (SELECT lineitem33.l_orderkey, lineitem33.l_suppkey FROM supplier AS supplier18, lineitem AS lineitem33, orders AS orders18, nation AS nation18) AS t72 ON lineitem32.l_orderkey = t72.l_orderkey AND lineitem32.l_suppkey <> t72.l_suppkey) AS t73 ON lineitem31.l_orderkey = t73.l_orderkey0 AND lineitem31.l_suppkey = t73.l_suppkey0 WHERE supplier17.s_suppkey = lineitem31.l_suppkey AND (orders17.o_orderkey = lineitem31.l_orderkey AND orders17.o_orderstatus = 'F') AND (lineitem31.l_receiptdate > lineitem31.l_commitdate AND supplier17.s_nationkey = nation17.n_nationkey AND (nation17.n_name = 'MOZAMBIQUE' AND t73.f0 IS NOT NULL))) AS t76 ON t71.l_orderkey = t76.l_orderkey AND t71.l_suppkey <> t76.l_suppkey) AS t77 ON t70.l_orderkey = t77.l_orderkey0 AND t70.l_suppkey = t77.l_suppkey0 WHERE t77.f0 IS NULL GROUP BY t70.s_name ORDER BY COUNT(*) DESC, t70.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
217,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 23 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 23 AND p_type LIKE '%STEEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
218,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-20' and l_shipdate > date '1995-03-20' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t800.l_orderkey, SUM(t800.l_extendedprice * (1 - t800.l_discount)) AS revenue, t799.o_orderdate, t799.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'HOUSEHOLD') AS t797, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-20') AS t798 WHERE t797.c_custkey = t798.o_custkey) AS t799, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-20') AS t800 WHERE t800.l_orderkey = t799.o_orderkey GROUP BY t800.l_orderkey, t799.o_orderdate, t799.o_shippriority ORDER BY SUM(t800.l_extendedprice * (1 - t800.l_discount)) DESC, t799.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
219,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and o_orderdate >= date '1996-01-01' and o_orderdate < date '1996-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation100.n_name, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount)) AS revenue FROM customer AS customer100 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1996-01-01' AND o_orderdate < (DATE '1996-01-01' + INTERVAL '1' YEAR)) AS t735 ON customer100.c_custkey = t735.o_custkey INNER JOIN lineitem AS lineitem100 ON t735.o_orderkey = lineitem100.l_orderkey INNER JOIN supplier AS supplier100 ON lineitem100.l_suppkey = supplier100.s_suppkey AND customer100.c_nationkey = supplier100.s_nationkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t736 ON nation100.n_regionkey = t736.r_regionkey GROUP BY nation100.n_name ORDER BY SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
220,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'GERMANY' and n2.n_name = 'INDIA') or (n1.n_name = 'INDIA' and n2.n_name = 'GERMANY') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation199.n_name AS supp_nation, nation200.n_name AS cust_nation, EXTRACT(YEAR FROM t629.l_shipdate) AS l_year, SUM(t629.l_extendedprice * (1 - t629.l_discount)) AS revenue FROM supplier AS supplier99 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t629 ON supplier99.s_suppkey = t629.l_suppkey INNER JOIN orders AS orders99 ON t629.l_orderkey = orders99.o_orderkey INNER JOIN customer AS customer99 ON orders99.o_custkey = customer99.c_custkey INNER JOIN nation AS nation199 ON supplier99.s_nationkey = nation199.n_nationkey INNER JOIN nation AS nation200 ON customer99.c_nationkey = nation200.n_nationkey AND (nation199.n_name = 'GERMANY' AND nation200.n_name = 'INDIA' OR nation199.n_name = 'INDIA' AND nation200.n_name = 'GERMANY') GROUP BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate) ORDER BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
221,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(5)) = 'INDIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY POLISHED NICKEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
222,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '31', '37', '26', '21', '24', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '31', '37', '26', '21', '24', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '25'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '25')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
223,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 2 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t315.s_acctbal, t315.s_name, t315.n_name, t315.p_partkey, t315.p_mfgr, t315.s_address, t315.s_phone, t315.s_comment FROM (SELECT t304.p_partkey, t304.p_name, t304.p_mfgr, t304.p_brand, t304.p_type, t304.p_size, t304.p_container, t304.p_retailprice, t304.p_comment, supplier41.s_suppkey, supplier41.s_name, supplier41.s_address, supplier41.s_nationkey, supplier41.s_phone, supplier41.s_acctbal, supplier41.s_comment, partsupp41.ps_partkey, partsupp41.ps_suppkey, partsupp41.ps_availqty, partsupp41.ps_supplycost, partsupp41.ps_comment, nation41.n_nationkey, nation41.n_name, nation41.n_regionkey, nation41.n_comment, t305.r_regionkey, t305.r_name, t305.r_comment, CAST(t313.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t313.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 2 AND p_type LIKE '%NICKEL') AS t304 CROSS JOIN supplier AS supplier41 INNER JOIN partsupp AS partsupp41 ON t304.p_partkey = partsupp41.ps_partkey AND supplier41.s_suppkey = partsupp41.ps_suppkey INNER JOIN nation AS nation41 ON supplier41.s_nationkey = nation41.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t305 ON nation41.n_regionkey = t305.r_regionkey INNER JOIN (SELECT t310.ps_partkey, MIN(t310.EXPR0) AS EXPR0 FROM (SELECT t308.ps_partkey, t309.n_regionkey, MIN(t308.EXPR0) AS EXPR0 FROM (SELECT t306.ps_partkey, t307.s_nationkey, MIN(t306.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t306 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t307 ON t306.ps_suppkey = t307.s_suppkey GROUP BY t306.ps_partkey, t307.s_nationkey) AS t308 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t309 ON t308.s_nationkey = t309.n_nationkey GROUP BY t308.ps_partkey, t309.n_regionkey) AS t310 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t312 ON t310.n_regionkey = t312.r_regionkey GROUP BY t310.ps_partkey) AS t313 ON t304.p_partkey = t313.ps_partkey AND partsupp41.ps_supplycost = t313.EXPR0 ORDER BY supplier41.s_acctbal DESC, nation41.n_name, supplier41.s_name, t304.p_partkey) AS t315",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
224,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(7)) = 'VIETNAM' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED COPPER') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'ASIA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
225,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '32', '34', '22', '37', '23', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '32', '34', '22', '37', '23', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
226,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 47 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 47 AND p_type LIKE '%TIN') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
227,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-10' and l_shipdate > date '1995-03-10' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t161.l_orderkey, SUM(t161.l_extendedprice * (1 - t161.l_discount)) AS revenue, t160.o_orderdate, t160.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t159 INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-10') AS t160 ON t159.c_custkey = t160.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-10') AS t161 ON t160.o_orderkey = t161.l_orderkey GROUP BY t161.l_orderkey, t160.o_orderdate, t160.o_shippriority ORDER BY SUM(t161.l_extendedprice * (1 - t161.l_discount)) DESC, t160.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
228,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'INDIA' group by s_name order by numwait desc, s_name;","SELECT t23.s_name, COUNT(*) AS numwait FROM (SELECT supplier3.s_suppkey, supplier3.s_name, supplier3.s_address, supplier3.s_nationkey, supplier3.s_phone, supplier3.s_acctbal, supplier3.s_comment, lineitem6.l_orderkey, lineitem6.l_partkey, lineitem6.l_suppkey, lineitem6.l_linenumber, lineitem6.l_quantity, lineitem6.l_extendedprice, lineitem6.l_discount, lineitem6.l_tax, lineitem6.l_returnflag, lineitem6.l_linestatus, lineitem6.l_shipdate, lineitem6.l_commitdate, lineitem6.l_receiptdate, lineitem6.l_shipinstruct, lineitem6.l_shipmode, lineitem6.l_comment, orders3.o_orderkey, orders3.o_custkey, orders3.o_orderstatus, orders3.o_totalprice, orders3.o_orderdate, orders3.o_orderpriority, orders3.o_clerk, orders3.o_shippriority, orders3.o_comment, nation3.n_nationkey, nation3.n_name, nation3.n_regionkey, nation3.n_comment, t21.f0 FROM supplier AS supplier3 CROSS JOIN lineitem AS lineitem6 CROSS JOIN orders AS orders3 CROSS JOIN nation AS nation3 LEFT JOIN (SELECT t20.l_orderkey AS l_orderkey0, t20.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem7 INNER JOIN (SELECT lineitem8.l_orderkey, lineitem8.l_suppkey FROM supplier AS supplier4, lineitem AS lineitem8, orders AS orders4, nation AS nation4) AS t20 ON lineitem7.l_orderkey = t20.l_orderkey AND lineitem7.l_suppkey <> t20.l_suppkey) AS t21 ON lineitem6.l_orderkey = t21.l_orderkey0 AND lineitem6.l_suppkey = t21.l_suppkey0 WHERE supplier3.s_suppkey = lineitem6.l_suppkey AND (orders3.o_orderkey = lineitem6.l_orderkey AND orders3.o_orderstatus = 'F') AND (lineitem6.l_receiptdate > lineitem6.l_commitdate AND supplier3.s_nationkey = nation3.n_nationkey AND (nation3.n_name = 'INDIA' AND t21.f0 IS NOT NULL))) AS t23 LEFT JOIN (SELECT t29.l_orderkey AS l_orderkey0, t29.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t24 INNER JOIN (SELECT lineitem10.l_orderkey, lineitem10.l_suppkey FROM supplier AS supplier5 CROSS JOIN lineitem AS lineitem10 CROSS JOIN orders AS orders5 CROSS JOIN nation AS nation5 LEFT JOIN (SELECT t25.l_orderkey AS l_orderkey0, t25.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem11 INNER JOIN (SELECT lineitem12.l_orderkey, lineitem12.l_suppkey FROM supplier AS supplier6, lineitem AS lineitem12, orders AS orders6, nation AS nation6) AS t25 ON lineitem11.l_orderkey = t25.l_orderkey AND lineitem11.l_suppkey <> t25.l_suppkey) AS t26 ON lineitem10.l_orderkey = t26.l_orderkey0 AND lineitem10.l_suppkey = t26.l_suppkey0 WHERE supplier5.s_suppkey = lineitem10.l_suppkey AND (orders5.o_orderkey = lineitem10.l_orderkey AND orders5.o_orderstatus = 'F') AND (lineitem10.l_receiptdate > lineitem10.l_commitdate AND supplier5.s_nationkey = nation5.n_nationkey AND (nation5.n_name = 'INDIA' AND t26.f0 IS NOT NULL))) AS t29 ON t24.l_orderkey = t29.l_orderkey AND t24.l_suppkey <> t29.l_suppkey) AS t30 ON t23.l_orderkey = t30.l_orderkey0 AND t23.l_suppkey = t30.l_suppkey0 WHERE t30.f0 IS NULL GROUP BY t23.s_name ORDER BY COUNT(*) DESC, t23.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
229,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '25', '20', '35', '34', '23', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '25', '20', '35', '34', '23', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '33'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '33')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
230,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 25 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 25 AND p_type LIKE '%STEEL') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
231,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-06-01' and o_orderdate < date '1997-06-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1997-06-01' AND o_orderdate < (DATE '1997-06-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
232,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%cornflower%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation103.n_name AS nation, EXTRACT(YEAR FROM orders103.o_orderdate) AS o_year, SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount) - partsupp103.ps_supplycost * lineitem103.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%cornflower%') AS t615 CROSS JOIN supplier AS supplier103 INNER JOIN lineitem AS lineitem103 ON supplier103.s_suppkey = lineitem103.l_suppkey AND t615.p_partkey = lineitem103.l_partkey INNER JOIN partsupp AS partsupp103 ON lineitem103.l_suppkey = partsupp103.ps_suppkey AND lineitem103.l_partkey = partsupp103.ps_partkey INNER JOIN orders AS orders103 ON lineitem103.l_orderkey = orders103.o_orderkey INNER JOIN nation AS nation103 ON supplier103.s_nationkey = nation103.n_nationkey GROUP BY nation103.n_name, EXTRACT(YEAR FROM orders103.o_orderdate) ORDER BY nation103.n_name, EXTRACT(YEAR FROM orders103.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
233,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '21', '30', '37', '44', '27', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '21', '30', '37', '44', '27', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '42'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '42')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
234,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 27 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 27 AND p_type LIKE '%BRASS') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
235,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL PLATED TIN') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
236,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%dark%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation102.n_name AS nation, EXTRACT(YEAR FROM orders102.o_orderdate) AS o_year, SUM(lineitem102.l_extendedprice * (1 - lineitem102.l_discount) - partsupp102.ps_supplycost * lineitem102.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%dark%') AS t607 CROSS JOIN supplier AS supplier102 INNER JOIN lineitem AS lineitem102 ON supplier102.s_suppkey = lineitem102.l_suppkey AND t607.p_partkey = lineitem102.l_partkey INNER JOIN partsupp AS partsupp102 ON lineitem102.l_suppkey = partsupp102.ps_suppkey AND lineitem102.l_partkey = partsupp102.ps_partkey INNER JOIN orders AS orders102 ON lineitem102.l_orderkey = orders102.o_orderkey INNER JOIN nation AS nation102 ON supplier102.s_nationkey = nation102.n_nationkey GROUP BY nation102.n_name, EXTRACT(YEAR FROM orders102.o_orderdate) ORDER BY nation102.n_name, EXTRACT(YEAR FROM orders102.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
237,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '22', '20', '30', '24', '42', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '22', '20', '30', '24', '42', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
238,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 41 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 41 AND p_type LIKE '%STEEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
239,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'IRAN' and n2.n_name = 'MOZAMBIQUE') or (n1.n_name = 'MOZAMBIQUE' and n2.n_name = 'IRAN') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation199.n_name AS supp_nation, nation200.n_name AS cust_nation, EXTRACT(YEAR FROM t629.l_shipdate) AS l_year, SUM(t629.l_extendedprice * (1 - t629.l_discount)) AS revenue FROM supplier AS supplier99 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t629 ON supplier99.s_suppkey = t629.l_suppkey INNER JOIN orders AS orders99 ON t629.l_orderkey = orders99.o_orderkey INNER JOIN customer AS customer99 ON orders99.o_custkey = customer99.c_custkey INNER JOIN nation AS nation199 ON supplier99.s_nationkey = nation199.n_nationkey INNER JOIN nation AS nation200 ON customer99.c_nationkey = nation200.n_nationkey AND (nation199.n_name = 'IRAN' AND nation200.n_name = 'MOZAMBIQUE' OR nation199.n_name = 'MOZAMBIQUE' AND nation200.n_name = 'IRAN') GROUP BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate) ORDER BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
240,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(10)) = 'MOZAMBIQUE' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM ANODIZED NICKEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
241,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '26', '23', '33', '44', '24', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '26', '23', '33', '44', '24', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '25'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '25')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
242,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 50 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 50 AND p_type LIKE '%TIN') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
243,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-23' and l_shipdate > date '1995-03-23' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t800.l_orderkey, SUM(t800.l_extendedprice * (1 - t800.l_discount)) AS revenue, t799.o_orderdate, t799.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t797, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-23') AS t798 WHERE t797.c_custkey = t798.o_custkey) AS t799, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-23') AS t800 WHERE t800.l_orderkey = t799.o_orderkey GROUP BY t800.l_orderkey, t799.o_orderdate, t799.o_shippriority ORDER BY SUM(t800.l_extendedprice * (1 - t800.l_discount)) DESC, t799.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
244,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-07-01' and o_orderdate < date '1996-07-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1996-07-01' AND o_orderdate < (DATE '1996-07-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
245,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '32', '23', '26', '33', '43', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '32', '23', '26', '33', '43', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
246,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 4 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 4 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
247,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-12' and l_shipdate > date '1995-03-12' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t775.l_orderkey, SUM(t775.l_extendedprice * (1 - t775.l_discount)) AS revenue, t774.o_orderdate, t774.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t772, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-12') AS t773 WHERE t772.c_custkey = t773.o_custkey) AS t774, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-12') AS t775 WHERE t775.l_orderkey = t774.o_orderkey GROUP BY t775.l_orderkey, t774.o_orderdate, t774.o_shippriority ORDER BY SUM(t775.l_extendedprice * (1 - t775.l_discount)) DESC, t774.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
248,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-11-01' and o_orderdate < date '1994-11-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-11-01' AND o_orderdate < (DATE '1994-11-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
249,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(4)) = 'PERU' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL POLISHED NICKEL') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
250,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%drab%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation99.n_name AS nation, EXTRACT(YEAR FROM orders99.o_orderdate) AS o_year, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount) - partsupp99.ps_supplycost * lineitem99.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%drab%') AS t583 CROSS JOIN supplier AS supplier99 INNER JOIN lineitem AS lineitem99 ON supplier99.s_suppkey = lineitem99.l_suppkey AND t583.p_partkey = lineitem99.l_partkey INNER JOIN partsupp AS partsupp99 ON lineitem99.l_suppkey = partsupp99.ps_suppkey AND lineitem99.l_partkey = partsupp99.ps_partkey INNER JOIN orders AS orders99 ON lineitem99.l_orderkey = orders99.o_orderkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey GROUP BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) ORDER BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
251,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '21', '27', '23', '29', '30', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '21', '27', '23', '29', '30', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
252,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 16 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 16 AND p_type LIKE '%BRASS') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
253,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-26' and l_shipdate > date '1995-03-26' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t793.l_orderkey, SUM(t793.l_extendedprice * (1 - t793.l_discount)) AS revenue, t792.o_orderdate, t792.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'HOUSEHOLD') AS t790, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-26') AS t791 WHERE t790.c_custkey = t791.o_custkey) AS t792, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-26') AS t793 WHERE t793.l_orderkey = t792.o_orderkey GROUP BY t793.l_orderkey, t792.o_orderdate, t792.o_shippriority ORDER BY SUM(t793.l_extendedprice * (1 - t793.l_discount)) DESC, t792.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
254,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM ANODIZED NICKEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
255,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '23', '30', '34', '27', '37', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '23', '30', '34', '27', '37', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
256,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 38 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 38 AND p_type LIKE '%STEEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
257,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-08' and l_shipdate > date '1995-03-08' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t814.l_orderkey, SUM(t814.l_extendedprice * (1 - t814.l_discount)) AS revenue, t813.o_orderdate, t813.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'FURNITURE') AS t811, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-08') AS t812 WHERE t811.c_custkey = t812.o_custkey) AS t813, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-08') AS t814 WHERE t814.l_orderkey = t813.o_orderkey GROUP BY t814.l_orderkey, t813.o_orderdate, t813.o_shippriority ORDER BY SUM(t814.l_extendedprice * (1 - t814.l_discount)) DESC, t813.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
258,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'FRANCE' and n2.n_name = 'INDONESIA') or (n1.n_name = 'INDONESIA' and n2.n_name = 'FRANCE') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation201.n_name AS supp_nation, nation202.n_name AS cust_nation, EXTRACT(YEAR FROM t638.l_shipdate) AS l_year, SUM(t638.l_extendedprice * (1 - t638.l_discount)) AS revenue FROM supplier AS supplier100 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t638 ON supplier100.s_suppkey = t638.l_suppkey INNER JOIN orders AS orders100 ON t638.l_orderkey = orders100.o_orderkey INNER JOIN customer AS customer100 ON orders100.o_custkey = customer100.c_custkey INNER JOIN nation AS nation201 ON supplier100.s_nationkey = nation201.n_nationkey INNER JOIN nation AS nation202 ON customer100.c_nationkey = nation202.n_nationkey AND (nation201.n_name = 'FRANCE' AND nation202.n_name = 'INDONESIA' OR nation201.n_name = 'INDONESIA' AND nation202.n_name = 'FRANCE') GROUP BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate) ORDER BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
259,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(9)) = 'INDONESIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BURNISHED COPPER') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'ASIA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
260,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '31', '43', '38', '35', '36', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '31', '43', '38', '35', '36', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
261,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 15 AND p_type LIKE '%NICKEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
262,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'INDIA' and n2.n_name = 'IRAQ') or (n1.n_name = 'IRAQ' and n2.n_name = 'INDIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation203.n_name AS supp_nation, nation204.n_name AS cust_nation, EXTRACT(YEAR FROM t647.l_shipdate) AS l_year, SUM(t647.l_extendedprice * (1 - t647.l_discount)) AS revenue FROM supplier AS supplier101 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t647 ON supplier101.s_suppkey = t647.l_suppkey INNER JOIN orders AS orders101 ON t647.l_orderkey = orders101.o_orderkey INNER JOIN customer AS customer101 ON orders101.o_custkey = customer101.c_custkey INNER JOIN nation AS nation203 ON supplier101.s_nationkey = nation203.n_nationkey INNER JOIN nation AS nation204 ON customer101.c_nationkey = nation204.n_nationkey AND (nation203.n_name = 'INDIA' AND nation204.n_name = 'IRAQ' OR nation203.n_name = 'IRAQ' AND nation204.n_name = 'INDIA') GROUP BY nation203.n_name, nation204.n_name, EXTRACT(YEAR FROM t647.l_shipdate) ORDER BY nation203.n_name, nation204.n_name, EXTRACT(YEAR FROM t647.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
263,tpch,"select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(4)) = 'IRAQ' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL ANODIZED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
264,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%chocolate%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation101.n_name AS nation, EXTRACT(YEAR FROM orders101.o_orderdate) AS o_year, SUM(lineitem101.l_extendedprice * (1 - lineitem101.l_discount) - partsupp101.ps_supplycost * lineitem101.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%chocolate%') AS t599 CROSS JOIN supplier AS supplier101 INNER JOIN lineitem AS lineitem101 ON supplier101.s_suppkey = lineitem101.l_suppkey AND t599.p_partkey = lineitem101.l_partkey INNER JOIN partsupp AS partsupp101 ON lineitem101.l_suppkey = partsupp101.ps_suppkey AND lineitem101.l_partkey = partsupp101.ps_partkey INNER JOIN orders AS orders101 ON lineitem101.l_orderkey = orders101.o_orderkey INNER JOIN nation AS nation101 ON supplier101.s_nationkey = nation101.n_nationkey GROUP BY nation101.n_name, EXTRACT(YEAR FROM orders101.o_orderdate) ORDER BY nation101.n_name, EXTRACT(YEAR FROM orders101.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
265,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '21', '22', '41', '26', '35', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '21', '22', '41', '26', '35', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '36'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '36')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
266,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 37 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 37 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
267,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'JAPAN' and n2.n_name = 'JORDAN') or (n1.n_name = 'JORDAN' and n2.n_name = 'JAPAN') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation199.n_name AS supp_nation, nation200.n_name AS cust_nation, EXTRACT(YEAR FROM t629.l_shipdate) AS l_year, SUM(t629.l_extendedprice * (1 - t629.l_discount)) AS revenue FROM supplier AS supplier99 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t629 ON supplier99.s_suppkey = t629.l_suppkey INNER JOIN orders AS orders99 ON t629.l_orderkey = orders99.o_orderkey INNER JOIN customer AS customer99 ON orders99.o_custkey = customer99.c_custkey INNER JOIN nation AS nation199 ON supplier99.s_nationkey = nation199.n_nationkey INNER JOIN nation AS nation200 ON customer99.c_nationkey = nation200.n_nationkey AND (nation199.n_name = 'JAPAN' AND nation200.n_name = 'JORDAN' OR nation199.n_name = 'JORDAN' AND nation200.n_name = 'JAPAN') GROUP BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate) ORDER BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
268,tpch,"select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(6)) = 'JORDAN' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL PLATED STEEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
269,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%dim%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation103.n_name AS nation, EXTRACT(YEAR FROM orders103.o_orderdate) AS o_year, SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount) - partsupp103.ps_supplycost * lineitem103.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%dim%') AS t615 CROSS JOIN supplier AS supplier103 INNER JOIN lineitem AS lineitem103 ON supplier103.s_suppkey = lineitem103.l_suppkey AND t615.p_partkey = lineitem103.l_partkey INNER JOIN partsupp AS partsupp103 ON lineitem103.l_suppkey = partsupp103.ps_suppkey AND lineitem103.l_partkey = partsupp103.ps_partkey INNER JOIN orders AS orders103 ON lineitem103.l_orderkey = orders103.o_orderkey INNER JOIN nation AS nation103 ON supplier103.s_nationkey = nation103.n_nationkey GROUP BY nation103.n_name, EXTRACT(YEAR FROM orders103.o_orderdate) ORDER BY nation103.n_name, EXTRACT(YEAR FROM orders103.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
270,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#12' and p_type not like 'STANDARD POLISHED%' and p_size in (41, 28, 43, 38, 8, 30, 12, 45) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t5.p_brand, t5.p_type, t5.p_size, COUNT(t5.ps_suppkey) AS supplier_cnt FROM (SELECT t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey FROM (SELECT * FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#12' AND t.p_size IN (8, 12, 28, 30, 38, 41, 43, 45) AND t.p_type NOT LIKE 'STANDARD POLISHED%') AS t0 LEFT JOIN (SELECT s_suppkey, TRUE AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') AS t2 ON t0.ps_suppkey0 = t2.s_suppkey WHERE t2.f1 IS NOT TRUE GROUP BY t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey) AS t5 GROUP BY t5.p_brand, t5.p_type, t5.p_size ORDER BY COUNT(t5.ps_suppkey) DESC, t5.p_brand, t5.p_type, t5.p_size;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
271,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 25 and l_quantity <= 25 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );",SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#53' AND ((part.p_container = 'SM CASE' OR part.p_container = 'SM BOX' OR part.p_container = 'SM PACK' OR part.p_container = 'SM PKG') AND lineitem.l_quantity >= 2) AND (lineitem.l_quantity <= 2 + 10 AND part.p_size >= 1 AND (part.p_size <= 5 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#54' AND ((part.p_container = 'MED BAG' OR part.p_container = 'MED BOX' OR part.p_container = 'MED PKG' OR part.p_container = 'MED PACK') AND lineitem.l_quantity >= 19) AND (lineitem.l_quantity <= 19 + 10 AND part.p_size >= 1 AND (part.p_size <= 10 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#13' AND ((part.p_container = 'LG CASE' OR part.p_container = 'LG BOX' OR part.p_container = 'LG PACK' OR part.p_container = 'LG PKG') AND lineitem.l_quantity >= 25) AND (lineitem.l_quantity <= 25 + 10 AND part.p_size >= 1 AND (part.p_size <= 15 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')));,['Empty List'],"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]"
272,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('38', '22', '34', '25', '42', '21', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('38', '22', '34', '25', '42', '21', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
273,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 9 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 9 AND p_type LIKE '%NICKEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
274,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and o_orderdate >= date '1993-01-01' and o_orderdate < date '1993-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation102.n_name, SUM(lineitem102.l_extendedprice * (1 - lineitem102.l_discount)) AS revenue FROM customer AS customer102 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-01-01' AND o_orderdate < (DATE '1993-01-01' + INTERVAL '1' YEAR)) AS t755 ON customer102.c_custkey = t755.o_custkey INNER JOIN lineitem AS lineitem102 ON t755.o_orderkey = lineitem102.l_orderkey INNER JOIN supplier AS supplier102 ON lineitem102.l_suppkey = supplier102.s_suppkey AND customer102.c_nationkey = supplier102.s_nationkey INNER JOIN nation AS nation102 ON supplier102.s_nationkey = nation102.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t756 ON nation102.n_regionkey = t756.r_regionkey GROUP BY nation102.n_name ORDER BY SUM(lineitem102.l_extendedprice * (1 - lineitem102.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
275,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(4)) = 'IRAN' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BURNISHED TIN') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
276,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '27', '25', '23', '20', '42', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '27', '25', '23', '20', '42', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
277,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 40 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 40 AND p_type LIKE '%TIN') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
278,tpch,"select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(6)) = 'JORDAN' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY POLISHED COPPER') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
279,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '30', '21', '24', '39', '27', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '30', '21', '24', '39', '27', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
280,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'UNITED STATES' and n2.n_name = 'ALGERIA') or (n1.n_name = 'ALGERIA' and n2.n_name = 'UNITED STATES') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation199.n_name AS supp_nation, nation200.n_name AS cust_nation, EXTRACT(YEAR FROM t629.l_shipdate) AS l_year, SUM(t629.l_extendedprice * (1 - t629.l_discount)) AS revenue FROM supplier AS supplier99 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t629 ON supplier99.s_suppkey = t629.l_suppkey INNER JOIN orders AS orders99 ON t629.l_orderkey = orders99.o_orderkey INNER JOIN customer AS customer99 ON orders99.o_custkey = customer99.c_custkey INNER JOIN nation AS nation199 ON supplier99.s_nationkey = nation199.n_nationkey INNER JOIN nation AS nation200 ON customer99.c_nationkey = nation200.n_nationkey AND (nation199.n_name = 'UNITED STATES' AND nation200.n_name = 'ALGERIA' OR nation199.n_name = 'ALGERIA' AND nation200.n_name = 'UNITED STATES') GROUP BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate) ORDER BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
281,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '29', '34', '20', '33', '44', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '29', '34', '20', '33', '44', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
282,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 14 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 14 AND p_type LIKE '%TIN') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
283,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(7)) = 'ALGERIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED NICKEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
284,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '39', '43', '36', '30', '37', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '39', '43', '36', '30', '37', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '40'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '40')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
285,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 38 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 38 AND p_type LIKE '%STEEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
286,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'MOZAMBIQUE' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'PROMO POLISHED TIN') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate);",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
287,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('FOB', 'REG AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders INNER JOIN (SELECT * FROM lineitem WHERE l_shipmode IN ('FOB', 'REG AIR') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1993-01-01' AND l_receiptdate < (DATE '1993-01-01' + INTERVAL '1' YEAR)) AS t ON orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]"
288,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '43', '41', '20', '25', '38', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '43', '41', '20', '25', '38', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '33'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '33')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
289,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 46 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 46 AND p_type LIKE '%STEEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
290,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-02' and l_shipdate > date '1995-03-02' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t789.l_orderkey, SUM(t789.l_extendedprice * (1 - t789.l_discount)) AS revenue, t788.o_orderdate, t788.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t786, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-02') AS t787 WHERE t786.c_custkey = t787.o_custkey) AS t788, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-02') AS t789 WHERE t789.l_orderkey = t788.o_orderkey GROUP BY t789.l_orderkey, t788.o_orderdate, t788.o_shippriority ORDER BY SUM(t789.l_extendedprice * (1 - t789.l_discount)) DESC, t788.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
291,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'ETHIOPIA' group by s_name order by numwait desc, s_name;","SELECT t2.s_name, COUNT(*) AS numwait FROM (SELECT * FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t0.f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t.l_orderkey AS l_orderkey0, t.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem0 INNER JOIN (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0) AS t ON lineitem0.l_orderkey = t.l_orderkey AND lineitem0.l_suppkey <> t.l_suppkey) AS t0 ON lineitem.l_orderkey = t0.l_orderkey0 AND lineitem.l_suppkey = t0.l_suppkey0) AS t1 WHERE t1.s_suppkey = t1.l_suppkey AND (t1.o_orderkey = t1.l_orderkey AND t1.o_orderstatus = 'F') AND (t1.l_receiptdate > t1.l_commitdate AND t1.s_nationkey = t1.n_nationkey AND (t1.n_name = 'ETHIOPIA' AND t1.f0 IS NOT NULL))) AS t2 LEFT JOIN (SELECT t8.l_orderkey AS l_orderkey0, t8.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t3 INNER JOIN (SELECT l_orderkey, l_suppkey FROM (SELECT supplier1.s_suppkey, supplier1.s_name, supplier1.s_address, supplier1.s_nationkey, supplier1.s_phone, supplier1.s_acctbal, supplier1.s_comment, lineitem3.l_orderkey, lineitem3.l_partkey, lineitem3.l_suppkey, lineitem3.l_linenumber, lineitem3.l_quantity, lineitem3.l_extendedprice, lineitem3.l_discount, lineitem3.l_tax, lineitem3.l_returnflag, lineitem3.l_linestatus, lineitem3.l_shipdate, lineitem3.l_commitdate, lineitem3.l_receiptdate, lineitem3.l_shipinstruct, lineitem3.l_shipmode, lineitem3.l_comment, orders1.o_orderkey, orders1.o_custkey, orders1.o_orderstatus, orders1.o_totalprice, orders1.o_orderdate, orders1.o_orderpriority, orders1.o_clerk, orders1.o_shippriority, orders1.o_comment, nation1.n_nationkey, nation1.n_name, nation1.n_regionkey, nation1.n_comment, t5.f0 FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t4.l_orderkey AS l_orderkey0, t4.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem4 INNER JOIN (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2) AS t4 ON lineitem4.l_orderkey = t4.l_orderkey AND lineitem4.l_suppkey <> t4.l_suppkey) AS t5 ON lineitem3.l_orderkey = t5.l_orderkey0 AND lineitem3.l_suppkey = t5.l_suppkey0) AS t6 WHERE t6.s_suppkey = t6.l_suppkey AND (t6.o_orderkey = t6.l_orderkey AND t6.o_orderstatus = 'F') AND (t6.l_receiptdate > t6.l_commitdate AND t6.s_nationkey = t6.n_nationkey AND (t6.n_name = 'ETHIOPIA' AND t6.f0 IS NOT NULL))) AS t8 ON t3.l_orderkey = t8.l_orderkey AND t3.l_suppkey <> t8.l_suppkey) AS t9 ON t2.l_orderkey = t9.l_orderkey0 AND t2.l_suppkey = t9.l_suppkey0 WHERE t9.f0 IS NULL GROUP BY t2.s_name ORDER BY COUNT(*) DESC, t2.s_name;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
292,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '43', '21', '29', '38', '37', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '43', '21', '29', '38', '37', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '25'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '25')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
293,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 26 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 26 AND p_type LIKE '%STEEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
294,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-09-01' and o_orderdate < date '1996-09-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1996-09-01' AND o_orderdate < (DATE '1996-09-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
295,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'JAPAN' and n2.n_name = 'MOROCCO') or (n1.n_name = 'MOROCCO' and n2.n_name = 'JAPAN') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation203.n_name AS supp_nation, nation204.n_name AS cust_nation, EXTRACT(YEAR FROM t647.l_shipdate) AS l_year, SUM(t647.l_extendedprice * (1 - t647.l_discount)) AS revenue FROM supplier AS supplier101 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t647 ON supplier101.s_suppkey = t647.l_suppkey INNER JOIN orders AS orders101 ON t647.l_orderkey = orders101.o_orderkey INNER JOIN customer AS customer101 ON orders101.o_custkey = customer101.c_custkey INNER JOIN nation AS nation203 ON supplier101.s_nationkey = nation203.n_nationkey INNER JOIN nation AS nation204 ON customer101.c_nationkey = nation204.n_nationkey AND (nation203.n_name = 'JAPAN' AND nation204.n_name = 'MOROCCO' OR nation203.n_name = 'MOROCCO' AND nation204.n_name = 'JAPAN') GROUP BY nation203.n_name, nation204.n_name, EXTRACT(YEAR FROM t647.l_shipdate) ORDER BY nation203.n_name, nation204.n_name, EXTRACT(YEAR FROM t647.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
296,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '26', '41', '43', '40', '38', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '26', '41', '43', '40', '38', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
297,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 49 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 49 AND p_type LIKE '%TIN') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
298,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-10-01' and o_orderdate < date '1995-10-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-10-01' AND o_orderdate < (DATE '1995-10-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
299,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'IRAN' and n2.n_name = 'JORDAN') or (n1.n_name = 'JORDAN' and n2.n_name = 'IRAN') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation199.n_name AS supp_nation, nation200.n_name AS cust_nation, EXTRACT(YEAR FROM t629.l_shipdate) AS l_year, SUM(t629.l_extendedprice * (1 - t629.l_discount)) AS revenue FROM supplier AS supplier99 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t629 ON supplier99.s_suppkey = t629.l_suppkey INNER JOIN orders AS orders99 ON t629.l_orderkey = orders99.o_orderkey INNER JOIN customer AS customer99 ON orders99.o_custkey = customer99.c_custkey INNER JOIN nation AS nation199 ON supplier99.s_nationkey = nation199.n_nationkey INNER JOIN nation AS nation200 ON customer99.c_nationkey = nation200.n_nationkey AND (nation199.n_name = 'IRAN' AND nation200.n_name = 'JORDAN' OR nation199.n_name = 'JORDAN' AND nation200.n_name = 'IRAN') GROUP BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate) ORDER BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
300,tpch,"select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(6)) = 'JORDAN' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO POLISHED BRASS') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
301,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '36', '39', '22', '28', '20', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '36', '39', '22', '28', '20', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
302,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 17 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 17 AND p_type LIKE '%TIN') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
303,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and o_orderdate >= date '1996-01-01' and o_orderdate < date '1996-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation99.n_name, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount)) AS revenue FROM customer AS customer99 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1996-01-01' AND o_orderdate < (DATE '1996-01-01' + INTERVAL '1' YEAR)) AS t725 ON customer99.c_custkey = t725.o_custkey INNER JOIN lineitem AS lineitem99 ON t725.o_orderkey = lineitem99.l_orderkey INNER JOIN supplier AS supplier99 ON lineitem99.l_suppkey = supplier99.s_suppkey AND customer99.c_nationkey = supplier99.s_nationkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t726 ON nation99.n_regionkey = t726.r_regionkey GROUP BY nation99.n_name ORDER BY SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
304,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'UNITED KINGDOM' and n2.n_name = 'CANADA') or (n1.n_name = 'CANADA' and n2.n_name = 'UNITED KINGDOM') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation199.n_name AS supp_nation, nation200.n_name AS cust_nation, EXTRACT(YEAR FROM t629.l_shipdate) AS l_year, SUM(t629.l_extendedprice * (1 - t629.l_discount)) AS revenue FROM supplier AS supplier99 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t629 ON supplier99.s_suppkey = t629.l_suppkey INNER JOIN orders AS orders99 ON t629.l_orderkey = orders99.o_orderkey INNER JOIN customer AS customer99 ON orders99.o_custkey = customer99.c_custkey INNER JOIN nation AS nation199 ON supplier99.s_nationkey = nation199.n_nationkey INNER JOIN nation AS nation200 ON customer99.c_nationkey = nation200.n_nationkey AND (nation199.n_name = 'UNITED KINGDOM' AND nation200.n_name = 'CANADA' OR nation199.n_name = 'CANADA' AND nation200.n_name = 'UNITED KINGDOM') GROUP BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate) ORDER BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
305,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(6)) = 'CANADA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BURNISHED COPPER') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
306,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%spring%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation100.n_name AS nation, EXTRACT(YEAR FROM orders100.o_orderdate) AS o_year, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount) - partsupp100.ps_supplycost * lineitem100.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%spring%') AS t591 CROSS JOIN supplier AS supplier100 INNER JOIN lineitem AS lineitem100 ON supplier100.s_suppkey = lineitem100.l_suppkey AND t591.p_partkey = lineitem100.l_partkey INNER JOIN partsupp AS partsupp100 ON lineitem100.l_suppkey = partsupp100.ps_suppkey AND lineitem100.l_partkey = partsupp100.ps_partkey INNER JOIN orders AS orders100 ON lineitem100.l_orderkey = orders100.o_orderkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey GROUP BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) ORDER BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
307,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '43', '23', '21', '20', '34', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '43', '23', '21', '20', '34', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '40'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '40')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
308,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 2 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 2 AND p_type LIKE '%BRASS') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
309,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(4)) = 'IRAN' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO PLATED STEEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
310,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('41', '28', '36', '21', '40', '42', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('41', '28', '36', '21', '40', '42', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
311,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 44 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 44 AND p_type LIKE '%NICKEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
312,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(4)) = 'IRAN' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED BRASS') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
313,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '27', '43', '33', '28', '36', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '27', '43', '33', '28', '36', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
314,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 17 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 17 AND p_type LIKE '%STEEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
315,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-30' and l_shipdate > date '1995-03-30' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t161.l_orderkey, SUM(t161.l_extendedprice * (1 - t161.l_discount)) AS revenue, t160.o_orderdate, t160.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t159 INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-30') AS t160 ON t159.c_custkey = t160.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-30') AS t161 ON t160.o_orderkey = t161.l_orderkey GROUP BY t161.l_orderkey, t160.o_orderdate, t160.o_shippriority ORDER BY SUM(t161.l_extendedprice * (1 - t161.l_discount)) DESC, t160.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
316,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(5)) = 'INDIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BRUSHED NICKEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'ASIA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
317,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('41', '37', '20', '30', '21', '38', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('41', '37', '20', '30', '21', '38', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '25'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '25')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
318,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 24 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 24 AND p_type LIKE '%COPPER') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
319,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-08-01' and o_orderdate < date '1996-08-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1996-08-01' AND o_orderdate < (DATE '1996-08-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
320,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '21', '25', '20', '42', '32', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '21', '25', '20', '42', '32', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
321,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 16 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 16 AND p_type LIKE '%STEEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
322,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-12-01' and o_orderdate < date '1996-12-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1996-12-01' AND o_orderdate < (DATE '1996-12-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
323,tpch,"select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(7)) = 'MOROCCO' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM PLATED TIN') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
324,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#44' and p_type not like 'ECONOMY BURNISHED%' and p_size in (38, 10, 20, 26, 49, 4, 16, 3) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t4.p_brand, t4.p_type, t4.p_size, COUNT(t4.ps_suppkey) AS supplier_cnt FROM (SELECT t0.ps_suppkey, t0.p_brand, t0.p_type, t0.p_size FROM (SELECT * FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#44' AND t.p_size IN (3, 4, 10, 16, 20, 26, 38, 49) AND t.p_type NOT LIKE 'ECONOMY BURNISHED%') AS t0 LEFT JOIN (SELECT s_suppkey, TRUE AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') AS t2 ON t0.ps_suppkey0 = t2.s_suppkey WHERE t2.f1 IS NOT TRUE GROUP BY t0.ps_suppkey, t0.p_brand, t0.p_type, t0.p_size) AS t4 GROUP BY t4.p_brand, t4.p_type, t4.p_size ORDER BY COUNT(t4.ps_suppkey) DESC, t4.p_brand, t4.p_type, t4.p_size;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
325,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '44', '20', '27', '30', '25', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '44', '20', '27', '30', '25', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '26'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '26')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
326,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 45 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t315.s_acctbal, t315.s_name, t315.n_name, t315.p_partkey, t315.p_mfgr, t315.s_address, t315.s_phone, t315.s_comment FROM (SELECT t304.p_partkey, t304.p_name, t304.p_mfgr, t304.p_brand, t304.p_type, t304.p_size, t304.p_container, t304.p_retailprice, t304.p_comment, supplier41.s_suppkey, supplier41.s_name, supplier41.s_address, supplier41.s_nationkey, supplier41.s_phone, supplier41.s_acctbal, supplier41.s_comment, partsupp41.ps_partkey, partsupp41.ps_suppkey, partsupp41.ps_availqty, partsupp41.ps_supplycost, partsupp41.ps_comment, nation41.n_nationkey, nation41.n_name, nation41.n_regionkey, nation41.n_comment, t305.r_regionkey, t305.r_name, t305.r_comment, CAST(t313.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t313.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 45 AND p_type LIKE '%NICKEL') AS t304 CROSS JOIN supplier AS supplier41 INNER JOIN partsupp AS partsupp41 ON t304.p_partkey = partsupp41.ps_partkey AND supplier41.s_suppkey = partsupp41.ps_suppkey INNER JOIN nation AS nation41 ON supplier41.s_nationkey = nation41.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t305 ON nation41.n_regionkey = t305.r_regionkey INNER JOIN (SELECT t310.ps_partkey, MIN(t310.EXPR0) AS EXPR0 FROM (SELECT t308.ps_partkey, t309.n_regionkey, MIN(t308.EXPR0) AS EXPR0 FROM (SELECT t306.ps_partkey, t307.s_nationkey, MIN(t306.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t306 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t307 ON t306.ps_suppkey = t307.s_suppkey GROUP BY t306.ps_partkey, t307.s_nationkey) AS t308 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t309 ON t308.s_nationkey = t309.n_nationkey GROUP BY t308.ps_partkey, t309.n_regionkey) AS t310 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t312 ON t310.n_regionkey = t312.r_regionkey GROUP BY t310.ps_partkey) AS t313 ON t304.p_partkey = t313.ps_partkey AND partsupp41.ps_supplycost = t313.EXPR0 ORDER BY supplier41.s_acctbal DESC, nation41.n_name, supplier41.s_name, t304.p_partkey) AS t315",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
327,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-05-01' and o_orderdate < date '1994-05-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-05-01' AND o_orderdate < (DATE '1994-05-01' + INTERVAL '3' MONTH)) AS t, (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 WHERE t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
328,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ARGENTINA' and n2.n_name = 'BRAZIL') or (n1.n_name = 'BRAZIL' and n2.n_name = 'ARGENTINA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation205.n_name AS supp_nation, nation206.n_name AS cust_nation, EXTRACT(YEAR FROM t656.l_shipdate) AS l_year, SUM(t656.l_extendedprice * (1 - t656.l_discount)) AS revenue FROM supplier AS supplier102 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t656 ON supplier102.s_suppkey = t656.l_suppkey INNER JOIN orders AS orders102 ON t656.l_orderkey = orders102.o_orderkey INNER JOIN customer AS customer102 ON orders102.o_custkey = customer102.c_custkey INNER JOIN nation AS nation205 ON supplier102.s_nationkey = nation205.n_nationkey INNER JOIN nation AS nation206 ON customer102.c_nationkey = nation206.n_nationkey AND (nation205.n_name = 'ARGENTINA' AND nation206.n_name = 'BRAZIL' OR nation205.n_name = 'BRAZIL' AND nation206.n_name = 'ARGENTINA') GROUP BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate) ORDER BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
329,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(6)) = 'BRAZIL' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED STEEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
330,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('38', '21', '29', '36', '23', '22', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('38', '21', '29', '36', '23', '22', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
331,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 39 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 39 AND p_type LIKE '%STEEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
332,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'INDONESIA' and n2.n_name = 'MOZAMBIQUE') or (n1.n_name = 'MOZAMBIQUE' and n2.n_name = 'INDONESIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation205.n_name AS supp_nation, nation206.n_name AS cust_nation, EXTRACT(YEAR FROM t656.l_shipdate) AS l_year, SUM(t656.l_extendedprice * (1 - t656.l_discount)) AS revenue FROM supplier AS supplier102 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t656 ON supplier102.s_suppkey = t656.l_suppkey INNER JOIN orders AS orders102 ON t656.l_orderkey = orders102.o_orderkey INNER JOIN customer AS customer102 ON orders102.o_custkey = customer102.c_custkey INNER JOIN nation AS nation205 ON supplier102.s_nationkey = nation205.n_nationkey INNER JOIN nation AS nation206 ON customer102.c_nationkey = nation206.n_nationkey AND (nation205.n_name = 'INDONESIA' AND nation206.n_name = 'MOZAMBIQUE' OR nation205.n_name = 'MOZAMBIQUE' AND nation206.n_name = 'INDONESIA') GROUP BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate) ORDER BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
333,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(9)) = 'INDONESIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED NICKEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'ASIA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
334,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '36', '27', '21', '33', '30', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '36', '27', '21', '33', '30', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '22'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '22')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
335,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 42 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 42 AND p_type LIKE '%STEEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
336,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-09-01' and o_orderdate < date '1995-09-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-09-01' AND o_orderdate < (DATE '1995-09-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
337,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD ANODIZED STEEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
338,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%aquamarine%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation103.n_name AS nation, EXTRACT(YEAR FROM orders103.o_orderdate) AS o_year, SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount) - partsupp103.ps_supplycost * lineitem103.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%aquamarine%') AS t615 CROSS JOIN supplier AS supplier103 INNER JOIN lineitem AS lineitem103 ON supplier103.s_suppkey = lineitem103.l_suppkey AND t615.p_partkey = lineitem103.l_partkey INNER JOIN partsupp AS partsupp103 ON lineitem103.l_suppkey = partsupp103.ps_suppkey AND lineitem103.l_partkey = partsupp103.ps_partkey INNER JOIN orders AS orders103 ON lineitem103.l_orderkey = orders103.o_orderkey INNER JOIN nation AS nation103 ON supplier103.s_nationkey = nation103.n_nationkey GROUP BY nation103.n_name, EXTRACT(YEAR FROM orders103.o_orderdate) ORDER BY nation103.n_name, EXTRACT(YEAR FROM orders103.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
339,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '22', '30', '41', '20', '27', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '22', '30', '41', '20', '27', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
340,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 18 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 18 AND p_type LIKE '%TIN') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
341,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-23' and l_shipdate > date '1995-03-23' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t789.l_orderkey, SUM(t789.l_extendedprice * (1 - t789.l_discount)) AS revenue, t788.o_orderdate, t788.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'BUILDING') AS t786, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-23') AS t787 WHERE t786.c_custkey = t787.o_custkey) AS t788, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-23') AS t789 WHERE t789.l_orderkey = t788.o_orderkey GROUP BY t789.l_orderkey, t788.o_orderdate, t788.o_shippriority ORDER BY SUM(t789.l_extendedprice * (1 - t789.l_discount)) DESC, t788.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
342,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'MOZAMBIQUE' and n2.n_name = 'VIETNAM') or (n1.n_name = 'VIETNAM' and n2.n_name = 'MOZAMBIQUE') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation203.n_name AS supp_nation, nation204.n_name AS cust_nation, EXTRACT(YEAR FROM t647.l_shipdate) AS l_year, SUM(t647.l_extendedprice * (1 - t647.l_discount)) AS revenue FROM supplier AS supplier101 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t647 ON supplier101.s_suppkey = t647.l_suppkey INNER JOIN orders AS orders101 ON t647.l_orderkey = orders101.o_orderkey INNER JOIN customer AS customer101 ON orders101.o_custkey = customer101.c_custkey INNER JOIN nation AS nation203 ON supplier101.s_nationkey = nation203.n_nationkey INNER JOIN nation AS nation204 ON customer101.c_nationkey = nation204.n_nationkey AND (nation203.n_name = 'MOZAMBIQUE' AND nation204.n_name = 'VIETNAM' OR nation203.n_name = 'VIETNAM' AND nation204.n_name = 'MOZAMBIQUE') GROUP BY nation203.n_name, nation204.n_name, EXTRACT(YEAR FROM t647.l_shipdate) ORDER BY nation203.n_name, nation204.n_name, EXTRACT(YEAR FROM t647.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
343,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 48 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 48 AND p_type LIKE '%TIN') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
344,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-14' and l_shipdate > date '1995-03-14' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t789.l_orderkey, SUM(t789.l_extendedprice * (1 - t789.l_discount)) AS revenue, t788.o_orderdate, t788.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t786, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-14') AS t787 WHERE t786.c_custkey = t787.o_custkey) AS t788, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-14') AS t789 WHERE t789.l_orderkey = t788.o_orderkey GROUP BY t789.l_orderkey, t788.o_orderdate, t788.o_shippriority ORDER BY SUM(t789.l_extendedprice * (1 - t789.l_discount)) DESC, t788.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
345,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-02-01' and o_orderdate < date '1995-02-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-02-01' AND o_orderdate < (DATE '1995-02-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
346,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '43', '30', '37', '42', '27', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '43', '30', '37', '42', '27', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '26'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '26')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
347,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 27 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 27 AND p_type LIKE '%STEEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
348,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-28' and l_shipdate > date '1995-03-28' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t814.l_orderkey, SUM(t814.l_extendedprice * (1 - t814.l_discount)) AS revenue, t813.o_orderdate, t813.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'BUILDING') AS t811, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-28') AS t812 WHERE t811.c_custkey = t812.o_custkey) AS t813, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-28') AS t814 WHERE t814.l_orderkey = t813.o_orderkey GROUP BY t814.l_orderkey, t813.o_orderdate, t813.o_shippriority ORDER BY SUM(t814.l_extendedprice * (1 - t814.l_discount)) DESC, t813.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
349,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-05-01' and o_orderdate < date '1997-05-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1997-05-01' AND o_orderdate < (DATE '1997-05-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
350,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(5)) = 'INDIA' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL POLISHED COPPER') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
351,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '43', '27', '23', '22', '30', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '43', '27', '23', '22', '30', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '42'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '42')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
352,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 45 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 45 AND p_type LIKE '%STEEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
353,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-29' and l_shipdate > date '1995-03-29' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t168.l_orderkey, SUM(t168.l_extendedprice * (1 - t168.l_discount)) AS revenue, t167.o_orderdate, t167.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t166 INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-29') AS t167 ON t166.c_custkey = t167.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-29') AS t168 ON t167.o_orderkey = t168.l_orderkey GROUP BY t168.l_orderkey, t167.o_orderdate, t167.o_shippriority ORDER BY SUM(t168.l_extendedprice * (1 - t168.l_discount)) DESC, t167.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
354,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL PLATED NICKEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
355,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%deep%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation100.n_name AS nation, EXTRACT(YEAR FROM orders100.o_orderdate) AS o_year, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount) - partsupp100.ps_supplycost * lineitem100.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%deep%') AS t591 CROSS JOIN supplier AS supplier100 INNER JOIN lineitem AS lineitem100 ON supplier100.s_suppkey = lineitem100.l_suppkey AND t591.p_partkey = lineitem100.l_partkey INNER JOIN partsupp AS partsupp100 ON lineitem100.l_suppkey = partsupp100.ps_suppkey AND lineitem100.l_partkey = partsupp100.ps_partkey INNER JOIN orders AS orders100 ON lineitem100.l_orderkey = orders100.o_orderkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey GROUP BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) ORDER BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
356,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '26', '34', '27', '20', '44', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '26', '34', '27', '20', '44', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
357,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 31 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 31 AND p_type LIKE '%STEEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
358,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-14' and l_shipdate > date '1995-03-14' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t793.l_orderkey, SUM(t793.l_extendedprice * (1 - t793.l_discount)) AS revenue, t792.o_orderdate, t792.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t790, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-14') AS t791 WHERE t790.c_custkey = t791.o_custkey) AS t792, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-14') AS t793 WHERE t793.l_orderkey = t792.o_orderkey GROUP BY t793.l_orderkey, t792.o_orderdate, t792.o_shippriority ORDER BY SUM(t793.l_extendedprice * (1 - t793.l_discount)) DESC, t792.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
359,tpch,"select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(7)) = 'MOROCCO' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL ANODIZED STEEL') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
360,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '44', '38', '39', '34', '31', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '44', '38', '39', '34', '31', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
361,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 12 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t315.s_acctbal, t315.s_name, t315.n_name, t315.p_partkey, t315.p_mfgr, t315.s_address, t315.s_phone, t315.s_comment FROM (SELECT t304.p_partkey, t304.p_name, t304.p_mfgr, t304.p_brand, t304.p_type, t304.p_size, t304.p_container, t304.p_retailprice, t304.p_comment, supplier41.s_suppkey, supplier41.s_name, supplier41.s_address, supplier41.s_nationkey, supplier41.s_phone, supplier41.s_acctbal, supplier41.s_comment, partsupp41.ps_partkey, partsupp41.ps_suppkey, partsupp41.ps_availqty, partsupp41.ps_supplycost, partsupp41.ps_comment, nation41.n_nationkey, nation41.n_name, nation41.n_regionkey, nation41.n_comment, t305.r_regionkey, t305.r_name, t305.r_comment, CAST(t313.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t313.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 12 AND p_type LIKE '%BRASS') AS t304 CROSS JOIN supplier AS supplier41 INNER JOIN partsupp AS partsupp41 ON t304.p_partkey = partsupp41.ps_partkey AND supplier41.s_suppkey = partsupp41.ps_suppkey INNER JOIN nation AS nation41 ON supplier41.s_nationkey = nation41.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t305 ON nation41.n_regionkey = t305.r_regionkey INNER JOIN (SELECT t310.ps_partkey, MIN(t310.EXPR0) AS EXPR0 FROM (SELECT t308.ps_partkey, t309.n_regionkey, MIN(t308.EXPR0) AS EXPR0 FROM (SELECT t306.ps_partkey, t307.s_nationkey, MIN(t306.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t306 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t307 ON t306.ps_suppkey = t307.s_suppkey GROUP BY t306.ps_partkey, t307.s_nationkey) AS t308 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t309 ON t308.s_nationkey = t309.n_nationkey GROUP BY t308.ps_partkey, t309.n_regionkey) AS t310 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t312 ON t310.n_regionkey = t312.r_regionkey GROUP BY t310.ps_partkey) AS t313 ON t304.p_partkey = t313.ps_partkey AND partsupp41.ps_supplycost = t313.EXPR0 ORDER BY supplier41.s_acctbal DESC, nation41.n_name, supplier41.s_name, t304.p_partkey) AS t315",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
362,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-01' and o_orderdate < date '1994-06-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-06-01' AND o_orderdate < (DATE '1994-06-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
363,tpch,"select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(5)) = 'CHINA' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM POLISHED BRASS') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
364,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '23', '43', '40', '41', '36', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '23', '43', '40', '41', '36', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
365,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 39 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 39 AND p_type LIKE '%TIN') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
366,tpch,"select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(12)) = 'SAUDI ARABIA' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BURNISHED STEEL') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
367,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '37', '22', '43', '31', '35', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '37', '22', '43', '31', '35', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '42'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '42')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
368,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 38 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 38 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
369,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-16' and l_shipdate > date '1995-03-16' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t161.l_orderkey, SUM(t161.l_extendedprice * (1 - t161.l_discount)) AS revenue, t160.o_orderdate, t160.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t159 INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-16') AS t160 ON t159.c_custkey = t160.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-16') AS t161 ON t160.o_orderkey = t161.l_orderkey GROUP BY t161.l_orderkey, t160.o_orderdate, t160.o_shippriority ORDER BY SUM(t161.l_extendedprice * (1 - t161.l_discount)) DESC, t160.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
370,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(6)) = 'FRANCE' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'PROMO BRUSHED COPPER') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
371,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '40', '43', '28', '23', '26', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '40', '43', '28', '23', '26', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
372,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 16 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 16 AND p_type LIKE '%NICKEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
373,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-18' and l_shipdate > date '1995-03-18' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t807.l_orderkey, SUM(t807.l_extendedprice * (1 - t807.l_discount)) AS revenue, t806.o_orderdate, t806.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t804, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-18') AS t805 WHERE t804.c_custkey = t805.o_custkey) AS t806, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-18') AS t807 WHERE t807.l_orderkey = t806.o_orderkey GROUP BY t807.l_orderkey, t806.o_orderdate, t806.o_shippriority ORDER BY SUM(t807.l_extendedprice * (1 - t807.l_discount)) DESC, t806.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
374,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(5)) = 'EGYPT' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO PLATED NICKEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
375,tpch,"select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%unusual%deposits%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc;","SELECT t2.c_count, COUNT(*) AS custdist FROM (SELECT COUNT(t.o_orderkey) AS c_count FROM customer LEFT JOIN (SELECT * FROM orders WHERE o_comment NOT LIKE '%unusual%deposits%') AS t ON customer.c_custkey = t.o_custkey GROUP BY customer.c_custkey) AS t2 GROUP BY t2.c_count ORDER BY COUNT(*) DESC, t2.c_count DESC;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]"
376,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '38', '30', '44', '33', '27', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '38', '30', '44', '33', '27', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '22'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '22')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
377,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 37 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 37 AND p_type LIKE '%STEEL') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
378,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-08-01' and o_orderdate < date '1993-08-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-08-01' AND o_orderdate < (DATE '1993-08-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
379,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(10)) = 'MOZAMBIQUE' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED STEEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
380,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 15 AND p_type LIKE '%BRASS') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
381,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 3 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 3 AND p_type LIKE '%NICKEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
382,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#33' and p_type not like 'SMALL BRUSHED%' and p_size in (28, 8, 22, 14, 19, 44, 47, 45) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t5.p_brand, t5.p_type, t5.p_size, COUNT(t5.ps_suppkey) AS supplier_cnt FROM (SELECT t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey FROM (SELECT * FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#33' AND t.p_size IN (8, 14, 19, 22, 28, 44, 45, 47) AND t.p_type NOT LIKE 'SMALL BRUSHED%') AS t0 LEFT JOIN (SELECT s_suppkey, TRUE AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') AS t2 ON t0.ps_suppkey0 = t2.s_suppkey WHERE t2.f1 IS NOT TRUE GROUP BY t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey) AS t5 GROUP BY t5.p_brand, t5.p_type, t5.p_size ORDER BY COUNT(t5.ps_suppkey) DESC, t5.p_brand, t5.p_type, t5.p_size;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
383,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 49 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 49 AND p_type LIKE '%COPPER') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
384,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 28 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 28 AND p_type LIKE '%STEEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
385,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 1 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 1 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
386,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-30' and l_shipdate > date '1995-03-30' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t775.l_orderkey, SUM(t775.l_extendedprice * (1 - t775.l_discount)) AS revenue, t774.o_orderdate, t774.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'BUILDING') AS t772, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-30') AS t773 WHERE t772.c_custkey = t773.o_custkey) AS t774, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-30') AS t775 WHERE t775.l_orderkey = t774.o_orderkey GROUP BY t775.l_orderkey, t774.o_orderdate, t774.o_shippriority ORDER BY SUM(t775.l_extendedprice * (1 - t775.l_discount)) DESC, t774.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
387,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'BRAZIL' and n2.n_name = 'CANADA') or (n1.n_name = 'CANADA' and n2.n_name = 'BRAZIL') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation201.n_name AS supp_nation, nation202.n_name AS cust_nation, EXTRACT(YEAR FROM t638.l_shipdate) AS l_year, SUM(t638.l_extendedprice * (1 - t638.l_discount)) AS revenue FROM supplier AS supplier100 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t638 ON supplier100.s_suppkey = t638.l_suppkey INNER JOIN orders AS orders100 ON t638.l_orderkey = orders100.o_orderkey INNER JOIN customer AS customer100 ON orders100.o_custkey = customer100.c_custkey INNER JOIN nation AS nation201 ON supplier100.s_nationkey = nation201.n_nationkey INNER JOIN nation AS nation202 ON customer100.c_nationkey = nation202.n_nationkey AND (nation201.n_name = 'BRAZIL' AND nation202.n_name = 'CANADA' OR nation201.n_name = 'CANADA' AND nation202.n_name = 'BRAZIL') GROUP BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate) ORDER BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
388,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'CANADA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED STEEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
389,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '38', '25', '32', '29', '42', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '38', '25', '32', '29', '42', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
390,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 24 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 24 AND p_type LIKE '%STEEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
391,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE ANODIZED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
392,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%magenta%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation99.n_name AS nation, EXTRACT(YEAR FROM orders99.o_orderdate) AS o_year, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount) - partsupp99.ps_supplycost * lineitem99.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%magenta%') AS t583 CROSS JOIN supplier AS supplier99 INNER JOIN lineitem AS lineitem99 ON supplier99.s_suppkey = lineitem99.l_suppkey AND t583.p_partkey = lineitem99.l_partkey INNER JOIN partsupp AS partsupp99 ON lineitem99.l_suppkey = partsupp99.ps_suppkey AND lineitem99.l_partkey = partsupp99.ps_partkey INNER JOIN orders AS orders99 ON lineitem99.l_orderkey = orders99.o_orderkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey GROUP BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) ORDER BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
393,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '24', '23', '28', '39', '43', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '24', '23', '28', '39', '43', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '25'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '25')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
394,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 19 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 19 AND p_type LIKE '%BRASS') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
395,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-10-01' and o_orderdate < date '1997-10-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1997-10-01' AND o_orderdate < (DATE '1997-10-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
396,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(7)) = 'GERMANY' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED STEEL') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
397,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '42', '34', '29', '36', '44', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '42', '34', '29', '36', '44', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
398,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 39 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 39 AND p_type LIKE '%TIN') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
399,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-11' and l_shipdate > date '1995-03-11' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t800.l_orderkey, SUM(t800.l_extendedprice * (1 - t800.l_discount)) AS revenue, t799.o_orderdate, t799.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t797, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-11') AS t798 WHERE t797.c_custkey = t798.o_custkey) AS t799, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-11') AS t800 WHERE t800.l_orderkey = t799.o_orderkey GROUP BY t800.l_orderkey, t799.o_orderdate, t799.o_shippriority ORDER BY SUM(t800.l_extendedprice * (1 - t800.l_discount)) DESC, t799.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
400,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(10)) = 'MOZAMBIQUE' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM ANODIZED COPPER') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
401,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '21', '30', '34', '25', '37', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '21', '30', '34', '25', '37', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
402,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 7 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 7 AND p_type LIKE '%COPPER') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
403,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ARGENTINA' and n2.n_name = 'FRANCE') or (n1.n_name = 'FRANCE' and n2.n_name = 'ARGENTINA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation207.n_name AS supp_nation, nation208.n_name AS cust_nation, EXTRACT(YEAR FROM t665.l_shipdate) AS l_year, SUM(t665.l_extendedprice * (1 - t665.l_discount)) AS revenue FROM supplier AS supplier103 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t665 ON supplier103.s_suppkey = t665.l_suppkey INNER JOIN orders AS orders103 ON t665.l_orderkey = orders103.o_orderkey INNER JOIN customer AS customer103 ON orders103.o_custkey = customer103.c_custkey INNER JOIN nation AS nation207 ON supplier103.s_nationkey = nation207.n_nationkey INNER JOIN nation AS nation208 ON customer103.c_nationkey = nation208.n_nationkey AND (nation207.n_name = 'ARGENTINA' AND nation208.n_name = 'FRANCE' OR nation207.n_name = 'FRANCE' AND nation208.n_name = 'ARGENTINA') GROUP BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate) ORDER BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
404,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(6)) = 'FRANCE' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL BRUSHED TIN') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
405,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('TRUCK', 'AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders INNER JOIN (SELECT * FROM lineitem WHERE l_shipmode IN ('AIR', 'TRUCK') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1993-01-01' AND l_receiptdate < (DATE '1993-01-01' + INTERVAL '1' YEAR)) AS t ON orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]"
406,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '28', '38', '37', '21', '31', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '28', '38', '37', '21', '31', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
407,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 31 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 31 AND p_type LIKE '%BRASS') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
408,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(5)) = 'EGYPT' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED COPPER') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
409,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '38', '36', '33', '21', '23', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '38', '36', '33', '21', '23', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '26'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '26')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
410,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 10 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 10 AND p_type LIKE '%NICKEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
411,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-28' and l_shipdate > date '1995-03-28' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t775.l_orderkey, SUM(t775.l_extendedprice * (1 - t775.l_discount)) AS revenue, t774.o_orderdate, t774.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'FURNITURE') AS t772, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-28') AS t773 WHERE t772.c_custkey = t773.o_custkey) AS t774, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-28') AS t775 WHERE t775.l_orderkey = t774.o_orderkey GROUP BY t775.l_orderkey, t774.o_orderdate, t774.o_shippriority ORDER BY SUM(t775.l_extendedprice * (1 - t775.l_discount)) DESC, t774.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
412,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ALGERIA' and n2.n_name = 'CANADA') or (n1.n_name = 'CANADA' and n2.n_name = 'ALGERIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'ALGERIA' AND nation0.n_name = 'CANADA' OR nation.n_name = 'CANADA' AND nation0.n_name = 'ALGERIA') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
413,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('41', '44', '34', '25', '40', '22', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('41', '44', '34', '25', '40', '22', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
414,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 4 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 4 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
415,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('38', '24', '34', '30', '26', '22', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('38', '24', '34', '30', '26', '22', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '36'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '36')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
416,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 2 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t315.s_acctbal, t315.s_name, t315.n_name, t315.p_partkey, t315.p_mfgr, t315.s_address, t315.s_phone, t315.s_comment FROM (SELECT t304.p_partkey, t304.p_name, t304.p_mfgr, t304.p_brand, t304.p_type, t304.p_size, t304.p_container, t304.p_retailprice, t304.p_comment, supplier41.s_suppkey, supplier41.s_name, supplier41.s_address, supplier41.s_nationkey, supplier41.s_phone, supplier41.s_acctbal, supplier41.s_comment, partsupp41.ps_partkey, partsupp41.ps_suppkey, partsupp41.ps_availqty, partsupp41.ps_supplycost, partsupp41.ps_comment, nation41.n_nationkey, nation41.n_name, nation41.n_regionkey, nation41.n_comment, t305.r_regionkey, t305.r_name, t305.r_comment, CAST(t313.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t313.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 2 AND p_type LIKE '%TIN') AS t304 CROSS JOIN supplier AS supplier41 INNER JOIN partsupp AS partsupp41 ON t304.p_partkey = partsupp41.ps_partkey AND supplier41.s_suppkey = partsupp41.ps_suppkey INNER JOIN nation AS nation41 ON supplier41.s_nationkey = nation41.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t305 ON nation41.n_regionkey = t305.r_regionkey INNER JOIN (SELECT t310.ps_partkey, MIN(t310.EXPR0) AS EXPR0 FROM (SELECT t308.ps_partkey, t309.n_regionkey, MIN(t308.EXPR0) AS EXPR0 FROM (SELECT t306.ps_partkey, t307.s_nationkey, MIN(t306.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t306 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t307 ON t306.ps_suppkey = t307.s_suppkey GROUP BY t306.ps_partkey, t307.s_nationkey) AS t308 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t309 ON t308.s_nationkey = t309.n_nationkey GROUP BY t308.ps_partkey, t309.n_regionkey) AS t310 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t312 ON t310.n_regionkey = t312.r_regionkey GROUP BY t310.ps_partkey) AS t313 ON t304.p_partkey = t313.ps_partkey AND partsupp41.ps_supplycost = t313.EXPR0 ORDER BY supplier41.s_acctbal DESC, nation41.n_name, supplier41.s_name, t304.p_partkey) AS t315",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
417,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(4)) = 'PERU' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED TIN') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
418,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'CHINA' group by s_name order by numwait desc, s_name;","SELECT t16.s_name, COUNT(*) AS numwait FROM (SELECT supplier3.s_suppkey, supplier3.s_name, supplier3.s_address, supplier3.s_nationkey, supplier3.s_phone, supplier3.s_acctbal, supplier3.s_comment, lineitem6.l_orderkey, lineitem6.l_partkey, lineitem6.l_suppkey, lineitem6.l_linenumber, lineitem6.l_quantity, lineitem6.l_extendedprice, lineitem6.l_discount, lineitem6.l_tax, lineitem6.l_returnflag, lineitem6.l_linestatus, lineitem6.l_shipdate, lineitem6.l_commitdate, lineitem6.l_receiptdate, lineitem6.l_shipinstruct, lineitem6.l_shipmode, lineitem6.l_comment, orders3.o_orderkey, orders3.o_custkey, orders3.o_orderstatus, orders3.o_totalprice, orders3.o_orderdate, orders3.o_orderpriority, orders3.o_clerk, orders3.o_shippriority, orders3.o_comment, nation3.n_nationkey, nation3.n_name, nation3.n_regionkey, nation3.n_comment, t14.f0 FROM supplier AS supplier3 CROSS JOIN lineitem AS lineitem6 CROSS JOIN orders AS orders3 CROSS JOIN nation AS nation3 LEFT JOIN (SELECT t13.l_orderkey AS l_orderkey0, t13.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem7 INNER JOIN (SELECT lineitem8.l_orderkey, lineitem8.l_suppkey FROM supplier AS supplier4, lineitem AS lineitem8, orders AS orders4, nation AS nation4) AS t13 ON lineitem7.l_orderkey = t13.l_orderkey AND lineitem7.l_suppkey <> t13.l_suppkey) AS t14 ON lineitem6.l_orderkey = t14.l_orderkey0 AND lineitem6.l_suppkey = t14.l_suppkey0 WHERE supplier3.s_suppkey = lineitem6.l_suppkey AND (orders3.o_orderkey = lineitem6.l_orderkey AND orders3.o_orderstatus = 'F') AND (lineitem6.l_receiptdate > lineitem6.l_commitdate AND supplier3.s_nationkey = nation3.n_nationkey AND (nation3.n_name = 'CHINA' AND t14.f0 IS NOT NULL))) AS t16 LEFT JOIN (SELECT t22.l_orderkey AS l_orderkey0, t22.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t17 INNER JOIN (SELECT lineitem10.l_orderkey, lineitem10.l_suppkey FROM supplier AS supplier5 CROSS JOIN lineitem AS lineitem10 CROSS JOIN orders AS orders5 CROSS JOIN nation AS nation5 LEFT JOIN (SELECT t18.l_orderkey AS l_orderkey0, t18.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem11 INNER JOIN (SELECT lineitem12.l_orderkey, lineitem12.l_suppkey FROM supplier AS supplier6, lineitem AS lineitem12, orders AS orders6, nation AS nation6) AS t18 ON lineitem11.l_orderkey = t18.l_orderkey AND lineitem11.l_suppkey <> t18.l_suppkey) AS t19 ON lineitem10.l_orderkey = t19.l_orderkey0 AND lineitem10.l_suppkey = t19.l_suppkey0 WHERE supplier5.s_suppkey = lineitem10.l_suppkey AND (orders5.o_orderkey = lineitem10.l_orderkey AND orders5.o_orderstatus = 'F') AND (lineitem10.l_receiptdate > lineitem10.l_commitdate AND supplier5.s_nationkey = nation5.n_nationkey AND (nation5.n_name = 'CHINA' AND t19.f0 IS NOT NULL))) AS t22 ON t17.l_orderkey = t22.l_orderkey AND t17.l_suppkey <> t22.l_suppkey) AS t23 ON t16.l_orderkey = t23.l_orderkey0 AND t16.l_suppkey = t23.l_suppkey0 WHERE t23.f0 IS NULL GROUP BY t16.s_name ORDER BY COUNT(*) DESC, t16.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
419,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '38', '30', '25', '31', '37', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '38', '30', '25', '31', '37', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
420,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(4)) = 'IRAN' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BURNISHED STEEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
421,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '22', '32', '24', '34', '35', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '22', '32', '24', '34', '35', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
422,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 29 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 29 AND p_type LIKE '%COPPER') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
423,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED TIN') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
424,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '22', '36', '38', '28', '32', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '22', '36', '38', '28', '32', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '37'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '37')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
425,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 36 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 36 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
426,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BRUSHED NICKEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
427,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '23', '20', '32', '40', '39', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '23', '20', '32', '40', '39', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
428,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 33 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 33 AND p_type LIKE '%TIN') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
429,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-25' and l_shipdate > date '1995-03-25' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t789.l_orderkey, SUM(t789.l_extendedprice * (1 - t789.l_discount)) AS revenue, t788.o_orderdate, t788.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'BUILDING') AS t786, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-25') AS t787 WHERE t786.c_custkey = t787.o_custkey) AS t788, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-25') AS t789 WHERE t789.l_orderkey = t788.o_orderkey GROUP BY t789.l_orderkey, t788.o_orderdate, t788.o_shippriority ORDER BY SUM(t789.l_extendedprice * (1 - t789.l_discount)) DESC, t788.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
430,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'CHINA' and n2.n_name = 'ROMANIA') or (n1.n_name = 'ROMANIA' and n2.n_name = 'CHINA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation203.n_name AS supp_nation, nation204.n_name AS cust_nation, EXTRACT(YEAR FROM t647.l_shipdate) AS l_year, SUM(t647.l_extendedprice * (1 - t647.l_discount)) AS revenue FROM supplier AS supplier101 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t647 ON supplier101.s_suppkey = t647.l_suppkey INNER JOIN orders AS orders101 ON t647.l_orderkey = orders101.o_orderkey INNER JOIN customer AS customer101 ON orders101.o_custkey = customer101.c_custkey INNER JOIN nation AS nation203 ON supplier101.s_nationkey = nation203.n_nationkey INNER JOIN nation AS nation204 ON customer101.c_nationkey = nation204.n_nationkey AND (nation203.n_name = 'CHINA' AND nation204.n_name = 'ROMANIA' OR nation203.n_name = 'ROMANIA' AND nation204.n_name = 'CHINA') GROUP BY nation203.n_name, nation204.n_name, EXTRACT(YEAR FROM t647.l_shipdate) ORDER BY nation203.n_name, nation204.n_name, EXTRACT(YEAR FROM t647.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
431,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM PLATED STEEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
432,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '43', '25', '22', '38', '42', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '43', '25', '22', '38', '42', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
433,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 4 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 4 AND p_type LIKE '%BRASS') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
434,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-11' and l_shipdate > date '1995-03-11' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t789.l_orderkey, SUM(t789.l_extendedprice * (1 - t789.l_discount)) AS revenue, t788.o_orderdate, t788.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'HOUSEHOLD') AS t786, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-11') AS t787 WHERE t786.c_custkey = t787.o_custkey) AS t788, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-11') AS t789 WHERE t789.l_orderkey = t788.o_orderkey GROUP BY t789.l_orderkey, t788.o_orderdate, t788.o_shippriority ORDER BY SUM(t789.l_extendedprice * (1 - t789.l_discount)) DESC, t788.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
435,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-09-01' and o_orderdate < date '1994-09-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-09-01' AND o_orderdate < (DATE '1994-09-01' + INTERVAL '3' MONTH)) AS t, (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 WHERE t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
436,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY') or (n1.n_name = 'GERMANY' and n2.n_name = 'FRANCE') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation201.n_name AS supp_nation, nation202.n_name AS cust_nation, EXTRACT(YEAR FROM t638.l_shipdate) AS l_year, SUM(t638.l_extendedprice * (1 - t638.l_discount)) AS revenue FROM supplier AS supplier100 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t638 ON supplier100.s_suppkey = t638.l_suppkey INNER JOIN orders AS orders100 ON t638.l_orderkey = orders100.o_orderkey INNER JOIN customer AS customer100 ON orders100.o_custkey = customer100.c_custkey INNER JOIN nation AS nation201 ON supplier100.s_nationkey = nation201.n_nationkey INNER JOIN nation AS nation202 ON customer100.c_nationkey = nation202.n_nationkey AND (nation201.n_name = 'FRANCE' AND nation202.n_name = 'GERMANY' OR nation201.n_name = 'GERMANY' AND nation202.n_name = 'FRANCE') GROUP BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate) ORDER BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
437,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(7)) = 'GERMANY' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM ANODIZED TIN') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
438,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '42', '29', '39', '31', '38', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '42', '29', '39', '31', '38', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
439,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 3 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 3 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
440,tpch,"select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(13)) = 'UNITED STATES' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM PLATED NICKEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
441,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '27', '21', '43', '20', '31', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '27', '21', '43', '20', '31', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '37'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '37')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
442,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 42 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 42 AND p_type LIKE '%TIN') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
443,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '25', '34', '41', '27', '22', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '25', '34', '41', '27', '22', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
444,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 27 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 27 AND p_type LIKE '%BRASS') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
445,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE POLISHED NICKEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
446,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '34', '23', '26', '35', '43', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '34', '23', '26', '35', '43', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
447,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 33 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 33 AND p_type LIKE '%BRASS') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
448,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-15' and l_shipdate > date '1995-03-15' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t168.l_orderkey, SUM(t168.l_extendedprice * (1 - t168.l_discount)) AS revenue, t167.o_orderdate, t167.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'FURNITURE') AS t166 INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-15') AS t167 ON t166.c_custkey = t167.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-15') AS t168 ON t167.o_orderkey = t168.l_orderkey GROUP BY t168.l_orderkey, t167.o_orderdate, t167.o_shippriority ORDER BY SUM(t168.l_extendedprice * (1 - t168.l_discount)) DESC, t167.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
449,tpch,"select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'MOROCCO' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL ANODIZED NICKEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
450,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%coral%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation100.n_name AS nation, EXTRACT(YEAR FROM orders100.o_orderdate) AS o_year, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount) - partsupp100.ps_supplycost * lineitem100.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%coral%') AS t591 CROSS JOIN supplier AS supplier100 INNER JOIN lineitem AS lineitem100 ON supplier100.s_suppkey = lineitem100.l_suppkey AND t591.p_partkey = lineitem100.l_partkey INNER JOIN partsupp AS partsupp100 ON lineitem100.l_suppkey = partsupp100.ps_suppkey AND lineitem100.l_partkey = partsupp100.ps_partkey INNER JOIN orders AS orders100 ON lineitem100.l_orderkey = orders100.o_orderkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey GROUP BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) ORDER BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
451,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '24', '30', '38', '32', '37', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '24', '30', '38', '32', '37', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
452,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 14 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 14 AND p_type LIKE '%BRASS') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
453,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-09' and l_shipdate > date '1995-03-09' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t168.l_orderkey, SUM(t168.l_extendedprice * (1 - t168.l_discount)) AS revenue, t167.o_orderdate, t167.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t166 INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-09') AS t167 ON t166.c_custkey = t167.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-09') AS t168 ON t167.o_orderkey = t168.l_orderkey GROUP BY t168.l_orderkey, t167.o_orderdate, t167.o_shippriority ORDER BY SUM(t168.l_extendedprice * (1 - t168.l_discount)) DESC, t167.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
454,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(7)) = 'GERMANY' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED COPPER') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
455,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('SHIP', 'FOB') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1996-01-01' and l_receiptdate < date '1996-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders INNER JOIN (SELECT * FROM lineitem WHERE l_shipmode IN ('FOB', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1996-01-01' AND l_receiptdate < (DATE '1996-01-01' + INTERVAL '1' YEAR)) AS t ON orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]"
456,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '24', '38', '33', '42', '31', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '24', '38', '33', '42', '31', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '37'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '37')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
457,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 35 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 35 AND p_type LIKE '%COPPER') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
458,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t5.o_orderdate) AS o_year, SUM(CASE WHEN t5.n_name0 = 'ROMANIA' THEN t5.l_extendedprice * (1 - t5.l_discount) ELSE 0 END) / SUM(t5.l_extendedprice * (1 - t5.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM PLATED NICKEL') AS t, supplier, lineitem WHERE t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey) AS t0, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t1 WHERE t0.l_orderkey = t1.o_orderkey) AS t2, customer WHERE t2.o_custkey = customer.c_custkey) AS t3, nation WHERE t3.c_nationkey = nation.n_nationkey) AS t4, nation AS nation0 WHERE t4.s_nationkey = nation0.n_nationkey) AS t5, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t6 WHERE t5.n_regionkey = t6.r_regionkey GROUP BY EXTRACT(YEAR FROM t5.o_orderdate) ORDER BY EXTRACT(YEAR FROM t5.o_orderdate);",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
459,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '24', '41', '21', '36', '28', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '24', '41', '21', '36', '28', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '22'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '22')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
460,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 6 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 6 AND p_type LIKE '%COPPER') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
461,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 6 and l_quantity <= 6 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 27 and l_quantity <= 27 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );",SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#13' AND ((part.p_container = 'SM CASE' OR part.p_container = 'SM BOX' OR part.p_container = 'SM PACK' OR part.p_container = 'SM PKG') AND lineitem.l_quantity >= 6) AND (lineitem.l_quantity <= 6 + 10 AND part.p_size >= 1 AND (part.p_size <= 5 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#13' AND ((part.p_container = 'MED BAG' OR part.p_container = 'MED BOX' OR part.p_container = 'MED PKG' OR part.p_container = 'MED PACK') AND lineitem.l_quantity >= 19) AND (lineitem.l_quantity <= 19 + 10 AND part.p_size >= 1 AND (part.p_size <= 10 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#32' AND ((part.p_container = 'LG CASE' OR part.p_container = 'LG BOX' OR part.p_container = 'LG PACK' OR part.p_container = 'LG PKG') AND lineitem.l_quantity >= 27) AND (lineitem.l_quantity <= 27 + 10 AND part.p_size >= 1 AND (part.p_size <= 15 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')));,['Empty List'],"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]"
462,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '35', '29', '21', '41', '39', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '35', '29', '21', '41', '39', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '42'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '42')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
463,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 26 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 26 AND p_type LIKE '%COPPER') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
464,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(5)) = 'JAPAN' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BRUSHED STEEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'ASIA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
465,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '35', '41', '33', '23', '28', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '35', '41', '33', '23', '28', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
466,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 50 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 50 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
467,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(4)) = 'IRAN' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BURNISHED BRASS') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
468,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '21', '39', '29', '43', '23', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '21', '39', '29', '43', '23', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '40'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '40')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
469,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 35 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 35 AND p_type LIKE '%TIN') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
470,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-07-01' and o_orderdate < date '1993-07-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-07-01' AND o_orderdate < (DATE '1993-07-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
471,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(10)) = 'MOZAMBIQUE' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED NICKEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
472,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '20', '41', '36', '29', '38', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '20', '41', '36', '29', '38', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '42'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '42')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
473,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 20 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 20 AND p_type LIKE '%NICKEL') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
474,tpch,"select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(4)) = 'IRAQ' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED TIN') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
475,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '38', '41', '37', '40', '28', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '38', '41', '37', '40', '28', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
476,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 23 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 23 AND p_type LIKE '%BRASS') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
477,tpch,"select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(7)) = 'MOROCCO' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD ANODIZED STEEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
478,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '42', '22', '20', '43', '25', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '42', '22', '20', '43', '25', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
479,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 27 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 27 AND p_type LIKE '%STEEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
480,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(10)) = 'MOZAMBIQUE' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
481,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '31', '25', '42', '38', '21', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '31', '25', '42', '38', '21', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
482,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '41', '23', '38', '26', '33', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '41', '23', '38', '26', '33', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
483,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 2 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 2 AND p_type LIKE '%TIN') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
484,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(6)) = 'CANADA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED TIN') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
485,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 40 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 40 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
486,tpch,"select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(12)) = 'SAUDI ARABIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BURNISHED NICKEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
487,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '41', '38', '42', '30', '21', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '41', '38', '42', '30', '21', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '33'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '33')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
488,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 13 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 13 AND p_type LIKE '%BRASS') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
489,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(6)) = 'RUSSIA' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED STEEL') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
490,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '43', '27', '22', '24', '40', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '43', '27', '22', '24', '40', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
491,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 40 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 40 AND p_type LIKE '%COPPER') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
492,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-20' and l_shipdate > date '1995-03-20' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t800.l_orderkey, SUM(t800.l_extendedprice * (1 - t800.l_discount)) AS revenue, t799.o_orderdate, t799.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t797, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-20') AS t798 WHERE t797.c_custkey = t798.o_custkey) AS t799, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-20') AS t800 WHERE t800.l_orderkey = t799.o_orderkey GROUP BY t800.l_orderkey, t799.o_orderdate, t799.o_shippriority ORDER BY SUM(t800.l_extendedprice * (1 - t800.l_discount)) DESC, t799.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
493,tpch,"select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(13)) = 'UNITED STATES' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED TIN') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
494,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 11 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 11 AND p_type LIKE '%NICKEL') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
495,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('38', '41', '21', '34', '24', '20', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('38', '41', '21', '34', '24', '20', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '36'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '36')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
496,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 8 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 8 AND p_type LIKE '%TIN') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
497,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'CANADA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED TIN') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
498,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '37', '21', '27', '42', '41', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '37', '21', '27', '42', '41', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '22'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '22')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
499,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 47 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 47 AND p_type LIKE '%NICKEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
500,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-18' and l_shipdate > date '1995-03-18' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t168.l_orderkey, SUM(t168.l_extendedprice * (1 - t168.l_discount)) AS revenue, t167.o_orderdate, t167.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'HOUSEHOLD') AS t166 INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-18') AS t167 ON t166.c_custkey = t167.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-18') AS t168 ON t167.o_orderkey = t168.l_orderkey GROUP BY t168.l_orderkey, t167.o_orderdate, t167.o_shippriority ORDER BY SUM(t168.l_extendedprice * (1 - t168.l_discount)) DESC, t167.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
501,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '34', '22', '25', '27', '23', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '34', '22', '25', '27', '23', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
502,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 37 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 37 AND p_type LIKE '%TIN') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
503,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(6)) = 'BRAZIL' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL BRUSHED BRASS') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
504,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 9 and l_quantity <= 9 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 29 and l_quantity <= 29 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#52' AND (part.p_container IN ('SM BOX', 'SM CASE', 'SM PACK', 'SM PKG') AND lineitem.l_quantity >= 9) AND (lineitem.l_quantity <= 9 + 10 AND (part.p_size >= 1 AND part.p_size <= 5) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#42' AND (part.p_container IN ('MED BAG', 'MED BOX', 'MED PACK', 'MED PKG') AND lineitem.l_quantity >= 10) AND (lineitem.l_quantity <= 10 + 10 AND (part.p_size >= 1 AND part.p_size <= 10) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#54' AND (part.p_container IN ('LG BOX', 'LG CASE', 'LG PACK', 'LG PKG') AND lineitem.l_quantity >= 29) AND (lineitem.l_quantity <= 29 + 10 AND (part.p_size >= 1 AND part.p_size <= 15) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'));",['Empty List'],"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]"
505,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '43', '36', '41', '24', '42', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '43', '36', '41', '24', '42', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
506,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 14 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 14 AND p_type LIKE '%STEEL') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
507,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(5)) = 'EGYPT' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO PLATED STEEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
508,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '33', '37', '23', '35', '41', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '33', '37', '23', '35', '41', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
509,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 22 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 22 AND p_type LIKE '%STEEL') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
510,tpch,"select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(4)) = 'IRAQ' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM ANODIZED NICKEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
511,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '22', '38', '36', '21', '41', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '22', '38', '36', '21', '41', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
512,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 44 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 44 AND p_type LIKE '%STEEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
513,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-25' and l_shipdate > date '1995-03-25' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t168.l_orderkey, SUM(t168.l_extendedprice * (1 - t168.l_discount)) AS revenue, t167.o_orderdate, t167.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t166 INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-25') AS t167 ON t166.c_custkey = t167.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-25') AS t168 ON t167.o_orderkey = t168.l_orderkey GROUP BY t168.l_orderkey, t167.o_orderdate, t167.o_shippriority ORDER BY SUM(t168.l_extendedprice * (1 - t168.l_discount)) DESC, t167.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
514,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%linen%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation99.n_name AS nation, EXTRACT(YEAR FROM orders99.o_orderdate) AS o_year, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount) - partsupp99.ps_supplycost * lineitem99.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%linen%') AS t583 CROSS JOIN supplier AS supplier99 INNER JOIN lineitem AS lineitem99 ON supplier99.s_suppkey = lineitem99.l_suppkey AND t583.p_partkey = lineitem99.l_partkey INNER JOIN partsupp AS partsupp99 ON lineitem99.l_suppkey = partsupp99.ps_suppkey AND lineitem99.l_partkey = partsupp99.ps_partkey INNER JOIN orders AS orders99 ON lineitem99.l_orderkey = orders99.o_orderkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey GROUP BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) ORDER BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
515,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '33', '25', '24', '43', '32', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '33', '25', '24', '43', '32', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
516,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 21 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 21 AND p_type LIKE '%NICKEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
517,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(7)) = 'GERMANY' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED NICKEL') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
518,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%brown%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation101.n_name AS nation, EXTRACT(YEAR FROM orders101.o_orderdate) AS o_year, SUM(lineitem101.l_extendedprice * (1 - lineitem101.l_discount) - partsupp101.ps_supplycost * lineitem101.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%brown%') AS t599 CROSS JOIN supplier AS supplier101 INNER JOIN lineitem AS lineitem101 ON supplier101.s_suppkey = lineitem101.l_suppkey AND t599.p_partkey = lineitem101.l_partkey INNER JOIN partsupp AS partsupp101 ON lineitem101.l_suppkey = partsupp101.ps_suppkey AND lineitem101.l_partkey = partsupp101.ps_partkey INNER JOIN orders AS orders101 ON lineitem101.l_orderkey = orders101.o_orderkey INNER JOIN nation AS nation101 ON supplier101.s_nationkey = nation101.n_nationkey GROUP BY nation101.n_name, EXTRACT(YEAR FROM orders101.o_orderdate) ORDER BY nation101.n_name, EXTRACT(YEAR FROM orders101.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
519,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '23', '27', '28', '20', '31', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '23', '27', '28', '20', '31', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '40'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '40')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
520,tpch,"select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(13)) = 'UNITED STATES' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM PLATED COPPER') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
521,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '23', '34', '44', '21', '24', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '23', '34', '44', '21', '24', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '26'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '26')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
522,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 15 AND p_type LIKE '%NICKEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
523,tpch,"select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(5)) = 'CHINA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BURNISHED NICKEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
524,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '33', '43', '38', '37', '36', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '33', '43', '38', '37', '36', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '22'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '22')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
525,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 30 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 30 AND p_type LIKE '%COPPER') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
526,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(5)) = 'JAPAN' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE ANODIZED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'ASIA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
527,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '23', '30', '22', '29', '27', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '23', '30', '22', '29', '27', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '42'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '42')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
528,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 15 AND p_type LIKE '%NICKEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
529,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-10' and l_shipdate > date '1995-03-10' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t168.l_orderkey, SUM(t168.l_extendedprice * (1 - t168.l_discount)) AS revenue, t167.o_orderdate, t167.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'FURNITURE') AS t166 INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-10') AS t167 ON t166.c_custkey = t167.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-10') AS t168 ON t167.o_orderkey = t168.l_orderkey GROUP BY t168.l_orderkey, t167.o_orderdate, t167.o_shippriority ORDER BY SUM(t168.l_extendedprice * (1 - t168.l_discount)) DESC, t167.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
530,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'GERMANY' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED NICKEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
531,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '29', '30', '32', '40', '38', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '29', '30', '32', '40', '38', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
532,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 42 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 42 AND p_type LIKE '%NICKEL') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
533,tpch,"select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(13)) = 'UNITED STATES' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL POLISHED NICKEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
534,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#14' and p_type not like 'MEDIUM BRUSHED%' and p_size in (45, 2, 38, 35, 43, 12, 19, 28) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t3.p_brand, t3.p_type, t3.p_size, COUNT(t3.ps_suppkey) AS supplier_cnt FROM (SELECT t.ps_suppkey, t.p_brand, t.p_type, t.p_size FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t LEFT JOIN (SELECT s_suppkey, TRUE AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') AS t1 ON t.ps_suppkey0 = t1.s_suppkey WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#14' AND t.p_size IN (2, 12, 19, 28, 35, 38, 43, 45) AND t1.f1 IS NOT TRUE AND t.p_type NOT LIKE 'MEDIUM BRUSHED%' GROUP BY t.ps_suppkey, t.p_brand, t.p_type, t.p_size) AS t3 GROUP BY t3.p_brand, t3.p_type, t3.p_size ORDER BY COUNT(t3.ps_suppkey) DESC, t3.p_brand, t3.p_type, t3.p_size;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
535,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 21 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 21 AND p_type LIKE '%COPPER') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
536,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('AIR', 'REG AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1994-01-01' and l_receiptdate < date '1994-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders INNER JOIN (SELECT * FROM lineitem WHERE l_shipmode IN ('AIR', 'REG AIR') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1994-01-01' AND l_receiptdate < (DATE '1994-01-01' + INTERVAL '1' YEAR)) AS t ON orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]"
537,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '41', '22', '37', '39', '35', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '41', '22', '37', '39', '35', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
538,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 23 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t315.s_acctbal, t315.s_name, t315.n_name, t315.p_partkey, t315.p_mfgr, t315.s_address, t315.s_phone, t315.s_comment FROM (SELECT t304.p_partkey, t304.p_name, t304.p_mfgr, t304.p_brand, t304.p_type, t304.p_size, t304.p_container, t304.p_retailprice, t304.p_comment, supplier41.s_suppkey, supplier41.s_name, supplier41.s_address, supplier41.s_nationkey, supplier41.s_phone, supplier41.s_acctbal, supplier41.s_comment, partsupp41.ps_partkey, partsupp41.ps_suppkey, partsupp41.ps_availqty, partsupp41.ps_supplycost, partsupp41.ps_comment, nation41.n_nationkey, nation41.n_name, nation41.n_regionkey, nation41.n_comment, t305.r_regionkey, t305.r_name, t305.r_comment, CAST(t313.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t313.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 23 AND p_type LIKE '%TIN') AS t304 CROSS JOIN supplier AS supplier41 INNER JOIN partsupp AS partsupp41 ON t304.p_partkey = partsupp41.ps_partkey AND supplier41.s_suppkey = partsupp41.ps_suppkey INNER JOIN nation AS nation41 ON supplier41.s_nationkey = nation41.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t305 ON nation41.n_regionkey = t305.r_regionkey INNER JOIN (SELECT t310.ps_partkey, MIN(t310.EXPR0) AS EXPR0 FROM (SELECT t308.ps_partkey, t309.n_regionkey, MIN(t308.EXPR0) AS EXPR0 FROM (SELECT t306.ps_partkey, t307.s_nationkey, MIN(t306.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t306 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t307 ON t306.ps_suppkey = t307.s_suppkey GROUP BY t306.ps_partkey, t307.s_nationkey) AS t308 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t309 ON t308.s_nationkey = t309.n_nationkey GROUP BY t308.ps_partkey, t309.n_regionkey) AS t310 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t312 ON t310.n_regionkey = t312.r_regionkey GROUP BY t310.ps_partkey) AS t313 ON t304.p_partkey = t313.ps_partkey AND partsupp41.ps_supplycost = t313.EXPR0 ORDER BY supplier41.s_acctbal DESC, nation41.n_name, supplier41.s_name, t304.p_partkey) AS t315",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
539,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(5)) = 'JAPAN' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BURNISHED COPPER') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'ASIA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
540,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '25', '41', '35', '37', '28', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '25', '41', '35', '37', '28', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
541,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 46 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 46 AND p_type LIKE '%BRASS') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
542,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(4)) = 'IRAN' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL POLISHED STEEL') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
543,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%firebrick%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation103.n_name AS nation, EXTRACT(YEAR FROM orders103.o_orderdate) AS o_year, SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount) - partsupp103.ps_supplycost * lineitem103.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%firebrick%') AS t615 CROSS JOIN supplier AS supplier103 INNER JOIN lineitem AS lineitem103 ON supplier103.s_suppkey = lineitem103.l_suppkey AND t615.p_partkey = lineitem103.l_partkey INNER JOIN partsupp AS partsupp103 ON lineitem103.l_suppkey = partsupp103.ps_suppkey AND lineitem103.l_partkey = partsupp103.ps_partkey INNER JOIN orders AS orders103 ON lineitem103.l_orderkey = orders103.o_orderkey INNER JOIN nation AS nation103 ON supplier103.s_nationkey = nation103.n_nationkey GROUP BY nation103.n_name, EXTRACT(YEAR FROM orders103.o_orderdate) ORDER BY nation103.n_name, EXTRACT(YEAR FROM orders103.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
544,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 20 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 20 AND p_type LIKE '%TIN') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
545,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(5)) = 'INDIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'ASIA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
546,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 25 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 25 AND p_type LIKE '%TIN') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
547,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'VIETNAM' and n2.n_name = 'ALGERIA') or (n1.n_name = 'ALGERIA' and n2.n_name = 'VIETNAM') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation201.n_name AS supp_nation, nation202.n_name AS cust_nation, EXTRACT(YEAR FROM t638.l_shipdate) AS l_year, SUM(t638.l_extendedprice * (1 - t638.l_discount)) AS revenue FROM supplier AS supplier100 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t638 ON supplier100.s_suppkey = t638.l_suppkey INNER JOIN orders AS orders100 ON t638.l_orderkey = orders100.o_orderkey INNER JOIN customer AS customer100 ON orders100.o_custkey = customer100.c_custkey INNER JOIN nation AS nation201 ON supplier100.s_nationkey = nation201.n_nationkey INNER JOIN nation AS nation202 ON customer100.c_nationkey = nation202.n_nationkey AND (nation201.n_name = 'VIETNAM' AND nation202.n_name = 'ALGERIA' OR nation201.n_name = 'ALGERIA' AND nation202.n_name = 'VIETNAM') GROUP BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate) ORDER BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
548,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'ALGERIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO POLISHED NICKEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
549,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%tomato%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation103.n_name AS nation, EXTRACT(YEAR FROM orders103.o_orderdate) AS o_year, SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount) - partsupp103.ps_supplycost * lineitem103.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%tomato%') AS t615 CROSS JOIN supplier AS supplier103 INNER JOIN lineitem AS lineitem103 ON supplier103.s_suppkey = lineitem103.l_suppkey AND t615.p_partkey = lineitem103.l_partkey INNER JOIN partsupp AS partsupp103 ON lineitem103.l_suppkey = partsupp103.ps_suppkey AND lineitem103.l_partkey = partsupp103.ps_partkey INNER JOIN orders AS orders103 ON lineitem103.l_orderkey = orders103.o_orderkey INNER JOIN nation AS nation103 ON supplier103.s_nationkey = nation103.n_nationkey GROUP BY nation103.n_name, EXTRACT(YEAR FROM orders103.o_orderdate) ORDER BY nation103.n_name, EXTRACT(YEAR FROM orders103.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
550,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '26', '36', '28', '38', '43', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '26', '36', '28', '38', '43', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
551,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 42 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 42 AND p_type LIKE '%BRASS') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
552,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(8)) = 'ETHIOPIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO POLISHED COPPER') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
553,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '25', '29', '26', '21', '39', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '25', '29', '26', '21', '39', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
554,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 5 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 5 AND p_type LIKE '%BRASS') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
555,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-06' and l_shipdate > date '1995-03-06' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t793.l_orderkey, SUM(t793.l_extendedprice * (1 - t793.l_discount)) AS revenue, t792.o_orderdate, t792.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'HOUSEHOLD') AS t790, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-06') AS t791 WHERE t790.c_custkey = t791.o_custkey) AS t792, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-06') AS t793 WHERE t793.l_orderkey = t792.o_orderkey GROUP BY t793.l_orderkey, t792.o_orderdate, t792.o_shippriority ORDER BY SUM(t793.l_extendedprice * (1 - t793.l_discount)) DESC, t792.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
556,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(4)) = 'PERU' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BURNISHED TIN') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
557,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '23', '39', '21', '28', '30', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '23', '39', '21', '28', '30', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '40'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '40')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
558,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 28 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 28 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
559,tpch,"select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(7)) = 'MOROCCO' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD PLATED COPPER') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
560,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '33', '38', '41', '37', '31', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '33', '38', '41', '37', '31', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
561,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 13 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 13 AND p_type LIKE '%COPPER') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
562,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-04' and l_shipdate > date '1995-03-04' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t168.l_orderkey, SUM(t168.l_extendedprice * (1 - t168.l_discount)) AS revenue, t167.o_orderdate, t167.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'FURNITURE') AS t166 INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-04') AS t167 ON t166.c_custkey = t167.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-04') AS t168 ON t167.o_orderkey = t168.l_orderkey GROUP BY t168.l_orderkey, t167.o_orderdate, t167.o_shippriority ORDER BY SUM(t168.l_extendedprice * (1 - t168.l_discount)) DESC, t167.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
563,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(4)) = 'PERU' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BURNISHED NICKEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
564,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '25', '32', '39', '40', '36', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '25', '32', '39', '40', '36', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '33'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '33')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
565,tpch,"select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(5)) = 'CHINA' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BURNISHED BRASS') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'ASIA') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
566,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('MAIL', 'FOB') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1997-01-01' and l_receiptdate < date '1997-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, (SELECT * FROM lineitem WHERE l_shipmode IN ('FOB', 'MAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1997-01-01' AND l_receiptdate < (DATE '1997-01-01' + INTERVAL '1' YEAR)) AS t WHERE orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]"
567,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '26', '25', '34', '31', '42', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '26', '25', '34', '31', '42', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
568,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 48 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 48 AND p_type LIKE '%TIN') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
569,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-23' and l_shipdate > date '1995-03-23' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t793.l_orderkey, SUM(t793.l_extendedprice * (1 - t793.l_discount)) AS revenue, t792.o_orderdate, t792.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t790, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-23') AS t791 WHERE t790.c_custkey = t791.o_custkey) AS t792, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-23') AS t793 WHERE t793.l_orderkey = t792.o_orderkey GROUP BY t793.l_orderkey, t792.o_orderdate, t792.o_shippriority ORDER BY SUM(t793.l_extendedprice * (1 - t793.l_discount)) DESC, t792.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
570,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(6)) = 'CANADA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE PLATED BRASS') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
571,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '31', '29', '33', '32', '28', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '31', '29', '33', '32', '28', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
572,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 33 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 33 AND p_type LIKE '%BRASS') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
573,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BURNISHED BRASS') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
574,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%metallic%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation103.n_name AS nation, EXTRACT(YEAR FROM orders103.o_orderdate) AS o_year, SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount) - partsupp103.ps_supplycost * lineitem103.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%metallic%') AS t615 CROSS JOIN supplier AS supplier103 INNER JOIN lineitem AS lineitem103 ON supplier103.s_suppkey = lineitem103.l_suppkey AND t615.p_partkey = lineitem103.l_partkey INNER JOIN partsupp AS partsupp103 ON lineitem103.l_suppkey = partsupp103.ps_suppkey AND lineitem103.l_partkey = partsupp103.ps_partkey INNER JOIN orders AS orders103 ON lineitem103.l_orderkey = orders103.o_orderkey INNER JOIN nation AS nation103 ON supplier103.s_nationkey = nation103.n_nationkey GROUP BY nation103.n_name, EXTRACT(YEAR FROM orders103.o_orderdate) ORDER BY nation103.n_name, EXTRACT(YEAR FROM orders103.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
575,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '37', '29', '35', '43', '39', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '37', '29', '35', '43', '39', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '25'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '25')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
576,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 10 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 10 AND p_type LIKE '%TIN') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
577,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(7)) = 'ALGERIA' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BRUSHED STEEL') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
578,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('41', '27', '30', '38', '34', '37', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('41', '27', '30', '38', '34', '37', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
579,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 19 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 19 AND p_type LIKE '%BRASS') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
580,tpch,"select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'MOROCCO' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED COPPER') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate);",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
581,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '30', '32', '25', '26', '23', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '30', '32', '25', '26', '23', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '36'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '36')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
582,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 32 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 32 AND p_type LIKE '%STEEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
583,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BURNISHED COPPER') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
584,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '32', '36', '22', '24', '21', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '32', '36', '22', '24', '21', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
585,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 48 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 48 AND p_type LIKE '%STEEL') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
586,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(4)) = 'PERU' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD PLATED STEEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
587,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '25', '27', '28', '36', '30', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '25', '27', '28', '36', '30', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '37'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '37')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
588,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 21 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 21 AND p_type LIKE '%NICKEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
589,tpch,"select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(7)) = 'MOROCCO' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED BRASS') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
590,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%light%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation.n_name AS nation, EXTRACT(YEAR FROM t2.o_orderdate) AS o_year, SUM(t2.l_extendedprice * (1 - t2.l_discount) - t2.ps_supplycost * t2.l_quantity) AS sum_profit FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_name LIKE '%light%') AS t, supplier, lineitem WHERE supplier.s_suppkey = lineitem.l_suppkey AND t.p_partkey = lineitem.l_partkey) AS t0, partsupp WHERE partsupp.ps_suppkey = t0.l_suppkey AND partsupp.ps_partkey = t0.l_partkey) AS t1, orders WHERE orders.o_orderkey = t1.l_orderkey) AS t2, nation WHERE t2.s_nationkey = nation.n_nationkey GROUP BY nation.n_name, EXTRACT(YEAR FROM t2.o_orderdate) ORDER BY nation.n_name, EXTRACT(YEAR FROM t2.o_orderdate) DESC;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
591,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '35', '25', '24', '23', '32', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '35', '25', '24', '23', '32', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
592,tpch,"select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(4)) = 'IRAQ' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BRUSHED BRASS') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
593,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '32', '21', '44', '30', '35', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '32', '21', '44', '30', '35', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
594,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 8 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 8 AND p_type LIKE '%COPPER') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
595,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ETHIOPIA' and n2.n_name = 'IRAN') or (n1.n_name = 'IRAN' and n2.n_name = 'ETHIOPIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'ETHIOPIA' AND nation0.n_name = 'IRAN' OR nation.n_name = 'IRAN' AND nation0.n_name = 'ETHIOPIA') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
596,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(4)) = 'IRAN' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'PROMO BRUSHED BRASS') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
597,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '24', '22', '21', '33', '35', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '24', '22', '21', '33', '35', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
598,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 16 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 16 AND p_type LIKE '%STEEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
599,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(7)) = 'GERMANY' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD ANODIZED COPPER') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
600,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '32', '34', '31', '39', '44', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '32', '34', '31', '39', '44', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
601,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 50 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 50 AND p_type LIKE '%BRASS') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
602,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(9)) = 'INDONESIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED NICKEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'ASIA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
603,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%salmon%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation103.n_name AS nation, EXTRACT(YEAR FROM orders103.o_orderdate) AS o_year, SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount) - partsupp103.ps_supplycost * lineitem103.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%salmon%') AS t615 CROSS JOIN supplier AS supplier103 INNER JOIN lineitem AS lineitem103 ON supplier103.s_suppkey = lineitem103.l_suppkey AND t615.p_partkey = lineitem103.l_partkey INNER JOIN partsupp AS partsupp103 ON lineitem103.l_suppkey = partsupp103.ps_suppkey AND lineitem103.l_partkey = partsupp103.ps_partkey INNER JOIN orders AS orders103 ON lineitem103.l_orderkey = orders103.o_orderkey INNER JOIN nation AS nation103 ON supplier103.s_nationkey = nation103.n_nationkey GROUP BY nation103.n_name, EXTRACT(YEAR FROM orders103.o_orderdate) ORDER BY nation103.n_name, EXTRACT(YEAR FROM orders103.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
604,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '23', '29', '22', '42', '21', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '23', '29', '22', '42', '21', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
605,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 29 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t315.s_acctbal, t315.s_name, t315.n_name, t315.p_partkey, t315.p_mfgr, t315.s_address, t315.s_phone, t315.s_comment FROM (SELECT t304.p_partkey, t304.p_name, t304.p_mfgr, t304.p_brand, t304.p_type, t304.p_size, t304.p_container, t304.p_retailprice, t304.p_comment, supplier41.s_suppkey, supplier41.s_name, supplier41.s_address, supplier41.s_nationkey, supplier41.s_phone, supplier41.s_acctbal, supplier41.s_comment, partsupp41.ps_partkey, partsupp41.ps_suppkey, partsupp41.ps_availqty, partsupp41.ps_supplycost, partsupp41.ps_comment, nation41.n_nationkey, nation41.n_name, nation41.n_regionkey, nation41.n_comment, t305.r_regionkey, t305.r_name, t305.r_comment, CAST(t313.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t313.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 29 AND p_type LIKE '%TIN') AS t304 CROSS JOIN supplier AS supplier41 INNER JOIN partsupp AS partsupp41 ON t304.p_partkey = partsupp41.ps_partkey AND supplier41.s_suppkey = partsupp41.ps_suppkey INNER JOIN nation AS nation41 ON supplier41.s_nationkey = nation41.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t305 ON nation41.n_regionkey = t305.r_regionkey INNER JOIN (SELECT t310.ps_partkey, MIN(t310.EXPR0) AS EXPR0 FROM (SELECT t308.ps_partkey, t309.n_regionkey, MIN(t308.EXPR0) AS EXPR0 FROM (SELECT t306.ps_partkey, t307.s_nationkey, MIN(t306.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t306 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t307 ON t306.ps_suppkey = t307.s_suppkey GROUP BY t306.ps_partkey, t307.s_nationkey) AS t308 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t309 ON t308.s_nationkey = t309.n_nationkey GROUP BY t308.ps_partkey, t309.n_regionkey) AS t310 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t312 ON t310.n_regionkey = t312.r_regionkey GROUP BY t310.ps_partkey) AS t313 ON t304.p_partkey = t313.ps_partkey AND partsupp41.ps_supplycost = t313.EXPR0 ORDER BY supplier41.s_acctbal DESC, nation41.n_name, supplier41.s_name, t304.p_partkey) AS t315",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
606,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'CHINA' and n2.n_name = 'RUSSIA') or (n1.n_name = 'RUSSIA' and n2.n_name = 'CHINA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'CHINA' AND nation0.n_name = 'RUSSIA' OR nation.n_name = 'RUSSIA' AND nation0.n_name = 'CHINA') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
607,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(6)) = 'RUSSIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BURNISHED COPPER') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
608,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '24', '25', '37', '27', '32', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '24', '25', '37', '27', '32', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
609,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 43 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 43 AND p_type LIKE '%NICKEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
610,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(9)) = 'INDONESIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BRUSHED NICKEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'ASIA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
611,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '22', '36', '34', '30', '43', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '22', '36', '34', '30', '43', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
612,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 37 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 37 AND p_type LIKE '%NICKEL') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
613,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(5)) = 'INDIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD ANODIZED NICKEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
614,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%almond%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation99.n_name AS nation, EXTRACT(YEAR FROM orders99.o_orderdate) AS o_year, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount) - partsupp99.ps_supplycost * lineitem99.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%almond%') AS t583 CROSS JOIN supplier AS supplier99 INNER JOIN lineitem AS lineitem99 ON supplier99.s_suppkey = lineitem99.l_suppkey AND t583.p_partkey = lineitem99.l_partkey INNER JOIN partsupp AS partsupp99 ON lineitem99.l_suppkey = partsupp99.ps_suppkey AND lineitem99.l_partkey = partsupp99.ps_partkey INNER JOIN orders AS orders99 ON lineitem99.l_orderkey = orders99.o_orderkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey GROUP BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) ORDER BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
615,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '28', '39', '38', '36', '20', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '28', '39', '38', '36', '20', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
616,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 8 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 8 AND p_type LIKE '%STEEL') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
617,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(7)) = 'ALGERIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE POLISHED BRASS') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
618,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 8 and l_quantity <= 8 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 16 and l_quantity <= 16 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 30 and l_quantity <= 30 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );",SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#42' AND ((part.p_container = 'SM CASE' OR part.p_container = 'SM BOX' OR part.p_container = 'SM PACK' OR part.p_container = 'SM PKG') AND lineitem.l_quantity >= 8) AND (lineitem.l_quantity <= 8 + 10 AND part.p_size >= 1 AND (part.p_size <= 5 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#14' AND ((part.p_container = 'MED BAG' OR part.p_container = 'MED BOX' OR part.p_container = 'MED PKG' OR part.p_container = 'MED PACK') AND lineitem.l_quantity >= 16) AND (lineitem.l_quantity <= 16 + 10 AND part.p_size >= 1 AND (part.p_size <= 10 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#53' AND ((part.p_container = 'LG CASE' OR part.p_container = 'LG BOX' OR part.p_container = 'LG PACK' OR part.p_container = 'LG PKG') AND lineitem.l_quantity >= 30) AND (lineitem.l_quantity <= 30 + 10 AND part.p_size >= 1 AND (part.p_size <= 15 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')));,['Empty List'],"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]"
619,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '43', '34', '40', '37', '44', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '43', '34', '40', '37', '44', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
620,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 34 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 34 AND p_type LIKE '%NICKEL') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
621,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BURNISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(6)) = 'BRAZIL' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL BURNISHED STEEL') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
622,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '33', '36', '43', '27', '42', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '33', '36', '43', '27', '42', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
623,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 11 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 11 AND p_type LIKE '%COPPER') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
624,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'CANADA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED COPPER') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
625,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '23', '20', '25', '39', '41', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '23', '20', '25', '39', '41', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
626,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 31 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 31 AND p_type LIKE '%NICKEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
627,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%black%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation100.n_name AS nation, EXTRACT(YEAR FROM orders100.o_orderdate) AS o_year, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount) - partsupp100.ps_supplycost * lineitem100.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%black%') AS t591 CROSS JOIN supplier AS supplier100 INNER JOIN lineitem AS lineitem100 ON supplier100.s_suppkey = lineitem100.l_suppkey AND t591.p_partkey = lineitem100.l_partkey INNER JOIN partsupp AS partsupp100 ON lineitem100.l_suppkey = partsupp100.ps_suppkey AND lineitem100.l_partkey = partsupp100.ps_partkey INNER JOIN orders AS orders100 ON lineitem100.l_orderkey = orders100.o_orderkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey GROUP BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) ORDER BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
628,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '26', '34', '30', '28', '22', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '26', '34', '30', '28', '22', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
629,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 10 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 10 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
630,tpch,"select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(4)) = 'IRAQ' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD PLATED COPPER') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
631,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '30', '29', '44', '31', '22', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '30', '29', '44', '31', '22', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
632,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(5)) = 'JAPAN' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BURNISHED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'ASIA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
633,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '44', '30', '26', '43', '27', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '44', '30', '26', '43', '27', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
634,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 26 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 26 AND p_type LIKE '%TIN') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
635,tpch,"select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(5)) = 'CHINA' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED BRASS') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
636,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '44', '22', '30', '25', '35', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '44', '22', '30', '25', '35', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
637,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 40 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 40 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
638,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ROMANIA' and n2.n_name = 'UNITED KINGDOM') or (n1.n_name = 'UNITED KINGDOM' and n2.n_name = 'ROMANIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation201.n_name AS supp_nation, nation202.n_name AS cust_nation, EXTRACT(YEAR FROM t638.l_shipdate) AS l_year, SUM(t638.l_extendedprice * (1 - t638.l_discount)) AS revenue FROM supplier AS supplier100 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t638 ON supplier100.s_suppkey = t638.l_suppkey INNER JOIN orders AS orders100 ON t638.l_orderkey = orders100.o_orderkey INNER JOIN customer AS customer100 ON orders100.o_custkey = customer100.c_custkey INNER JOIN nation AS nation201 ON supplier100.s_nationkey = nation201.n_nationkey INNER JOIN nation AS nation202 ON customer100.c_nationkey = nation202.n_nationkey AND (nation201.n_name = 'ROMANIA' AND nation202.n_name = 'UNITED KINGDOM' OR nation201.n_name = 'UNITED KINGDOM' AND nation202.n_name = 'ROMANIA') GROUP BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate) ORDER BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
639,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BRUSHED COPPER') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
640,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '35', '41', '30', '21', '38', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '35', '41', '30', '21', '38', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '22'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '22')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
641,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 17 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 17 AND p_type LIKE '%STEEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
642,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(7)) = 'ALGERIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY POLISHED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
643,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '25', '43', '33', '26', '37', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '25', '43', '33', '26', '37', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
644,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 5 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 5 AND p_type LIKE '%STEEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
645,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'BRAZIL' and n2.n_name = 'FRANCE') or (n1.n_name = 'FRANCE' and n2.n_name = 'BRAZIL') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation207.n_name AS supp_nation, nation208.n_name AS cust_nation, EXTRACT(YEAR FROM t665.l_shipdate) AS l_year, SUM(t665.l_extendedprice * (1 - t665.l_discount)) AS revenue FROM supplier AS supplier103 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t665 ON supplier103.s_suppkey = t665.l_suppkey INNER JOIN orders AS orders103 ON t665.l_orderkey = orders103.o_orderkey INNER JOIN customer AS customer103 ON orders103.o_custkey = customer103.c_custkey INNER JOIN nation AS nation207 ON supplier103.s_nationkey = nation207.n_nationkey INNER JOIN nation AS nation208 ON customer103.c_nationkey = nation208.n_nationkey AND (nation207.n_name = 'BRAZIL' AND nation208.n_name = 'FRANCE' OR nation207.n_name = 'FRANCE' AND nation208.n_name = 'BRAZIL') GROUP BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate) ORDER BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
646,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'FRANCE' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY POLISHED TIN') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
647,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '44', '41', '39', '31', '38', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '44', '41', '39', '31', '38', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
648,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 14 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 14 AND p_type LIKE '%STEEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
649,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(7)) = 'VIETNAM' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BURNISHED STEEL') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'ASIA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
650,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '21', '39', '26', '24', '40', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '21', '39', '26', '24', '40', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
651,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 22 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 22 AND p_type LIKE '%NICKEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
652,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BURNISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(5)) = 'INDIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL BURNISHED STEEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
653,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '28', '34', '27', '32', '44', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '28', '34', '27', '32', '44', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '40'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '40')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
654,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 6 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 6 AND p_type LIKE '%TIN') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
655,tpch,"select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(5)) = 'KENYA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED COPPER') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
656,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '35', '43', '34', '41', '26', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '35', '43', '34', '41', '26', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
657,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 35 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 35 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
658,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '36', '39', '43', '26', '29', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '36', '39', '43', '26', '29', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
659,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 45 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 45 AND p_type LIKE '%STEEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
660,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'EGYPT' and n2.n_name = 'FRANCE') or (n1.n_name = 'FRANCE' and n2.n_name = 'EGYPT') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation205.n_name AS supp_nation, nation206.n_name AS cust_nation, EXTRACT(YEAR FROM t656.l_shipdate) AS l_year, SUM(t656.l_extendedprice * (1 - t656.l_discount)) AS revenue FROM supplier AS supplier102 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t656 ON supplier102.s_suppkey = t656.l_suppkey INNER JOIN orders AS orders102 ON t656.l_orderkey = orders102.o_orderkey INNER JOIN customer AS customer102 ON orders102.o_custkey = customer102.c_custkey INNER JOIN nation AS nation205 ON supplier102.s_nationkey = nation205.n_nationkey INNER JOIN nation AS nation206 ON customer102.c_nationkey = nation206.n_nationkey AND (nation205.n_name = 'EGYPT' AND nation206.n_name = 'FRANCE' OR nation205.n_name = 'FRANCE' AND nation206.n_name = 'EGYPT') GROUP BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate) ORDER BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
661,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#33' and p_type not like 'LARGE POLISHED%' and p_size in (36, 30, 40, 38, 39, 26, 7, 44) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t3.p_brand, t3.p_type, t3.p_size, COUNT(t3.ps_suppkey) AS supplier_cnt FROM (SELECT t.ps_suppkey, t.p_brand, t.p_type, t.p_size FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t LEFT JOIN (SELECT s_suppkey, TRUE AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') AS t1 ON t.ps_suppkey0 = t1.s_suppkey WHERE t.p_partkey = t.ps_partkey AND t.p_brand <> 'Brand#33' AND t.p_type NOT LIKE 'LARGE POLISHED%' AND (t.p_size = 36 OR t.p_size = 30 OR (t.p_size = 40 OR t.p_size = 38) OR (t.p_size = 39 OR t.p_size = 26 OR (t.p_size = 7 OR t.p_size = 44))) AND NOT (t1.f1 IS TRUE AND t.ps_suppkey0 IS NOT NULL) GROUP BY t.ps_suppkey, t.p_brand, t.p_type, t.p_size) AS t3 GROUP BY t3.p_brand, t3.p_type, t3.p_size ORDER BY COUNT(t3.ps_suppkey) DESC, t3.p_brand, t3.p_type, t3.p_size;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
662,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 30 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 30 AND p_type LIKE '%BRASS') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
663,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(5)) = 'INDIA' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BURNISHED STEEL') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'ASIA') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
664,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '29', '27', '43', '44', '30', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '29', '27', '43', '44', '30', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
665,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 42 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 42 AND p_type LIKE '%STEEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
666,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(10)) = 'MOZAMBIQUE' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM POLISHED STEEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
667,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 8 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 8 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
668,tpch,"select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(5)) = 'KENYA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED NICKEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
669,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '40', '36', '33', '39', '32', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '40', '36', '33', '39', '32', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '42'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '42')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
670,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 23 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 23 AND p_type LIKE '%BRASS') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
671,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BURNISHED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
672,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '34', '36', '32', '28', '42', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '34', '36', '32', '28', '42', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '22'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '22')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
673,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 44 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 44 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
674,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(6)) = 'FRANCE' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE POLISHED COPPER') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
675,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '33', '39', '24', '43', '22', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '33', '39', '24', '43', '22', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '25'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '25')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
676,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 34 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 34 AND p_type LIKE '%BRASS') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
677,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '30', '20', '22', '21', '31', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '30', '20', '22', '21', '31', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
678,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 26 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 26 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
679,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(5)) = 'EGYPT' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE POLISHED STEEL') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
680,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('41', '23', '43', '37', '22', '27', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('41', '23', '43', '37', '22', '27', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
681,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(5)) = 'INDIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED TIN') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'ASIA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
682,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 17 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 17 AND p_type LIKE '%COPPER') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
683,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'IRAN' and n2.n_name = 'KENYA') or (n1.n_name = 'KENYA' and n2.n_name = 'IRAN') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation199.n_name AS supp_nation, nation200.n_name AS cust_nation, EXTRACT(YEAR FROM t629.l_shipdate) AS l_year, SUM(t629.l_extendedprice * (1 - t629.l_discount)) AS revenue FROM supplier AS supplier99 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t629 ON supplier99.s_suppkey = t629.l_suppkey INNER JOIN orders AS orders99 ON t629.l_orderkey = orders99.o_orderkey INNER JOIN customer AS customer99 ON orders99.o_custkey = customer99.c_custkey INNER JOIN nation AS nation199 ON supplier99.s_nationkey = nation199.n_nationkey INNER JOIN nation AS nation200 ON customer99.c_nationkey = nation200.n_nationkey AND (nation199.n_name = 'IRAN' AND nation200.n_name = 'KENYA' OR nation199.n_name = 'KENYA' AND nation200.n_name = 'IRAN') GROUP BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate) ORDER BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
684,tpch,"select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(5)) = 'KENYA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED COPPER') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
685,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '22', '21', '27', '29', '25', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '22', '21', '27', '29', '25', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
686,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 38 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 38 AND p_type LIKE '%NICKEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
687,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED NICKEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
688,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '21', '25', '41', '44', '42', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '21', '25', '41', '44', '42', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
689,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 3 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 3 AND p_type LIKE '%BRASS') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
690,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-07-01' and o_orderdate < date '1997-07-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1997-07-01' AND o_orderdate < (DATE '1997-07-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, TRUE AS f0 FROM lineitem WHERE l_commitdate < l_receiptdate) AS t1 ON t.o_orderkey = t1.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
691,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(6)) = 'FRANCE' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL BURNISHED COPPER') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
692,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '37', '22', '40', '33', '25', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '37', '22', '40', '33', '25', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
693,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 49 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT supplier.s_acctbal, supplier.s_name, nation.n_name, t.p_partkey, t.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment FROM (SELECT * FROM part WHERE p_size = 49 AND p_type LIKE '%STEEL') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT t5.ps_partkey, MIN(t5.EXPR0) AS EXPR0 FROM (SELECT t3.ps_partkey, t4.n_regionkey, MIN(t3.EXPR0) AS EXPR0 FROM (SELECT t1.ps_partkey, t2.s_nationkey, MIN(t1.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t2 ON t1.ps_suppkey = t2.s_suppkey GROUP BY t1.ps_partkey, t2.s_nationkey) AS t3 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t4 ON t3.s_nationkey = t4.n_nationkey GROUP BY t3.ps_partkey, t4.n_regionkey) AS t5 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t7 ON t5.n_regionkey = t7.r_regionkey GROUP BY t5.ps_partkey) AS t8 ON t.p_partkey = t8.ps_partkey AND partsupp.ps_supplycost = t8.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey;",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
694,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '21', '34', '36', '41', '22', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '21', '34', '36', '41', '22', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
695,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 22 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 22 AND p_type LIKE '%TIN') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
696,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BRUSHED STEEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
697,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '31', '32', '33', '29', '36', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '31', '32', '33', '29', '36', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
698,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 19 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 19 AND p_type LIKE '%TIN') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
699,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'BRAZIL' and n2.n_name = 'EGYPT') or (n1.n_name = 'EGYPT' and n2.n_name = 'BRAZIL') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation201.n_name AS supp_nation, nation202.n_name AS cust_nation, EXTRACT(YEAR FROM t638.l_shipdate) AS l_year, SUM(t638.l_extendedprice * (1 - t638.l_discount)) AS revenue FROM supplier AS supplier100 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t638 ON supplier100.s_suppkey = t638.l_suppkey INNER JOIN orders AS orders100 ON t638.l_orderkey = orders100.o_orderkey INNER JOIN customer AS customer100 ON orders100.o_custkey = customer100.c_custkey INNER JOIN nation AS nation201 ON supplier100.s_nationkey = nation201.n_nationkey INNER JOIN nation AS nation202 ON customer100.c_nationkey = nation202.n_nationkey AND (nation201.n_name = 'BRAZIL' AND nation202.n_name = 'EGYPT' OR nation201.n_name = 'EGYPT' AND nation202.n_name = 'BRAZIL') GROUP BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate) ORDER BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
700,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(5)) = 'EGYPT' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD ANODIZED TIN') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
701,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '24', '30', '41', '22', '27', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '24', '30', '41', '22', '27', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '40'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '40')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
702,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 41 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 41 AND p_type LIKE '%BRASS') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
703,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%pale%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation103.n_name AS nation, EXTRACT(YEAR FROM orders103.o_orderdate) AS o_year, SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount) - partsupp103.ps_supplycost * lineitem103.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%pale%') AS t615 CROSS JOIN supplier AS supplier103 INNER JOIN lineitem AS lineitem103 ON supplier103.s_suppkey = lineitem103.l_suppkey AND t615.p_partkey = lineitem103.l_partkey INNER JOIN partsupp AS partsupp103 ON lineitem103.l_suppkey = partsupp103.ps_suppkey AND lineitem103.l_partkey = partsupp103.ps_partkey INNER JOIN orders AS orders103 ON lineitem103.l_orderkey = orders103.o_orderkey INNER JOIN nation AS nation103 ON supplier103.s_nationkey = nation103.n_nationkey GROUP BY nation103.n_name, EXTRACT(YEAR FROM orders103.o_orderdate) ORDER BY nation103.n_name, EXTRACT(YEAR FROM orders103.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
704,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 21 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 21 AND p_type LIKE '%TIN') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
705,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'UNITED STATES' and n2.n_name = 'ARGENTINA') or (n1.n_name = 'ARGENTINA' and n2.n_name = 'UNITED STATES') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation199.n_name AS supp_nation, nation200.n_name AS cust_nation, EXTRACT(YEAR FROM t629.l_shipdate) AS l_year, SUM(t629.l_extendedprice * (1 - t629.l_discount)) AS revenue FROM supplier AS supplier99 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t629 ON supplier99.s_suppkey = t629.l_suppkey INNER JOIN orders AS orders99 ON t629.l_orderkey = orders99.o_orderkey INNER JOIN customer AS customer99 ON orders99.o_custkey = customer99.c_custkey INNER JOIN nation AS nation199 ON supplier99.s_nationkey = nation199.n_nationkey INNER JOIN nation AS nation200 ON customer99.c_nationkey = nation200.n_nationkey AND (nation199.n_name = 'UNITED STATES' AND nation200.n_name = 'ARGENTINA' OR nation199.n_name = 'ARGENTINA' AND nation200.n_name = 'UNITED STATES') GROUP BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate) ORDER BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
706,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM PLATED STEEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
707,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%ivory%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation102.n_name AS nation, EXTRACT(YEAR FROM orders102.o_orderdate) AS o_year, SUM(lineitem102.l_extendedprice * (1 - lineitem102.l_discount) - partsupp102.ps_supplycost * lineitem102.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%ivory%') AS t607 CROSS JOIN supplier AS supplier102 INNER JOIN lineitem AS lineitem102 ON supplier102.s_suppkey = lineitem102.l_suppkey AND t607.p_partkey = lineitem102.l_partkey INNER JOIN partsupp AS partsupp102 ON lineitem102.l_suppkey = partsupp102.ps_suppkey AND lineitem102.l_partkey = partsupp102.ps_partkey INNER JOIN orders AS orders102 ON lineitem102.l_orderkey = orders102.o_orderkey INNER JOIN nation AS nation102 ON supplier102.s_nationkey = nation102.n_nationkey GROUP BY nation102.n_name, EXTRACT(YEAR FROM orders102.o_orderdate) ORDER BY nation102.n_name, EXTRACT(YEAR FROM orders102.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
708,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 50 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 50 AND p_type LIKE '%STEEL') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
709,tpch,"select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(6)) = 'JORDAN' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE ANODIZED TIN') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
710,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '39', '43', '21', '27', '26', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '39', '43', '21', '27', '26', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
711,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 48 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 48 AND p_type LIKE '%NICKEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
712,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '40', '32', '31', '24', '36', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '40', '32', '31', '24', '36', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
713,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 1 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 1 AND p_type LIKE '%BRASS') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
714,tpch,"select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(6)) = 'JORDAN' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED STEEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
715,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 39 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 39 AND p_type LIKE '%NICKEL') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
716,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED BRASS') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
717,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '39', '34', '43', '31', '22', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '39', '34', '43', '31', '22', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
718,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 16 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 16 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
719,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(7)) = 'VIETNAM' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD PLATED COPPER') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'ASIA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
720,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '29', '20', '25', '42', '33', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '29', '20', '25', '42', '33', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
721,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 30 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 30 AND p_type LIKE '%TIN') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
722,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE PLATED NICKEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
723,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '44', '32', '24', '22', '36', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '44', '32', '24', '22', '36', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '37'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '37')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
724,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 14 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 14 AND p_type LIKE '%TIN') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
725,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ROMANIA' and n2.n_name = 'VIETNAM') or (n1.n_name = 'VIETNAM' and n2.n_name = 'ROMANIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation201.n_name AS supp_nation, nation202.n_name AS cust_nation, EXTRACT(YEAR FROM t638.l_shipdate) AS l_year, SUM(t638.l_extendedprice * (1 - t638.l_discount)) AS revenue FROM supplier AS supplier100 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t638 ON supplier100.s_suppkey = t638.l_suppkey INNER JOIN orders AS orders100 ON t638.l_orderkey = orders100.o_orderkey INNER JOIN customer AS customer100 ON orders100.o_custkey = customer100.c_custkey INNER JOIN nation AS nation201 ON supplier100.s_nationkey = nation201.n_nationkey INNER JOIN nation AS nation202 ON customer100.c_nationkey = nation202.n_nationkey AND (nation201.n_name = 'ROMANIA' AND nation202.n_name = 'VIETNAM' OR nation201.n_name = 'VIETNAM' AND nation202.n_name = 'ROMANIA') GROUP BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate) ORDER BY nation201.n_name, nation202.n_name, EXTRACT(YEAR FROM t638.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
726,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(7)) = 'VIETNAM' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED NICKEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'ASIA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
727,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '24', '43', '26', '44', '23', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '24', '43', '26', '44', '23', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '42'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '42')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
728,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 18 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 18 AND p_type LIKE '%BRASS') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
729,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'RUSSIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED STEEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
730,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '37', '23', '22', '39', '33', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '37', '23', '22', '39', '33', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
731,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 35 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 35 AND p_type LIKE '%BRASS') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
732,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(9)) = 'INDONESIA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD ANODIZED STEEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'ASIA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
733,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 45 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 45 AND p_type LIKE '%COPPER') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
734,tpch,"select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(13)) = 'UNITED STATES' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BURNISHED TIN') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
735,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('38', '27', '25', '26', '30', '31', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('38', '27', '25', '26', '30', '31', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '33'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '33')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
736,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 22 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 22 AND p_type LIKE '%BRASS') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
737,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-16' and l_shipdate > date '1995-03-16' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t793.l_orderkey, SUM(t793.l_extendedprice * (1 - t793.l_discount)) AS revenue, t792.o_orderdate, t792.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'BUILDING') AS t790, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-16') AS t791 WHERE t790.c_custkey = t791.o_custkey) AS t792, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-16') AS t793 WHERE t793.l_orderkey = t792.o_orderkey GROUP BY t793.l_orderkey, t792.o_orderdate, t792.o_shippriority ORDER BY SUM(t793.l_extendedprice * (1 - t793.l_discount)) DESC, t792.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
738,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ARGENTINA' and n2.n_name = 'UNITED STATES') or (n1.n_name = 'UNITED STATES' and n2.n_name = 'ARGENTINA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation203.n_name AS supp_nation, nation204.n_name AS cust_nation, EXTRACT(YEAR FROM t647.l_shipdate) AS l_year, SUM(t647.l_extendedprice * (1 - t647.l_discount)) AS revenue FROM supplier AS supplier101 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t647 ON supplier101.s_suppkey = t647.l_suppkey INNER JOIN orders AS orders101 ON t647.l_orderkey = orders101.o_orderkey INNER JOIN customer AS customer101 ON orders101.o_custkey = customer101.c_custkey INNER JOIN nation AS nation203 ON supplier101.s_nationkey = nation203.n_nationkey INNER JOIN nation AS nation204 ON customer101.c_nationkey = nation204.n_nationkey AND (nation203.n_name = 'ARGENTINA' AND nation204.n_name = 'UNITED STATES' OR nation203.n_name = 'UNITED STATES' AND nation204.n_name = 'ARGENTINA') GROUP BY nation203.n_name, nation204.n_name, EXTRACT(YEAR FROM t647.l_shipdate) ORDER BY nation203.n_name, nation204.n_name, EXTRACT(YEAR FROM t647.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
739,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BRUSHED NICKEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
740,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '41', '27', '30', '21', '23', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '41', '27', '30', '21', '23', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
741,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(7)) = 'VIETNAM' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO POLISHED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'ASIA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
742,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '23', '27', '31', '32', '40', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '23', '27', '31', '32', '40', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
743,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 44 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 44 AND p_type LIKE '%STEEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
744,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'IRAQ' and n2.n_name = 'JORDAN') or (n1.n_name = 'JORDAN' and n2.n_name = 'IRAQ') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation205.n_name AS supp_nation, nation206.n_name AS cust_nation, EXTRACT(YEAR FROM t656.l_shipdate) AS l_year, SUM(t656.l_extendedprice * (1 - t656.l_discount)) AS revenue FROM supplier AS supplier102 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t656 ON supplier102.s_suppkey = t656.l_suppkey INNER JOIN orders AS orders102 ON t656.l_orderkey = orders102.o_orderkey INNER JOIN customer AS customer102 ON orders102.o_custkey = customer102.c_custkey INNER JOIN nation AS nation205 ON supplier102.s_nationkey = nation205.n_nationkey INNER JOIN nation AS nation206 ON customer102.c_nationkey = nation206.n_nationkey AND (nation205.n_name = 'IRAQ' AND nation206.n_name = 'JORDAN' OR nation205.n_name = 'JORDAN' AND nation206.n_name = 'IRAQ') GROUP BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate) ORDER BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
745,tpch,"select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'JORDAN' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BURNISHED TIN') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
746,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '21', '23', '43', '34', '33', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '21', '23', '43', '34', '33', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '37'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '37')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
747,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 34 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 34 AND p_type LIKE '%STEEL') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
748,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(9)) = 'INDONESIA' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'STANDARD BURNISHED NICKEL') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
749,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '42', '30', '40', '39', '37', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '42', '30', '40', '39', '37', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
750,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 7 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 7 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
751,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(7)) = 'GERMANY' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM PLATED COPPER') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
752,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '28', '29', '37', '21', '38', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '28', '29', '37', '21', '38', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
753,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 23 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 23 AND p_type LIKE '%NICKEL') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
754,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'UNITED KINGDOM' and n2.n_name = 'ARGENTINA') or (n1.n_name = 'ARGENTINA' and n2.n_name = 'UNITED KINGDOM') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation205.n_name AS supp_nation, nation206.n_name AS cust_nation, EXTRACT(YEAR FROM t656.l_shipdate) AS l_year, SUM(t656.l_extendedprice * (1 - t656.l_discount)) AS revenue FROM supplier AS supplier102 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t656 ON supplier102.s_suppkey = t656.l_suppkey INNER JOIN orders AS orders102 ON t656.l_orderkey = orders102.o_orderkey INNER JOIN customer AS customer102 ON orders102.o_custkey = customer102.c_custkey INNER JOIN nation AS nation205 ON supplier102.s_nationkey = nation205.n_nationkey INNER JOIN nation AS nation206 ON customer102.c_nationkey = nation206.n_nationkey AND (nation205.n_name = 'UNITED KINGDOM' AND nation206.n_name = 'ARGENTINA' OR nation205.n_name = 'ARGENTINA' AND nation206.n_name = 'UNITED KINGDOM') GROUP BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate) ORDER BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
755,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO POLISHED STEEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
756,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '22', '43', '29', '40', '36', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '22', '43', '29', '40', '36', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
757,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ETHIOPIA' and n2.n_name = 'SAUDI ARABIA') or (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'ETHIOPIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation199.n_name AS supp_nation, nation200.n_name AS cust_nation, EXTRACT(YEAR FROM t629.l_shipdate) AS l_year, SUM(t629.l_extendedprice * (1 - t629.l_discount)) AS revenue FROM supplier AS supplier99 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t629 ON supplier99.s_suppkey = t629.l_suppkey INNER JOIN orders AS orders99 ON t629.l_orderkey = orders99.o_orderkey INNER JOIN customer AS customer99 ON orders99.o_custkey = customer99.c_custkey INNER JOIN nation AS nation199 ON supplier99.s_nationkey = nation199.n_nationkey INNER JOIN nation AS nation200 ON customer99.c_nationkey = nation200.n_nationkey AND (nation199.n_name = 'ETHIOPIA' AND nation200.n_name = 'SAUDI ARABIA' OR nation199.n_name = 'SAUDI ARABIA' AND nation200.n_name = 'ETHIOPIA') GROUP BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate) ORDER BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
758,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(8)) = 'ETHIOPIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED STEEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
759,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '38', '27', '33', '37', '40', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '38', '27', '33', '37', '40', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
760,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 2 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 2 AND p_type LIKE '%COPPER') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
761,tpch,"select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(6)) = 'JORDAN' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'STANDARD BURNISHED NICKEL') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
762,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 4 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 4 AND p_type LIKE '%STEEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
763,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '27', '32', '36', '44', '20', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '27', '32', '36', '44', '20', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
764,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 18 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 18 AND p_type LIKE '%COPPER') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
765,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-25' and l_shipdate > date '1995-03-25' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t789.l_orderkey, SUM(t789.l_extendedprice * (1 - t789.l_discount)) AS revenue, t788.o_orderdate, t788.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t786, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-25') AS t787 WHERE t786.c_custkey = t787.o_custkey) AS t788, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-25') AS t789 WHERE t789.l_orderkey = t788.o_orderkey GROUP BY t789.l_orderkey, t788.o_orderdate, t788.o_shippriority ORDER BY SUM(t789.l_extendedprice * (1 - t789.l_discount)) DESC, t788.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
766,tpch,"select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(5)) = 'CHINA' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE ANODIZED NICKEL') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'ASIA') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
767,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('41', '42', '29', '36', '34', '22', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('41', '42', '29', '36', '34', '22', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
768,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(8)) = 'ETHIOPIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM PLATED STEEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
769,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '42', '32', '27', '28', '26', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '42', '32', '27', '28', '26', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
770,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 27 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 27 AND p_type LIKE '%TIN') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
771,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '20', '30', '33', '23', '27', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '20', '30', '33', '23', '27', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
772,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 36 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 36 AND p_type LIKE '%TIN') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
773,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL BURNISHED NICKEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
774,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '38', '29', '42', '26', '22', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '38', '29', '42', '26', '22', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '25'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '25')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
775,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 38 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 38 AND p_type LIKE '%BRASS') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
776,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(8)) = 'ETHIOPIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM POLISHED NICKEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
777,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%lace%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation102.n_name AS nation, EXTRACT(YEAR FROM orders102.o_orderdate) AS o_year, SUM(lineitem102.l_extendedprice * (1 - lineitem102.l_discount) - partsupp102.ps_supplycost * lineitem102.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%lace%') AS t607 CROSS JOIN supplier AS supplier102 INNER JOIN lineitem AS lineitem102 ON supplier102.s_suppkey = lineitem102.l_suppkey AND t607.p_partkey = lineitem102.l_partkey INNER JOIN partsupp AS partsupp102 ON lineitem102.l_suppkey = partsupp102.ps_suppkey AND lineitem102.l_partkey = partsupp102.ps_partkey INNER JOIN orders AS orders102 ON lineitem102.l_orderkey = orders102.o_orderkey INNER JOIN nation AS nation102 ON supplier102.s_nationkey = nation102.n_nationkey GROUP BY nation102.n_name, EXTRACT(YEAR FROM orders102.o_orderdate) ORDER BY nation102.n_name, EXTRACT(YEAR FROM orders102.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
778,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('REG AIR', 'TRUCK') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1996-01-01' and l_receiptdate < date '1996-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders INNER JOIN (SELECT * FROM lineitem WHERE l_shipmode IN ('REG AIR', 'TRUCK') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1996-01-01' AND l_receiptdate < (DATE '1996-01-01' + INTERVAL '1' YEAR)) AS t ON orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]"
779,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '37', '39', '28', '29', '22', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '37', '39', '28', '29', '22', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
780,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 9 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 9 AND p_type LIKE '%STEEL') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
781,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-27' and l_shipdate > date '1995-03-27' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t168.l_orderkey, SUM(t168.l_extendedprice * (1 - t168.l_discount)) AS revenue, t167.o_orderdate, t167.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'HOUSEHOLD') AS t166 INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-27') AS t167 ON t166.c_custkey = t167.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-27') AS t168 ON t167.o_orderkey = t168.l_orderkey GROUP BY t168.l_orderkey, t167.o_orderdate, t167.o_shippriority ORDER BY SUM(t168.l_extendedprice * (1 - t168.l_discount)) DESC, t167.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
782,tpch,"select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(5)) = 'CHINA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM ANODIZED STEEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'ASIA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
783,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%goldenrod%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation99.n_name AS nation, EXTRACT(YEAR FROM orders99.o_orderdate) AS o_year, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount) - partsupp99.ps_supplycost * lineitem99.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%goldenrod%') AS t583 CROSS JOIN supplier AS supplier99 INNER JOIN lineitem AS lineitem99 ON supplier99.s_suppkey = lineitem99.l_suppkey AND t583.p_partkey = lineitem99.l_partkey INNER JOIN partsupp AS partsupp99 ON lineitem99.l_suppkey = partsupp99.ps_suppkey AND lineitem99.l_partkey = partsupp99.ps_partkey INNER JOIN orders AS orders99 ON lineitem99.l_orderkey = orders99.o_orderkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey GROUP BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) ORDER BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
784,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '36', '43', '42', '44', '21', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '36', '43', '42', '44', '21', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
785,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 3 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 3 AND p_type LIKE '%STEEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
786,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-05' and l_shipdate > date '1995-03-05' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t168.l_orderkey, SUM(t168.l_extendedprice * (1 - t168.l_discount)) AS revenue, t167.o_orderdate, t167.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'BUILDING') AS t166 INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-05') AS t167 ON t166.c_custkey = t167.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-05') AS t168 ON t167.o_orderkey = t168.l_orderkey GROUP BY t168.l_orderkey, t167.o_orderdate, t167.o_shippriority ORDER BY SUM(t168.l_extendedprice * (1 - t168.l_discount)) DESC, t167.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
787,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(4)) = 'PERU' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BURNISHED STEEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
788,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%powder%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation100.n_name AS nation, EXTRACT(YEAR FROM orders100.o_orderdate) AS o_year, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount) - partsupp100.ps_supplycost * lineitem100.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%powder%') AS t591 CROSS JOIN supplier AS supplier100 INNER JOIN lineitem AS lineitem100 ON supplier100.s_suppkey = lineitem100.l_suppkey AND t591.p_partkey = lineitem100.l_partkey INNER JOIN partsupp AS partsupp100 ON lineitem100.l_suppkey = partsupp100.ps_suppkey AND lineitem100.l_partkey = partsupp100.ps_partkey INNER JOIN orders AS orders100 ON lineitem100.l_orderkey = orders100.o_orderkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey GROUP BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) ORDER BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
789,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('38', '43', '23', '24', '30', '21', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('38', '43', '23', '24', '30', '21', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
790,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(8)) = 'ETHIOPIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL POLISHED TIN') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
791,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('38', '36', '23', '34', '20', '33', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('38', '36', '23', '34', '20', '33', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
792,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 12 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 12 AND p_type LIKE '%COPPER') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
793,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(7)) = 'VIETNAM' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE PLATED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'ASIA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
794,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '40', '23', '27', '25', '33', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '40', '23', '27', '25', '33', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
795,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 33 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 33 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
796,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(9)) = 'INDONESIA' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED BRASS') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
797,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '20', '27', '41', '21', '30', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '20', '27', '41', '21', '30', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
798,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 9 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 9 AND p_type LIKE '%STEEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
799,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '21', '29', '32', '38', '39', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '21', '29', '32', '38', '39', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
800,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 36 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 36 AND p_type LIKE '%BRASS') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
801,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(8)) = 'ETHIOPIA' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL BRUSHED COPPER') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
802,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '32', '21', '30', '31', '26', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '32', '21', '30', '31', '26', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '37'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '37')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
803,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 44 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 44 AND p_type LIKE '%NICKEL') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
804,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'BRAZIL' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BURNISHED NICKEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
805,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '39', '22', '37', '38', '35', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '39', '22', '37', '38', '35', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
806,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 28 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 28 AND p_type LIKE '%TIN') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
807,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(5)) = 'EGYPT' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BRUSHED STEEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
808,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '30', '39', '35', '40', '24', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '30', '39', '35', '40', '24', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
809,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 2 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 2 AND p_type LIKE '%BRASS') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
810,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(6)) = 'BRAZIL' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BURNISHED BRASS') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
811,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '40', '38', '31', '29', '41', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '40', '38', '31', '29', '41', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
812,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 15 AND p_type LIKE '%STEEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
813,tpch,"select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(5)) = 'KENYA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL POLISHED COPPER') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
814,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '38', '25', '29', '32', '24', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '38', '25', '29', '32', '24', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '26'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '26')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
815,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 9 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 9 AND p_type LIKE '%NICKEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
816,tpch,"select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(5)) = 'CHINA' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO PLATED NICKEL') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'ASIA') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
817,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('41', '39', '23', '20', '43', '24', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('41', '39', '23', '20', '43', '24', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
818,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'RUSSIA') or (n1.n_name = 'RUSSIA' and n2.n_name = 'SAUDI ARABIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation205.n_name AS supp_nation, nation206.n_name AS cust_nation, EXTRACT(YEAR FROM t656.l_shipdate) AS l_year, SUM(t656.l_extendedprice * (1 - t656.l_discount)) AS revenue FROM supplier AS supplier102 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t656 ON supplier102.s_suppkey = t656.l_suppkey INNER JOIN orders AS orders102 ON t656.l_orderkey = orders102.o_orderkey INNER JOIN customer AS customer102 ON orders102.o_custkey = customer102.c_custkey INNER JOIN nation AS nation205 ON supplier102.s_nationkey = nation205.n_nationkey INNER JOIN nation AS nation206 ON customer102.c_nationkey = nation206.n_nationkey AND (nation205.n_name = 'SAUDI ARABIA' AND nation206.n_name = 'RUSSIA' OR nation205.n_name = 'RUSSIA' AND nation206.n_name = 'SAUDI ARABIA') GROUP BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate) ORDER BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
819,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'RUSSIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED NICKEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
820,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '42', '39', '44', '38', '22', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '42', '39', '44', '38', '22', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
821,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 49 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 49 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
822,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '42', '36', '30', '44', '43', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '42', '36', '30', '44', '43', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
823,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 33 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 33 AND p_type LIKE '%STEEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
824,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '25', '22', '38', '32', '21', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '25', '22', '38', '32', '21', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
825,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 21 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 21 AND p_type LIKE '%BRASS') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
826,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(5)) = 'INDIA' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL PLATED TIN') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
827,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '23', '41', '27', '34', '38', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '23', '41', '27', '34', '38', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
828,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 11 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 11 AND p_type LIKE '%TIN') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
829,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'MOROCCO' and n2.n_name = 'CHINA') or (n1.n_name = 'CHINA' and n2.n_name = 'MOROCCO') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation207.n_name AS supp_nation, nation208.n_name AS cust_nation, EXTRACT(YEAR FROM t665.l_shipdate) AS l_year, SUM(t665.l_extendedprice * (1 - t665.l_discount)) AS revenue FROM supplier AS supplier103 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t665 ON supplier103.s_suppkey = t665.l_suppkey INNER JOIN orders AS orders103 ON t665.l_orderkey = orders103.o_orderkey INNER JOIN customer AS customer103 ON orders103.o_custkey = customer103.c_custkey INNER JOIN nation AS nation207 ON supplier103.s_nationkey = nation207.n_nationkey INNER JOIN nation AS nation208 ON customer103.c_nationkey = nation208.n_nationkey AND (nation207.n_name = 'MOROCCO' AND nation208.n_name = 'CHINA' OR nation207.n_name = 'CHINA' AND nation208.n_name = 'MOROCCO') GROUP BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate) ORDER BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
830,tpch,"select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(5)) = 'CHINA' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BURNISHED COPPER') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'ASIA') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
831,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '44', '39', '40', '42', '29', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '44', '39', '40', '42', '29', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
832,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 32 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 32 AND p_type LIKE '%BRASS') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
833,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(8)) = 'ETHIOPIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED NICKEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
834,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '43', '21', '32', '36', '26', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '43', '21', '32', '36', '26', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '25'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '25')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
835,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 47 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 47 AND p_type LIKE '%TIN') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
836,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'IRAN' and n2.n_name = 'VIETNAM') or (n1.n_name = 'VIETNAM' and n2.n_name = 'IRAN') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'IRAN' AND nation0.n_name = 'VIETNAM' OR nation.n_name = 'VIETNAM' AND nation0.n_name = 'IRAN') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
837,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(4)) = 'IRAN' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED NICKEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
838,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '37', '43', '31', '24', '36', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '37', '43', '31', '24', '36', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
839,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 14 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 14 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
840,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'FRANCE' and n2.n_name = 'IRAN') or (n1.n_name = 'IRAN' and n2.n_name = 'FRANCE') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation205.n_name AS supp_nation, nation206.n_name AS cust_nation, EXTRACT(YEAR FROM t656.l_shipdate) AS l_year, SUM(t656.l_extendedprice * (1 - t656.l_discount)) AS revenue FROM supplier AS supplier102 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t656 ON supplier102.s_suppkey = t656.l_suppkey INNER JOIN orders AS orders102 ON t656.l_orderkey = orders102.o_orderkey INNER JOIN customer AS customer102 ON orders102.o_custkey = customer102.c_custkey INNER JOIN nation AS nation205 ON supplier102.s_nationkey = nation205.n_nationkey INNER JOIN nation AS nation206 ON customer102.c_nationkey = nation206.n_nationkey AND (nation205.n_name = 'FRANCE' AND nation206.n_name = 'IRAN' OR nation205.n_name = 'IRAN' AND nation206.n_name = 'FRANCE') GROUP BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate) ORDER BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
841,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(4)) = 'IRAN' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE POLISHED BRASS') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
842,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '42', '41', '21', '27', '28', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '42', '41', '21', '27', '28', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
843,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 27 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 27 AND p_type LIKE '%COPPER') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
844,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(6)) = 'RUSSIA' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM ANODIZED STEEL') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
845,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 8 and l_quantity <= 8 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 13 and l_quantity <= 13 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 27 and l_quantity <= 27 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );",SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#11' AND ((part.p_container = 'SM CASE' OR part.p_container = 'SM BOX' OR part.p_container = 'SM PACK' OR part.p_container = 'SM PKG') AND lineitem.l_quantity >= 8) AND (lineitem.l_quantity <= 8 + 10 AND part.p_size >= 1 AND (part.p_size <= 5 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#42' AND ((part.p_container = 'MED BAG' OR part.p_container = 'MED BOX' OR part.p_container = 'MED PKG' OR part.p_container = 'MED PACK') AND lineitem.l_quantity >= 13) AND (lineitem.l_quantity <= 13 + 10 AND part.p_size >= 1 AND (part.p_size <= 10 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#52' AND ((part.p_container = 'LG CASE' OR part.p_container = 'LG BOX' OR part.p_container = 'LG PACK' OR part.p_container = 'LG PKG') AND lineitem.l_quantity >= 27) AND (lineitem.l_quantity <= 27 + 10 AND part.p_size >= 1 AND (part.p_size <= 15 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')));,['Empty List'],"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]"
846,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '40', '29', '39', '30', '23', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '40', '29', '39', '30', '23', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '37'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '37')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
847,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 6 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT supplier.s_acctbal, supplier.s_name, nation.n_name, t.p_partkey, t.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment FROM (SELECT * FROM part WHERE p_size = 6 AND p_type LIKE '%BRASS') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT partsupp0.ps_partkey, MIN(partsupp0.ps_supplycost) AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN nation AS nation0 ON supplier0.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1 ON nation0.n_regionkey = t1.r_regionkey GROUP BY partsupp0.ps_partkey) AS t2 ON t.p_partkey = t2.ps_partkey AND partsupp.ps_supplycost = t2.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey;",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
848,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '41', '25', '22', '36', '42', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '41', '25', '22', '36', '42', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '33'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '33')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
849,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BURNISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(5)) = 'JAPAN' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL BURNISHED STEEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'ASIA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
850,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '20', '43', '23', '38', '27', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '20', '43', '23', '38', '27', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '36'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '36')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
851,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 48 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 48 AND p_type LIKE '%STEEL') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
852,tpch,"select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(6)) = 'JORDAN' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BURNISHED COPPER') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
853,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '33', '36', '40', '29', '21', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '33', '36', '40', '29', '21', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
854,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 47 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 47 AND p_type LIKE '%BRASS') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
855,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(6)) = 'FRANCE' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE PLATED COPPER') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
856,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%moccasin%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation100.n_name AS nation, EXTRACT(YEAR FROM orders100.o_orderdate) AS o_year, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount) - partsupp100.ps_supplycost * lineitem100.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%moccasin%') AS t591 CROSS JOIN supplier AS supplier100 INNER JOIN lineitem AS lineitem100 ON supplier100.s_suppkey = lineitem100.l_suppkey AND t591.p_partkey = lineitem100.l_partkey INNER JOIN partsupp AS partsupp100 ON lineitem100.l_suppkey = partsupp100.ps_suppkey AND lineitem100.l_partkey = partsupp100.ps_partkey INNER JOIN orders AS orders100 ON lineitem100.l_orderkey = orders100.o_orderkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey GROUP BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) ORDER BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
857,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '43', '25', '44', '40', '32', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '43', '25', '44', '40', '32', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
858,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 45 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 45 AND p_type LIKE '%BRASS') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
859,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '41', '30', '29', '39', '37', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '41', '30', '29', '39', '37', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '36'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '36')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
860,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 24 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 24 AND p_type LIKE '%TIN') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
861,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(5)) = 'EGYPT' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BRUSHED TIN') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
862,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '42', '27', '38', '24', '40', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '42', '27', '38', '24', '40', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '33'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '33')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
863,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 42 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 42 AND p_type LIKE '%BRASS') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
864,tpch,"select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'JORDAN' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM ANODIZED TIN') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
865,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '37', '27', '44', '36', '40', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '37', '27', '44', '36', '40', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
866,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 4 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 4 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
867,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(4)) = 'IRAN' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM POLISHED COPPER') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
868,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '36', '32', '26', '37', '21', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '36', '32', '26', '37', '21', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '42'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '42')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
869,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 28 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 28 AND p_type LIKE '%NICKEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
870,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(5)) = 'INDIA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED BRASS') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'ASIA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
871,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 1 and l_quantity <= 1 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 11 and l_quantity <= 11 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#12' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 26 and l_quantity <= 26 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );",SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#34' AND ((part.p_container = 'SM CASE' OR part.p_container = 'SM BOX' OR part.p_container = 'SM PACK' OR part.p_container = 'SM PKG') AND lineitem.l_quantity >= 1) AND (lineitem.l_quantity <= 1 + 10 AND part.p_size >= 1 AND (part.p_size <= 5 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#43' AND ((part.p_container = 'MED BAG' OR part.p_container = 'MED BOX' OR part.p_container = 'MED PKG' OR part.p_container = 'MED PACK') AND lineitem.l_quantity >= 11) AND (lineitem.l_quantity <= 11 + 10 AND part.p_size >= 1 AND (part.p_size <= 10 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#12' AND ((part.p_container = 'LG CASE' OR part.p_container = 'LG BOX' OR part.p_container = 'LG PACK' OR part.p_container = 'LG PKG') AND lineitem.l_quantity >= 26) AND (lineitem.l_quantity <= 26 + 10 AND part.p_size >= 1 AND (part.p_size <= 15 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')));,['Empty List'],"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]"
872,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '22', '30', '23', '26', '37', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '22', '30', '23', '26', '37', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
873,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 5 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 5 AND p_type LIKE '%STEEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
874,tpch,"select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(5)) = 'KENYA' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'STANDARD BRUSHED TIN') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
875,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '32', '39', '35', '42', '22', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '32', '39', '35', '42', '22', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
876,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 29 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 29 AND p_type LIKE '%TIN') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
877,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(5)) = 'JAPAN' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE ANODIZED COPPER') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'ASIA') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
878,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '42', '37', '31', '23', '41', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '42', '37', '31', '23', '41', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
879,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 13 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 13 AND p_type LIKE '%COPPER') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
880,tpch,"select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(5)) = 'KENYA' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL BRUSHED NICKEL') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
881,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 35 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 35 AND p_type LIKE '%NICKEL') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
882,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE ANODIZED COPPER') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
883,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '41', '22', '34', '42', '25', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '41', '22', '34', '42', '25', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
884,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 8 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 8 AND p_type LIKE '%STEEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
885,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(7)) = 'VIETNAM' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO PLATED STEEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'ASIA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
886,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '27', '43', '30', '23', '21', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '27', '43', '30', '23', '21', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '40'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '40')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
887,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(5)) = 'JAPAN' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'LARGE PLATED STEEL') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
888,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '38', '23', '27', '24', '34', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '38', '23', '27', '24', '34', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
889,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 37 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 37 AND p_type LIKE '%TIN') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
890,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 10 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 10 AND p_type LIKE '%BRASS') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
891,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(4)) = 'PERU' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM ANODIZED TIN') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
892,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '41', '36', '21', '43', '24', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '41', '36', '21', '43', '24', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
893,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 6 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 6 AND p_type LIKE '%STEEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
894,tpch,"select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(13)) = 'UNITED STATES' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE ANODIZED TIN') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
895,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '38', '27', '41', '39', '30', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '38', '27', '41', '39', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
896,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 3 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 3 AND p_type LIKE '%STEEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
897,tpch,"select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(12)) = 'SAUDI ARABIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL POLISHED STEEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
898,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '34', '23', '21', '36', '22', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '34', '23', '21', '36', '22', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
899,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '26', '23', '36', '42', '33', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '26', '23', '36', '42', '33', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
900,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 5 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 5 AND p_type LIKE '%TIN') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
901,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(7)) = 'VIETNAM' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO POLISHED STEEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'ASIA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
902,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '42', '34', '32', '33', '22', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '42', '34', '32', '33', '22', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
903,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 3 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 3 AND p_type LIKE '%COPPER') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
904,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(6)) = 'FRANCE' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY POLISHED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
905,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '40', '20', '21', '32', '24', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '40', '20', '21', '32', '24', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
906,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 16 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 16 AND p_type LIKE '%NICKEL') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
907,tpch,"select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(5)) = 'KENYA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
908,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '41', '29', '28', '31', '39', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '41', '29', '28', '31', '39', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
909,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 43 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 43 AND p_type LIKE '%COPPER') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
910,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '40', '30', '44', '35', '27', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '40', '30', '44', '35', '27', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '25'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '25')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
911,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 39 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 39 AND p_type LIKE '%STEEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
912,tpch,"select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(6)) = 'JORDAN' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL PLATED NICKEL') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
913,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '27', '21', '24', '40', '23', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '27', '21', '24', '40', '23', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '26'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '26')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
914,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 15 AND p_type LIKE '%COPPER') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
915,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'UNITED STATES' and n2.n_name = 'CANADA') or (n1.n_name = 'CANADA' and n2.n_name = 'UNITED STATES') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation205.n_name AS supp_nation, nation206.n_name AS cust_nation, EXTRACT(YEAR FROM t656.l_shipdate) AS l_year, SUM(t656.l_extendedprice * (1 - t656.l_discount)) AS revenue FROM supplier AS supplier102 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t656 ON supplier102.s_suppkey = t656.l_suppkey INNER JOIN orders AS orders102 ON t656.l_orderkey = orders102.o_orderkey INNER JOIN customer AS customer102 ON orders102.o_custkey = customer102.c_custkey INNER JOIN nation AS nation205 ON supplier102.s_nationkey = nation205.n_nationkey INNER JOIN nation AS nation206 ON customer102.c_nationkey = nation206.n_nationkey AND (nation205.n_name = 'UNITED STATES' AND nation206.n_name = 'CANADA' OR nation205.n_name = 'CANADA' AND nation206.n_name = 'UNITED STATES') GROUP BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate) ORDER BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
916,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(6)) = 'CANADA' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM ANODIZED STEEL') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
917,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '35', '20', '44', '34', '40', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '35', '20', '44', '34', '40', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
918,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(7)) = 'ALGERIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM PLATED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
919,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '43', '20', '29', '41', '30', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '43', '20', '29', '41', '30', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
920,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(7)) = 'GERMANY' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE PLATED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
921,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '39', '30', '20', '37', '24', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '39', '30', '20', '37', '24', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
922,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 47 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 47 AND p_type LIKE '%STEEL') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
923,tpch,"select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(12)) = 'SAUDI ARABIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BRUSHED STEEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
924,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 49 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 49 AND p_type LIKE '%NICKEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
925,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(6)) = 'BRAZIL' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD ANODIZED NICKEL') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
926,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '33', '41', '21', '31', '28', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '33', '41', '21', '31', '28', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
927,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 46 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 46 AND p_type LIKE '%BRASS') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
928,tpch,"select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'JORDAN' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED STEEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
929,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('38', '26', '39', '42', '32', '40', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('38', '26', '39', '42', '32', '40', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
930,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 23 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 23 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
931,tpch,"select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(7)) = 'MOROCCO' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM POLISHED COPPER') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
932,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '40', '41', '23', '44', '38', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '40', '41', '23', '44', '38', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '25'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '25')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
933,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 25 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 25 AND p_type LIKE '%TIN') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
934,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '35', '36', '20', '31', '32', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '35', '36', '20', '31', '32', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '26'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '26')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
935,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 41 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 41 AND p_type LIKE '%NICKEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
936,tpch,"select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(12)) = 'SAUDI ARABIA' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'LARGE PLATED COPPER') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
937,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '44', '41', '42', '29', '28', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '44', '41', '42', '29', '28', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
938,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 18 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 18 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
939,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(6)) = 'RUSSIA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL BURNISHED TIN') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
940,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '34', '43', '23', '40', '26', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '34', '43', '23', '40', '26', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '33'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '33')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
941,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 15 AND p_type LIKE '%TIN') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
942,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(7)) = 'ALGERIA' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'ECONOMY POLISHED STEEL') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
943,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '44', '27', '34', '28', '30', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '44', '27', '34', '28', '30', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
944,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(6)) = 'BRAZIL' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BURNISHED COPPER') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
945,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '34', '29', '38', '39', '22', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '34', '29', '38', '39', '22', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
946,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 40 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 40 AND p_type LIKE '%BRASS') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
947,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(10)) = 'MOZAMBIQUE' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'PROMO PLATED BRASS') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
948,tpch,"select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(5)) = 'CHINA' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE ANODIZED STEEL') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'ASIA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
949,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '38', '36', '37', '35', '42', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '38', '36', '37', '35', '42', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
950,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 16 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 16 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
951,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(5)) = 'EGYPT' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM POLISHED COPPER') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
952,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '41', '34', '43', '32', '22', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '41', '34', '43', '32', '22', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
953,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 43 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 43 AND p_type LIKE '%BRASS') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
954,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'FRANCE' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD PLATED TIN') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
955,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '31', '36', '25', '44', '32', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '31', '36', '25', '44', '32', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
956,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 21 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 21 AND p_type LIKE '%COPPER') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
957,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(6)) = 'RUSSIA' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BURNISHED STEEL') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
958,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '22', '32', '20', '36', '26', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '22', '32', '20', '36', '26', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
959,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 48 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 48 AND p_type LIKE '%BRASS') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
960,tpch,"select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(13)) = 'UNITED STATES' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM ANODIZED TIN') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
961,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '36', '34', '24', '26', '44', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '36', '34', '24', '26', '44', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
962,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 44 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 44 AND p_type LIKE '%BRASS') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
963,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(10)) = 'MOZAMBIQUE' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM POLISHED NICKEL') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
964,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '36', '23', '31', '40', '44', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '36', '23', '31', '40', '44', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
965,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 47 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t315.s_acctbal, t315.s_name, t315.n_name, t315.p_partkey, t315.p_mfgr, t315.s_address, t315.s_phone, t315.s_comment FROM (SELECT t304.p_partkey, t304.p_name, t304.p_mfgr, t304.p_brand, t304.p_type, t304.p_size, t304.p_container, t304.p_retailprice, t304.p_comment, supplier41.s_suppkey, supplier41.s_name, supplier41.s_address, supplier41.s_nationkey, supplier41.s_phone, supplier41.s_acctbal, supplier41.s_comment, partsupp41.ps_partkey, partsupp41.ps_suppkey, partsupp41.ps_availqty, partsupp41.ps_supplycost, partsupp41.ps_comment, nation41.n_nationkey, nation41.n_name, nation41.n_regionkey, nation41.n_comment, t305.r_regionkey, t305.r_name, t305.r_comment, CAST(t313.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t313.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 47 AND p_type LIKE '%NICKEL') AS t304 CROSS JOIN supplier AS supplier41 INNER JOIN partsupp AS partsupp41 ON t304.p_partkey = partsupp41.ps_partkey AND supplier41.s_suppkey = partsupp41.ps_suppkey INNER JOIN nation AS nation41 ON supplier41.s_nationkey = nation41.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t305 ON nation41.n_regionkey = t305.r_regionkey INNER JOIN (SELECT t310.ps_partkey, MIN(t310.EXPR0) AS EXPR0 FROM (SELECT t308.ps_partkey, t309.n_regionkey, MIN(t308.EXPR0) AS EXPR0 FROM (SELECT t306.ps_partkey, t307.s_nationkey, MIN(t306.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t306 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t307 ON t306.ps_suppkey = t307.s_suppkey GROUP BY t306.ps_partkey, t307.s_nationkey) AS t308 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t309 ON t308.s_nationkey = t309.n_nationkey GROUP BY t308.ps_partkey, t309.n_regionkey) AS t310 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t312 ON t310.n_regionkey = t312.r_regionkey GROUP BY t310.ps_partkey) AS t313 ON t304.p_partkey = t313.ps_partkey AND partsupp41.ps_supplycost = t313.EXPR0 ORDER BY supplier41.s_acctbal DESC, nation41.n_name, supplier41.s_name, t304.p_partkey) AS t315",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
966,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(10)) = 'MOZAMBIQUE' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BURNISHED TIN') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
967,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '22', '23', '28', '37', '43', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '22', '23', '28', '37', '43', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
968,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 24 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 24 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
969,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 23 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 23 AND p_type LIKE '%TIN') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
970,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(5)) = 'EGYPT' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE ANODIZED STEEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
971,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '37', '43', '20', '26', '27', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '37', '43', '20', '26', '27', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '33'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '33')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
972,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 31 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 31 AND p_type LIKE '%TIN') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
973,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL BRUSHED BRASS') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
974,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 40 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 40 AND p_type LIKE '%STEEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
975,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(8)) = 'ETHIOPIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BRUSHED NICKEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
976,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '21', '36', '27', '23', '33', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '21', '36', '27', '23', '33', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
977,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 13 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 13 AND p_type LIKE '%TIN') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
978,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(5)) = 'EGYPT' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BURNISHED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
979,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '31', '34', '23', '36', '22', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '31', '34', '23', '36', '22', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
980,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 17 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT supplier.s_acctbal, supplier.s_name, nation.n_name, t.p_partkey, t.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment FROM (SELECT * FROM part WHERE p_size = 17 AND p_type LIKE '%NICKEL') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT t5.ps_partkey, MIN(t5.EXPR0) AS EXPR0 FROM (SELECT t3.ps_partkey, t4.n_regionkey, MIN(t3.EXPR0) AS EXPR0 FROM (SELECT t1.ps_partkey, t2.s_nationkey, MIN(t1.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t2 ON t1.ps_suppkey = t2.s_suppkey GROUP BY t1.ps_partkey, t2.s_nationkey) AS t3 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t4 ON t3.s_nationkey = t4.n_nationkey GROUP BY t3.ps_partkey, t4.n_regionkey) AS t5 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t7 ON t5.n_regionkey = t7.r_regionkey GROUP BY t5.ps_partkey) AS t8 ON t.p_partkey = t8.ps_partkey AND partsupp.ps_supplycost = t8.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey;",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
981,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(5)) = 'EGYPT' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'STANDARD ANODIZED STEEL') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
982,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '43', '37', '42', '31', '41', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '43', '37', '42', '31', '41', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
983,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 37 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 37 AND p_type LIKE '%BRASS') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
984,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'BRAZIL' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED COPPER') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
985,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '41', '32', '42', '25', '36', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '41', '32', '42', '25', '36', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
986,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 46 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 46 AND p_type LIKE '%TIN') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
987,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(4)) = 'PERU' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
988,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '44', '34', '29', '38', '21', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '44', '34', '29', '38', '21', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
989,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 8 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 8 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
990,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(7)) = 'ALGERIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL ANODIZED TIN') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
991,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '22', '37', '39', '36', '31', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '22', '37', '39', '36', '31', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
992,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 24 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 24 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
993,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED COPPER') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
994,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '39', '29', '31', '26', '22', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '39', '29', '31', '26', '22', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
995,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 29 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 29 AND p_type LIKE '%STEEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
996,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'JAPAN' and n2.n_name = 'BRAZIL') or (n1.n_name = 'BRAZIL' and n2.n_name = 'JAPAN') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation207.n_name AS supp_nation, nation208.n_name AS cust_nation, EXTRACT(YEAR FROM t665.l_shipdate) AS l_year, SUM(t665.l_extendedprice * (1 - t665.l_discount)) AS revenue FROM supplier AS supplier103 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t665 ON supplier103.s_suppkey = t665.l_suppkey INNER JOIN orders AS orders103 ON t665.l_orderkey = orders103.o_orderkey INNER JOIN customer AS customer103 ON orders103.o_custkey = customer103.c_custkey INNER JOIN nation AS nation207 ON supplier103.s_nationkey = nation207.n_nationkey INNER JOIN nation AS nation208 ON customer103.c_nationkey = nation208.n_nationkey AND (nation207.n_name = 'JAPAN' AND nation208.n_name = 'BRAZIL' OR nation207.n_name = 'BRAZIL' AND nation208.n_name = 'JAPAN') GROUP BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate) ORDER BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
997,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(5)) = 'JAPAN' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'STANDARD PLATED BRASS') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
998,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '21', '41', '31', '30', '28', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '21', '41', '31', '30', '28', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '22'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '22')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
999,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 1 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 1 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1000,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-28' and l_shipdate > date '1995-03-28' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t793.l_orderkey, SUM(t793.l_extendedprice * (1 - t793.l_discount)) AS revenue, t792.o_orderdate, t792.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t790, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-28') AS t791 WHERE t790.c_custkey = t791.o_custkey) AS t792, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-28') AS t793 WHERE t793.l_orderkey = t792.o_orderkey GROUP BY t793.l_orderkey, t792.o_orderdate, t792.o_shippriority ORDER BY SUM(t793.l_extendedprice * (1 - t793.l_discount)) DESC, t792.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
1001,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(7)) = 'VIETNAM' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL BRUSHED TIN') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'ASIA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1002,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '29', '30', '35', '38', '27', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '29', '30', '35', '38', '27', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '37'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '37')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1003,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 28 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 28 AND p_type LIKE '%BRASS') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1004,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'RUSSIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO PLATED BRASS') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1005,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 19 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 19 AND p_type LIKE '%COPPER') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1006,tpch,"select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(4)) = 'IRAQ' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL PLATED BRASS') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1007,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '36', '38', '22', '41', '24', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '36', '38', '22', '41', '24', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1008,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(4)) = 'IRAN' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD PLATED NICKEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1009,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('38', '34', '22', '43', '29', '35', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('38', '34', '22', '43', '29', '35', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '26'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '26')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1010,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '35', '39', '28', '27', '40', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '35', '39', '28', '27', '40', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1011,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 32 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 32 AND p_type LIKE '%NICKEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1012,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(5)) = 'INDIA' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BURNISHED NICKEL') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'ASIA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1013,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '34', '43', '42', '20', '37', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '34', '43', '42', '20', '37', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1014,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 35 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 35 AND p_type LIKE '%TIN') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1015,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(5)) = 'INDIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED TIN') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1016,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '21', '43', '40', '39', '37', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '21', '43', '40', '39', '37', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1017,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 10 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 10 AND p_type LIKE '%STEEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1018,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(7)) = 'GERMANY' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BURNISHED COPPER') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1019,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('41', '38', '21', '35', '25', '31', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('41', '38', '21', '35', '25', '31', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1020,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 34 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 34 AND p_type LIKE '%TIN') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1021,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '24', '36', '31', '34', '33', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '24', '36', '31', '34', '33', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '22'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '22')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1022,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(14)) = 'UNITED KINGDOM' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'STANDARD ANODIZED NICKEL') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1023,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '29', '32', '36', '25', '24', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '29', '32', '36', '25', '24', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1024,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 4 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 4 AND p_type LIKE '%STEEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1025,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(7)) = 'VIETNAM' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BURNISHED COPPER') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'ASIA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1026,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '39', '30', '33', '20', '27', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '39', '30', '33', '20', '27', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1027,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 29 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 29 AND p_type LIKE '%NICKEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1028,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE PLATED STEEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1029,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '39', '21', '25', '33', '29', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '39', '21', '25', '33', '29', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '26'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '26')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1030,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 2 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 2 AND p_type LIKE '%STEEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1031,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '25', '37', '44', '43', '31', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '25', '37', '44', '43', '31', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '36'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '36')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1032,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 1 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 1 AND p_type LIKE '%STEEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1033,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(6)) = 'FRANCE' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL PLATED NICKEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1034,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '32', '29', '41', '35', '39', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '32', '29', '41', '35', '39', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '42'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '42')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1035,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 30 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 30 AND p_type LIKE '%NICKEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1036,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL BRUSHED COPPER') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1037,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '33', '25', '27', '41', '42', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '33', '25', '27', '41', '42', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1038,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ARGENTINA' and n2.n_name = 'CANADA') or (n1.n_name = 'CANADA' and n2.n_name = 'ARGENTINA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'ARGENTINA' AND nation0.n_name = 'CANADA' OR nation.n_name = 'CANADA' AND nation0.n_name = 'ARGENTINA') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
1039,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(6)) = 'CANADA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BRUSHED COPPER') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1040,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '22', '21', '30', '27', '35', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '22', '21', '30', '27', '35', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1041,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 32 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 32 AND p_type LIKE '%NICKEL') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1042,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(10)) = 'MOZAMBIQUE' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED BRASS') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1043,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 33 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 33 AND p_type LIKE '%TIN') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1044,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(5)) = 'JAPAN' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BURNISHED BRASS') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'ASIA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1045,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '31', '27', '29', '26', '40', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '31', '27', '29', '26', '40', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1046,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 11 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 11 AND p_type LIKE '%STEEL') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1047,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'ALGERIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BRUSHED TIN') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1048,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '31', '23', '37', '32', '44', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '31', '23', '37', '32', '44', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1049,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 41 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 41 AND p_type LIKE '%NICKEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1050,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(10)) = 'MOZAMBIQUE' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO PLATED TIN') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1051,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '20', '27', '32', '43', '30', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '20', '27', '32', '43', '30', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1052,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 34 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 34 AND p_type LIKE '%COPPER') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1053,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(10)) = 'MOZAMBIQUE' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BURNISHED COPPER') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1054,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 33 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 33 AND p_type LIKE '%NICKEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1055,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED BRASS') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1056,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '28', '29', '44', '22', '24', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '28', '29', '44', '22', '24', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1057,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 9 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 9 AND p_type LIKE '%COPPER') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1058,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(6)) = 'CANADA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BURNISHED STEEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1059,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '42', '30', '26', '41', '27', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '42', '30', '26', '41', '27', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1060,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 12 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 12 AND p_type LIKE '%STEEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1061,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(6)) = 'CANADA' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED BRASS') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1062,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '28', '30', '24', '37', '27', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '28', '30', '24', '37', '27', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1063,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 36 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 36 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1064,tpch,"select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(12)) = 'SAUDI ARABIA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE ANODIZED BRASS') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1065,tpch,"select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(13)) = 'UNITED STATES' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM ANODIZED BRASS') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1066,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '32', '41', '25', '28', '38', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '32', '41', '25', '28', '38', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1067,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 29 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 29 AND p_type LIKE '%BRASS') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1068,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '36', '41', '22', '21', '38', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '36', '41', '22', '21', '38', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '40'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '40')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1069,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 50 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 50 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1070,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(6)) = 'CANADA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE PLATED TIN') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1071,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 28 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 28 AND p_type LIKE '%BRASS') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1072,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM ANODIZED BRASS') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1073,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '28', '32', '21', '43', '35', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '28', '32', '21', '43', '35', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1074,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 16 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 16 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1075,tpch,"select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(4)) = 'IRAQ' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL POLISHED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1076,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '26', '29', '40', '24', '28', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '26', '29', '40', '24', '28', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '36'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '36')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1077,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 12 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 12 AND p_type LIKE '%TIN') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1078,tpch,"select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(4)) = 'IRAQ' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE POLISHED COPPER') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1079,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 41 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 41 AND p_type LIKE '%STEEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1080,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BURNISHED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1081,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '38', '22', '29', '34', '25', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '38', '22', '29', '34', '25', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1082,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 9 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 9 AND p_type LIKE '%COPPER') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1083,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'GERMANY' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM PLATED BRASS') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1084,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#34' and p_type not like 'ECONOMY PLATED%' and p_size in (46, 43, 2, 27, 29, 6, 33, 13) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t4.p_brand, t4.p_type, t4.p_size, COUNT(t4.ps_suppkey) AS supplier_cnt FROM (SELECT t0.ps_suppkey, t0.p_brand, t0.p_type, t0.p_size FROM (SELECT * FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#34' AND t.p_size IN (2, 6, 13, 27, 29, 33, 43, 46) AND t.p_type NOT LIKE 'ECONOMY PLATED%') AS t0 LEFT JOIN (SELECT s_suppkey, TRUE AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') AS t2 ON t0.ps_suppkey0 = t2.s_suppkey WHERE t2.f1 IS NOT TRUE GROUP BY t0.ps_suppkey, t0.p_brand, t0.p_type, t0.p_size) AS t4 GROUP BY t4.p_brand, t4.p_type, t4.p_size ORDER BY COUNT(t4.ps_suppkey) DESC, t4.p_brand, t4.p_type, t4.p_size;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
1085,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '33', '22', '36', '26', '25', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '33', '22', '36', '26', '25', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1086,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(5)) = 'JAPAN' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM POLISHED BRASS') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1087,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 22 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 22 AND p_type LIKE '%TIN') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1088,tpch,"select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(4)) = 'IRAQ' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY POLISHED STEEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1089,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '43', '34', '36', '39', '22', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '43', '34', '36', '39', '22', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1090,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 25 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 25 AND p_type LIKE '%COPPER') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1091,tpch,"select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(4)) = 'IRAQ' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BURNISHED BRASS') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1092,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '29', '34', '22', '35', '23', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '29', '34', '22', '35', '23', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1093,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 46 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 46 AND p_type LIKE '%NICKEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1094,tpch,"select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(13)) = 'UNITED STATES' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY POLISHED COPPER') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1095,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 45 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 45 AND p_type LIKE '%BRASS') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1096,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(9)) = 'INDONESIA' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL ANODIZED NICKEL') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'ASIA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1097,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '29', '32', '33', '27', '36', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '29', '32', '33', '27', '36', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1098,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 4 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 4 AND p_type LIKE '%BRASS') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1099,tpch,"select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(13)) = 'UNITED STATES' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BRUSHED TIN') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1100,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('38', '30', '21', '43', '41', '37', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('38', '30', '21', '43', '41', '37', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1101,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 49 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 49 AND p_type LIKE '%BRASS') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1102,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '30', '43', '27', '34', '37', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '30', '43', '27', '34', '37', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1103,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 20 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 20 AND p_type LIKE '%COPPER') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1104,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(5)) = 'EGYPT' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BRUSHED STEEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1105,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '29', '23', '40', '28', '20', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '29', '23', '40', '28', '20', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1106,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 44 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 44 AND p_type LIKE '%BRASS') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1107,tpch,"select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(13)) = 'UNITED STATES' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED NICKEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1108,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '24', '22', '27', '31', '25', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '24', '22', '27', '31', '25', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1109,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 15 AND p_type LIKE '%COPPER') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1110,tpch,"select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(4)) = 'IRAQ' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BURNISHED STEEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1111,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '23', '25', '41', '22', '42', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '23', '25', '41', '22', '42', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1112,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 18 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 18 AND p_type LIKE '%TIN') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1113,tpch,"select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(4)) = 'IRAQ' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL PLATED COPPER') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1114,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('41', '31', '22', '39', '43', '35', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('41', '31', '22', '39', '43', '35', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1115,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 39 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 39 AND p_type LIKE '%BRASS') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1116,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL ANODIZED NICKEL') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1117,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '30', '25', '31', '37', '32', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '30', '25', '31', '37', '32', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1118,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 43 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 43 AND p_type LIKE '%STEEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1119,tpch,"select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(12)) = 'SAUDI ARABIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BRUSHED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1120,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '28', '37', '40', '26', '41', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '28', '37', '40', '26', '41', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1121,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(7)) = 'GERMANY' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BURNISHED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1122,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '27', '41', '32', '22', '38', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '27', '41', '32', '22', '38', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1123,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 48 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 48 AND p_type LIKE '%BRASS') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1124,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'CANADA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD ANODIZED COPPER') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1125,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '28', '25', '34', '33', '42', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '28', '25', '34', '33', '42', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '22'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '22')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1126,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 19 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 19 AND p_type LIKE '%COPPER') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1127,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 11 and l_quantity <= 11 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 27 and l_quantity <= 27 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );",SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#22' AND ((part.p_container = 'SM CASE' OR part.p_container = 'SM BOX' OR part.p_container = 'SM PACK' OR part.p_container = 'SM PKG') AND lineitem.l_quantity >= 2) AND (lineitem.l_quantity <= 2 + 10 AND part.p_size >= 1 AND (part.p_size <= 5 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#44' AND ((part.p_container = 'MED BAG' OR part.p_container = 'MED BOX' OR part.p_container = 'MED PKG' OR part.p_container = 'MED PACK') AND lineitem.l_quantity >= 11) AND (lineitem.l_quantity <= 11 + 10 AND part.p_size >= 1 AND (part.p_size <= 10 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#22' AND ((part.p_container = 'LG CASE' OR part.p_container = 'LG BOX' OR part.p_container = 'LG PACK' OR part.p_container = 'LG PKG') AND lineitem.l_quantity >= 27) AND (lineitem.l_quantity <= 27 + 10 AND part.p_size >= 1 AND (part.p_size <= 15 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')));,['Empty List'],"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]"
1128,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '27', '29', '26', '21', '39', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '27', '29', '26', '21', '39', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1129,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'BRAZIL' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED STEEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1130,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '27', '32', '39', '42', '35', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '27', '32', '39', '42', '35', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1131,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 24 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 24 AND p_type LIKE '%TIN') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1132,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(5)) = 'INDIA' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL BURNISHED TIN') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'ASIA') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1133,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '33', '27', '26', '30', '24', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '33', '27', '26', '30', '24', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1134,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 45 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 45 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1135,tpch,"select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(12)) = 'SAUDI ARABIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1136,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '32', '20', '39', '24', '27', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '32', '20', '39', '24', '27', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1137,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 43 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 43 AND p_type LIKE '%BRASS') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1138,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BURNISHED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1139,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '43', '38', '28', '33', '31', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '43', '38', '28', '33', '31', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '42'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '42')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1140,tpch,"select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(12)) = 'SAUDI ARABIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED BRASS') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1141,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '26', '27', '35', '39', '40', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '26', '27', '35', '39', '40', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '22'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '22')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1142,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'RUSSIA' and n2.n_name = 'BRAZIL') or (n1.n_name = 'BRAZIL' and n2.n_name = 'RUSSIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation205.n_name AS supp_nation, nation206.n_name AS cust_nation, EXTRACT(YEAR FROM t656.l_shipdate) AS l_year, SUM(t656.l_extendedprice * (1 - t656.l_discount)) AS revenue FROM supplier AS supplier102 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t656 ON supplier102.s_suppkey = t656.l_suppkey INNER JOIN orders AS orders102 ON t656.l_orderkey = orders102.o_orderkey INNER JOIN customer AS customer102 ON orders102.o_custkey = customer102.c_custkey INNER JOIN nation AS nation205 ON supplier102.s_nationkey = nation205.n_nationkey INNER JOIN nation AS nation206 ON customer102.c_nationkey = nation206.n_nationkey AND (nation205.n_name = 'RUSSIA' AND nation206.n_name = 'BRAZIL' OR nation205.n_name = 'BRAZIL' AND nation206.n_name = 'RUSSIA') GROUP BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate) ORDER BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
1143,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t5.o_orderdate) AS o_year, SUM(CASE WHEN t5.n_name0 = 'BRAZIL' THEN t5.l_extendedprice * (1 - t5.l_discount) ELSE 0 END) / SUM(t5.l_extendedprice * (1 - t5.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO PLATED BRASS') AS t, supplier, lineitem WHERE t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey) AS t0, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t1 WHERE t0.l_orderkey = t1.o_orderkey) AS t2, customer WHERE t2.o_custkey = customer.c_custkey) AS t3, nation WHERE t3.c_nationkey = nation.n_nationkey) AS t4, nation AS nation0 WHERE t4.s_nationkey = nation0.n_nationkey) AS t5, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t6 WHERE t5.n_regionkey = t6.r_regionkey GROUP BY EXTRACT(YEAR FROM t5.o_orderdate) ORDER BY EXTRACT(YEAR FROM t5.o_orderdate);",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1144,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '23', '41', '35', '21', '28', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '23', '41', '35', '21', '28', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '42'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '42')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1145,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 19 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 19 AND p_type LIKE '%TIN') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1146,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('38', '33', '39', '32', '44', '30', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('38', '33', '39', '32', '44', '30', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1147,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 21 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t11.s_acctbal, t11.s_name, t11.n_name, t11.p_partkey, t11.p_mfgr, t11.s_address, t11.s_phone, t11.s_comment FROM (SELECT t3.p_partkey, t3.p_name, t3.p_mfgr, t3.p_brand, t3.p_type, t3.p_size, t3.p_container, t3.p_retailprice, t3.p_comment, t3.s_suppkey, t3.s_name, t3.s_address, t3.s_nationkey, t3.s_phone, t3.s_acctbal, t3.s_comment, t3.ps_partkey, t3.ps_suppkey, t3.ps_availqty, t3.ps_supplycost, t3.ps_comment, t3.n_nationkey, t3.n_name, t3.n_regionkey, t3.n_comment, t3.r_regionkey, t3.r_name, t3.r_comment, CAST(t8.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t8.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 21 AND p_type LIKE '%STEEL') AS t, supplier, partsupp WHERE t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey) AS t0, nation WHERE t0.s_nationkey = nation.n_nationkey) AS t1, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t2 WHERE t1.n_regionkey = t2.r_regionkey) AS t3, (SELECT t5.ps_partkey, MIN(t5.ps_supplycost) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM partsupp AS partsupp0, supplier AS supplier0 WHERE supplier0.s_suppkey = partsupp0.ps_suppkey) AS t4, nation AS nation0 WHERE t4.s_nationkey = nation0.n_nationkey) AS t5, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t6 WHERE t5.n_regionkey = t6.r_regionkey GROUP BY t5.ps_partkey) AS t8 WHERE t3.p_partkey = t8.ps_partkey AND t3.ps_supplycost = t8.EXPR0 ORDER BY t3.s_acctbal DESC, t3.n_name, t3.s_name, t3.p_partkey) AS t11;",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1148,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'GERMANY' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BRUSHED COPPER') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1149,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '26', '20', '27', '33', '37', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '26', '20', '27', '33', '37', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1150,tpch,"select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(12)) = 'SAUDI ARABIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE ANODIZED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1151,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('TRUCK', 'MAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1997-01-01' and l_receiptdate < date '1997-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders INNER JOIN (SELECT * FROM lineitem WHERE l_shipmode IN ('MAIL', 'TRUCK') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1997-01-01' AND l_receiptdate < (DATE '1997-01-01' + INTERVAL '1' YEAR)) AS t ON orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]"
1152,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('38', '34', '41', '44', '32', '28', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('38', '34', '41', '44', '32', '28', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1153,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 42 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 42 AND p_type LIKE '%COPPER') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1154,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'CANADA') or (n1.n_name = 'CANADA' and n2.n_name = 'SAUDI ARABIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation199.n_name AS supp_nation, nation200.n_name AS cust_nation, EXTRACT(YEAR FROM t629.l_shipdate) AS l_year, SUM(t629.l_extendedprice * (1 - t629.l_discount)) AS revenue FROM supplier AS supplier99 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t629 ON supplier99.s_suppkey = t629.l_suppkey INNER JOIN orders AS orders99 ON t629.l_orderkey = orders99.o_orderkey INNER JOIN customer AS customer99 ON orders99.o_custkey = customer99.c_custkey INNER JOIN nation AS nation199 ON supplier99.s_nationkey = nation199.n_nationkey INNER JOIN nation AS nation200 ON customer99.c_nationkey = nation200.n_nationkey AND (nation199.n_name = 'SAUDI ARABIA' AND nation200.n_name = 'CANADA' OR nation199.n_name = 'CANADA' AND nation200.n_name = 'SAUDI ARABIA') GROUP BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate) ORDER BY nation199.n_name, nation200.n_name, EXTRACT(YEAR FROM t629.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
1155,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '23', '22', '41', '28', '35', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '23', '22', '41', '28', '35', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '33'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '33')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1156,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 17 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 17 AND p_type LIKE '%NICKEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1157,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'GERMANY' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE PLATED STEEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1158,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '34', '37', '30', '38', '31', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '34', '37', '30', '38', '31', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1159,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 4 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 4 AND p_type LIKE '%TIN') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1160,tpch,"select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(13)) = 'UNITED STATES' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'LARGE ANODIZED STEEL') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1161,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '33', '20', '42', '40', '44', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '33', '20', '42', '40', '44', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '37'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '37')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1162,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(6)) = 'CANADA' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL BURNISHED BRASS') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1163,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '24', '25', '30', '26', '41', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '24', '25', '30', '26', '41', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1164,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 25 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 25 AND p_type LIKE '%NICKEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1165,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(5)) = 'JAPAN' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM POLISHED TIN') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'ASIA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1166,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '32', '37', '34', '23', '41', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '32', '37', '34', '23', '41', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '40'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '40')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1167,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 7 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 7 AND p_type LIKE '%STEEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1168,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(4)) = 'PERU' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL PLATED NICKEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1169,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '31', '36', '43', '25', '23', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '31', '36', '43', '25', '23', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1170,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 9 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 9 AND p_type LIKE '%BRASS') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1171,tpch,"select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(13)) = 'UNITED STATES' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'LARGE PLATED COPPER') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1172,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '24', '27', '39', '35', '30', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '24', '27', '39', '35', '30', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1173,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 38 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 38 AND p_type LIKE '%TIN') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1174,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(5)) = 'JAPAN' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED BRASS') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'ASIA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1175,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '24', '23', '25', '41', '33', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '24', '23', '25', '41', '33', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1176,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 34 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 34 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1177,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED BRASS') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1178,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('41', '21', '38', '25', '37', '20', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('41', '21', '38', '25', '37', '20', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1179,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '41', '34', '40', '35', '44', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '41', '34', '40', '35', '44', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1180,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t5.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t5.n_name0 AS CHAR(6)) = 'CANADA' THEN t5.l_extendedprice * (1 - t5.l_discount) ELSE 0 END) / SUM(t5.l_extendedprice * (1 - t5.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL ANODIZED BRASS') AS t, supplier, lineitem WHERE t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey) AS t0, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t1 WHERE t0.l_orderkey = t1.o_orderkey) AS t2, customer WHERE t2.o_custkey = customer.c_custkey) AS t3, nation WHERE t3.c_nationkey = nation.n_nationkey) AS t4, nation AS nation0 WHERE t4.s_nationkey = nation0.n_nationkey) AS t5, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t6 WHERE t5.n_regionkey = t6.r_regionkey GROUP BY EXTRACT(YEAR FROM t5.o_orderdate) ORDER BY EXTRACT(YEAR FROM t5.o_orderdate);",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1181,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '34', '21', '28', '43', '22', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '34', '21', '28', '43', '22', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1182,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 36 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 36 AND p_type LIKE '%NICKEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1183,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(10)) = 'MOZAMBIQUE' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL POLISHED TIN') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1184,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '35', '30', '36', '28', '37', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '35', '30', '36', '28', '37', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1185,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 28 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 28 AND p_type LIKE '%TIN') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1186,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY POLISHED STEEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1187,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '25', '29', '22', '44', '23', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '25', '29', '22', '44', '23', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1188,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 6 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 6 AND p_type LIKE '%STEEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1189,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(7)) = 'GERMANY' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BURNISHED NICKEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1190,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '26', '25', '37', '29', '32', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '26', '25', '37', '29', '32', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1191,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 35 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t315.s_acctbal, t315.s_name, t315.n_name, t315.p_partkey, t315.p_mfgr, t315.s_address, t315.s_phone, t315.s_comment FROM (SELECT t304.p_partkey, t304.p_name, t304.p_mfgr, t304.p_brand, t304.p_type, t304.p_size, t304.p_container, t304.p_retailprice, t304.p_comment, supplier41.s_suppkey, supplier41.s_name, supplier41.s_address, supplier41.s_nationkey, supplier41.s_phone, supplier41.s_acctbal, supplier41.s_comment, partsupp41.ps_partkey, partsupp41.ps_suppkey, partsupp41.ps_availqty, partsupp41.ps_supplycost, partsupp41.ps_comment, nation41.n_nationkey, nation41.n_name, nation41.n_regionkey, nation41.n_comment, t305.r_regionkey, t305.r_name, t305.r_comment, CAST(t313.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t313.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 35 AND p_type LIKE '%NICKEL') AS t304 CROSS JOIN supplier AS supplier41 INNER JOIN partsupp AS partsupp41 ON t304.p_partkey = partsupp41.ps_partkey AND supplier41.s_suppkey = partsupp41.ps_suppkey INNER JOIN nation AS nation41 ON supplier41.s_nationkey = nation41.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t305 ON nation41.n_regionkey = t305.r_regionkey INNER JOIN (SELECT t310.ps_partkey, MIN(t310.EXPR0) AS EXPR0 FROM (SELECT t308.ps_partkey, t309.n_regionkey, MIN(t308.EXPR0) AS EXPR0 FROM (SELECT t306.ps_partkey, t307.s_nationkey, MIN(t306.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t306 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t307 ON t306.ps_suppkey = t307.s_suppkey GROUP BY t306.ps_partkey, t307.s_nationkey) AS t308 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t309 ON t308.s_nationkey = t309.n_nationkey GROUP BY t308.ps_partkey, t309.n_regionkey) AS t310 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t312 ON t310.n_regionkey = t312.r_regionkey GROUP BY t310.ps_partkey) AS t313 ON t304.p_partkey = t313.ps_partkey AND partsupp41.ps_supplycost = t313.EXPR0 ORDER BY supplier41.s_acctbal DESC, nation41.n_name, supplier41.s_name, t304.p_partkey) AS t315",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1192,tpch,"select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(12)) = 'SAUDI ARABIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO POLISHED COPPER') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1193,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '26', '22', '24', '35', '23', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '26', '22', '24', '35', '23', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1194,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 27 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 27 AND p_type LIKE '%NICKEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1195,tpch,"select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(7)) = 'MOROCCO' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED BRASS') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1196,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '29', '22', '42', '39', '25', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '29', '22', '42', '39', '25', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1197,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 5 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 5 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1198,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(6)) = 'CANADA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL ANODIZED COPPER') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1199,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '29', '41', '21', '24', '28', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '29', '41', '21', '24', '28', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '36'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '36')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1200,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 37 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 37 AND p_type LIKE '%NICKEL') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1201,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(10)) = 'MOZAMBIQUE' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BURNISHED NICKEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1202,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('38', '40', '37', '35', '26', '31', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('38', '40', '37', '35', '26', '31', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1203,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 11 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT supplier.s_acctbal, supplier.s_name, nation.n_name, t.p_partkey, t.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment FROM (SELECT * FROM part WHERE p_size = 11 AND p_type LIKE '%STEEL') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT partsupp0.ps_partkey, MIN(partsupp0.ps_supplycost) AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN nation AS nation0 ON supplier0.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1 ON nation0.n_regionkey = t1.r_regionkey GROUP BY partsupp0.ps_partkey) AS t3 ON t.p_partkey = t3.ps_partkey AND partsupp.ps_supplycost = t3.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey;",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1204,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '26', '36', '31', '22', '32', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '26', '36', '31', '22', '32', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '33'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '33')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1205,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 2 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 2 AND p_type LIKE '%COPPER') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1206,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ALGERIA' and n2.n_name = 'FRANCE') or (n1.n_name = 'FRANCE' and n2.n_name = 'ALGERIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation207.n_name AS supp_nation, nation208.n_name AS cust_nation, EXTRACT(YEAR FROM t665.l_shipdate) AS l_year, SUM(t665.l_extendedprice * (1 - t665.l_discount)) AS revenue FROM supplier AS supplier103 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t665 ON supplier103.s_suppkey = t665.l_suppkey INNER JOIN orders AS orders103 ON t665.l_orderkey = orders103.o_orderkey INNER JOIN customer AS customer103 ON orders103.o_custkey = customer103.c_custkey INNER JOIN nation AS nation207 ON supplier103.s_nationkey = nation207.n_nationkey INNER JOIN nation AS nation208 ON customer103.c_nationkey = nation208.n_nationkey AND (nation207.n_name = 'ALGERIA' AND nation208.n_name = 'FRANCE' OR nation207.n_name = 'FRANCE' AND nation208.n_name = 'ALGERIA') GROUP BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate) ORDER BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
1207,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(6)) = 'FRANCE' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED TIN') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1208,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '34', '41', '22', '21', '38', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '34', '41', '22', '21', '38', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1209,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 23 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 23 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1210,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '33', '22', '32', '28', '35', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '33', '22', '32', '28', '35', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1211,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 18 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 18 AND p_type LIKE '%STEEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1212,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(5)) = 'EGYPT' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM POLISHED BRASS') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1213,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '22', '27', '42', '31', '40', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '22', '27', '42', '31', '40', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1214,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 28 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 28 AND p_type LIKE '%NICKEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1215,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '27', '41', '29', '43', '28', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '27', '41', '29', '43', '28', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1216,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 49 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 49 AND p_type LIKE '%STEEL') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1217,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 17 and l_quantity <= 17 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#33' AND (part.p_container IN ('SM BOX', 'SM CASE', 'SM PACK', 'SM PKG') AND lineitem.l_quantity >= 10) AND (lineitem.l_quantity <= 10 + 10 AND (part.p_size >= 1 AND part.p_size <= 5) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#32' AND (part.p_container IN ('MED BAG', 'MED BOX', 'MED PACK', 'MED PKG') AND lineitem.l_quantity >= 17) AND (lineitem.l_quantity <= 17 + 10 AND (part.p_size >= 1 AND part.p_size <= 10) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#21' AND (part.p_container IN ('LG BOX', 'LG CASE', 'LG PACK', 'LG PKG') AND lineitem.l_quantity >= 20) AND (lineitem.l_quantity <= 20 + 10 AND (part.p_size >= 1 AND part.p_size <= 15) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'));",['Empty List'],"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]"
1218,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '27', '22', '42', '37', '25', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '27', '22', '42', '37', '25', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1219,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(6)) = 'BRAZIL' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED NICKEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1220,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '32', '25', '38', '20', '42', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '32', '25', '38', '20', '42', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1221,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 15 AND p_type LIKE '%BRASS') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1222,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(7)) = 'ALGERIA' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL BURNISHED COPPER') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1223,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '42', '23', '35', '29', '43', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '42', '23', '35', '29', '43', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1224,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 43 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 43 AND p_type LIKE '%COPPER') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1225,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL PLATED STEEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1226,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '21', '41', '28', '32', '38', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '21', '41', '28', '32', '38', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '33'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '33')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1227,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 20 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 20 AND p_type LIKE '%BRASS') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1228,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(7)) = 'ALGERIA' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED COPPER') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1229,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '35', '43', '31', '22', '36', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '35', '43', '31', '22', '36', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '42'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '42')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1230,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 34 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 34 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1231,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(14)) = 'UNITED KINGDOM' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED TIN') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1232,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '39', '32', '34', '42', '25', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '39', '32', '34', '42', '25', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1233,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 19 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 19 AND p_type LIKE '%NICKEL') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1234,tpch,"select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(5)) = 'CHINA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BURNISHED COPPER') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1235,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '21', '32', '35', '33', '36', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '21', '32', '35', '33', '36', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1236,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 46 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 46 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1237,tpch,"select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(12)) = 'SAUDI ARABIA' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED TIN') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1238,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '35', '34', '39', '44', '22', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '35', '34', '39', '44', '22', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1239,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 5 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 5 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1240,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'IRAN' and n2.n_name = 'ALGERIA') or (n1.n_name = 'ALGERIA' and n2.n_name = 'IRAN') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation207.n_name AS supp_nation, nation208.n_name AS cust_nation, EXTRACT(YEAR FROM t665.l_shipdate) AS l_year, SUM(t665.l_extendedprice * (1 - t665.l_discount)) AS revenue FROM supplier AS supplier103 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t665 ON supplier103.s_suppkey = t665.l_suppkey INNER JOIN orders AS orders103 ON t665.l_orderkey = orders103.o_orderkey INNER JOIN customer AS customer103 ON orders103.o_custkey = customer103.c_custkey INNER JOIN nation AS nation207 ON supplier103.s_nationkey = nation207.n_nationkey INNER JOIN nation AS nation208 ON customer103.c_nationkey = nation208.n_nationkey AND (nation207.n_name = 'IRAN' AND nation208.n_name = 'ALGERIA' OR nation207.n_name = 'ALGERIA' AND nation208.n_name = 'IRAN') GROUP BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate) ORDER BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
1241,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(4)) = 'IRAN' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD ANODIZED BRASS') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1242,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '39', '36', '26', '22', '42', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '39', '36', '26', '22', '42', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '33'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '33')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1243,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(7)) = 'GERMANY' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY POLISHED COPPER') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1244,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('41', '35', '32', '20', '34', '25', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('41', '35', '32', '20', '34', '25', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '33'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '33')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1245,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 3 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 3 AND p_type LIKE '%TIN') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1246,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(7)) = 'VIETNAM' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED NICKEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'ASIA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1247,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 41 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 41 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1248,tpch,"select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(6)) = 'JORDAN' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY POLISHED NICKEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1249,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '35', '23', '22', '37', '33', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '35', '23', '22', '37', '33', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1250,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 14 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 14 AND p_type LIKE '%BRASS') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1251,tpch,"select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(7)) = 'MOROCCO' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED COPPER') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1252,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '36', '21', '29', '32', '24', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '36', '21', '29', '32', '24', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1253,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 17 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 17 AND p_type LIKE '%BRASS') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1254,tpch,"select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(5)) = 'CHINA' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD PLATED BRASS') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'ASIA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1255,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '40', '39', '36', '34', '29', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '40', '39', '36', '34', '29', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1256,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 33 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t315.s_acctbal, t315.s_name, t315.n_name, t315.p_partkey, t315.p_mfgr, t315.s_address, t315.s_phone, t315.s_comment FROM (SELECT t304.p_partkey, t304.p_name, t304.p_mfgr, t304.p_brand, t304.p_type, t304.p_size, t304.p_container, t304.p_retailprice, t304.p_comment, supplier41.s_suppkey, supplier41.s_name, supplier41.s_address, supplier41.s_nationkey, supplier41.s_phone, supplier41.s_acctbal, supplier41.s_comment, partsupp41.ps_partkey, partsupp41.ps_suppkey, partsupp41.ps_availqty, partsupp41.ps_supplycost, partsupp41.ps_comment, nation41.n_nationkey, nation41.n_name, nation41.n_regionkey, nation41.n_comment, t305.r_regionkey, t305.r_name, t305.r_comment, CAST(t313.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t313.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 33 AND p_type LIKE '%STEEL') AS t304 CROSS JOIN supplier AS supplier41 INNER JOIN partsupp AS partsupp41 ON t304.p_partkey = partsupp41.ps_partkey AND supplier41.s_suppkey = partsupp41.ps_suppkey INNER JOIN nation AS nation41 ON supplier41.s_nationkey = nation41.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t305 ON nation41.n_regionkey = t305.r_regionkey INNER JOIN (SELECT t310.ps_partkey, MIN(t310.EXPR0) AS EXPR0 FROM (SELECT t308.ps_partkey, t309.n_regionkey, MIN(t308.EXPR0) AS EXPR0 FROM (SELECT t306.ps_partkey, t307.s_nationkey, MIN(t306.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t306 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t307 ON t306.ps_suppkey = t307.s_suppkey GROUP BY t306.ps_partkey, t307.s_nationkey) AS t308 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t309 ON t308.s_nationkey = t309.n_nationkey GROUP BY t308.ps_partkey, t309.n_regionkey) AS t310 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t312 ON t310.n_regionkey = t312.r_regionkey GROUP BY t310.ps_partkey) AS t313 ON t304.p_partkey = t313.ps_partkey AND partsupp41.ps_supplycost = t313.EXPR0 ORDER BY supplier41.s_acctbal DESC, nation41.n_name, supplier41.s_name, t304.p_partkey) AS t315",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1257,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '33', '30', '28', '25', '27', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '33', '30', '28', '25', '27', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1258,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 7 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 7 AND p_type LIKE '%TIN') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1259,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(4)) = 'IRAN' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BRUSHED COPPER') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1260,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 1 and l_quantity <= 1 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 15 and l_quantity <= 15 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 22 and l_quantity <= 22 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );",SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#22' AND ((part.p_container = 'SM CASE' OR part.p_container = 'SM BOX' OR part.p_container = 'SM PACK' OR part.p_container = 'SM PKG') AND lineitem.l_quantity >= 1) AND (lineitem.l_quantity <= 1 + 10 AND part.p_size >= 1 AND (part.p_size <= 5 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#22' AND ((part.p_container = 'MED BAG' OR part.p_container = 'MED BOX' OR part.p_container = 'MED PKG' OR part.p_container = 'MED PACK') AND lineitem.l_quantity >= 15) AND (lineitem.l_quantity <= 15 + 10 AND part.p_size >= 1 AND (part.p_size <= 10 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#52' AND ((part.p_container = 'LG CASE' OR part.p_container = 'LG BOX' OR part.p_container = 'LG PACK' OR part.p_container = 'LG PKG') AND lineitem.l_quantity >= 22) AND (lineitem.l_quantity <= 22 + 10 AND part.p_size >= 1 AND (part.p_size <= 15 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')));,['Empty List'],"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]"
1261,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '43', '29', '25', '35', '22', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '43', '29', '25', '35', '22', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1262,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 46 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 46 AND p_type LIKE '%NICKEL') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1263,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(6)) = 'FRANCE' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL ANODIZED TIN') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1264,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '41', '36', '44', '40', '32', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '41', '36', '44', '40', '32', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1265,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 32 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 32 AND p_type LIKE '%STEEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1266,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(5)) = 'INDIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO PLATED COPPER') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'ASIA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1267,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '37', '23', '41', '22', '43', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '37', '23', '41', '22', '43', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1268,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 6 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 6 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1269,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(6)) = 'FRANCE' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL BRUSHED STEEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1270,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '23', '22', '38', '30', '25', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '23', '22', '38', '30', '25', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1271,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 2 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 2 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1272,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '40', '43', '24', '31', '37', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '40', '43', '24', '31', '37', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1273,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD PLATED TIN') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1274,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '25', '41', '32', '39', '38', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '25', '41', '32', '39', '38', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1275,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 29 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 29 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1276,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY POLISHED NICKEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1277,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '20', '22', '28', '42', '35', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '20', '22', '28', '42', '35', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1278,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(7)) = 'VIETNAM' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BURNISHED BRASS') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'ASIA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1279,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#13' and p_type not like 'PROMO PLATED%' and p_size in (7, 11, 18, 48, 49, 9, 25, 26) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t3.p_brand, t3.p_type, t3.p_size, COUNT(t3.ps_suppkey) AS supplier_cnt FROM (SELECT t.ps_suppkey, t.p_brand, t.p_type, t.p_size FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t LEFT JOIN (SELECT s_suppkey, TRUE AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') AS t1 ON t.ps_suppkey0 = t1.s_suppkey WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#13' AND t.p_size IN (7, 9, 11, 18, 25, 26, 48, 49) AND t1.f1 IS NOT TRUE AND t.p_type NOT LIKE 'PROMO PLATED%' GROUP BY t.ps_suppkey, t.p_brand, t.p_type, t.p_size) AS t3 GROUP BY t3.p_brand, t3.p_type, t3.p_size ORDER BY COUNT(t3.ps_suppkey) DESC, t3.p_brand, t3.p_type, t3.p_size;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
1280,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '44', '23', '32', '33', '24', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '44', '23', '32', '33', '24', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1281,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 16 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 16 AND p_type LIKE '%TIN') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1282,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(4)) = 'IRAN' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BRUSHED STEEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1283,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '26', '38', '40', '20', '41', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '26', '38', '40', '20', '41', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1284,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 35 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 35 AND p_type LIKE '%BRASS') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1285,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BRUSHED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1286,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '35', '25', '43', '27', '42', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '35', '25', '43', '27', '42', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1287,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 14 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 14 AND p_type LIKE '%TIN') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1288,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'INDIA' and n2.n_name = 'KENYA') or (n1.n_name = 'KENYA' and n2.n_name = 'INDIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation205.n_name AS supp_nation, nation206.n_name AS cust_nation, EXTRACT(YEAR FROM t656.l_shipdate) AS l_year, SUM(t656.l_extendedprice * (1 - t656.l_discount)) AS revenue FROM supplier AS supplier102 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t656 ON supplier102.s_suppkey = t656.l_suppkey INNER JOIN orders AS orders102 ON t656.l_orderkey = orders102.o_orderkey INNER JOIN customer AS customer102 ON orders102.o_custkey = customer102.c_custkey INNER JOIN nation AS nation205 ON supplier102.s_nationkey = nation205.n_nationkey INNER JOIN nation AS nation206 ON customer102.c_nationkey = nation206.n_nationkey AND (nation205.n_name = 'INDIA' AND nation206.n_name = 'KENYA' OR nation205.n_name = 'KENYA' AND nation206.n_name = 'INDIA') GROUP BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate) ORDER BY nation205.n_name, nation206.n_name, EXTRACT(YEAR FROM t656.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
1289,tpch,"select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(5)) = 'KENYA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED TIN') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1290,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '36', '22', '29', '33', '25', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '36', '22', '29', '33', '25', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1291,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 49 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 49 AND p_type LIKE '%BRASS') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1292,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(6)) = 'FRANCE' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BURNISHED TIN') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1293,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '38', '34', '24', '20', '44', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '38', '34', '24', '20', '44', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1294,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 23 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 23 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1295,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(6)) = 'RUSSIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1296,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '28', '39', '42', '34', '22', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '28', '39', '42', '34', '22', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1297,tpch,"select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(13)) = 'UNITED STATES' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM POLISHED NICKEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1298,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '42', '41', '20', '24', '38', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '42', '41', '20', '24', '38', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1299,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 46 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 46 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1300,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '38', '37', '21', '43', '41', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '38', '37', '21', '43', '41', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '37') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1301,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 11 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 11 AND p_type LIKE '%TIN') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1302,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(4)) = 'IRAN' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE ANODIZED STEEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1303,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '32', '41', '44', '30', '28', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '32', '41', '44', '30', '28', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1304,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 40 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 40 AND p_type LIKE '%STEEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1305,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE POLISHED NICKEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1306,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '32', '38', '30', '36', '31', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '32', '38', '30', '36', '31', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1307,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 5 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 5 AND p_type LIKE '%NICKEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1308,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(6)) = 'CANADA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BRUSHED NICKEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1309,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '27', '38', '29', '25', '41', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '27', '38', '29', '25', '41', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '26'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '26')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1310,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 12 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 12 AND p_type LIKE '%COPPER') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1311,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('38', '28', '25', '31', '35', '32', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('38', '28', '25', '31', '35', '32', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1312,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(6)) = 'BRAZIL' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM PLATED NICKEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1313,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 41 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 41 AND p_type LIKE '%BRASS') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1314,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL POLISHED BRASS') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1315,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 31 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 31 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1316,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(8)) = 'ETHIOPIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL PLATED BRASS') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1317,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '41', '39', '33', '37', '40', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '41', '39', '33', '37', '40', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '36'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '36')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1318,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '29', '41', '20', '26', '38', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '29', '41', '20', '26', '38', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1319,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 7 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 7 AND p_type LIKE '%NICKEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1320,tpch,"select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(13)) = 'UNITED STATES' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BURNISHED COPPER') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1321,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '20', '30', '21', '38', '37', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '20', '30', '21', '38', '37', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1322,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 30 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 30 AND p_type LIKE '%STEEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1323,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM POLISHED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1324,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '20', '29', '37', '21', '39', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '20', '29', '37', '21', '39', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1325,tpch,"select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(4)) = 'IRAQ' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL ANODIZED STEEL') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1326,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '40', '29', '42', '27', '28', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '40', '29', '42', '27', '28', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '26'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '26')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1327,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 9 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 9 AND p_type LIKE '%TIN') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1328,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(7)) = 'VIETNAM' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED NICKEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'ASIA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1329,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '30', '23', '29', '22', '33', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '30', '23', '29', '22', '33', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1330,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 43 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 43 AND p_type LIKE '%TIN') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1331,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(6)) = 'BRAZIL' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO POLISHED BRASS') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1332,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '37', '20', '21', '38', '35', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '37', '20', '21', '38', '35', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1333,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 22 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 22 AND p_type LIKE '%STEEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1334,tpch,"select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(7)) = 'MOROCCO' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BURNISHED TIN') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1335,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '38', '29', '24', '44', '21', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '38', '29', '24', '44', '21', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '37'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '37')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1336,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 32 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 32 AND p_type LIKE '%BRASS') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1337,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BURNISHED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1338,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '40', '22', '26', '39', '35', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '40', '22', '26', '39', '35', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1339,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(6)) = 'BRAZIL' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO POLISHED TIN') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1340,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 10 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 10 AND p_type LIKE '%BRASS') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1341,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(7)) = 'GERMANY' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BRUSHED TIN') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1342,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ROMANIA' and n2.n_name = 'RUSSIA') or (n1.n_name = 'RUSSIA' and n2.n_name = 'ROMANIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation203.n_name AS supp_nation, nation204.n_name AS cust_nation, EXTRACT(YEAR FROM t647.l_shipdate) AS l_year, SUM(t647.l_extendedprice * (1 - t647.l_discount)) AS revenue FROM supplier AS supplier101 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t647 ON supplier101.s_suppkey = t647.l_suppkey INNER JOIN orders AS orders101 ON t647.l_orderkey = orders101.o_orderkey INNER JOIN customer AS customer101 ON orders101.o_custkey = customer101.c_custkey INNER JOIN nation AS nation203 ON supplier101.s_nationkey = nation203.n_nationkey INNER JOIN nation AS nation204 ON customer101.c_nationkey = nation204.n_nationkey AND (nation203.n_name = 'ROMANIA' AND nation204.n_name = 'RUSSIA' OR nation203.n_name = 'RUSSIA' AND nation204.n_name = 'ROMANIA') GROUP BY nation203.n_name, nation204.n_name, EXTRACT(YEAR FROM t647.l_shipdate) ORDER BY nation203.n_name, nation204.n_name, EXTRACT(YEAR FROM t647.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
1343,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BURNISHED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1344,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '35', '29', '27', '40', '28', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '35', '29', '27', '40', '28', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1345,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(5)) = 'EGYPT' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BURNISHED NICKEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1346,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '32', '27', '40', '22', '23', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '32', '27', '40', '22', '23', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1347,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 25 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 25 AND p_type LIKE '%COPPER') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1348,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL PLATED BRASS') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1349,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '42', '32', '31', '25', '35', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '42', '32', '31', '25', '35', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '37'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '37')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1350,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 18 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 18 AND p_type LIKE '%BRASS') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1351,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('41', '25', '21', '26', '28', '32', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('41', '25', '21', '26', '28', '32', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '36'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '36')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1352,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 45 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 45 AND p_type LIKE '%TIN') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1353,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(10)) = 'MOZAMBIQUE' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BRUSHED COPPER') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1354,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '39', '27', '30', '21', '23', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '39', '27', '30', '21', '23', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '22'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '22')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1355,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 32 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 32 AND p_type LIKE '%BRASS') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1356,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(6)) = 'RUSSIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM POLISHED TIN') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1357,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '31', '22', '20', '24', '25', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '31', '22', '20', '24', '25', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1358,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(4)) = 'IRAN' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM ANODIZED BRASS') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1359,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '31', '25', '27', '39', '42', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '31', '25', '27', '39', '42', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '22'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '22')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t2.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t2.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t2.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1360,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 3 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 3 AND p_type LIKE '%TIN') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1361,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(4)) = 'IRAN' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED NICKEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1362,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '31', '39', '27', '22', '29', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '31', '39', '27', '22', '29', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1363,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 44 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 44 AND p_type LIKE '%TIN') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1364,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '42', '43', '22', '35', '27', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '42', '43', '22', '35', '27', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1365,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 17 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 17 AND p_type LIKE '%BRASS') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1366,tpch,"select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'IRAQ' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BURNISHED NICKEL') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate);",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1367,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '28', '41', '40', '44', '21', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '28', '41', '40', '44', '21', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '37'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '37')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1368,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 27 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT supplier.s_acctbal, supplier.s_name, nation.n_name, t.p_partkey, t.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment FROM (SELECT * FROM part WHERE p_size = 27 AND p_type LIKE '%BRASS') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT partsupp0.ps_partkey, MIN(partsupp0.ps_supplycost) AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN nation AS nation0 ON supplier0.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1 ON nation0.n_regionkey = t1.r_regionkey GROUP BY partsupp0.ps_partkey) AS t3 ON t.p_partkey = t3.ps_partkey AND partsupp.ps_supplycost = t3.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey;",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1369,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'INDONESIA' and n2.n_name = 'MOROCCO') or (n1.n_name = 'MOROCCO' and n2.n_name = 'INDONESIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation203.n_name AS supp_nation, nation204.n_name AS cust_nation, EXTRACT(YEAR FROM t647.l_shipdate) AS l_year, SUM(t647.l_extendedprice * (1 - t647.l_discount)) AS revenue FROM supplier AS supplier101 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t647 ON supplier101.s_suppkey = t647.l_suppkey INNER JOIN orders AS orders101 ON t647.l_orderkey = orders101.o_orderkey INNER JOIN customer AS customer101 ON orders101.o_custkey = customer101.c_custkey INNER JOIN nation AS nation203 ON supplier101.s_nationkey = nation203.n_nationkey INNER JOIN nation AS nation204 ON customer101.c_nationkey = nation204.n_nationkey AND (nation203.n_name = 'INDONESIA' AND nation204.n_name = 'MOROCCO' OR nation203.n_name = 'MOROCCO' AND nation204.n_name = 'INDONESIA') GROUP BY nation203.n_name, nation204.n_name, EXTRACT(YEAR FROM t647.l_shipdate) ORDER BY nation203.n_name, nation204.n_name, EXTRACT(YEAR FROM t647.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
1370,tpch,"select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(7)) = 'MOROCCO' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BURNISHED NICKEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1371,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 48 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 48 AND p_type LIKE '%COPPER') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1372,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(6)) = 'BRAZIL' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM POLISHED STEEL') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1373,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '30', '38', '34', '32', '41', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '30', '38', '34', '32', '41', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1374,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'CANADA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL POLISHED COPPER') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1375,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 21 and l_quantity <= 21 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );",SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#52' AND ((part.p_container = 'SM CASE' OR part.p_container = 'SM BOX' OR part.p_container = 'SM PACK' OR part.p_container = 'SM PKG') AND lineitem.l_quantity >= 2) AND (lineitem.l_quantity <= 2 + 10 AND part.p_size >= 1 AND (part.p_size <= 5 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#13' AND ((part.p_container = 'MED BAG' OR part.p_container = 'MED BOX' OR part.p_container = 'MED PKG' OR part.p_container = 'MED PACK') AND lineitem.l_quantity >= 19) AND (lineitem.l_quantity <= 19 + 10 AND part.p_size >= 1 AND (part.p_size <= 10 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#45' AND ((part.p_container = 'LG CASE' OR part.p_container = 'LG BOX' OR part.p_container = 'LG PACK' OR part.p_container = 'LG PKG') AND lineitem.l_quantity >= 21) AND (lineitem.l_quantity <= 21 + 10 AND part.p_size >= 1 AND (part.p_size <= 15 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')));,['Empty List'],"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]"
1376,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '39', '41', '26', '22', '28', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '39', '41', '26', '22', '28', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '41') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1377,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 12 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 12 AND p_type LIKE '%STEEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1378,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'GERMANY' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE ANODIZED NICKEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1379,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '43', '22', '20', '44', '25', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '43', '22', '20', '44', '25', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1380,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(8)) = 'ETHIOPIA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO PLATED TIN') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1381,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '29', '43', '30', '32', '26', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '29', '43', '30', '32', '26', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '37'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '37')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1382,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 31 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT supplier.s_acctbal, supplier.s_name, nation.n_name, t.p_partkey, t.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment FROM (SELECT * FROM part WHERE p_size = 31 AND p_type LIKE '%TIN') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT t5.ps_partkey, MIN(t5.EXPR0) AS EXPR0 FROM (SELECT t3.ps_partkey, t4.n_regionkey, MIN(t3.EXPR0) AS EXPR0 FROM (SELECT t1.ps_partkey, t2.s_nationkey, MIN(t1.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t2 ON t1.ps_suppkey = t2.s_suppkey GROUP BY t1.ps_partkey, t2.s_nationkey) AS t3 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t4 ON t3.s_nationkey = t4.n_nationkey GROUP BY t3.ps_partkey, t4.n_regionkey) AS t5 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t7 ON t5.n_regionkey = t7.r_regionkey GROUP BY t5.ps_partkey) AS t8 ON t.p_partkey = t8.ps_partkey AND partsupp.ps_supplycost = t8.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey;",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1383,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(9)) = 'INDONESIA' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'PROMO POLISHED BRASS') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1384,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '32', '30', '42', '43', '37', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '32', '30', '42', '43', '37', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1385,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 34 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t315.s_acctbal, t315.s_name, t315.n_name, t315.p_partkey, t315.p_mfgr, t315.s_address, t315.s_phone, t315.s_comment FROM (SELECT t304.p_partkey, t304.p_name, t304.p_mfgr, t304.p_brand, t304.p_type, t304.p_size, t304.p_container, t304.p_retailprice, t304.p_comment, supplier41.s_suppkey, supplier41.s_name, supplier41.s_address, supplier41.s_nationkey, supplier41.s_phone, supplier41.s_acctbal, supplier41.s_comment, partsupp41.ps_partkey, partsupp41.ps_suppkey, partsupp41.ps_availqty, partsupp41.ps_supplycost, partsupp41.ps_comment, nation41.n_nationkey, nation41.n_name, nation41.n_regionkey, nation41.n_comment, t305.r_regionkey, t305.r_name, t305.r_comment, CAST(t313.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t313.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 34 AND p_type LIKE '%TIN') AS t304 CROSS JOIN supplier AS supplier41 INNER JOIN partsupp AS partsupp41 ON t304.p_partkey = partsupp41.ps_partkey AND supplier41.s_suppkey = partsupp41.ps_suppkey INNER JOIN nation AS nation41 ON supplier41.s_nationkey = nation41.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t305 ON nation41.n_regionkey = t305.r_regionkey INNER JOIN (SELECT t310.ps_partkey, MIN(t310.EXPR0) AS EXPR0 FROM (SELECT t308.ps_partkey, t309.n_regionkey, MIN(t308.EXPR0) AS EXPR0 FROM (SELECT t306.ps_partkey, t307.s_nationkey, MIN(t306.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t306 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t307 ON t306.ps_suppkey = t307.s_suppkey GROUP BY t306.ps_partkey, t307.s_nationkey) AS t308 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t309 ON t308.s_nationkey = t309.n_nationkey GROUP BY t308.ps_partkey, t309.n_regionkey) AS t310 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t312 ON t310.n_regionkey = t312.r_regionkey GROUP BY t310.ps_partkey) AS t313 ON t304.p_partkey = t313.ps_partkey AND partsupp41.ps_supplycost = t313.EXPR0 ORDER BY supplier41.s_acctbal DESC, nation41.n_name, supplier41.s_name, t304.p_partkey) AS t315",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1386,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(5)) = 'JAPAN' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BRUSHED COPPER') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1387,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 13 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 13 AND p_type LIKE '%STEEL') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1388,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(7)) = 'ALGERIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL PLATED BRASS') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1389,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '37', '30', '36', '22', '21', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '37', '30', '36', '22', '21', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '40'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '40')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1390,tpch,"select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(12)) = 'SAUDI ARABIA' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL ANODIZED COPPER') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1391,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '23', '21', '36', '20', '34', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '23', '21', '36', '20', '34', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '37'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '37')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1392,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 26 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 26 AND p_type LIKE '%BRASS') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1393,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(6)) = 'RUSSIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED TIN') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1394,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '37', '25', '40', '31', '32', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '37', '25', '40', '31', '32', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1395,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(4)) = 'PERU' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY POLISHED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1396,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '23', '38', '44', '41', '31', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '23', '38', '44', '41', '31', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '38') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1397,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 16 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 16 AND p_type LIKE '%BRASS') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1398,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '35', '32', '37', '20', '24', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '35', '32', '37', '20', '24', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1399,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '36', '29', '24', '20', '39', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '36', '29', '24', '20', '39', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '40'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '40')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1400,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 2 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 2 AND p_type LIKE '%STEEL') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1401,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(4)) = 'PERU' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE POLISHED NICKEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1402,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '37', '39', '25', '32', '30', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '37', '39', '25', '32', '30', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1403,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 3 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 3 AND p_type LIKE '%BRASS') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1404,tpch,"select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(5)) = 'KENYA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE PLATED COPPER') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1405,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '25', '43', '20', '24', '26', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '25', '43', '20', '24', '26', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '40'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '40')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1406,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 46 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 46 AND p_type LIKE '%TIN') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1407,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t5.o_orderdate) AS o_year, SUM(CASE WHEN t5.n_name0 = 'INDONESIA' THEN t5.l_extendedprice * (1 - t5.l_discount) ELSE 0 END) / SUM(t5.l_extendedprice * (1 - t5.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED TIN') AS t, supplier, lineitem WHERE t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey) AS t0, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t1 WHERE t0.l_orderkey = t1.o_orderkey) AS t2, customer WHERE t2.o_custkey = customer.c_custkey) AS t3, nation WHERE t3.c_nationkey = nation.n_nationkey) AS t4, nation AS nation0 WHERE t4.s_nationkey = nation0.n_nationkey) AS t5, (SELECT * FROM region WHERE r_name = 'ASIA') AS t6 WHERE t5.n_regionkey = t6.r_regionkey GROUP BY EXTRACT(YEAR FROM t5.o_orderdate) ORDER BY EXTRACT(YEAR FROM t5.o_orderdate);",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1408,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(6)) = 'RUSSIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BRUSHED BRASS') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1409,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '31', '39', '24', '41', '40', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '31', '39', '24', '41', '40', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1410,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 22 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 22 AND p_type LIKE '%BRASS') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1411,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '25', '36', '42', '35', '33', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '25', '36', '42', '35', '33', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1412,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 32 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 32 AND p_type LIKE '%COPPER') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1413,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(5)) = 'JAPAN' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE POLISHED STEEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'ASIA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1414,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#53' and p_type not like 'ECONOMY ANODIZED%' and p_size in (24, 49, 3, 25, 20, 37, 5, 14) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t4.p_brand, t4.p_type, t4.p_size, COUNT(t4.ps_suppkey) AS supplier_cnt FROM (SELECT t0.ps_suppkey, t0.p_brand, t0.p_type, t0.p_size FROM (SELECT * FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#53' AND t.p_size IN (3, 5, 14, 20, 24, 25, 37, 49) AND t.p_type NOT LIKE 'ECONOMY ANODIZED%') AS t0 LEFT JOIN (SELECT s_suppkey, TRUE AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') AS t2 ON t0.ps_suppkey0 = t2.s_suppkey WHERE t2.f1 IS NOT TRUE GROUP BY t0.ps_suppkey, t0.p_brand, t0.p_type, t0.p_size) AS t4 GROUP BY t4.p_brand, t4.p_type, t4.p_size ORDER BY COUNT(t4.ps_suppkey) DESC, t4.p_brand, t4.p_type, t4.p_size;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
1415,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 8 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 8 AND p_type LIKE '%BRASS') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1416,tpch,"select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(5)) = 'KENYA' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL BURNISHED COPPER') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1417,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '43', '39', '33', '38', '22', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '43', '39', '33', '38', '22', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1418,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(9)) = 'INDONESIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL ANODIZED COPPER') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'ASIA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1419,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '24', '39', '34', '29', '21', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '24', '39', '34', '29', '21', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1420,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 31 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 31 AND p_type LIKE '%BRASS') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1421,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED COPPER') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1422,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '20', '36', '21', '31', '43', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '20', '36', '21', '31', '43', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '27'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '27')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1423,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(6)) = 'RUSSIA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL POLISHED COPPER') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1424,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '44', '43', '22', '37', '26', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '44', '43', '22', '37', '26', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1425,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 44 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 44 AND p_type LIKE '%TIN') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1426,tpch,"select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(12)) = 'SAUDI ARABIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED STEEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1427,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '23', '32', '22', '37', '26', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '23', '32', '22', '37', '26', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1428,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 29 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 29 AND p_type LIKE '%STEEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1429,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(8)) = 'ETHIOPIA' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BURNISHED BRASS') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1430,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '33', '43', '34', '39', '26', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '33', '43', '34', '39', '26', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1431,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 8 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 8 AND p_type LIKE '%NICKEL') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1432,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(4)) = 'PERU' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY POLISHED COPPER') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1433,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '34', '39', '43', '24', '30', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '34', '39', '43', '24', '30', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1434,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(6)) = 'FRANCE' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BURNISHED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1435,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '23', '39', '26', '21', '22', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '23', '39', '26', '21', '22', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1436,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 32 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 32 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1437,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(14)) = 'UNITED KINGDOM' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BRUSHED STEEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1438,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '34', '25', '35', '44', '20', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '34', '25', '35', '44', '20', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1439,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 39 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 39 AND p_type LIKE '%BRASS') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1440,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(9)) = 'INDONESIA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BURNISHED NICKEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'ASIA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1441,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '36', '21', '37', '33', '43', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '36', '21', '37', '33', '43', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1442,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '20', '34', '33', '43', '44', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '20', '34', '33', '43', '44', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '34') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1443,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 4 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 4 AND p_type LIKE '%NICKEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1444,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(4)) = 'IRAN' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO PLATED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1445,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '33', '29', '27', '38', '22', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '33', '29', '27', '38', '22', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1446,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 47 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 47 AND p_type LIKE '%COPPER') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1447,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t926.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t926.n_name0 AS CHAR(9)) = 'INDONESIA' THEN t926.l_extendedprice * (1 - t926.l_discount) ELSE 0 END) / SUM(t926.l_extendedprice * (1 - t926.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BURNISHED BRASS') AS t920, supplier AS supplier100, lineitem AS lineitem100 WHERE t920.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t921, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t922 WHERE t921.l_orderkey = t922.o_orderkey) AS t923, customer AS customer100 WHERE t923.o_custkey = customer100.c_custkey) AS t924, nation AS nation201 WHERE t924.c_nationkey = nation201.n_nationkey) AS t925, nation AS nation202 WHERE t925.s_nationkey = nation202.n_nationkey) AS t926, (SELECT * FROM region WHERE r_name = 'ASIA') AS t927 WHERE t926.n_regionkey = t927.r_regionkey GROUP BY EXTRACT(YEAR FROM t926.o_orderdate) ORDER BY EXTRACT(YEAR FROM t926.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1448,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '37', '29', '31', '25', '20', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '37', '29', '31', '25', '20', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1449,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 38 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 38 AND p_type LIKE '%STEEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1450,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(8)) = 'ETHIOPIA' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'PROMO BURNISHED TIN') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1451,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '20', '29', '28', '22', '21', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '20', '29', '28', '22', '21', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1452,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 12 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1644.s_acctbal, t1644.s_name, t1644.n_name, t1644.p_partkey, t1644.p_mfgr, t1644.s_address, t1644.s_phone, t1644.s_comment FROM (SELECT t1630.p_partkey, t1630.p_name, t1630.p_mfgr, t1630.p_brand, t1630.p_type, t1630.p_size, t1630.p_container, t1630.p_retailprice, t1630.p_comment, t1630.s_suppkey, t1630.s_name, t1630.s_address, t1630.s_nationkey, t1630.s_phone, t1630.s_acctbal, t1630.s_comment, t1630.ps_partkey, t1630.ps_suppkey, t1630.ps_availqty, t1630.ps_supplycost, t1630.ps_comment, t1630.n_nationkey, t1630.n_name, t1630.n_regionkey, t1630.n_comment, t1630.r_regionkey, t1630.r_name, t1630.r_comment, CAST(t1641.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1641.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 12 AND p_type LIKE '%TIN') AS t1626, supplier AS supplier205, partsupp AS partsupp205 WHERE t1626.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1627, nation AS nation205 WHERE t1627.s_nationkey = nation205.n_nationkey) AS t1628, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1629 WHERE t1628.n_regionkey = t1629.r_regionkey) AS t1630, (SELECT t1637.ps_partkey, MIN(t1637.EXPR0) AS EXPR0 FROM (SELECT t1634.ps_partkey, t1635.n_regionkey, MIN(t1634.EXPR0) AS EXPR0 FROM (SELECT t1631.ps_partkey, t1632.s_nationkey, MIN(t1631.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1631, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1632 WHERE t1632.s_suppkey = t1631.ps_suppkey GROUP BY t1631.ps_partkey, t1632.s_nationkey) AS t1634, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1635 WHERE t1634.s_nationkey = t1635.n_nationkey GROUP BY t1634.ps_partkey, t1635.n_regionkey) AS t1637, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1639 WHERE t1637.n_regionkey = t1639.r_regionkey GROUP BY t1637.ps_partkey) AS t1641 WHERE t1630.p_partkey = t1641.ps_partkey AND t1630.ps_supplycost = t1641.EXPR0 ORDER BY t1630.s_acctbal DESC, t1630.n_name, t1630.s_name, t1630.p_partkey) AS t1644",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1453,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(6)) = 'CANADA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL PLATED COPPER') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1454,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '25', '27', '24', '38', '41', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '25', '27', '24', '38', '41', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1455,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 1 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 1 AND p_type LIKE '%BRASS') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1456,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '35', '27', '25', '20', '30', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '35', '27', '25', '20', '30', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1457,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 22 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 22 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1458,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(5)) = 'EGYPT' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'STANDARD PLATED COPPER') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1459,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '34', '30', '39', '20', '27', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '34', '30', '39', '20', '27', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '32')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1460,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 19 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 19 AND p_type LIKE '%STEEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1461,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BURNISHED BRASS') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1462,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '31', '27', '32', '20', '30', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '31', '27', '32', '20', '30', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1463,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 26 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 26 AND p_type LIKE '%TIN') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1464,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'ARGENTINA' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'STANDARD BURNISHED BRASS') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate);",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1465,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '32', '43', '27', '36', '24', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '32', '43', '27', '36', '24', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1466,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 47 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 47 AND p_type LIKE '%BRASS') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1467,tpch,"select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(6)) = 'JORDAN' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BRUSHED TIN') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1468,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '20', '23', '40', '30', '33', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '20', '23', '40', '30', '33', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '29'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '29')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1469,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 13 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 13 AND p_type LIKE '%TIN') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1470,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(7)) = 'VIETNAM' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'PROMO BRUSHED COPPER') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1471,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '42', '36', '27', '25', '33', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '42', '36', '27', '25', '33', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1472,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BURNISHED STEEL') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1473,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 25 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 25 AND p_type LIKE '%STEEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1474,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(6)) = 'RUSSIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED STEEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1475,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '33', '32', '41', '22', '26', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '33', '32', '41', '22', '26', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '36'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '36')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1476,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 15 AND p_type LIKE '%TIN') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1477,tpch,"select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(5)) = 'CHINA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM PLATED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'ASIA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1478,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '32', '29', '38', '37', '22', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '32', '29', '38', '37', '22', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '29') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1479,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 7 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 7 AND p_type LIKE '%BRASS') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1480,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '37', '32', '34', '40', '26', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '37', '32', '34', '40', '26', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '22'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '22')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1481,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 28 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 28 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1482,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BURNISHED TIN') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1483,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 38 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 38 AND p_type LIKE '%BRASS') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1484,tpch,"select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(10)) = 'MOZAMBIQUE' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED NICKEL') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1485,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '42', '27', '34', '20', '31', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '42', '27', '34', '20', '31', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '44'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '44')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1486,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 5 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t315.s_acctbal, t315.s_name, t315.n_name, t315.p_partkey, t315.p_mfgr, t315.s_address, t315.s_phone, t315.s_comment FROM (SELECT t304.p_partkey, t304.p_name, t304.p_mfgr, t304.p_brand, t304.p_type, t304.p_size, t304.p_container, t304.p_retailprice, t304.p_comment, supplier41.s_suppkey, supplier41.s_name, supplier41.s_address, supplier41.s_nationkey, supplier41.s_phone, supplier41.s_acctbal, supplier41.s_comment, partsupp41.ps_partkey, partsupp41.ps_suppkey, partsupp41.ps_availqty, partsupp41.ps_supplycost, partsupp41.ps_comment, nation41.n_nationkey, nation41.n_name, nation41.n_regionkey, nation41.n_comment, t305.r_regionkey, t305.r_name, t305.r_comment, CAST(t313.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t313.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 5 AND p_type LIKE '%TIN') AS t304 CROSS JOIN supplier AS supplier41 INNER JOIN partsupp AS partsupp41 ON t304.p_partkey = partsupp41.ps_partkey AND supplier41.s_suppkey = partsupp41.ps_suppkey INNER JOIN nation AS nation41 ON supplier41.s_nationkey = nation41.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t305 ON nation41.n_regionkey = t305.r_regionkey INNER JOIN (SELECT t310.ps_partkey, MIN(t310.EXPR0) AS EXPR0 FROM (SELECT t308.ps_partkey, t309.n_regionkey, MIN(t308.EXPR0) AS EXPR0 FROM (SELECT t306.ps_partkey, t307.s_nationkey, MIN(t306.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t306 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t307 ON t306.ps_suppkey = t307.s_suppkey GROUP BY t306.ps_partkey, t307.s_nationkey) AS t308 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t309 ON t308.s_nationkey = t309.n_nationkey GROUP BY t308.ps_partkey, t309.n_regionkey) AS t310 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t312 ON t310.n_regionkey = t312.r_regionkey GROUP BY t310.ps_partkey) AS t313 ON t304.p_partkey = t313.ps_partkey AND partsupp41.ps_supplycost = t313.EXPR0 ORDER BY supplier41.s_acctbal DESC, nation41.n_name, supplier41.s_name, t304.p_partkey) AS t315",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1487,tpch,"select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(5)) = 'KENYA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE PLATED BRASS') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1488,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '30', '36', '20', '43', '33', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '30', '36', '20', '43', '33', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '31'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '31')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1489,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 33 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 33 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1490,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED TIN') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1491,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '30', '32', '44', '20', '36', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '30', '32', '44', '20', '36', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '24'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '24')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1492,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 13 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 13 AND p_type LIKE '%NICKEL') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1493,tpch,"select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t919.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t919.n_name0 AS CHAR(5)) = 'CHINA' THEN t919.l_extendedprice * (1 - t919.l_discount) ELSE 0 END) / SUM(t919.l_extendedprice * (1 - t919.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM PLATED COPPER') AS t913, supplier AS supplier99, lineitem AS lineitem99 WHERE t913.p_partkey = lineitem99.l_partkey AND supplier99.s_suppkey = lineitem99.l_suppkey) AS t914, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t915 WHERE t914.l_orderkey = t915.o_orderkey) AS t916, customer AS customer99 WHERE t916.o_custkey = customer99.c_custkey) AS t917, nation AS nation199 WHERE t917.c_nationkey = nation199.n_nationkey) AS t918, nation AS nation200 WHERE t918.s_nationkey = nation200.n_nationkey) AS t919, (SELECT * FROM region WHERE r_name = 'ASIA') AS t920 WHERE t919.n_regionkey = t920.r_regionkey GROUP BY EXTRACT(YEAR FROM t919.o_orderdate) ORDER BY EXTRACT(YEAR FROM t919.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1494,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '27', '36', '39', '23', '43', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '27', '36', '39', '23', '43', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '25'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '23' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '25')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1495,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 42 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 42 AND p_type LIKE '%TIN') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1496,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-28' and l_shipdate > date '1995-03-28' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t800.l_orderkey, SUM(t800.l_extendedprice * (1 - t800.l_discount)) AS revenue, t799.o_orderdate, t799.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'HOUSEHOLD') AS t797, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-28') AS t798 WHERE t797.c_custkey = t798.o_custkey) AS t799, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-28') AS t800 WHERE t800.l_orderkey = t799.o_orderkey GROUP BY t800.l_orderkey, t799.o_orderdate, t799.o_shippriority ORDER BY SUM(t800.l_extendedprice * (1 - t800.l_discount)) DESC, t799.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
1497,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(9)) = 'INDONESIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL BURNISHED NICKEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'ASIA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1498,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '44', '23', '35', '31', '43', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '44', '23', '35', '31', '43', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1499,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 45 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 45 AND p_type LIKE '%TIN') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1500,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '24', '27', '42', '33', '40', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '24', '27', '42', '33', '40', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '27') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1501,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 6 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 6 AND p_type LIKE '%TIN') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1502,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(4)) = 'PERU' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL PLATED COPPER') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1503,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '26', '20', '44', '27', '36', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '26', '20', '44', '27', '36', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '20') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1504,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(8)) = 'ETHIOPIA' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM ANODIZED BRASS') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1505,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '27', '39', '31', '33', '22', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '27', '39', '31', '33', '22', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1506,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 18 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 18 AND p_type LIKE '%STEEL') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1507,tpch,"select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(4)) = 'IRAQ' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED STEEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1508,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '34', '25', '38', '42', '24', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '34', '25', '38', '42', '24', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1509,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 6 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 6 AND p_type LIKE '%NICKEL') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1510,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'CANADA' and n2.n_name = 'CHINA') or (n1.n_name = 'CHINA' and n2.n_name = 'CANADA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation203.n_name AS supp_nation, nation204.n_name AS cust_nation, EXTRACT(YEAR FROM t647.l_shipdate) AS l_year, SUM(t647.l_extendedprice * (1 - t647.l_discount)) AS revenue FROM supplier AS supplier101 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t647 ON supplier101.s_suppkey = t647.l_suppkey INNER JOIN orders AS orders101 ON t647.l_orderkey = orders101.o_orderkey INNER JOIN customer AS customer101 ON orders101.o_custkey = customer101.c_custkey INNER JOIN nation AS nation203 ON supplier101.s_nationkey = nation203.n_nationkey INNER JOIN nation AS nation204 ON customer101.c_nationkey = nation204.n_nationkey AND (nation203.n_name = 'CANADA' AND nation204.n_name = 'CHINA' OR nation203.n_name = 'CHINA' AND nation204.n_name = 'CANADA') GROUP BY nation203.n_name, nation204.n_name, EXTRACT(YEAR FROM t647.l_shipdate) ORDER BY nation203.n_name, nation204.n_name, EXTRACT(YEAR FROM t647.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
1511,tpch,"select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(6)) = 'CANADA' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED STEEL') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1512,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '32', '22', '28', '44', '35', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '32', '22', '28', '44', '35', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '26'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '22') OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '44' OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '26')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1513,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 47 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 47 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1514,tpch,"select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation0.n_name AS CHAR(6)) = 'JORDAN' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM PLATED NICKEL') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate);",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1515,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '28', '43', '41', '31', '26', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '28', '43', '41', '31', '26', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '38'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '38')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1516,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 18 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 18 AND p_type LIKE '%NICKEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1517,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(7)) = 'ALGERIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL BRUSHED STEEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1518,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '20', '23', '33', '25', '43', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '20', '23', '33', '25', '43', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '41'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '41')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1519,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 33 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 33 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1520,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(8)) = 'ETHIOPIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM ANODIZED COPPER') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1521,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '22', '23', '32', '35', '33', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '22', '23', '32', '35', '33', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '36'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '36')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1522,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD BRUSHED BRASS') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1523,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('38', '42', '43', '24', '32', '36', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('38', '42', '43', '24', '32', '36', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '25'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '25')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1524,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED COPPER') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1525,tpch,"select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t980.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t980.n_name0 AS CHAR(5)) = 'CHINA' THEN t980.l_extendedprice * (1 - t980.l_discount) ELSE 0 END) / SUM(t980.l_extendedprice * (1 - t980.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE POLISHED TIN') AS t974, supplier AS supplier100, lineitem AS lineitem100 WHERE t974.p_partkey = lineitem100.l_partkey AND supplier100.s_suppkey = lineitem100.l_suppkey) AS t975, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t976 WHERE t975.l_orderkey = t976.o_orderkey) AS t977, customer AS customer100 WHERE t977.o_custkey = customer100.c_custkey) AS t978, nation AS nation201 WHERE t978.c_nationkey = nation201.n_nationkey) AS t979, nation AS nation202 WHERE t979.s_nationkey = nation202.n_nationkey) AS t980, (SELECT * FROM region WHERE r_name = 'ASIA') AS t981 WHERE t980.n_regionkey = t981.r_regionkey GROUP BY EXTRACT(YEAR FROM t980.o_orderdate) ORDER BY EXTRACT(YEAR FROM t980.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1526,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 42 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 42 AND p_type LIKE '%COPPER') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1527,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(6)) = 'FRANCE' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'LARGE ANODIZED BRASS') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1528,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '28', '32', '25', '24', '26', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '28', '32', '25', '24', '26', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '39'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '39')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1529,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 40 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1581.s_acctbal, t1581.s_name, t1581.n_name, t1581.p_partkey, t1581.p_mfgr, t1581.s_address, t1581.s_phone, t1581.s_comment FROM (SELECT t1567.p_partkey, t1567.p_name, t1567.p_mfgr, t1567.p_brand, t1567.p_type, t1567.p_size, t1567.p_container, t1567.p_retailprice, t1567.p_comment, t1567.s_suppkey, t1567.s_name, t1567.s_address, t1567.s_nationkey, t1567.s_phone, t1567.s_acctbal, t1567.s_comment, t1567.ps_partkey, t1567.ps_suppkey, t1567.ps_availqty, t1567.ps_supplycost, t1567.ps_comment, t1567.n_nationkey, t1567.n_name, t1567.n_regionkey, t1567.n_comment, t1567.r_regionkey, t1567.r_name, t1567.r_comment, CAST(t1578.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1578.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 40 AND p_type LIKE '%TIN') AS t1563, supplier AS supplier205, partsupp AS partsupp205 WHERE t1563.p_partkey = partsupp205.ps_partkey AND supplier205.s_suppkey = partsupp205.ps_suppkey) AS t1564, nation AS nation205 WHERE t1564.s_nationkey = nation205.n_nationkey) AS t1565, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1566 WHERE t1565.n_regionkey = t1566.r_regionkey) AS t1567, (SELECT t1574.ps_partkey, MIN(t1574.EXPR0) AS EXPR0 FROM (SELECT t1571.ps_partkey, t1572.n_regionkey, MIN(t1571.EXPR0) AS EXPR0 FROM (SELECT t1568.ps_partkey, t1569.s_nationkey, MIN(t1568.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1568, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1569 WHERE t1569.s_suppkey = t1568.ps_suppkey GROUP BY t1568.ps_partkey, t1569.s_nationkey) AS t1571, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1572 WHERE t1571.s_nationkey = t1572.n_nationkey GROUP BY t1571.ps_partkey, t1572.n_regionkey) AS t1574, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1576 WHERE t1574.n_regionkey = t1576.r_regionkey GROUP BY t1574.ps_partkey) AS t1578 WHERE t1567.p_partkey = t1578.ps_partkey AND t1567.ps_supplycost = t1578.EXPR0 ORDER BY t1567.s_acctbal DESC, t1567.n_name, t1567.s_name, t1567.p_partkey) AS t1581",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1530,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-16' and l_shipdate > date '1995-03-16' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t793.l_orderkey, SUM(t793.l_extendedprice * (1 - t793.l_discount)) AS revenue, t792.o_orderdate, t792.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'HOUSEHOLD') AS t790, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-16') AS t791 WHERE t790.c_custkey = t791.o_custkey) AS t792, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-16') AS t793 WHERE t793.l_orderkey = t792.o_orderkey GROUP BY t793.l_orderkey, t792.o_orderdate, t792.o_shippriority ORDER BY SUM(t793.l_extendedprice * (1 - t793.l_discount)) DESC, t792.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
1531,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(9)) = 'INDONESIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED TIN') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1532,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '38', '39', '36', '33', '30', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '38', '39', '36', '33', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1533,tpch,"select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(13)) = 'UNITED STATES' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BURNISHED TIN') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1534,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#23' and p_type not like 'STANDARD ANODIZED%' and p_size in (41, 11, 17, 36, 49, 23, 7, 8) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t3.p_brand, t3.p_type, t3.p_size, COUNT(t3.ps_suppkey) AS supplier_cnt FROM (SELECT t.ps_suppkey, t.p_brand, t.p_type, t.p_size FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t LEFT JOIN (SELECT s_suppkey, TRUE AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') AS t1 ON t.ps_suppkey0 = t1.s_suppkey WHERE t.p_partkey = t.ps_partkey AND t.p_brand <> 'Brand#23' AND t.p_type NOT LIKE 'STANDARD ANODIZED%' AND (t.p_size = 41 OR t.p_size = 11 OR (t.p_size = 17 OR t.p_size = 36) OR (t.p_size = 49 OR t.p_size = 23 OR (t.p_size = 7 OR t.p_size = 8))) AND NOT (t1.f1 IS TRUE AND t.ps_suppkey0 IS NOT NULL) GROUP BY t.ps_suppkey, t.p_brand, t.p_type, t.p_size) AS t3 GROUP BY t3.p_brand, t3.p_type, t3.p_size ORDER BY COUNT(t3.ps_suppkey) DESC, t3.p_brand, t3.p_type, t3.p_size;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
1535,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '44', '30', '23', '24', '20', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '44', '30', '23', '24', '20', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '36'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '23' OR SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '36')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1536,tpch,"select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(9)) = 'ARGENTINA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED BRASS') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1537,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '34', '32', '26', '35', '36', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '34', '32', '26', '35', '36', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '25' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '35' OR (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1538,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 19 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT supplier.s_acctbal, supplier.s_name, nation.n_name, t.p_partkey, t.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment FROM (SELECT * FROM part WHERE p_size = 19 AND p_type LIKE '%STEEL') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT t5.ps_partkey, MIN(t5.EXPR0) AS EXPR0 FROM (SELECT t3.ps_partkey, t4.n_regionkey, MIN(t3.EXPR0) AS EXPR0 FROM (SELECT t1.ps_partkey, t2.s_nationkey, MIN(t1.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t2 ON t1.ps_suppkey = t2.s_suppkey GROUP BY t1.ps_partkey, t2.s_nationkey) AS t3 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t4 ON t3.s_nationkey = t4.n_nationkey GROUP BY t3.ps_partkey, t4.n_regionkey) AS t5 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t7 ON t5.n_regionkey = t7.r_regionkey GROUP BY t5.ps_partkey) AS t8 ON t.p_partkey = t8.ps_partkey AND partsupp.ps_supplycost = t8.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey;",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1539,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(6)) = 'RUSSIA' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'SMALL ANODIZED STEEL') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1540,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '39', '36', '44', '21', '33', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '39', '36', '44', '21', '33', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '43'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '39' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '21' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '43')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1541,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 37 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 37 AND p_type LIKE '%COPPER') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1542,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(8)) = 'ETHIOPIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO BURNISHED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1543,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '34', '36', '29', '20', '33', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '34', '36', '29', '20', '33', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '28'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '28')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1544,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 24 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1543.s_acctbal, t1543.s_name, t1543.n_name, t1543.p_partkey, t1543.p_mfgr, t1543.s_address, t1543.s_phone, t1543.s_comment FROM (SELECT t1529.p_partkey, t1529.p_name, t1529.p_mfgr, t1529.p_brand, t1529.p_type, t1529.p_size, t1529.p_container, t1529.p_retailprice, t1529.p_comment, t1529.s_suppkey, t1529.s_name, t1529.s_address, t1529.s_nationkey, t1529.s_phone, t1529.s_acctbal, t1529.s_comment, t1529.ps_partkey, t1529.ps_suppkey, t1529.ps_availqty, t1529.ps_supplycost, t1529.ps_comment, t1529.n_nationkey, t1529.n_name, t1529.n_regionkey, t1529.n_comment, t1529.r_regionkey, t1529.r_name, t1529.r_comment, CAST(t1540.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1540.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 24 AND p_type LIKE '%NICKEL') AS t1525, supplier AS supplier199, partsupp AS partsupp199 WHERE t1525.p_partkey = partsupp199.ps_partkey AND supplier199.s_suppkey = partsupp199.ps_suppkey) AS t1526, nation AS nation199 WHERE t1526.s_nationkey = nation199.n_nationkey) AS t1527, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1528 WHERE t1527.n_regionkey = t1528.r_regionkey) AS t1529, (SELECT t1536.ps_partkey, MIN(t1536.EXPR0) AS EXPR0 FROM (SELECT t1533.ps_partkey, t1534.n_regionkey, MIN(t1533.EXPR0) AS EXPR0 FROM (SELECT t1530.ps_partkey, t1531.s_nationkey, MIN(t1530.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1530, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1531 WHERE t1531.s_suppkey = t1530.ps_suppkey GROUP BY t1530.ps_partkey, t1531.s_nationkey) AS t1533, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1534 WHERE t1533.s_nationkey = t1534.n_nationkey GROUP BY t1533.ps_partkey, t1534.n_regionkey) AS t1536, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1538 WHERE t1536.n_regionkey = t1538.r_regionkey GROUP BY t1536.ps_partkey) AS t1540 WHERE t1529.p_partkey = t1540.ps_partkey AND t1529.ps_supplycost = t1540.EXPR0 ORDER BY t1529.s_acctbal DESC, t1529.n_name, t1529.s_name, t1529.p_partkey) AS t1543",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1545,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '27', '30', '35', '20', '28', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '27', '30', '35', '20', '28', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '40'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '30') OR (SUBSTR(c_phone FROM 1 FOR 2) = '35' OR SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '28' OR SUBSTR(c_phone FROM 1 FOR 2) = '40')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1546,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 1 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1632.s_acctbal, t1632.s_name, t1632.n_name, t1632.p_partkey, t1632.p_mfgr, t1632.s_address, t1632.s_phone, t1632.s_comment FROM (SELECT t1618.p_partkey, t1618.p_name, t1618.p_mfgr, t1618.p_brand, t1618.p_type, t1618.p_size, t1618.p_container, t1618.p_retailprice, t1618.p_comment, t1618.s_suppkey, t1618.s_name, t1618.s_address, t1618.s_nationkey, t1618.s_phone, t1618.s_acctbal, t1618.s_comment, t1618.ps_partkey, t1618.ps_suppkey, t1618.ps_availqty, t1618.ps_supplycost, t1618.ps_comment, t1618.n_nationkey, t1618.n_name, t1618.n_regionkey, t1618.n_comment, t1618.r_regionkey, t1618.r_name, t1618.r_comment, CAST(t1629.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1629.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 1 AND p_type LIKE '%COPPER') AS t1614, supplier AS supplier203, partsupp AS partsupp203 WHERE t1614.p_partkey = partsupp203.ps_partkey AND supplier203.s_suppkey = partsupp203.ps_suppkey) AS t1615, nation AS nation203 WHERE t1615.s_nationkey = nation203.n_nationkey) AS t1616, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1617 WHERE t1616.n_regionkey = t1617.r_regionkey) AS t1618, (SELECT t1625.ps_partkey, MIN(t1625.EXPR0) AS EXPR0 FROM (SELECT t1622.ps_partkey, t1623.n_regionkey, MIN(t1622.EXPR0) AS EXPR0 FROM (SELECT t1619.ps_partkey, t1620.s_nationkey, MIN(t1619.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1619, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1620 WHERE t1620.s_suppkey = t1619.ps_suppkey GROUP BY t1619.ps_partkey, t1620.s_nationkey) AS t1622, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1623 WHERE t1622.s_nationkey = t1623.n_nationkey GROUP BY t1622.ps_partkey, t1623.n_regionkey) AS t1625, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1627 WHERE t1625.n_regionkey = t1627.r_regionkey GROUP BY t1625.ps_partkey) AS t1629 WHERE t1618.p_partkey = t1629.ps_partkey AND t1618.ps_supplycost = t1629.EXPR0 ORDER BY t1618.s_acctbal DESC, t1618.n_name, t1618.s_name, t1618.p_partkey) AS t1632",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1547,tpch,"select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t195.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation46.n_name AS CHAR(6)) = 'JORDAN' THEN lineitem22.l_extendedprice * (1 - lineitem22.l_discount) ELSE 0 END) / SUM(lineitem22.l_extendedprice * (1 - lineitem22.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'PROMO POLISHED TIN') AS t194 CROSS JOIN supplier AS supplier22 INNER JOIN lineitem AS lineitem22 ON t194.p_partkey = lineitem22.l_partkey AND supplier22.s_suppkey = lineitem22.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t195 ON lineitem22.l_orderkey = t195.o_orderkey INNER JOIN customer AS customer22 ON t195.o_custkey = customer22.c_custkey INNER JOIN nation AS nation45 ON customer22.c_nationkey = nation45.n_nationkey INNER JOIN nation AS nation46 ON supplier22.s_nationkey = nation46.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t196 ON nation45.n_regionkey = t196.r_regionkey GROUP BY EXTRACT(YEAR FROM t195.o_orderdate) ORDER BY EXTRACT(YEAR FROM t195.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1548,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#34' and p_type not like 'SMALL PLATED%' and p_size in (41, 50, 12, 3, 43, 27, 38, 14) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t3.p_brand, t3.p_type, t3.p_size, COUNT(t3.ps_suppkey) AS supplier_cnt FROM (SELECT t.ps_suppkey, t.p_brand, t.p_type, t.p_size FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t LEFT JOIN (SELECT s_suppkey, TRUE AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') AS t1 ON t.ps_suppkey0 = t1.s_suppkey WHERE t.p_partkey = t.ps_partkey AND t.p_brand <> 'Brand#34' AND t.p_type NOT LIKE 'SMALL PLATED%' AND (t.p_size = 41 OR t.p_size = 50 OR (t.p_size = 12 OR t.p_size = 3) OR (t.p_size = 43 OR t.p_size = 27 OR (t.p_size = 38 OR t.p_size = 14))) AND NOT (t1.f1 IS TRUE AND t.ps_suppkey0 IS NOT NULL) GROUP BY t.ps_suppkey, t.p_brand, t.p_type, t.p_size) AS t3 GROUP BY t3.p_brand, t3.p_type, t3.p_size ORDER BY COUNT(t3.ps_suppkey) DESC, t3.p_brand, t3.p_type, t3.p_size;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
1549,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '41', '32', '38', '27', '26', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '41', '32', '38', '27', '26', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '41' OR SUBSTR(c_phone FROM 1 FOR 2) = '32') OR (SUBSTR(c_phone FROM 1 FOR 2) = '38' OR SUBSTR(c_phone FROM 1 FOR 2) = '27' OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '30')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
1550,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'VIETNAM' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD ANODIZED COPPER') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1551,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 39 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 39 AND p_type LIKE '%NICKEL') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'ASIA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1552,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(9)) = 'INDONESIA' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED BRASS') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'ASIA') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
1553,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '33', '23', '37', '34', '43', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '33', '23', '37', '34', '43', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t3.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t3.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '36'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR SUBSTR(c_phone FROM 1 FOR 2) = '23') OR (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR SUBSTR(c_phone FROM 1 FOR 2) = '34' OR (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR SUBSTR(c_phone FROM 1 FOR 2) = '36')))) AS t2 WHERE t.c_acctbal > t2.EXPR0) AS t3 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t4 ON t3.c_custkey = t4.o_custkey WHERE t4.f0 IS NULL GROUP BY SUBSTR(t3.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t3.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"