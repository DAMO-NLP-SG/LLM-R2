,db_id,original_sql,rewritten_sql,activated_rules,original_logical_plan
0,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 100 * 0.01 AND 120 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1195 and 1195 + 11  and s_state in ('CA','IN','KS'   ,'KY','LA','MO','SC','SD')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1195+ 12 and 1195 + 23  and s_state in ('CA','IN','KS'   ,'KY','LA','MO','SC','SD')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;","SELECT t1713.s_store_name1, t1713.s_store_id1, t1713.d_week_seq1, t1713.sun_sales1 / t1722.sun_sales2, t1713.mon_sales1 / t1722.mon_sales2, t1713.tue_sales1 / t1722.tue_sales2, t1713.wed_sales1 / t1722.wed_sales2, t1713.thu_sales1 / t1722.thu_sales2, t1713.fri_sales1 / t1722.fri_sales2, t1713.sat_sales1 / t1722.sat_sales2 FROM (SELECT t1710.s_store_name AS s_store_name1, t1710.d_week_seq AS d_week_seq1, t1710.s_store_id AS s_store_id1, t1710.sun_sales AS sun_sales1, t1710.mon_sales AS mon_sales1, t1710.tue_sales AS tue_sales1, t1710.wed_sales AS wed_sales1, t1710.thu_sales AS thu_sales1, t1710.fri_sales AS fri_sales1, t1710.sat_sales AS sat_sales1 FROM (SELECT * FROM (SELECT date_dim399.d_week_seq, t1705.ss_store_sk, SUM(CASE WHEN CAST(date_dim399.d_day_name AS CHAR(6)) = 'Sunday' THEN t1705.ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN CAST(date_dim399.d_day_name AS CHAR(6)) = 'Monday' THEN t1705.ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN CAST(date_dim399.d_day_name AS CHAR(7)) = 'Tuesday' THEN t1705.ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN CAST(date_dim399.d_day_name AS CHAR(9)) = 'Wednesday' THEN t1705.ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN CAST(date_dim399.d_day_name AS CHAR(8)) = 'Thursday' THEN t1705.ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN CAST(date_dim399.d_day_name AS CHAR(6)) = 'Friday' THEN t1705.ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN CAST(date_dim399.d_day_name AS CHAR(8)) = 'Saturday' THEN t1705.ss_sales_price ELSE NULL END) AS sat_sales FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 100 * 0.01 AND ss_sales_price / ss_list_price <= 120 * 0.01) AS t1705, date_dim AS date_dim399 WHERE date_dim399.d_date_sk = t1705.ss_sold_date_sk GROUP BY date_dim399.d_week_seq, t1705.ss_store_sk) AS t1708, (SELECT * FROM store WHERE s_state IN ('CA', 'IN', 'KS', 'KY', 'LA', 'MO', 'SC', 'SD')) AS t1709 WHERE t1708.ss_store_sk = t1709.s_store_sk) AS t1710, (SELECT * FROM date_dim WHERE d_month_seq >= 1195 AND d_month_seq <= 1195 + 11) AS t1711 WHERE t1711.d_week_seq = t1710.d_week_seq) AS t1713, (SELECT t1719.s_store_name AS s_store_name2, t1719.d_week_seq AS d_week_seq2, t1719.s_store_id AS s_store_id2, t1719.sun_sales AS sun_sales2, t1719.mon_sales AS mon_sales2, t1719.tue_sales AS tue_sales2, t1719.wed_sales AS wed_sales2, t1719.thu_sales AS thu_sales2, t1719.fri_sales AS fri_sales2, t1719.sat_sales AS sat_sales2 FROM (SELECT * FROM (SELECT date_dim401.d_week_seq, t1714.ss_store_sk, SUM(CASE WHEN CAST(date_dim401.d_day_name AS CHAR(6)) = 'Sunday' THEN t1714.ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN CAST(date_dim401.d_day_name AS CHAR(6)) = 'Monday' THEN t1714.ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN CAST(date_dim401.d_day_name AS CHAR(7)) = 'Tuesday' THEN t1714.ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN CAST(date_dim401.d_day_name AS CHAR(9)) = 'Wednesday' THEN t1714.ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN CAST(date_dim401.d_day_name AS CHAR(8)) = 'Thursday' THEN t1714.ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN CAST(date_dim401.d_day_name AS CHAR(6)) = 'Friday' THEN t1714.ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN CAST(date_dim401.d_day_name AS CHAR(8)) = 'Saturday' THEN t1714.ss_sales_price ELSE NULL END) AS sat_sales FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 100 * 0.01 AND ss_sales_price / ss_list_price <= 120 * 0.01) AS t1714, date_dim AS date_dim401 WHERE date_dim401.d_date_sk = t1714.ss_sold_date_sk GROUP BY date_dim401.d_week_seq, t1714.ss_store_sk) AS t1717, (SELECT * FROM store WHERE s_state IN ('CA', 'IN', 'KS', 'KY', 'LA', 'MO', 'SC', 'SD')) AS t1718 WHERE t1717.ss_store_sk = t1718.s_store_sk) AS t1719, (SELECT * FROM date_dim WHERE d_month_seq >= 1195 + 12 AND d_month_seq <= 1195 + 23) AS t1720 WHERE t1720.d_week_seq = t1719.d_week_seq) AS t1722 WHERE t1713.s_store_id1 = t1722.s_store_id2 AND t1713.d_week_seq1 = t1722.d_week_seq2 - 52 ORDER BY t1713.s_store_name1, t1713.s_store_id1, t1713.d_week_seq1 LIMIT 100",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]"
1,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'W' and cd_education_status = 'Unknown' and d_year = 2001 and s_state = 'NE' and i_category = 'Home' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT item.i_item_id, store.s_state, GROUPING(store.s_state) AS g_state, AVG(store_sales.ss_quantity) AS agg1, AVG(store_sales.ss_list_price) AS agg2, AVG(store_sales.ss_coupon_amt) AS agg3, AVG(store_sales.ss_sales_price) AS agg4 FROM store_sales, customer_demographics, date_dim, store, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk AND (store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND customer_demographics.cd_gender = 'M')) AND (customer_demographics.cd_marital_status = 'W' AND customer_demographics.cd_education_status = 'Unknown' AND (date_dim.d_year = 2001 AND (store.s_state = 'NE' AND item.i_category = 'Home'))) GROUP BY ROLLUP(store.s_state, item.i_item_id) ORDER BY item.i_item_id, store.s_state LIMIT 100;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
2,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('KY','MO','WV') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('D', 'S', 'M') and cd_education_status in ('Unknown', '2 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 6 and 6+2  and ss_list_price between 211 and 300 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 6 and 6+2  and ws_list_price between 211 and 300  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 6 and 6+2  and cs_list_price between 211 and 300)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;","SELECT t9.cd_gender, t9.cd_marital_status, t9.cd_education_status, COUNT(*) AS cnt1, t9.cd_purchase_estimate, COUNT(*) AS cnt2, t9.cd_credit_rating, COUNT(*) AS cnt3 FROM (SELECT * FROM (SELECT t3.c_customer_sk, t3.c_current_hdemo_sk, t3.c_current_addr_sk, t3.c_first_shipto_date_sk, t3.c_first_sales_date_sk, t3.c_birth_day, t3.c_birth_month, t3.c_birth_year, t3.c_last_review_date_sk, t3.c_current_cdemo_sk, t3.c_customer_id, t3.c_last_name, t3.c_preferred_cust_flag, t3.c_birth_country, t3.c_login, t3.c_email_address, t3.c_salutation, t3.c_first_name, t3.ca_gmt_offset, t3.ca_address_sk, t3.ca_street_number, t3.ca_street_name, t3.ca_street_type, t3.ca_suite_number, t3.ca_city, t3.ca_county, t3.ca_state, t3.ca_zip, t3.ca_country, t3.ca_location_type, t3.ca_address_id, t3.cd_dep_college_count, t3.cd_purchase_estimate, t3.cd_dep_count, t3.cd_dep_employed_count, t3.cd_demo_sk, t3.cd_gender, t3.cd_marital_status, t3.cd_education_status, t3.cd_credit_rating, t3.f0, t7.f0 AS f041 FROM (SELECT customer.c_customer_sk, customer.c_current_hdemo_sk, customer.c_current_addr_sk, customer.c_first_shipto_date_sk, customer.c_first_sales_date_sk, customer.c_birth_day, customer.c_birth_month, customer.c_birth_year, customer.c_last_review_date_sk, customer.c_current_cdemo_sk, customer.c_customer_id, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_country, customer.c_login, customer.c_email_address, customer.c_salutation, customer.c_first_name, customer_address.ca_gmt_offset, customer_address.ca_address_sk, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_street_type, customer_address.ca_suite_number, customer_address.ca_city, customer_address.ca_county, customer_address.ca_state, customer_address.ca_zip, customer_address.ca_country, customer_address.ca_location_type, customer_address.ca_address_id, customer_demographics.cd_dep_college_count, customer_demographics.cd_purchase_estimate, customer_demographics.cd_dep_count, customer_demographics.cd_dep_employed_count, customer_demographics.cd_demo_sk, customer_demographics.cd_gender, customer_demographics.cd_marital_status, customer_demographics.cd_education_status, customer_demographics.cd_credit_rating, t2.f0 FROM customer CROSS JOIN customer_address CROSS JOIN customer_demographics LEFT JOIN (SELECT t.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM store_sales WHERE ss_list_price >= 211 AND ss_list_price <= 300) AS t, (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy >= 6 AND d_moy <= 6 + 2) AS t0 WHERE t.ss_sold_date_sk = t0.d_date_sk) AS t2 ON customer.c_customer_sk = t2.ss_customer_sk) AS t3 LEFT JOIN (SELECT t4.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM web_sales WHERE ws_list_price >= 211 AND ws_list_price <= 300) AS t4, (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy >= 6 AND d_moy <= 6 + 2) AS t5 WHERE t4.ws_sold_date_sk = t5.d_date_sk) AS t7 ON t3.c_customer_sk = t7.ws_bill_customer_sk) AS t8 WHERE t8.c_current_addr_sk = t8.ca_address_sk AND (t8.ca_state IN ('KY', 'MO', 'WV') AND t8.cd_demo_sk = t8.c_current_cdemo_sk) AND (t8.cd_marital_status IN ('D', 'M', 'S') AND t8.cd_education_status IN ('2 yr Degree', 'Unknown') AND (t8.f041 IS NULL AND t8.f0 IS NOT NULL))) AS t9 LEFT JOIN (SELECT t10.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 211 AND cs_list_price <= 300) AS t10, (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy >= 6 AND d_moy <= 6 + 2) AS t11 WHERE t10.cs_sold_date_sk = t11.d_date_sk) AS t13 ON t9.c_customer_sk = t13.cs_ship_customer_sk WHERE t13.f0 IS NULL GROUP BY t9.cd_purchase_estimate, t9.cd_gender, t9.cd_marital_status, t9.cd_education_status, t9.cd_credit_rating ORDER BY t9.cd_gender, t9.cd_marital_status, t9.cd_education_status, t9.cd_purchase_estimate, t9.cd_credit_rating LIMIT 100;",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
3,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 2 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;","SELECT t1202.cc_call_center_id AS Call_Center, t1202.cc_name AS Call_Center_Name, t1202.cc_manager AS Manager, SUM(t1202.cr_net_loss) AS Returns_Loss FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM call_center AS call_center103, catalog_returns AS catalog_returns103 WHERE catalog_returns103.cr_call_center_sk = call_center103.cc_call_center_sk) AS t1195, (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy = 2) AS t1196 WHERE t1195.cr_returned_date_sk = t1196.d_date_sk) AS t1197, customer AS customer103 WHERE t1197.cr_returning_customer_sk = customer103.c_customer_sk) AS t1198, (SELECT * FROM customer_address WHERE ca_gmt_offset = -7) AS t1199 WHERE t1199.ca_address_sk = t1198.c_current_addr_sk) AS t1200, (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree') AS t1201 WHERE t1201.cd_demo_sk = t1200.c_current_cdemo_sk) AS t1202, (SELECT * FROM household_demographics WHERE hd_buy_potential LIKE '5001-10000%') AS t1203 WHERE t1203.hd_demo_sk = t1202.c_current_hdemo_sk GROUP BY t1202.cc_call_center_id, t1202.cc_name, t1202.cc_manager, t1202.cd_marital_status, t1202.cd_education_status ORDER BY SUM(t1202.cr_net_loss) DESC",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
4,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 50 and 59 and wr_return_amt / wr_return_quantity between 46 and 75 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AL', 'NE', 'TX', 'WI')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (61, 68) and c_birth_year BETWEEN 1963 AND 1969 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t1735.c_customer_id, t1735.c_salutation, t1735.c_first_name, t1735.c_last_name, t1735.c_preferred_cust_flag, t1735.c_birth_day, t1735.c_birth_month, t1735.c_birth_year, t1735.c_birth_country, t1735.c_login, t1735.c_email_address, t1735.c_last_review_date_sk, t1733.ctr_total_return FROM (SELECT t1728.wr_returning_customer_sk, t1728.ca_state, t1728.wr_reason_sk, SUM(t1728.ctr_total_return * t1730.f1) AS ctr_total_return FROM (SELECT t1725.wr_item_sk, t1725.wr_returning_customer_sk, t1725.wr_reason_sk, t1726.ca_state, SUM(t1725.ctr_total_return * t1726.f2) AS ctr_total_return FROM (SELECT t1720.wr_item_sk, t1720.wr_returning_customer_sk, t1720.wr_returning_addr_sk, t1720.wr_reason_sk, SUM(t1720.ctr_total_return * t1722.f1) AS ctr_total_return FROM (SELECT wr_returned_date_sk, wr_item_sk, wr_returning_customer_sk, wr_returning_addr_sk, wr_reason_sk, SUM(wr_return_amt) AS ctr_total_return FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 46 AND wr_return_amt / wr_return_quantity <= 75 GROUP BY wr_returned_date_sk, wr_item_sk, wr_returning_customer_sk, wr_returning_addr_sk, wr_reason_sk) AS t1720 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_year = 2002 GROUP BY d_date_sk) AS t1722 ON t1720.wr_returned_date_sk = t1722.d_date_sk GROUP BY t1720.wr_item_sk, t1720.wr_returning_customer_sk, t1720.wr_returning_addr_sk, t1720.wr_reason_sk HAVING t1720.wr_reason_sk IN (61, 68)) AS t1725 INNER JOIN (SELECT ca_address_sk, ca_state, COUNT(*) AS f2 FROM customer_address GROUP BY ca_address_sk, ca_state) AS t1726 ON t1725.wr_returning_addr_sk = t1726.ca_address_sk GROUP BY t1725.wr_item_sk, t1725.wr_returning_customer_sk, t1725.wr_reason_sk, t1726.ca_state) AS t1728 INNER JOIN (SELECT i_item_sk, COUNT(*) AS f1 FROM item WHERE i_manager_id >= 50 AND i_manager_id <= 59 GROUP BY i_item_sk) AS t1730 ON t1728.wr_item_sk = t1730.i_item_sk GROUP BY t1728.wr_returning_customer_sk, t1728.wr_reason_sk, t1728.ca_state) AS t1733 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('AL', 'NE', 'TX', 'WI')) AS t1734 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1963 AND c_birth_year <= 1969) AS t1735 ON t1734.ca_address_sk = t1735.c_current_addr_sk AND t1733.wr_returning_customer_sk = t1735.c_customer_sk INNER JOIN (SELECT t1748.ca_state, AVG(t1748.ctr_total_return) AS f1 FROM (SELECT t1744.wr_returning_customer_sk, t1744.wr_reason_sk, t1744.ca_state, SUM(t1744.ctr_total_return * t1746.f1) AS ctr_total_return FROM (SELECT t1741.wr_item_sk, t1741.wr_returning_customer_sk, t1741.wr_reason_sk, t1742.ca_state, SUM(t1741.ctr_total_return * t1742.f2) AS ctr_total_return FROM (SELECT t1737.wr_item_sk, t1737.wr_returning_customer_sk, t1737.wr_returning_addr_sk, t1737.wr_reason_sk, SUM(t1737.ctr_total_return * t1739.f1) AS ctr_total_return FROM (SELECT wr_returned_date_sk, wr_item_sk, wr_returning_customer_sk, wr_returning_addr_sk, wr_reason_sk, SUM(wr_return_amt) AS ctr_total_return FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 46 AND wr_return_amt / wr_return_quantity <= 75 GROUP BY wr_returned_date_sk, wr_item_sk, wr_returning_customer_sk, wr_returning_addr_sk, wr_reason_sk) AS t1737 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_year = 2002 GROUP BY d_date_sk) AS t1739 ON t1737.wr_returned_date_sk = t1739.d_date_sk GROUP BY t1737.wr_item_sk, t1737.wr_returning_customer_sk, t1737.wr_returning_addr_sk, t1737.wr_reason_sk) AS t1741 INNER JOIN (SELECT ca_address_sk, ca_state, COUNT(*) AS f2 FROM customer_address GROUP BY ca_address_sk, ca_state) AS t1742 ON t1741.wr_returning_addr_sk = t1742.ca_address_sk GROUP BY t1741.wr_item_sk, t1741.wr_returning_customer_sk, t1741.wr_reason_sk, t1742.ca_state) AS t1744 INNER JOIN (SELECT i_item_sk, COUNT(*) AS f1 FROM item WHERE i_manager_id >= 50 AND i_manager_id <= 59 GROUP BY i_item_sk) AS t1746 ON t1744.wr_item_sk = t1746.i_item_sk GROUP BY t1744.wr_returning_customer_sk, t1744.wr_reason_sk, t1744.ca_state) AS t1748 GROUP BY t1748.ca_state) AS t1749 ON t1733.ca_state = t1749.ca_state AND t1733.ctr_total_return > t1749.f1 * 1.2 ORDER BY t1735.c_customer_id, t1735.c_salutation, t1735.c_first_name, t1735.c_last_name, t1735.c_preferred_cust_flag, t1735.c_birth_day, t1735.c_birth_month, t1735.c_birth_year, t1735.c_birth_country, t1735.c_login, t1735.c_email_address, t1735.c_last_review_date_sk, t1733.ctr_total_return LIMIT 100",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
5,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'S' and  cd_education_status = '2 yr Degree' and  d_year = 1999 and  s_state = 'MO' and i_category = 'Books'  ;","SELECT MIN(t97.EXPR0), MIN(t95.EXPR1), MIN(t95.EXPR2), MIN(t95.EXPR3), MIN(t95.EXPR4), MIN(t95.EXPR5), MIN(t95.EXPR6), MIN(t95.EXPR7) FROM (SELECT t91.ss_item_sk, MIN(t93.EXPR1) AS EXPR1, MIN(t91.EXPR2) AS EXPR2, MIN(t91.EXPR3) AS EXPR3, MIN(t91.EXPR4) AS EXPR4, MIN(t91.EXPR5) AS EXPR5, MIN(t91.EXPR6) AS EXPR6, MIN(t91.EXPR7) AS EXPR7 FROM (SELECT t87.ss_item_sk, t87.ss_store_sk, MIN(t87.EXPR2) AS EXPR2, MIN(t87.EXPR3) AS EXPR3, MIN(t87.EXPR4) AS EXPR4, MIN(t87.EXPR5) AS EXPR5, MIN(t87.EXPR6) AS EXPR6, MIN(t87.EXPR7) AS EXPR7 FROM (SELECT t83.ss_sold_date_sk, t83.ss_item_sk, t83.ss_store_sk, MIN(t83.EXPR2) AS EXPR2, MIN(t83.EXPR3) AS EXPR3, MIN(t83.EXPR4) AS EXPR4, MIN(t83.EXPR5) AS EXPR5, MIN(t83.EXPR6) AS EXPR6, MIN(t83.EXPR7) AS EXPR7 FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_cdemo_sk, ss_store_sk, MIN(ss_quantity) AS EXPR2, MIN(ss_list_price) AS EXPR3, MIN(ss_coupon_amt) AS EXPR4, MIN(ss_sales_price) AS EXPR5, MIN(ss_item_sk) AS EXPR6, MIN(ss_ticket_number) AS EXPR7 FROM store_sales GROUP BY ss_sold_date_sk, ss_item_sk, ss_cdemo_sk, ss_store_sk) AS t83, (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'F' AND cd_marital_status = 'S' AND cd_education_status = '2 yr Degree' GROUP BY cd_demo_sk) AS t85 WHERE t83.ss_cdemo_sk = t85.cd_demo_sk GROUP BY t83.ss_sold_date_sk, t83.ss_item_sk, t83.ss_store_sk) AS t87, (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 GROUP BY d_date_sk) AS t89 WHERE t87.ss_sold_date_sk = t89.d_date_sk GROUP BY t87.ss_item_sk, t87.ss_store_sk) AS t91, (SELECT s_store_sk, MIN(s_state) AS EXPR1 FROM store WHERE s_state = 'MO' GROUP BY s_store_sk) AS t93 WHERE t91.ss_store_sk = t93.s_store_sk GROUP BY t91.ss_item_sk) AS t95, (SELECT i_item_sk, MIN(i_item_id) AS EXPR0 FROM item WHERE i_category = 'Books' GROUP BY i_item_sk) AS t97 WHERE t95.ss_item_sk = t97.i_item_sk",['Empty List'],"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
6,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 165 and 224 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 70 AND 73 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AR', 'MI', 'VA') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('U', 'U') and cd_education_status IN ('Secondary', 'Secondary') and cd_gender = 'M' and c_birth_month = 8 and c_birth_year BETWEEN 1938 AND 1944 order by c_customer_id limit 100 ;","SELECT t5.c_customer_id FROM (SELECT ctr_customer_sk, ctr_store_sk, ctr_reason_sk, SUM(sr_return_amt) AS ctr_total_return FROM (SELECT t.sr_customer_sk AS ctr_customer_sk, t.sr_store_sk AS ctr_store_sk, t.sr_reason_sk AS ctr_reason_sk, t.sr_return_amt FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 165 AND sr_return_amt / sr_return_quantity <= 224) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t0 ON t.sr_returned_date_sk = t0.d_date_sk) AS t1 WHERE t1.ctr_reason_sk >= 70 AND t1.ctr_reason_sk <= 73 GROUP BY ctr_customer_sk, ctr_store_sk, ctr_reason_sk) AS t3 INNER JOIN (SELECT * FROM store WHERE s_state IN ('AR', 'MI', 'VA')) AS t4 ON t3.ctr_store_sk = t4.s_store_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 8 AND (c_birth_year >= 1938 AND c_birth_year <= 1944)) AS t5 ON t3.ctr_customer_sk = t5.c_customer_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'U' AND cd_education_status = 'Secondary' AND cd_gender = 'M') AS t6 ON t5.c_current_cdemo_sk = t6.cd_demo_sk INNER JOIN (SELECT t12.sr_store_sk, AVG(t12.ctr_total_return) AS f1 FROM (SELECT t8.sr_customer_sk, t8.sr_store_sk, t8.sr_reason_sk, SUM(t8.ctr_total_return * t10.f1) AS ctr_total_return FROM (SELECT sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_reason_sk, SUM(sr_return_amt) AS ctr_total_return FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 165 AND sr_return_amt / sr_return_quantity <= 224 GROUP BY sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_reason_sk) AS t8 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_year = 2001 GROUP BY d_date_sk) AS t10 ON t8.sr_returned_date_sk = t10.d_date_sk GROUP BY t8.sr_customer_sk, t8.sr_store_sk, t8.sr_reason_sk) AS t12 GROUP BY t12.sr_store_sk) AS t13 ON t3.ctr_store_sk = t13.sr_store_sk AND t3.ctr_total_return > t13.f1 * 1.2 ORDER BY t5.c_customer_id LIMIT 100;",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
7,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1214 and 1214+11 and ss_list_price between 229 and 258 and c_birth_year BETWEEN 1978 AND 1984 and ss_wholesale_cost BETWEEN 21 AND 31 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1214 and 1214+11 and cs_list_price between 229 and 258 and c_birth_year BETWEEN 1978 AND 1984 and cs_wholesale_cost BETWEEN 21 AND 31 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1214 and 1214+11 and ws_list_price between 229 and 258 and c_birth_year BETWEEN 1978 AND 1984 and ws_wholesale_cost BETWEEN 21 AND 31 ) ) cool_cust  ;","SELECT COUNT(*) FROM (SELECT * FROM (SELECT t1.c_last_name, t1.c_first_name, t0.d_date FROM (SELECT * FROM store_sales WHERE ss_list_price >= 229 AND ss_list_price <= 258 AND (ss_wholesale_cost >= 21 AND ss_wholesale_cost <= 31)) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1214 AND d_month_seq <= 1214 + 11) AS t0 ON t.ss_sold_date_sk = t0.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1978 AND c_birth_year <= 1984) AS t1 ON t.ss_customer_sk = t1.c_customer_sk EXCEPT SELECT t5.c_last_name, t5.c_first_name, t4.d_date FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 229 AND cs_list_price <= 258 AND (cs_wholesale_cost >= 21 AND cs_wholesale_cost <= 31)) AS t3 INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1214 AND d_month_seq <= 1214 + 11) AS t4 ON t3.cs_sold_date_sk = t4.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1978 AND c_birth_year <= 1984) AS t5 ON t3.cs_bill_customer_sk = t5.c_customer_sk) AS t EXCEPT SELECT t10.c_last_name, t10.c_first_name, t9.d_date FROM (SELECT * FROM web_sales WHERE ws_list_price >= 229 AND ws_list_price <= 258 AND (ws_wholesale_cost >= 21 AND ws_wholesale_cost <= 31)) AS t8 INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1214 AND d_month_seq <= 1214 + 11) AS t9 ON t8.ws_sold_date_sk = t9.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1978 AND c_birth_year <= 1984) AS t10 ON t8.ws_bill_customer_sk = t10.c_customer_sk) AS t12;",['Empty List'],"['LogicalAggregate', ['LogicalMinus', ['LogicalMinus', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]"
8,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Deerfield' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 5 * 10000 and ib_upper_bound <= 5 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;","SELECT MIN(t905.EXPR0), MIN(t906.EXPR1), MIN(t906.EXPR2) FROM (SELECT t901.cd_demo_sk, MIN(t901.EXPR0) AS EXPR0 FROM (SELECT t898.cd_demo_sk, t899.hd_income_band_sk, MIN(t898.EXPR0) AS EXPR0 FROM (SELECT t895.c_current_hdemo_sk, t896.cd_demo_sk, MIN(t895.EXPR0) AS EXPR0 FROM (SELECT t891.c_current_hdemo_sk, t891.c_current_cdemo_sk, MIN(t891.EXPR0) AS EXPR0 FROM (SELECT c_current_hdemo_sk, c_current_addr_sk, c_current_cdemo_sk, MIN(c_customer_id) AS EXPR0 FROM customer GROUP BY c_current_hdemo_sk, c_current_addr_sk, c_current_cdemo_sk) AS t891, (SELECT ca_address_sk FROM customer_address WHERE ca_city = 'Deerfield' GROUP BY ca_address_sk) AS t893 WHERE t891.c_current_addr_sk = t893.ca_address_sk GROUP BY t891.c_current_hdemo_sk, t891.c_current_cdemo_sk) AS t895, (SELECT cd_demo_sk FROM customer_demographics GROUP BY cd_demo_sk) AS t896 WHERE t896.cd_demo_sk = t895.c_current_cdemo_sk GROUP BY t895.c_current_hdemo_sk, t896.cd_demo_sk) AS t898, (SELECT hd_demo_sk, hd_income_band_sk FROM household_demographics GROUP BY hd_demo_sk, hd_income_band_sk) AS t899 WHERE t899.hd_demo_sk = t898.c_current_hdemo_sk GROUP BY t898.cd_demo_sk, t899.hd_income_band_sk) AS t901, (SELECT ib_income_band_sk FROM income_band WHERE ib_lower_bound >= 5 * 10000 AND ib_upper_bound <= 5 * 10000 + 50000 GROUP BY ib_income_band_sk) AS t903 WHERE t903.ib_income_band_sk = t901.hd_income_band_sk GROUP BY t901.cd_demo_sk) AS t905, (SELECT sr_cdemo_sk, MIN(sr_ticket_number) AS EXPR1, MIN(sr_item_sk) AS EXPR2 FROM store_returns GROUP BY sr_cdemo_sk) AS t906 WHERE t906.sr_cdemo_sk = t905.cd_demo_sk",['Empty List'],"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
9,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,avg(ss_net_profit) as store_sales_profit ,avg(sr_net_loss) as store_returns_loss ,avg(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 2001 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;","SELECT item.i_item_id, item.i_item_desc, store.s_store_id, store.s_store_name, AVG(store_sales.ss_net_profit) AS store_sales_profit, AVG(store_returns.sr_net_loss) AS store_returns_loss, AVG(catalog_sales.cs_net_profit) AS catalog_sales_profit FROM store_sales, store_returns, catalog_sales, date_dim, date_dim AS date_dim0, date_dim AS date_dim1, store, item WHERE date_dim.d_moy = 4 AND date_dim.d_year = 2001 AND (date_dim.d_date_sk = store_sales.ss_sold_date_sk AND item.i_item_sk = store_sales.ss_item_sk) AND (store.s_store_sk = store_sales.ss_store_sk AND store_sales.ss_customer_sk = store_returns.sr_customer_sk AND (store_sales.ss_item_sk = store_returns.sr_item_sk AND (store_sales.ss_ticket_number = store_returns.sr_ticket_number AND store_returns.sr_returned_date_sk = date_dim0.d_date_sk))) AND (date_dim0.d_moy >= 4 AND date_dim0.d_moy <= 4 + 2 AND (date_dim0.d_year = 2001 AND store_returns.sr_customer_sk = catalog_sales.cs_bill_customer_sk) AND (store_returns.sr_item_sk = catalog_sales.cs_item_sk AND catalog_sales.cs_sold_date_sk = date_dim1.d_date_sk AND (date_dim1.d_moy >= 4 AND (date_dim1.d_moy <= 4 + 2 AND date_dim1.d_year = 2001)))) GROUP BY store.s_store_id, store.s_store_name, item.i_item_id, item.i_item_desc ORDER BY item.i_item_id, item.i_item_desc, store.s_store_id, store.s_store_name LIMIT 100;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
10,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Home') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'S' and cd_education_status = 'Primary' and s1.ss_list_price between 83 and 97 and s2.ss_list_price between 83 and 97 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT t1232.i_item_sk, t1232.i_item_sk0, COALESCE(SUM(t1232.cnt * t1234.cnt), 0) AS cnt FROM (SELECT t1229.i_item_sk, t1229.i_item_sk0, t1229.c_current_cdemo_sk, COALESCE(SUM(t1229.cnt * t1230.cnt), 0) AS cnt FROM (SELECT t1226.i_item_sk, t1226.i_item_sk0, t1227.c_current_addr_sk, t1227.c_current_cdemo_sk, COALESCE(SUM(t1226.cnt * t1227.cnt), 0) AS cnt FROM (SELECT t1222.i_item_sk, t1222.i_item_sk0, t1222.ss_customer_sk, COALESCE(SUM(t1222.cnt * t1224.cnt), 0) AS cnt FROM (SELECT t1218.i_item_sk, t1218.i_item_sk0, t1218.ss_sold_date_sk, t1218.ss_customer_sk, COALESCE(SUM(t1218.f8 * t1220.cnt), 0) AS cnt FROM (SELECT t1215.i_item_sk, t1215.i_item_sk0, t1217.ss_sold_date_sk, t1217.ss_customer_sk, t1217.ss_ticket_number, t1215.cnt * t1217.cnt AS f8 FROM (SELECT t1213.i_item_sk, t1214.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM (SELECT * FROM item WHERE i_category IN ('Books', 'Home')) AS t1213 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 81 AND i_manager_id <= 100) AS t1214 ON t1213.i_item_sk < t1214.i_item_sk GROUP BY t1213.i_item_sk, t1214.i_item_sk) AS t1215 INNER JOIN (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_ticket_number, COUNT(*) AS cnt FROM store_sales WHERE ss_list_price >= 83 AND ss_list_price <= 97 GROUP BY ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_ticket_number) AS t1217 ON t1215.i_item_sk = t1217.ss_item_sk) AS t1218 INNER JOIN (SELECT ss_item_sk, ss_ticket_number, COUNT(*) AS cnt FROM store_sales WHERE ss_list_price >= 83 AND ss_list_price <= 97 GROUP BY ss_item_sk, ss_ticket_number) AS t1220 ON t1218.ss_ticket_number = t1220.ss_ticket_number AND t1218.i_item_sk0 = t1220.ss_item_sk GROUP BY t1218.i_item_sk, t1218.i_item_sk0, t1218.ss_sold_date_sk, t1218.ss_customer_sk) AS t1222 INNER JOIN (SELECT d_date_sk, COUNT(*) AS cnt FROM date_dim WHERE d_year >= 1998 AND d_year <= 1998 + 1 GROUP BY d_date_sk) AS t1224 ON t1222.ss_sold_date_sk = t1224.d_date_sk GROUP BY t1222.i_item_sk, t1222.i_item_sk0, t1222.ss_customer_sk) AS t1226 INNER JOIN (SELECT c_customer_sk, c_current_addr_sk, c_current_cdemo_sk, COUNT(*) AS cnt FROM customer GROUP BY c_customer_sk, c_current_addr_sk, c_current_cdemo_sk) AS t1227 ON t1226.ss_customer_sk = t1227.c_customer_sk GROUP BY t1226.i_item_sk, t1226.i_item_sk0, t1227.c_current_addr_sk, t1227.c_current_cdemo_sk) AS t1229 INNER JOIN (SELECT ca_address_sk, COUNT(*) AS cnt FROM customer_address GROUP BY ca_address_sk) AS t1230 ON t1229.c_current_addr_sk = t1230.ca_address_sk GROUP BY t1229.i_item_sk, t1229.i_item_sk0, t1229.c_current_cdemo_sk) AS t1232 INNER JOIN (SELECT cd_demo_sk, COUNT(*) AS cnt FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status = 'Primary' GROUP BY cd_demo_sk) AS t1234 ON t1232.c_current_cdemo_sk = t1234.cd_demo_sk GROUP BY t1232.i_item_sk, t1232.i_item_sk0 ORDER BY COALESCE(SUM(t1232.cnt * t1234.cnt), 0)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
11,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Shoes') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = 'Unknown' and s1.ss_list_price between 153 and 167 and s2.ss_list_price between 153 and 167  ;","SELECT MIN(t1042.EXPR0), MIN(t1042.EXPR1), MIN(t1042.EXPR2), MIN(t1042.EXPR3) FROM (SELECT t1040.c_current_cdemo_sk, MIN(t1040.EXPR0) AS EXPR0, MIN(t1040.EXPR1) AS EXPR1, MIN(t1040.EXPR2) AS EXPR2, MIN(t1040.EXPR3) AS EXPR3 FROM (SELECT t1039.c_current_addr_sk, t1039.c_current_cdemo_sk, MIN(t1038.EXPR0) AS EXPR0, MIN(t1038.EXPR1) AS EXPR1, MIN(t1038.EXPR2) AS EXPR2, MIN(t1038.EXPR3) AS EXPR3 FROM (SELECT t1035.ss_customer_sk, MIN(t1035.EXPR0) AS EXPR0, MIN(t1035.EXPR1) AS EXPR1, MIN(t1035.EXPR2) AS EXPR2, MIN(t1035.EXPR3) AS EXPR3 FROM (SELECT t1032.ss_sold_date_sk, t1032.ss_customer_sk, MIN(t1032.EXPR0) AS EXPR0, MIN(t1032.EXPR1) AS EXPR1, MIN(t1032.EXPR2) AS EXPR2, MIN(t1032.EXPR3) AS EXPR3 FROM (SELECT t1029.i_item_sk0, t1031.ss_sold_date_sk, t1031.ss_customer_sk, t1031.ss_ticket_number, MIN(t1029.EXPR0) AS EXPR0, MIN(t1029.EXPR1) AS EXPR1, MIN(t1031.EXPR2) AS EXPR2, MIN(t1031.EXPR3) AS EXPR3 FROM (SELECT t1027.i_item_sk, t1028.i_item_sk AS i_item_sk0, MIN(t1027.i_item_sk) AS EXPR0, MIN(t1028.i_item_sk) AS EXPR1 FROM (SELECT * FROM item WHERE i_category IN ('Books', 'Shoes')) AS t1027 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 81 AND i_manager_id <= 100) AS t1028 ON t1027.i_item_sk < t1028.i_item_sk GROUP BY t1027.i_item_sk, t1028.i_item_sk) AS t1029 INNER JOIN (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_ticket_number, MIN(ss_ticket_number) AS EXPR2, MIN(ss_item_sk) AS EXPR3 FROM store_sales WHERE ss_list_price >= 153 AND ss_list_price <= 167 GROUP BY ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_ticket_number) AS t1031 ON t1029.i_item_sk = t1031.ss_item_sk GROUP BY t1029.i_item_sk0, t1031.ss_sold_date_sk, t1031.ss_customer_sk, t1031.ss_ticket_number) AS t1032 INNER JOIN (SELECT ss_item_sk, ss_ticket_number FROM store_sales WHERE ss_list_price >= 153 AND ss_list_price <= 167 GROUP BY ss_item_sk, ss_ticket_number) AS t1034 ON t1032.ss_ticket_number = t1034.ss_ticket_number AND t1032.i_item_sk0 = t1034.ss_item_sk GROUP BY t1032.ss_sold_date_sk, t1032.ss_customer_sk) AS t1035 INNER JOIN (SELECT d_date_sk FROM date_dim WHERE d_year >= 1998 AND d_year <= 1998 + 1 GROUP BY d_date_sk) AS t1037 ON t1035.ss_sold_date_sk = t1037.d_date_sk GROUP BY t1035.ss_customer_sk) AS t1038 INNER JOIN (SELECT c_customer_sk, c_current_addr_sk, c_current_cdemo_sk FROM customer GROUP BY c_customer_sk, c_current_addr_sk, c_current_cdemo_sk) AS t1039 ON t1038.ss_customer_sk = t1039.c_customer_sk GROUP BY t1039.c_current_addr_sk, t1039.c_current_cdemo_sk) AS t1040 INNER JOIN (SELECT ca_address_sk FROM customer_address GROUP BY ca_address_sk) AS t1041 ON t1040.c_current_addr_sk = t1041.ca_address_sk GROUP BY t1040.c_current_cdemo_sk) AS t1042 INNER JOIN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' GROUP BY cd_demo_sk) AS t1044 ON t1042.c_current_cdemo_sk = t1044.cd_demo_sk",['Empty List'],"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
12,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Home', 'Men', 'Women') and i_manager_id BETWEEN 1 and 10 and ss_wholesale_cost BETWEEN 36 AND 56 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Home', 'Men', 'Women') and i_manager_id BETWEEN 1 and 10 and cs_wholesale_cost BETWEEN 36 AND 56 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 36 AND 56 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Home', 'Men', 'Women') and i_manager_id BETWEEN 1 and 10 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 36 AND 56  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 36 AND 56  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 36 AND 56 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 3) and i_category IN ('Home', 'Men', 'Women') and i_manager_id BETWEEN 1 and 10 and ss_wholesale_cost BETWEEN 36 AND 56 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 3) and i_category IN ('Home', 'Men', 'Women') and ss_wholesale_cost BETWEEN 36 AND 56 and i_manager_id BETWEEN 1 and 10 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;","SELECT * FROM (SELECT 'store' AS channel, t11239.i_brand_id, t11239.i_class_id, t11239.i_category_id, t11239.sales, t11239.number_sales FROM (SELECT t11238.i_brand_id, t11238.i_class_id, t11238.i_category_id, SUM(t11238.f3) AS sales, COUNT(*) AS number_sales FROM (SELECT t11233.i_brand_id, t11233.i_class_id, t11233.i_category_id, t11233.ss_quantity * t11233.ss_list_price AS f3 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 36 AND ss_wholesale_cost <= 56) AS t11207, (SELECT * FROM item WHERE i_category IN ('Home', 'Men', 'Women') AND (i_manager_id >= 1 AND i_manager_id <= 10)) AS t11208 WHERE t11207.ss_item_sk = t11208.i_item_sk) AS t11209, date_dim AS date_dim2111 WHERE t11209.ss_sold_date_sk = date_dim2111.d_date_sk) AS t11210, (SELECT t11211.i_item_sk AS ss_item_sk FROM (SELECT * FROM item WHERE i_category IN ('Home', 'Men', 'Women') AND (i_manager_id >= 1 AND i_manager_id <= 10)) AS t11211, (SELECT * FROM (SELECT t11214.i_brand_id AS brand_id, t11214.i_class_id AS class_id, t11214.i_category_id AS category_id FROM (SELECT * FROM (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 36 AND ss_wholesale_cost <= 56) AS t11212, (SELECT * FROM item WHERE i_category IN ('Home', 'Men', 'Women') AND (i_manager_id >= 1 AND i_manager_id <= 10)) AS t11213 WHERE t11212.ss_item_sk = t11213.i_item_sk) AS t11214, (SELECT * FROM date_dim WHERE d_year >= 2000 AND d_year <= 2000 + 2) AS t11215 WHERE t11214.ss_sold_date_sk = t11215.d_date_sk INTERSECT SELECT t11220.i_brand_id, t11220.i_class_id, t11220.i_category_id FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 36 AND cs_wholesale_cost <= 56) AS t11218, (SELECT * FROM item WHERE i_category IN ('Home', 'Men', 'Women') AND (i_manager_id >= 1 AND i_manager_id <= 10)) AS t11219 WHERE t11218.cs_item_sk = t11219.i_item_sk) AS t11220, (SELECT * FROM date_dim WHERE d_year >= 2000 AND d_year <= 2000 + 2) AS t11221 WHERE t11220.cs_sold_date_sk = t11221.d_date_sk) AS t INTERSECT SELECT t11226.i_brand_id, t11226.i_class_id, t11226.i_category_id FROM (SELECT * FROM (SELECT * FROM web_sales WHERE ws_wholesale_cost >= 36 AND ws_wholesale_cost <= 56) AS t11225, item AS item1323 WHERE t11225.ws_item_sk = item1323.i_item_sk) AS t11226, (SELECT * FROM date_dim WHERE d_year >= 2000 AND d_year <= 2000 + 2) AS t11227 WHERE t11226.ws_sold_date_sk = t11227.d_date_sk) AS t11230 WHERE t11211.i_brand_id = t11230.brand_id AND t11211.i_class_id = t11230.class_id AND t11211.i_category_id = t11230.category_id) AS t11232 WHERE t11210.ss_item_sk = t11232.ss_item_sk) AS t11233, (SELECT d_week_seq FROM date_dim WHERE d_year = 2000 + 1 AND d_moy = 12 AND d_dom = 3) AS t11235 WHERE t11233.d_week_seq = t11235.d_week_seq) AS t11238 GROUP BY t11238.i_brand_id, t11238.i_class_id, t11238.i_category_id) AS t11239, (SELECT AVG(f0) AS average_sales FROM (SELECT quantity * list_price AS f0 FROM (SELECT * FROM (SELECT t11240.ss_quantity AS quantity, t11240.ss_list_price AS list_price FROM (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 36 AND ss_wholesale_cost <= 56) AS t11240, (SELECT * FROM date_dim WHERE d_year >= 2000 AND d_year <= 2000 + 2) AS t11241 WHERE t11240.ss_sold_date_sk = t11241.d_date_sk UNION ALL SELECT t11244.cs_quantity AS quantity, t11244.cs_list_price AS list_price FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 36 AND cs_wholesale_cost <= 56) AS t11244, (SELECT * FROM date_dim WHERE d_year >= 2000 AND d_year <= 2000 + 2) AS t11245 WHERE t11244.cs_sold_date_sk = t11245.d_date_sk) AS t UNION ALL SELECT t11249.ws_quantity AS quantity, t11249.ws_list_price AS list_price FROM (SELECT * FROM web_sales WHERE ws_wholesale_cost >= 36 AND ws_wholesale_cost <= 56) AS t11249, (SELECT * FROM date_dim WHERE d_year >= 2000 AND d_year <= 2000 + 2) AS t11250 WHERE t11249.ws_sold_date_sk = t11250.d_date_sk) AS t) AS t11254) AS t11255 WHERE t11239.sales > t11255.average_sales) AS t11257, (SELECT 'store' AS channel, t11290.i_brand_id, t11290.i_class_id, t11290.i_category_id, t11290.sales, t11290.number_sales FROM (SELECT t11289.i_brand_id, t11289.i_class_id, t11289.i_category_id, SUM(t11289.f3) AS sales, COUNT(*) AS number_sales FROM (SELECT t11284.i_brand_id, t11284.i_class_id, t11284.i_category_id, t11284.ss_quantity * t11284.ss_list_price AS f3 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 36 AND ss_wholesale_cost <= 56) AS t11258, (SELECT * FROM item WHERE i_category IN ('Home', 'Men', 'Women') AND (i_manager_id >= 1 AND i_manager_id <= 10)) AS t11259 WHERE t11258.ss_item_sk = t11259.i_item_sk) AS t11260, date_dim AS date_dim2119 WHERE t11260.ss_sold_date_sk = date_dim2119.d_date_sk) AS t11261, (SELECT t11262.i_item_sk AS ss_item_sk FROM (SELECT * FROM item WHERE i_category IN ('Home', 'Men', 'Women') AND (i_manager_id >= 1 AND i_manager_id <= 10)) AS t11262, (SELECT * FROM (SELECT t11265.i_brand_id AS brand_id, t11265.i_class_id AS class_id, t11265.i_category_id AS category_id FROM (SELECT * FROM (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 36 AND ss_wholesale_cost <= 56) AS t11263, (SELECT * FROM item WHERE i_category IN ('Home', 'Men', 'Women') AND (i_manager_id >= 1 AND i_manager_id <= 10)) AS t11264 WHERE t11263.ss_item_sk = t11264.i_item_sk) AS t11265, (SELECT * FROM date_dim WHERE d_year >= 2000 AND d_year <= 2000 + 2) AS t11266 WHERE t11265.ss_sold_date_sk = t11266.d_date_sk INTERSECT SELECT t11271.i_brand_id, t11271.i_class_id, t11271.i_category_id FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 36 AND cs_wholesale_cost <= 56) AS t11269, (SELECT * FROM item WHERE i_category IN ('Home', 'Men', 'Women') AND (i_manager_id >= 1 AND i_manager_id <= 10)) AS t11270 WHERE t11269.cs_item_sk = t11270.i_item_sk) AS t11271, (SELECT * FROM date_dim WHERE d_year >= 2000 AND d_year <= 2000 + 2) AS t11272 WHERE t11271.cs_sold_date_sk = t11272.d_date_sk) AS t INTERSECT SELECT t11277.i_brand_id, t11277.i_class_id, t11277.i_category_id FROM (SELECT * FROM (SELECT * FROM web_sales WHERE ws_wholesale_cost >= 36 AND ws_wholesale_cost <= 56) AS t11276, item AS item1328 WHERE t11276.ws_item_sk = item1328.i_item_sk) AS t11277, (SELECT * FROM date_dim WHERE d_year >= 2000 AND d_year <= 2000 + 2) AS t11278 WHERE t11277.ws_sold_date_sk = t11278.d_date_sk) AS t11281 WHERE t11262.i_brand_id = t11281.brand_id AND t11262.i_class_id = t11281.class_id AND t11262.i_category_id = t11281.category_id) AS t11283 WHERE t11261.ss_item_sk = t11283.ss_item_sk) AS t11284, (SELECT d_week_seq FROM date_dim WHERE d_year = 2000 AND d_moy = 12 AND d_dom = 3) AS t11286 WHERE t11284.d_week_seq = t11286.d_week_seq) AS t11289 GROUP BY t11289.i_brand_id, t11289.i_class_id, t11289.i_category_id) AS t11290, (SELECT AVG(f0) AS average_sales FROM (SELECT quantity * list_price AS f0 FROM (SELECT * FROM (SELECT t11291.ss_quantity AS quantity, t11291.ss_list_price AS list_price FROM (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 36 AND ss_wholesale_cost <= 56) AS t11291, (SELECT * FROM date_dim WHERE d_year >= 2000 AND d_year <= 2000 + 2) AS t11292 WHERE t11291.ss_sold_date_sk = t11292.d_date_sk UNION ALL SELECT t11295.cs_quantity AS quantity, t11295.cs_list_price AS list_price FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 36 AND cs_wholesale_cost <= 56) AS t11295, (SELECT * FROM date_dim WHERE d_year >= 2000 AND d_year <= 2000 + 2) AS t11296 WHERE t11295.cs_sold_date_sk = t11296.d_date_sk) AS t UNION ALL SELECT t11300.ws_quantity AS quantity, t11300.ws_list_price AS list_price FROM (SELECT * FROM web_sales WHERE ws_wholesale_cost >= 36 AND ws_wholesale_cost <= 56) AS t11300, (SELECT * FROM date_dim WHERE d_year >= 2000 AND d_year <= 2000 + 2) AS t11301 WHERE t11300.ws_sold_date_sk = t11301.d_date_sk) AS t) AS t11305) AS t11306 WHERE t11290.sales > t11306.average_sales) AS t11308 WHERE t11257.i_brand_id = t11308.i_brand_id AND t11257.i_class_id = t11308.i_class_id AND t11257.i_category_id = t11308.i_category_id ORDER BY t11257.channel, t11257.i_brand_id, t11257.i_class_id, t11257.i_category_id LIMIT 100",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalIntersect', ['LogicalIntersect', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]]], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalUnion', ['LogicalUnion', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]]]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalIntersect', ['LogicalIntersect', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]]], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalUnion', ['LogicalUnion', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]]]]]]]]]"
13,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2000-02-10','2000-04-28','2000-07-11','2000-10-18'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Shoes') and i_manager_id BETWEEN 32 and 41 and sr_return_amt / sr_return_quantity between 186 and 215 and sr_reason_sk in (7, 8, 33, 38, 45) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-02-10','2000-04-28','2000-07-11','2000-10-18'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Shoes') and i_manager_id BETWEEN 32 and 41 and cr_return_amount / cr_return_quantity between 186 and 215 and cr_reason_sk in (7, 8, 33, 38, 45) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-02-10','2000-04-28','2000-07-11','2000-10-18'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Shoes') and i_manager_id BETWEEN 32 and 41 and wr_return_amt / wr_return_quantity between 186 and 215 and wr_reason_sk in (7, 8, 33, 38, 45) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;","SELECT t3612.i_item_id AS item_id, t3612.sr_item_qty, t3612.sr_item_qty / (t3612.sr_item_qty + t3628.cr_item_qty + t3644.wr_item_qty) / 3.0 * 100 AS sr_dev, t3628.cr_item_qty, t3628.cr_item_qty / (t3612.sr_item_qty + t3628.cr_item_qty + t3644.wr_item_qty) / 3.0 * 100 AS cr_dev, t3644.wr_item_qty, t3644.wr_item_qty / (t3612.sr_item_qty + t3628.cr_item_qty + t3644.wr_item_qty) / 3.0 * 100 AS wr_dev, (t3612.sr_item_qty + t3628.cr_item_qty + t3644.wr_item_qty) / 3.0 AS average FROM (SELECT t3605.i_item_id, SUM(CAST(t3605.sr_item_qty * t3610.f1 AS INTEGER)) AS sr_item_qty FROM (SELECT t3602.i_item_id, t3603.d_date, SUM(CAST(t3602.sr_item_qty * t3603.f2 AS INTEGER)) AS sr_item_qty FROM (SELECT t3598.sr_returned_date_sk, t3600.i_item_id, SUM(CAST(t3598.sr_item_qty * t3600.f2 AS INTEGER)) AS sr_item_qty FROM (SELECT sr_returned_date_sk, sr_item_sk, SUM(sr_return_quantity) AS sr_item_qty FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 186 AND sr_return_amt / sr_return_quantity <= 215 AND sr_reason_sk IN (7, 8, 33, 38, 45) GROUP BY sr_returned_date_sk, sr_item_sk) AS t3598 INNER JOIN (SELECT i_item_sk, i_item_id, COUNT(*) AS f2 FROM item WHERE i_category IN ('Children', 'Shoes') AND (i_manager_id >= 32 AND i_manager_id <= 41) GROUP BY i_item_sk, i_item_id) AS t3600 ON t3598.sr_item_sk = t3600.i_item_sk GROUP BY t3598.sr_returned_date_sk, t3600.i_item_id) AS t3602 INNER JOIN (SELECT d_date_sk, d_date, COUNT(*) AS f2 FROM date_dim GROUP BY d_date_sk, d_date) AS t3603 ON t3602.sr_returned_date_sk = t3603.d_date_sk GROUP BY t3602.i_item_id, t3603.d_date) AS t3605 INNER JOIN (SELECT t3606.d_date, COALESCE(SUM(t3606.f2 * t3608.f1), 0) AS f1 FROM (SELECT d_date, d_month_seq, COUNT(*) AS f2 FROM date_dim GROUP BY d_date, d_month_seq) AS t3606 INNER JOIN (SELECT d_month_seq, COUNT(*) AS f1 FROM date_dim WHERE d_date IN (DATE '2000-02-10', DATE '2000-04-28', DATE '2000-07-11', DATE '2000-10-18') GROUP BY d_month_seq) AS t3608 ON t3606.d_month_seq = t3608.d_month_seq GROUP BY t3606.d_date) AS t3610 ON t3605.d_date = t3610.d_date GROUP BY t3605.i_item_id) AS t3612 INNER JOIN (SELECT t3621.i_item_id, SUM(CAST(t3621.cr_item_qty * t3626.f1 AS INTEGER)) AS cr_item_qty FROM (SELECT t3618.i_item_id, t3619.d_date, SUM(CAST(t3618.cr_item_qty * t3619.f2 AS INTEGER)) AS cr_item_qty FROM (SELECT t3614.cr_returned_date_sk, t3616.i_item_id, SUM(CAST(t3614.cr_item_qty * t3616.f2 AS INTEGER)) AS cr_item_qty FROM (SELECT cr_returned_date_sk, cr_item_sk, SUM(cr_return_quantity) AS cr_item_qty FROM catalog_returns WHERE cr_return_amount / cr_return_quantity >= 186 AND cr_return_amount / cr_return_quantity <= 215 AND cr_reason_sk IN (7, 8, 33, 38, 45) GROUP BY cr_returned_date_sk, cr_item_sk) AS t3614 INNER JOIN (SELECT i_item_sk, i_item_id, COUNT(*) AS f2 FROM item WHERE i_category IN ('Children', 'Shoes') AND (i_manager_id >= 32 AND i_manager_id <= 41) GROUP BY i_item_sk, i_item_id) AS t3616 ON t3614.cr_item_sk = t3616.i_item_sk GROUP BY t3614.cr_returned_date_sk, t3616.i_item_id) AS t3618 INNER JOIN (SELECT d_date_sk, d_date, COUNT(*) AS f2 FROM date_dim GROUP BY d_date_sk, d_date) AS t3619 ON t3618.cr_returned_date_sk = t3619.d_date_sk GROUP BY t3618.i_item_id, t3619.d_date) AS t3621 INNER JOIN (SELECT t3622.d_date, COALESCE(SUM(t3622.f2 * t3624.f1), 0) AS f1 FROM (SELECT d_date, d_month_seq, COUNT(*) AS f2 FROM date_dim GROUP BY d_date, d_month_seq) AS t3622 INNER JOIN (SELECT d_month_seq, COUNT(*) AS f1 FROM date_dim WHERE d_date IN (DATE '2000-02-10', DATE '2000-04-28', DATE '2000-07-11', DATE '2000-10-18') GROUP BY d_month_seq) AS t3624 ON t3622.d_month_seq = t3624.d_month_seq GROUP BY t3622.d_date) AS t3626 ON t3621.d_date = t3626.d_date GROUP BY t3621.i_item_id) AS t3628 ON t3612.i_item_id = t3628.i_item_id INNER JOIN (SELECT t3637.i_item_id, SUM(CAST(t3637.wr_item_qty * t3642.f1 AS INTEGER)) AS wr_item_qty FROM (SELECT t3634.i_item_id, t3635.d_date, SUM(CAST(t3634.wr_item_qty * t3635.f2 AS INTEGER)) AS wr_item_qty FROM (SELECT t3630.wr_returned_date_sk, t3632.i_item_id, SUM(CAST(t3630.wr_item_qty * t3632.f2 AS INTEGER)) AS wr_item_qty FROM (SELECT wr_returned_date_sk, wr_item_sk, SUM(wr_return_quantity) AS wr_item_qty FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 186 AND wr_return_amt / wr_return_quantity <= 215 AND wr_reason_sk IN (7, 8, 33, 38, 45) GROUP BY wr_returned_date_sk, wr_item_sk) AS t3630 INNER JOIN (SELECT i_item_sk, i_item_id, COUNT(*) AS f2 FROM item WHERE i_category IN ('Children', 'Shoes') AND (i_manager_id >= 32 AND i_manager_id <= 41) GROUP BY i_item_sk, i_item_id) AS t3632 ON t3630.wr_item_sk = t3632.i_item_sk GROUP BY t3630.wr_returned_date_sk, t3632.i_item_id) AS t3634 INNER JOIN (SELECT d_date_sk, d_date, COUNT(*) AS f2 FROM date_dim GROUP BY d_date_sk, d_date) AS t3635 ON t3634.wr_returned_date_sk = t3635.d_date_sk GROUP BY t3634.i_item_id, t3635.d_date) AS t3637 INNER JOIN (SELECT t3638.d_date, COALESCE(SUM(t3638.f2 * t3640.f1), 0) AS f1 FROM (SELECT d_date, d_month_seq, COUNT(*) AS f2 FROM date_dim GROUP BY d_date, d_month_seq) AS t3638 INNER JOIN (SELECT d_month_seq, COUNT(*) AS f1 FROM date_dim WHERE d_date IN (DATE '2000-02-10', DATE '2000-04-28', DATE '2000-07-11', DATE '2000-10-18') GROUP BY d_month_seq) AS t3640 ON t3638.d_month_seq = t3640.d_month_seq GROUP BY t3638.d_date) AS t3642 ON t3637.d_date = t3642.d_date GROUP BY t3637.i_item_id) AS t3644 ON t3612.i_item_id = t3644.i_item_id ORDER BY t3612.i_item_id, t3612.sr_item_qty LIMIT 100",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]]"
14,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 10 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -6  ;","SELECT MIN(t745.EXPR0), MIN(t745.EXPR1), MIN(t745.EXPR2), MIN(t745.EXPR3), MIN(t745.EXPR4), MIN(t745.EXPR5) FROM (SELECT t742.c_current_hdemo_sk, MIN(t742.EXPR0) AS EXPR0, MIN(t742.EXPR1) AS EXPR1, MIN(t742.EXPR2) AS EXPR2, MIN(t742.EXPR3) AS EXPR3, MIN(t742.EXPR4) AS EXPR4, MIN(t742.EXPR5) AS EXPR5 FROM (SELECT t739.c_current_hdemo_sk, t739.c_current_cdemo_sk, MIN(t739.EXPR0) AS EXPR0, MIN(t739.EXPR1) AS EXPR1, MIN(t739.EXPR2) AS EXPR2, MIN(t739.EXPR3) AS EXPR3, MIN(t739.EXPR4) AS EXPR4, MIN(t739.EXPR5) AS EXPR5 FROM (SELECT t738.c_current_hdemo_sk, t738.c_current_addr_sk, t738.c_current_cdemo_sk, MIN(t737.EXPR0) AS EXPR0, MIN(t737.EXPR1) AS EXPR1, MIN(t737.EXPR2) AS EXPR2, MIN(t737.EXPR3) AS EXPR3, MIN(t737.EXPR4) AS EXPR4, MIN(t737.EXPR5) AS EXPR5 FROM (SELECT t734.cr_returning_customer_sk, MIN(t734.EXPR0) AS EXPR0, MIN(t734.EXPR1) AS EXPR1, MIN(t734.EXPR2) AS EXPR2, MIN(t734.EXPR3) AS EXPR3, MIN(t734.EXPR4) AS EXPR4, MIN(t734.EXPR5) AS EXPR5 FROM (SELECT t733.cr_returned_date_sk, t733.cr_returning_customer_sk, MIN(t732.EXPR0) AS EXPR0, MIN(t732.EXPR1) AS EXPR1, MIN(t732.EXPR2) AS EXPR2, MIN(t733.EXPR3) AS EXPR3, MIN(t733.EXPR4) AS EXPR4, MIN(t733.EXPR5) AS EXPR5 FROM (SELECT cc_call_center_sk, MIN(cc_call_center_id) AS EXPR0, MIN(cc_name) AS EXPR1, MIN(cc_manager) AS EXPR2 FROM call_center GROUP BY cc_call_center_sk) AS t732 INNER JOIN (SELECT cr_returned_date_sk, cr_returning_customer_sk, cr_call_center_sk, MIN(cr_net_loss) AS EXPR3, MIN(cr_item_sk) AS EXPR4, MIN(cr_order_number) AS EXPR5 FROM catalog_returns GROUP BY cr_returned_date_sk, cr_returning_customer_sk, cr_call_center_sk) AS t733 ON t732.cc_call_center_sk = t733.cr_call_center_sk GROUP BY t733.cr_returned_date_sk, t733.cr_returning_customer_sk) AS t734 INNER JOIN (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 10 GROUP BY d_date_sk) AS t736 ON t734.cr_returned_date_sk = t736.d_date_sk GROUP BY t734.cr_returning_customer_sk) AS t737 INNER JOIN (SELECT c_customer_sk, c_current_hdemo_sk, c_current_addr_sk, c_current_cdemo_sk FROM customer GROUP BY c_customer_sk, c_current_hdemo_sk, c_current_addr_sk, c_current_cdemo_sk) AS t738 ON t737.cr_returning_customer_sk = t738.c_customer_sk GROUP BY t738.c_current_hdemo_sk, t738.c_current_addr_sk, t738.c_current_cdemo_sk) AS t739 INNER JOIN (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -6 GROUP BY ca_address_sk) AS t741 ON t739.c_current_addr_sk = t741.ca_address_sk GROUP BY t739.c_current_hdemo_sk, t739.c_current_cdemo_sk) AS t742 INNER JOIN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree' GROUP BY cd_demo_sk) AS t744 ON t742.c_current_cdemo_sk = t744.cd_demo_sk GROUP BY t742.c_current_hdemo_sk) AS t745 INNER JOIN (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential LIKE '1001-5000%' GROUP BY hd_demo_sk) AS t747 ON t745.c_current_hdemo_sk = t747.hd_demo_sk",['Empty List'],"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
15,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1201 and 1201+11 and ss_sales_price / ss_list_price BETWEEN 67 * 0.01 AND 77 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1201 and 1201+11 and ss_sales_price / ss_list_price BETWEEN 67 * 0.01 AND 77 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 85 and 89  and s_state in ('IN','MN','TN') order by s_store_name, i_item_desc limit 100 ;","SELECT t208.s_store_name, t209.i_item_desc, t223.revenue, t209.i_current_price, t209.i_wholesale_cost, t209.i_brand FROM (SELECT * FROM store WHERE s_state IN ('IN', 'MN', 'TN')) AS t208 CROSS JOIN (SELECT * FROM item WHERE i_manager_id >= 85 AND i_manager_id <= 89) AS t209 CROSS JOIN (SELECT t215.ss_store_sk, AVG(t215.revenue) AS ave FROM (SELECT t211.ss_item_sk, t211.ss_store_sk, SUM(t211.revenue * t213.f1) AS revenue FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_store_sk, SUM(ss_sales_price) AS revenue FROM store_sales WHERE ss_sales_price / ss_list_price >= 67 * 0.01 AND ss_sales_price / ss_list_price <= 77 * 0.01 GROUP BY ss_sold_date_sk, ss_item_sk, ss_store_sk) AS t211 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_month_seq >= 1201 AND d_month_seq <= 1201 + 11 GROUP BY d_date_sk) AS t213 ON t211.ss_sold_date_sk = t213.d_date_sk GROUP BY t211.ss_item_sk, t211.ss_store_sk) AS t215 GROUP BY t215.ss_store_sk) AS t216 INNER JOIN (SELECT t218.ss_store_sk, t218.ss_item_sk, SUM(t218.revenue * t220.f1) AS revenue FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_store_sk, SUM(ss_sales_price) AS revenue FROM store_sales WHERE ss_sales_price / ss_list_price >= 67 * 0.01 AND ss_sales_price / ss_list_price <= 77 * 0.01 GROUP BY ss_sold_date_sk, ss_item_sk, ss_store_sk) AS t218 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_month_seq >= 1201 AND d_month_seq <= 1201 + 11 GROUP BY d_date_sk) AS t220 ON t218.ss_sold_date_sk = t220.d_date_sk GROUP BY t218.ss_item_sk, t218.ss_store_sk) AS t223 ON t216.ss_store_sk = t223.ss_store_sk AND t223.revenue <= 0.1 * t216.ave AND t208.s_store_sk = t223.ss_store_sk AND t209.i_item_sk = t223.ss_item_sk ORDER BY t208.s_store_name, t209.i_item_desc LIMIT 100",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]]]"
16,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Lakeview' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 35416 and ib_upper_bound <= 35416 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;","SELECT customer80.c_customer_id AS customer_id, customer80.c_last_name || ', ' || customer80.c_first_name AS customername FROM customer AS customer80 INNER JOIN (SELECT * FROM customer_address WHERE ca_city = 'Lakeview') AS t510 ON customer80.c_current_addr_sk = t510.ca_address_sk INNER JOIN customer_demographics AS customer_demographics80 ON customer80.c_current_cdemo_sk = customer_demographics80.cd_demo_sk INNER JOIN household_demographics AS household_demographics80 ON customer80.c_current_hdemo_sk = household_demographics80.hd_demo_sk INNER JOIN (SELECT * FROM income_band WHERE ib_lower_bound >= 35416 AND ib_upper_bound <= 35416 + 50000) AS t511 ON household_demographics80.hd_income_band_sk = t511.ib_income_band_sk INNER JOIN store_returns AS store_returns80 ON customer_demographics80.cd_demo_sk = store_returns80.sr_cdemo_sk ORDER BY customer80.c_customer_id LIMIT 100",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
17,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('mint', 'sandy') and i_manager_id BETWEEN 5 and 24 and ss_list_price between 278 and 292 and ca_state in ('AR','GA') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('mint', 'sandy') and i_manager_id BETWEEN 5 and 24 and ws_list_price between 278 and 292 and ca_state in ('AR','GA') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year ;","SELECT t3287.ca_county, t3287.d_year, t3347.web_sales / t3332.web_sales AS web_q1_q2_increase, t3302.store_sales / t3287.store_sales AS store_q1_q2_increase, t3362.web_sales / t3347.web_sales AS web_q2_q3_increase, t3317.store_sales / t3302.store_sales AS store_q2_q3_increase FROM (SELECT t3282.ca_county, 1 AS d_qoy, 2000 AS d_year, SUM(t3282.store_sales * t3284.f1) AS store_sales FROM (SELECT t3278.ss_item_sk, t3280.ca_county, SUM(t3278.store_sales * t3280.f2) AS store_sales FROM (SELECT t3274.ss_item_sk, t3274.ss_addr_sk, SUM(t3274.store_sales * t3276.f1) AS store_sales FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_addr_sk, SUM(ss_ext_sales_price) AS store_sales FROM store_sales WHERE ss_list_price >= 278 AND ss_list_price <= 292 GROUP BY ss_sold_date_sk, ss_item_sk, ss_addr_sk) AS t3274 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_qoy = 1 AND d_year = 2000 GROUP BY d_date_sk) AS t3276 ON t3274.ss_sold_date_sk = t3276.d_date_sk GROUP BY t3274.ss_item_sk, t3274.ss_addr_sk) AS t3278 INNER JOIN (SELECT ca_address_sk, ca_county, COUNT(*) AS f2 FROM customer_address WHERE ca_state IN ('AR', 'GA') GROUP BY ca_address_sk, ca_county) AS t3280 ON t3278.ss_addr_sk = t3280.ca_address_sk GROUP BY t3278.ss_item_sk, t3280.ca_county) AS t3282 INNER JOIN (SELECT i_item_sk, COUNT(*) AS f1 FROM item WHERE i_color IN ('mint', 'sandy') AND (i_manager_id >= 5 AND i_manager_id <= 24) GROUP BY i_item_sk) AS t3284 ON t3282.ss_item_sk = t3284.i_item_sk GROUP BY t3282.ca_county) AS t3287 INNER JOIN (SELECT t3297.ca_county, 2 AS d_qoy, 2000 AS d_year, SUM(t3297.store_sales * t3299.f1) AS store_sales FROM (SELECT t3293.ss_item_sk, t3295.ca_county, SUM(t3293.store_sales * t3295.f2) AS store_sales FROM (SELECT t3289.ss_item_sk, t3289.ss_addr_sk, SUM(t3289.store_sales * t3291.f1) AS store_sales FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_addr_sk, SUM(ss_ext_sales_price) AS store_sales FROM store_sales WHERE ss_list_price >= 278 AND ss_list_price <= 292 GROUP BY ss_sold_date_sk, ss_item_sk, ss_addr_sk) AS t3289 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_qoy = 2 AND d_year = 2000 GROUP BY d_date_sk) AS t3291 ON t3289.ss_sold_date_sk = t3291.d_date_sk GROUP BY t3289.ss_item_sk, t3289.ss_addr_sk) AS t3293 INNER JOIN (SELECT ca_address_sk, ca_county, COUNT(*) AS f2 FROM customer_address WHERE ca_state IN ('AR', 'GA') GROUP BY ca_address_sk, ca_county) AS t3295 ON t3293.ss_addr_sk = t3295.ca_address_sk GROUP BY t3293.ss_item_sk, t3295.ca_county) AS t3297 INNER JOIN (SELECT i_item_sk, COUNT(*) AS f1 FROM item WHERE i_color IN ('mint', 'sandy') AND (i_manager_id >= 5 AND i_manager_id <= 24) GROUP BY i_item_sk) AS t3299 ON t3297.ss_item_sk = t3299.i_item_sk GROUP BY t3297.ca_county) AS t3302 ON t3287.ca_county = t3302.ca_county INNER JOIN (SELECT t3312.ca_county, 3 AS d_qoy, 2000 AS d_year, SUM(t3312.store_sales * t3314.f1) AS store_sales FROM (SELECT t3308.ss_item_sk, t3310.ca_county, SUM(t3308.store_sales * t3310.f2) AS store_sales FROM (SELECT t3304.ss_item_sk, t3304.ss_addr_sk, SUM(t3304.store_sales * t3306.f1) AS store_sales FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_addr_sk, SUM(ss_ext_sales_price) AS store_sales FROM store_sales WHERE ss_list_price >= 278 AND ss_list_price <= 292 GROUP BY ss_sold_date_sk, ss_item_sk, ss_addr_sk) AS t3304 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_qoy = 3 AND d_year = 2000 GROUP BY d_date_sk) AS t3306 ON t3304.ss_sold_date_sk = t3306.d_date_sk GROUP BY t3304.ss_item_sk, t3304.ss_addr_sk) AS t3308 INNER JOIN (SELECT ca_address_sk, ca_county, COUNT(*) AS f2 FROM customer_address WHERE ca_state IN ('AR', 'GA') GROUP BY ca_address_sk, ca_county) AS t3310 ON t3308.ss_addr_sk = t3310.ca_address_sk GROUP BY t3308.ss_item_sk, t3310.ca_county) AS t3312 INNER JOIN (SELECT i_item_sk, COUNT(*) AS f1 FROM item WHERE i_color IN ('mint', 'sandy') AND (i_manager_id >= 5 AND i_manager_id <= 24) GROUP BY i_item_sk) AS t3314 ON t3312.ss_item_sk = t3314.i_item_sk GROUP BY t3312.ca_county) AS t3317 ON t3302.ca_county = t3317.ca_county INNER JOIN (SELECT t3327.ca_county, 1 AS d_qoy, 2000 AS d_year, SUM(t3327.web_sales * t3329.f1) AS web_sales FROM (SELECT t3323.ws_item_sk, t3325.ca_county, SUM(t3323.web_sales * t3325.f2) AS web_sales FROM (SELECT t3319.ws_item_sk, t3319.ws_bill_addr_sk, SUM(t3319.web_sales * t3321.f1) AS web_sales FROM (SELECT ws_sold_date_sk, ws_item_sk, ws_bill_addr_sk, SUM(ws_ext_sales_price) AS web_sales FROM web_sales WHERE ws_list_price >= 278 AND ws_list_price <= 292 GROUP BY ws_sold_date_sk, ws_item_sk, ws_bill_addr_sk) AS t3319 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_qoy = 1 AND d_year = 2000 GROUP BY d_date_sk) AS t3321 ON t3319.ws_sold_date_sk = t3321.d_date_sk GROUP BY t3319.ws_item_sk, t3319.ws_bill_addr_sk) AS t3323 INNER JOIN (SELECT ca_address_sk, ca_county, COUNT(*) AS f2 FROM customer_address WHERE ca_state IN ('AR', 'GA') GROUP BY ca_address_sk, ca_county) AS t3325 ON t3323.ws_bill_addr_sk = t3325.ca_address_sk GROUP BY t3323.ws_item_sk, t3325.ca_county) AS t3327 INNER JOIN (SELECT i_item_sk, COUNT(*) AS f1 FROM item WHERE i_color IN ('mint', 'sandy') AND (i_manager_id >= 5 AND i_manager_id <= 24) GROUP BY i_item_sk) AS t3329 ON t3327.ws_item_sk = t3329.i_item_sk GROUP BY t3327.ca_county) AS t3332 ON t3287.ca_county = t3332.ca_county INNER JOIN (SELECT t3342.ca_county, 2 AS d_qoy, 2000 AS d_year, SUM(t3342.web_sales * t3344.f1) AS web_sales FROM (SELECT t3338.ws_item_sk, t3340.ca_county, SUM(t3338.web_sales * t3340.f2) AS web_sales FROM (SELECT t3334.ws_item_sk, t3334.ws_bill_addr_sk, SUM(t3334.web_sales * t3336.f1) AS web_sales FROM (SELECT ws_sold_date_sk, ws_item_sk, ws_bill_addr_sk, SUM(ws_ext_sales_price) AS web_sales FROM web_sales WHERE ws_list_price >= 278 AND ws_list_price <= 292 GROUP BY ws_sold_date_sk, ws_item_sk, ws_bill_addr_sk) AS t3334 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_qoy = 2 AND d_year = 2000 GROUP BY d_date_sk) AS t3336 ON t3334.ws_sold_date_sk = t3336.d_date_sk GROUP BY t3334.ws_item_sk, t3334.ws_bill_addr_sk) AS t3338 INNER JOIN (SELECT ca_address_sk, ca_county, COUNT(*) AS f2 FROM customer_address WHERE ca_state IN ('AR', 'GA') GROUP BY ca_address_sk, ca_county) AS t3340 ON t3338.ws_bill_addr_sk = t3340.ca_address_sk GROUP BY t3338.ws_item_sk, t3340.ca_county) AS t3342 INNER JOIN (SELECT i_item_sk, COUNT(*) AS f1 FROM item WHERE i_color IN ('mint', 'sandy') AND (i_manager_id >= 5 AND i_manager_id <= 24) GROUP BY i_item_sk) AS t3344 ON t3342.ws_item_sk = t3344.i_item_sk GROUP BY t3342.ca_county) AS t3347 ON t3332.ca_county = t3347.ca_county AND CASE WHEN t3332.web_sales > 0 THEN t3347.web_sales / t3332.web_sales ELSE NULL END > CASE WHEN t3287.store_sales > 0 THEN t3302.store_sales / t3287.store_sales ELSE NULL END INNER JOIN (SELECT t3357.ca_county, 3 AS d_qoy, 2000 AS d_year, SUM(t3357.web_sales * t3359.f1) AS web_sales FROM (SELECT t3353.ws_item_sk, t3355.ca_county, SUM(t3353.web_sales * t3355.f2) AS web_sales FROM (SELECT t3349.ws_item_sk, t3349.ws_bill_addr_sk, SUM(t3349.web_sales * t3351.f1) AS web_sales FROM (SELECT ws_sold_date_sk, ws_item_sk, ws_bill_addr_sk, SUM(ws_ext_sales_price) AS web_sales FROM web_sales WHERE ws_list_price >= 278 AND ws_list_price <= 292 GROUP BY ws_sold_date_sk, ws_item_sk, ws_bill_addr_sk) AS t3349 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_qoy = 3 AND d_year = 2000 GROUP BY d_date_sk) AS t3351 ON t3349.ws_sold_date_sk = t3351.d_date_sk GROUP BY t3349.ws_item_sk, t3349.ws_bill_addr_sk) AS t3353 INNER JOIN (SELECT ca_address_sk, ca_county, COUNT(*) AS f2 FROM customer_address WHERE ca_state IN ('AR', 'GA') GROUP BY ca_address_sk, ca_county) AS t3355 ON t3353.ws_bill_addr_sk = t3355.ca_address_sk GROUP BY t3353.ws_item_sk, t3355.ca_county) AS t3357 INNER JOIN (SELECT i_item_sk, COUNT(*) AS f1 FROM item WHERE i_color IN ('mint', 'sandy') AND (i_manager_id >= 5 AND i_manager_id <= 24) GROUP BY i_item_sk) AS t3359 ON t3357.ws_item_sk = t3359.i_item_sk GROUP BY t3357.ca_county) AS t3362 ON t3332.ca_county = t3362.ca_county AND CASE WHEN t3347.web_sales > 0 THEN t3362.web_sales / t3347.web_sales ELSE NULL END > CASE WHEN t3302.store_sales > 0 THEN t3317.store_sales / t3302.store_sales ELSE NULL END ORDER BY t3287.d_year",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
18,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-07-16')) and ss_sold_date_sk = d_date_sk and ss_list_price between 271 and 300 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-07-16')) and cs_sold_date_sk = d_date_sk and cs_list_price between 271 and 300 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-07-16')) and ws_sold_date_sk = d_date_sk and ws_list_price between 271 and 300 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;","SELECT t4465.item_id, t4465.birth_year, t4465.ss_item_rev, t4465.ss_item_rev / ((t4465.ss_item_rev + t4474.cs_item_rev + t4483.ws_item_rev) / 3) * 100 AS ss_dev, t4474.cs_item_rev, t4474.cs_item_rev / ((t4465.ss_item_rev + t4474.cs_item_rev + t4483.ws_item_rev) / 3) * 100 AS cs_dev, t4483.ws_item_rev, t4483.ws_item_rev / ((t4465.ss_item_rev + t4474.cs_item_rev + t4483.ws_item_rev) / 3) * 100 AS ws_dev, (t4465.ss_item_rev + t4474.cs_item_rev + t4483.ws_item_rev) / 3 AS average FROM (SELECT t4458.i_item_id AS item_id, t4459.c_birth_year AS birth_year, SUM(t4457.ss_ext_sales_price) AS ss_item_rev FROM (SELECT * FROM store_sales WHERE ss_list_price >= 271 AND ss_list_price <= 300) AS t4457 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 71 AND i_manager_id <= 100) AS t4458 ON t4457.ss_item_sk = t4458.i_item_sk INNER JOIN date_dim AS date_dim1061 ON t4457.ss_sold_date_sk = date_dim1061.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1987 AND c_birth_year <= 1993) AS t4459 ON t4457.ss_customer_sk = t4459.c_customer_sk INNER JOIN (SELECT date_dim1062.d_date FROM date_dim AS date_dim1062 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = DATE '2000-07-16') AS t4461 ON date_dim1062.d_month_seq = t4461.d_month_seq) AS t4463 ON date_dim1061.d_date = t4463.d_date GROUP BY t4458.i_item_id, t4459.c_birth_year) AS t4465 INNER JOIN (SELECT t4467.i_item_id AS item_id, t4468.c_birth_year AS birth_year, SUM(t4466.cs_ext_sales_price) AS cs_item_rev FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 271 AND cs_list_price <= 300) AS t4466 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 71 AND i_manager_id <= 100) AS t4467 ON t4466.cs_item_sk = t4467.i_item_sk INNER JOIN date_dim AS date_dim1064 ON t4466.cs_sold_date_sk = date_dim1064.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1987 AND c_birth_year <= 1993) AS t4468 ON t4466.cs_bill_customer_sk = t4468.c_customer_sk INNER JOIN (SELECT date_dim1065.d_date FROM date_dim AS date_dim1065 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = DATE '2000-07-16') AS t4470 ON date_dim1065.d_month_seq = t4470.d_month_seq) AS t4472 ON date_dim1064.d_date = t4472.d_date GROUP BY t4467.i_item_id, t4468.c_birth_year) AS t4474 ON t4465.item_id = t4474.item_id AND (t4465.birth_year = t4474.birth_year AND t4465.ss_item_rev >= 0.9 * t4474.cs_item_rev) AND (t4465.ss_item_rev <= 1.1 * t4474.cs_item_rev AND (t4474.cs_item_rev >= 0.9 * t4465.ss_item_rev AND t4474.cs_item_rev <= 1.1 * t4465.ss_item_rev)) INNER JOIN (SELECT t4476.i_item_id AS item_id, t4477.c_birth_year AS birth_year, SUM(t4475.ws_ext_sales_price) AS ws_item_rev FROM (SELECT * FROM web_sales WHERE ws_list_price >= 271 AND ws_list_price <= 300) AS t4475 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 71 AND i_manager_id <= 100) AS t4476 ON t4475.ws_item_sk = t4476.i_item_sk INNER JOIN date_dim AS date_dim1067 ON t4475.ws_sold_date_sk = date_dim1067.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1987 AND c_birth_year <= 1993) AS t4477 ON t4475.ws_bill_customer_sk = t4477.c_customer_sk INNER JOIN (SELECT date_dim1068.d_date FROM date_dim AS date_dim1068 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = DATE '2000-07-16') AS t4479 ON date_dim1068.d_month_seq = t4479.d_month_seq) AS t4481 ON date_dim1067.d_date = t4481.d_date GROUP BY t4476.i_item_id, t4477.c_birth_year) AS t4483 ON t4465.item_id = t4483.item_id AND t4465.birth_year = t4483.birth_year AND (t4465.ss_item_rev >= 0.9 * t4483.ws_item_rev AND (t4465.ss_item_rev <= 1.1 * t4483.ws_item_rev AND t4474.cs_item_rev >= 0.9 * t4483.ws_item_rev)) AND (t4474.cs_item_rev <= 1.1 * t4483.ws_item_rev AND t4483.ws_item_rev >= 0.9 * t4465.ss_item_rev AND (t4483.ws_item_rev <= 1.1 * t4465.ss_item_rev AND (t4483.ws_item_rev >= 0.9 * t4474.cs_item_rev AND t4483.ws_item_rev <= 1.1 * t4474.cs_item_rev))) ORDER BY t4465.item_id, t4465.birth_year, t4465.ss_item_rev LIMIT 100",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]]]"
19,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 13 AND 33 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 45 and 45 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('GA','MA','UT') and ss_wholesale_cost BETWEEN 13 AND 33 and cd1.cd_marital_status in ('U', 'U', 'S') and cd1.cd_education_status in ('Advanced Degree', 'Secondary', 'Secondary') and cd2.cd_marital_status in ('U', 'U', 'S') and cd2.cd_education_status in ('Advanced Degree', 'Secondary', 'Secondary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2000 and cs2.syear = 2000 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;","SELECT t3937.product_name, t3937.store_name, t3937.store_zip, t3937.b_street_number, t3937.b_street_name, t3937.b_city, t3937.b_zip, t3937.c_street_number, t3937.c_street_name, t3937.c_city, t3937.c_zip, t3937.syear, t3937.cnt, t3937.s1 AS s11, t3937.s2 AS s21, t3937.s3 AS s31, t3950.s1 AS s12, t3950.s2 AS s22, t3950.s3 AS s32, t3950.syear AS syear0, t3950.cnt AS cnt0 FROM (SELECT t3935.i_product_name AS product_name, t3935.i_item_sk AS item_sk, store177.s_store_name AS store_name, store177.s_zip AS store_zip, customer_address355.ca_street_number AS b_street_number, customer_address355.ca_street_name AS b_street_name, customer_address355.ca_city AS b_city, customer_address355.ca_zip AS b_zip, t3934.ca_street_number AS c_street_number, t3934.ca_street_name AS c_street_name, t3934.ca_city AS c_city, t3934.ca_zip AS c_zip, t3930.d_year AS syear, date_dim534.d_year AS fsyear, date_dim535.d_year AS s2year, COUNT(*) AS cnt, SUM(t3925.ss_wholesale_cost) AS s1, SUM(t3925.ss_list_price) AS s2, SUM(t3925.ss_coupon_amt) AS s3 FROM (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 13 AND ss_wholesale_cost <= 33) AS t3925 INNER JOIN store_returns AS store_returns177 ON t3925.ss_item_sk = store_returns177.sr_item_sk AND t3925.ss_ticket_number = store_returns177.sr_ticket_number INNER JOIN (SELECT t3926.cs_item_sk, SUM(t3926.cs_ext_list_price) AS sale, SUM(catalog_returns177.cr_refunded_cash + catalog_returns177.cr_reversed_charge + catalog_returns177.cr_store_credit) AS refund FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 13 AND cs_wholesale_cost <= 33) AS t3926 INNER JOIN catalog_returns AS catalog_returns177 ON t3926.cs_item_sk = catalog_returns177.cr_item_sk AND t3926.cs_order_number = catalog_returns177.cr_order_number GROUP BY t3926.cs_item_sk HAVING SUM(t3926.cs_ext_list_price) > 2 * SUM(catalog_returns177.cr_refunded_cash + catalog_returns177.cr_reversed_charge + catalog_returns177.cr_store_credit)) AS t3929 ON t3925.ss_item_sk = t3929.cs_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t3930 ON t3925.ss_sold_date_sk = t3930.d_date_sk CROSS JOIN date_dim AS date_dim534 CROSS JOIN date_dim AS date_dim535 INNER JOIN store AS store177 ON t3925.ss_store_sk = store177.s_store_sk INNER JOIN customer AS customer177 ON t3925.ss_customer_sk = customer177.c_customer_sk AND date_dim534.d_date_sk = customer177.c_first_sales_date_sk AND date_dim535.d_date_sk = customer177.c_first_shipto_date_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('S', 'U') AND cd_education_status IN ('Advanced Degree', 'Secondary')) AS t3931 ON t3925.ss_cdemo_sk = t3931.cd_demo_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('S', 'U') AND cd_education_status IN ('Advanced Degree', 'Secondary')) AS t3932 ON customer177.c_current_cdemo_sk = t3932.cd_demo_sk AND t3931.cd_marital_status <> t3932.cd_marital_status INNER JOIN (SELECT * FROM promotion WHERE p_channel_email = 'N' AND p_channel_tv = 'Y' AND p_channel_radio = 'Y') AS t3933 ON t3925.ss_promo_sk = t3933.p_promo_sk INNER JOIN household_demographics AS household_demographics355 ON t3925.ss_hdemo_sk = household_demographics355.hd_demo_sk INNER JOIN household_demographics AS household_demographics356 ON customer177.c_current_hdemo_sk = household_demographics356.hd_demo_sk INNER JOIN customer_address AS customer_address355 ON t3925.ss_addr_sk = customer_address355.ca_address_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('GA', 'MA', 'UT')) AS t3934 ON customer177.c_current_addr_sk = t3934.ca_address_sk INNER JOIN income_band AS income_band355 ON household_demographics355.hd_income_band_sk = income_band355.ib_income_band_sk INNER JOIN income_band AS income_band356 ON household_demographics356.hd_income_band_sk = income_band356.ib_income_band_sk INNER JOIN (SELECT * FROM item WHERE i_current_price >= 45 AND i_current_price <= 45 + 10) AS t3935 ON t3925.ss_item_sk = t3935.i_item_sk GROUP BY t3935.i_product_name, t3935.i_item_sk, store177.s_store_name, store177.s_zip, customer_address355.ca_street_number, customer_address355.ca_street_name, customer_address355.ca_city, customer_address355.ca_zip, t3934.ca_street_number, t3934.ca_street_name, t3934.ca_city, t3934.ca_zip, t3930.d_year, date_dim534.d_year, date_dim535.d_year) AS t3937 INNER JOIN (SELECT t3948.i_product_name AS product_name, t3948.i_item_sk AS item_sk, store178.s_store_name AS store_name, store178.s_zip AS store_zip, customer_address357.ca_street_number AS b_street_number, customer_address357.ca_street_name AS b_street_name, customer_address357.ca_city AS b_city, customer_address357.ca_zip AS b_zip, t3947.ca_street_number AS c_street_number, t3947.ca_street_name AS c_street_name, t3947.ca_city AS c_city, t3947.ca_zip AS c_zip, t3943.d_year AS syear, date_dim537.d_year AS fsyear, date_dim538.d_year AS s2year, COUNT(*) AS cnt, SUM(t3938.ss_wholesale_cost) AS s1, SUM(t3938.ss_list_price) AS s2, SUM(t3938.ss_coupon_amt) AS s3 FROM (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 13 AND ss_wholesale_cost <= 33) AS t3938 INNER JOIN store_returns AS store_returns178 ON t3938.ss_item_sk = store_returns178.sr_item_sk AND t3938.ss_ticket_number = store_returns178.sr_ticket_number INNER JOIN (SELECT t3939.cs_item_sk, SUM(t3939.cs_ext_list_price) AS sale, SUM(catalog_returns178.cr_refunded_cash + catalog_returns178.cr_reversed_charge + catalog_returns178.cr_store_credit) AS refund FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 13 AND cs_wholesale_cost <= 33) AS t3939 INNER JOIN catalog_returns AS catalog_returns178 ON t3939.cs_item_sk = catalog_returns178.cr_item_sk AND t3939.cs_order_number = catalog_returns178.cr_order_number GROUP BY t3939.cs_item_sk HAVING SUM(t3939.cs_ext_list_price) > 2 * SUM(catalog_returns178.cr_refunded_cash + catalog_returns178.cr_reversed_charge + catalog_returns178.cr_store_credit)) AS t3942 ON t3938.ss_item_sk = t3942.cs_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000 + 1) AS t3943 ON t3938.ss_sold_date_sk = t3943.d_date_sk CROSS JOIN date_dim AS date_dim537 CROSS JOIN date_dim AS date_dim538 INNER JOIN store AS store178 ON t3938.ss_store_sk = store178.s_store_sk INNER JOIN customer AS customer178 ON t3938.ss_customer_sk = customer178.c_customer_sk AND date_dim537.d_date_sk = customer178.c_first_sales_date_sk AND date_dim538.d_date_sk = customer178.c_first_shipto_date_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('S', 'U') AND cd_education_status IN ('Advanced Degree', 'Secondary')) AS t3944 ON t3938.ss_cdemo_sk = t3944.cd_demo_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('S', 'U') AND cd_education_status IN ('Advanced Degree', 'Secondary')) AS t3945 ON customer178.c_current_cdemo_sk = t3945.cd_demo_sk AND t3944.cd_marital_status <> t3945.cd_marital_status INNER JOIN (SELECT * FROM promotion WHERE p_channel_email = 'N' AND p_channel_tv = 'Y' AND p_channel_radio = 'Y') AS t3946 ON t3938.ss_promo_sk = t3946.p_promo_sk INNER JOIN household_demographics AS household_demographics357 ON t3938.ss_hdemo_sk = household_demographics357.hd_demo_sk INNER JOIN household_demographics AS household_demographics358 ON customer178.c_current_hdemo_sk = household_demographics358.hd_demo_sk INNER JOIN customer_address AS customer_address357 ON t3938.ss_addr_sk = customer_address357.ca_address_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('GA', 'MA', 'UT')) AS t3947 ON customer178.c_current_addr_sk = t3947.ca_address_sk INNER JOIN income_band AS income_band357 ON household_demographics357.hd_income_band_sk = income_band357.ib_income_band_sk INNER JOIN income_band AS income_band358 ON household_demographics358.hd_income_band_sk = income_band358.ib_income_band_sk INNER JOIN (SELECT * FROM item WHERE i_current_price >= 45 AND i_current_price <= 45 + 10) AS t3948 ON t3938.ss_item_sk = t3948.i_item_sk GROUP BY t3948.i_product_name, t3948.i_item_sk, store178.s_store_name, store178.s_zip, customer_address357.ca_street_number, customer_address357.ca_street_name, customer_address357.ca_city, customer_address357.ca_zip, t3947.ca_street_number, t3947.ca_street_name, t3947.ca_city, t3947.ca_zip, t3943.d_year, date_dim537.d_year, date_dim538.d_year) AS t3950 ON t3937.item_sk = t3950.item_sk AND t3937.cnt >= t3950.cnt AND t3937.store_name = t3950.store_name AND t3937.store_zip = t3950.store_zip ORDER BY t3937.product_name, t3937.store_name, t3950.cnt, t3937.s1, t3950.s1",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
20,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212 + 11 and c_birth_month in (3, 4, 9, 11) and ss_list_price between 158 and 217 and ss_wholesale_cost BETWEEN 71 AND 91 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212 + 11 and c_birth_month in (3, 4, 9, 11) and cs_list_price between 158 and 217 and cs_wholesale_cost BETWEEN 71 AND 91 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212 + 11 and c_birth_month in (3, 4, 9, 11) and ws_list_price between 158 and 217 and ws_wholesale_cost BETWEEN 71 AND 91 ) hot_cust limit 100 ;","SELECT COUNT(*) FROM (SELECT * FROM (SELECT customer.c_last_name, customer.c_first_name, date_dim.d_date FROM store_sales, date_dim, customer WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk AND (date_dim.d_month_seq >= 1212 AND date_dim.d_month_seq <= 1212 + 11) AND ((customer.c_birth_month = 3 OR customer.c_birth_month = 4 OR customer.c_birth_month = 9 OR customer.c_birth_month = 11) AND store_sales.ss_list_price >= 158 AND (store_sales.ss_list_price <= 217 AND (store_sales.ss_wholesale_cost >= 71 AND store_sales.ss_wholesale_cost <= 91))) INTERSECT SELECT customer0.c_last_name, customer0.c_first_name, date_dim0.d_date FROM catalog_sales, date_dim AS date_dim0, customer AS customer0 WHERE catalog_sales.cs_sold_date_sk = date_dim0.d_date_sk AND catalog_sales.cs_bill_customer_sk = customer0.c_customer_sk AND (date_dim0.d_month_seq >= 1212 AND date_dim0.d_month_seq <= 1212 + 11) AND ((customer0.c_birth_month = 3 OR customer0.c_birth_month = 4 OR customer0.c_birth_month = 9 OR customer0.c_birth_month = 11) AND catalog_sales.cs_list_price >= 158 AND (catalog_sales.cs_list_price <= 217 AND (catalog_sales.cs_wholesale_cost >= 71 AND catalog_sales.cs_wholesale_cost <= 91)))) AS t INTERSECT SELECT customer1.c_last_name, customer1.c_first_name, date_dim1.d_date FROM web_sales, date_dim AS date_dim1, customer AS customer1 WHERE web_sales.ws_sold_date_sk = date_dim1.d_date_sk AND web_sales.ws_bill_customer_sk = customer1.c_customer_sk AND (date_dim1.d_month_seq >= 1212 AND date_dim1.d_month_seq <= 1212 + 11) AND ((customer1.c_birth_month = 3 OR customer1.c_birth_month = 4 OR customer1.c_birth_month = 9 OR customer1.c_birth_month = 11) AND web_sales.ws_list_price >= 158 AND (web_sales.ws_list_price <= 217 AND (web_sales.ws_wholesale_cost >= 71 AND web_sales.ws_wholesale_cost <= 91)))) AS t6 LIMIT 100;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalIntersect', ['LogicalIntersect', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
21,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'KY', 'NC') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'NE', 'UT') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'MN', 'NE') and ss_net_profit between 50 and 250 ))  ;","SELECT MIN(store_sales.ss_quantity), MIN(store_sales.ss_ext_sales_price), MIN(store_sales.ss_ext_wholesale_cost), MIN(store_sales.ss_ext_wholesale_cost) FROM store_sales INNER JOIN store ON store_sales.ss_store_sk = store.s_store_sk CROSS JOIN customer_demographics INNER JOIN household_demographics ON store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (customer_demographics.cd_demo_sk = store_sales.ss_cdemo_sk AND customer_demographics.cd_marital_status = 'M') AND (customer_demographics.cd_education_status = '4 yr Degree' AND (store_sales.ss_sales_price >= 100.00 AND store_sales.ss_sales_price <= 150.00 AND household_demographics.hd_dep_count = 3)) OR store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (customer_demographics.cd_demo_sk = store_sales.ss_cdemo_sk AND customer_demographics.cd_marital_status = 'M') AND (customer_demographics.cd_education_status = 'Advanced Degree' AND (store_sales.ss_sales_price >= 50.00 AND store_sales.ss_sales_price <= 100.00 AND household_demographics.hd_dep_count = 1)) OR store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (customer_demographics.cd_demo_sk = store_sales.ss_cdemo_sk AND customer_demographics.cd_marital_status = 'S') AND (customer_demographics.cd_education_status = '4 yr Degree' AND (store_sales.ss_sales_price >= 150.00 AND store_sales.ss_sales_price <= 200.00 AND household_demographics.hd_dep_count = 1)) INNER JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk AND customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('AR', 'KY', 'NC') AND (store_sales.ss_net_profit >= 100 AND store_sales.ss_net_profit <= 200) OR store_sales.ss_addr_sk = customer_address.ca_address_sk AND customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('KY', 'NE', 'UT') AND (store_sales.ss_net_profit >= 150 AND store_sales.ss_net_profit <= 300) OR store_sales.ss_addr_sk = customer_address.ca_address_sk AND customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('KY', 'MN', 'NE') AND (store_sales.ss_net_profit >= 50 AND store_sales.ss_net_profit <= 250) INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t ON store_sales.ss_sold_date_sk = t.d_date_sk;",['Empty List'],"['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
22,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Clarke County','Franklin County','Jim Wells County','Licking County','Windham County') and c.c_birth_month in (8, 9) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'S', 'W') and cd_education_status in ('Advanced Degree', 'Advanced Degree', '4 yr Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 5 and 5+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and ss_sales_price / ss_list_price BETWEEN 82 * 0.01 AND 92 * 0.01  and i_manager_id BETWEEN 47 and 56  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 5 ANd 5+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and i_manager_id BETWEEN 47 and 56  and ws_sales_price / ws_list_price BETWEEN 82 * 0.01 AND 92 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 5 and 5+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and i_manager_id BETWEEN 47 and 56  and cs_sales_price / cs_list_price BETWEEN 82 * 0.01 AND 92 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;","SELECT t9.cd_gender, t9.cd_marital_status, t9.cd_education_status, COUNT(*) AS cnt1, t9.cd_purchase_estimate, COUNT(*) AS cnt2, t9.cd_credit_rating, COUNT(*) AS cnt3, t9.cd_dep_count, COUNT(*) AS cnt4, t9.cd_dep_employed_count, COUNT(*) AS cnt5, t9.cd_dep_college_count, COUNT(*) AS cnt6 FROM (SELECT t3.c_customer_sk, t3.c_current_hdemo_sk, t3.c_current_addr_sk, t3.c_first_shipto_date_sk, t3.c_first_sales_date_sk, t3.c_birth_day, t3.c_birth_month, t3.c_birth_year, t3.c_last_review_date_sk, t3.c_current_cdemo_sk, t3.c_customer_id, t3.c_last_name, t3.c_preferred_cust_flag, t3.c_birth_country, t3.c_login, t3.c_email_address, t3.c_salutation, t3.c_first_name, t3.ca_gmt_offset, t3.ca_address_sk, t3.ca_street_number, t3.ca_street_name, t3.ca_street_type, t3.ca_suite_number, t3.ca_city, t3.ca_county, t3.ca_state, t3.ca_zip, t3.ca_country, t3.ca_location_type, t3.ca_address_id, t3.cd_dep_college_count, t3.cd_purchase_estimate, t3.cd_dep_count, t3.cd_dep_employed_count, t3.cd_demo_sk, t3.cd_gender, t3.cd_marital_status, t3.cd_education_status, t3.cd_credit_rating, t3.f0, t7.f0 AS f041 FROM (SELECT customer.c_customer_sk, customer.c_current_hdemo_sk, customer.c_current_addr_sk, customer.c_first_shipto_date_sk, customer.c_first_sales_date_sk, customer.c_birth_day, customer.c_birth_month, customer.c_birth_year, customer.c_last_review_date_sk, customer.c_current_cdemo_sk, customer.c_customer_id, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_country, customer.c_login, customer.c_email_address, customer.c_salutation, customer.c_first_name, customer_address.ca_gmt_offset, customer_address.ca_address_sk, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_street_type, customer_address.ca_suite_number, customer_address.ca_city, customer_address.ca_county, customer_address.ca_state, customer_address.ca_zip, customer_address.ca_country, customer_address.ca_location_type, customer_address.ca_address_id, customer_demographics.cd_dep_college_count, customer_demographics.cd_purchase_estimate, customer_demographics.cd_dep_count, customer_demographics.cd_dep_employed_count, customer_demographics.cd_demo_sk, customer_demographics.cd_gender, customer_demographics.cd_marital_status, customer_demographics.cd_education_status, customer_demographics.cd_credit_rating, t2.f0 FROM customer CROSS JOIN customer_address CROSS JOIN customer_demographics LEFT JOIN (SELECT t.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 82 * 0.01 AND ss_sales_price / ss_list_price <= 92 * 0.01) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy >= 5 AND d_moy <= 5 + 3) AS t0 ON t.ss_sold_date_sk = t0.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Home') AND (i_manager_id >= 47 AND i_manager_id <= 56)) AS t1 ON t.ss_item_sk = t1.i_item_sk) AS t2 ON customer.c_customer_sk = t2.ss_customer_sk) AS t3 LEFT JOIN (SELECT t4.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM web_sales WHERE ws_sales_price / ws_list_price >= 82 * 0.01 AND ws_sales_price / ws_list_price <= 92 * 0.01) AS t4 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy >= 5 AND d_moy <= 5 + 3) AS t5 ON t4.ws_sold_date_sk = t5.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Home') AND (i_manager_id >= 47 AND i_manager_id <= 56)) AS t6 ON t4.ws_item_sk = t6.i_item_sk) AS t7 ON t3.c_customer_sk = t7.ws_bill_customer_sk WHERE t3.c_current_addr_sk = t3.ca_address_sk AND t3.ca_county IN ('Clarke County', 'Franklin County', 'Jim Wells County', 'Licking County', 'Windham County') AND (t3.c_birth_month IN (8, 9) AND t3.cd_demo_sk = t3.c_current_cdemo_sk) AND (t3.cd_marital_status IN ('S', 'W') AND t3.cd_education_status IN ('4 yr Degree', 'Advanced Degree') AND (t3.cd_gender = 'M' AND t3.f0 IS NOT NULL))) AS t9 LEFT JOIN (SELECT t10.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM catalog_sales WHERE cs_sales_price / cs_list_price >= 82 * 0.01 AND cs_sales_price / cs_list_price <= 92 * 0.01) AS t10 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy >= 5 AND d_moy <= 5 + 3) AS t11 ON t10.cs_sold_date_sk = t11.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Home') AND (i_manager_id >= 47 AND i_manager_id <= 56)) AS t12 ON t10.cs_item_sk = t12.i_item_sk) AS t13 ON t9.c_customer_sk = t13.cs_ship_customer_sk WHERE t9.f041 IS NOT NULL OR t13.f0 IS NOT NULL GROUP BY t9.cd_gender, t9.cd_marital_status, t9.cd_education_status, t9.cd_purchase_estimate, t9.cd_credit_rating, t9.cd_dep_count, t9.cd_dep_employed_count, t9.cd_dep_college_count ORDER BY t9.cd_gender, t9.cd_marital_status, t9.cd_education_status, t9.cd_purchase_estimate, t9.cd_credit_rating, t9.cd_dep_count, t9.cd_dep_employed_count, t9.cd_dep_college_count LIMIT 100;",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
23,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Primary' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 6 and ca_state in ('AK', 'AZ', 'VA') and cs_wholesale_cost BETWEEN 52 AND 57 AND i_category = 'Women' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;","SELECT t4.i_item_id, t2.ca_country, t2.ca_state, t2.ca_county, AVG(CAST(t.cs_quantity AS DECIMAL(12, 2))) AS agg1, AVG(CAST(t.cs_list_price AS DECIMAL(12, 2))) AS agg2, AVG(CAST(t.cs_coupon_amt AS DECIMAL(12, 2))) AS agg3, AVG(CAST(t.cs_sales_price AS DECIMAL(12, 2))) AS agg4, AVG(CAST(t.cs_net_profit AS DECIMAL(12, 2))) AS agg5, AVG(CAST(t1.c_birth_year AS DECIMAL(12, 2))) AS agg6 FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 52 AND cs_wholesale_cost <= 57) AS t INNER JOIN (SELECT * FROM customer_demographics WHERE cd_gender = 'M' AND cd_education_status = 'Primary') AS t0 ON t.cs_bill_cdemo_sk = t0.cd_demo_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 6) AS t1 ON t.cs_bill_customer_sk = t1.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('AK', 'AZ', 'VA')) AS t2 ON t1.c_current_addr_sk = t2.ca_address_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t3 ON t.cs_sold_date_sk = t3.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category = 'Women') AS t4 ON t.cs_item_sk = t4.i_item_sk GROUP BY ROLLUP(t4.i_item_id, t2.ca_country, t2.ca_state, t2.ca_county) ORDER BY t2.ca_country, t2.ca_state, t2.ca_county, t4.i_item_id LIMIT 100;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
24,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Shoes' and i_class = 'kids' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 4 and d_year = 2000 and wholesale_cost BETWEEN 32 AND 62 and c_birth_year BETWEEN 1962 AND 1975 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 32 AND 62  and s_state in ('FL','GA','IL'   ,'MO','MS','NM'   ,'NY','TN','TX'   ,'VT')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 4)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 4) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t26.segment, COUNT(*) AS num_customers, t26.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t20.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t15.c_customer_sk, t15.c_current_addr_sk, t15.ss_sold_date_sk, t15.ss_sold_time_sk, t15.ss_item_sk, t15.ss_customer_sk, t15.ss_cdemo_sk, t15.ss_hdemo_sk, t15.ss_addr_sk, t15.ss_store_sk, t15.ss_promo_sk, t15.ss_ticket_number, t15.ss_quantity, t15.ss_wholesale_cost, t15.ss_list_price, t15.ss_sales_price, t15.ss_ext_discount_amt, t15.ss_ext_sales_price, t15.ss_ext_wholesale_cost, t15.ss_ext_list_price, t15.ss_ext_tax, t15.ss_coupon_amt, t15.ss_net_paid, t15.ss_net_paid_inc_tax, t15.ss_net_profit, t15.ca_gmt_offset, t15.ca_address_sk, t15.ca_street_number, t15.ca_street_name, t15.ca_street_type, t15.ca_suite_number, t15.ca_city, t15.ca_county, t15.ca_state, t15.ca_zip, t15.ca_country, t15.ca_location_type, t15.ca_address_id, t15.s_tax_precentage, t15.s_rec_start_date, t15.s_rec_end_date, t15.s_closed_date_sk, t15.s_number_employees, t15.s_floor_space, t15.s_market_id, t15.s_division_id, t15.s_company_id, t15.s_gmt_offset, t15.s_store_sk, t15.s_geography_class, t15.s_market_desc, t15.s_market_manager, t15.s_zip, t15.s_division_name, t15.s_country, t15.s_company_name, t15.s_street_number, t15.s_store_id, t15.s_street_name, t15.s_street_type, t15.s_suite_number, t15.s_store_name, t15.s_city, t15.s_county, t15.s_hours, t15.s_manager, t15.s_state, t15.d_quarter_seq, t15.d_year, t15.d_first_dom, t15.d_last_dom, t15.d_same_day_ly, t15.d_same_day_lq, t15.d_dow, t15.d_moy, t15.d_dom, t15.d_qoy, t15.d_date_sk, t15.d_fy_year, t15.d_fy_quarter_seq, t15.d_fy_week_seq, t15.d_date, t15.d_month_seq, t15.d_week_seq, t15.d_current_year, t15.d_date_id, t15.d_day_name, t15.d_quarter_name, t15.d_holiday, t15.d_weekend, t15.d_following_holiday, t15.d_current_day, t15.d_current_week, t15.d_current_month, t15.d_current_quarter, CAST(t18.EXPR0 AS INTEGER) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT t7.c_customer_sk, t7.c_current_addr_sk FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales) AS t1 WHERE wholesale_cost >= 32 AND wholesale_cost <= 62) AS t2, (SELECT * FROM item WHERE i_category = 'Shoes' AND i_class = 'kids') AS t3 WHERE t2.item_sk = t3.i_item_sk) AS t4, (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy = 4) AS t5 WHERE t4.sold_date_sk = t5.d_date_sk) AS t6, (SELECT * FROM customer WHERE c_birth_year >= 1962 AND c_birth_year <= 1975) AS t7 WHERE t7.c_customer_sk = t6.customer_sk) AS t9, (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 32 AND ss_wholesale_cost <= 62) AS t10 WHERE t9.c_customer_sk = t10.ss_customer_sk) AS t11, customer_address WHERE t11.c_current_addr_sk = customer_address.ca_address_sk) AS t12, (SELECT * FROM store WHERE s_state IN ('FL', 'GA', 'IL', 'MO', 'MS', 'NM', 'NY', 'TN', 'TX', 'VT')) AS t13 WHERE t12.ca_county = t13.s_county AND t12.ca_state = t13.s_state) AS t14, date_dim AS date_dim0 WHERE t14.ss_sold_date_sk = date_dim0.d_date_sk) AS t15, (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2000 AND d_moy = 4 GROUP BY d_month_seq + 1) AS t18 WHERE t15.d_month_seq >= t18.EXPR0) AS t20, (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2000 AND d_moy = 4 GROUP BY d_month_seq + 3) AS t23 WHERE t20.d_month_seq <= t23.EXPR0 GROUP BY t20.c_customer_sk) AS t26 GROUP BY t26.segment ORDER BY t26.segment, COUNT(*) LIMIT 100",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"