,db_id,original_sql,rewritten_sql,activated_rules,latency_org,latency_new,original_logical_plan
0,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'MD', 'MS') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'IN', 'PA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'KS', 'TX') and ss_net_profit between 50 and 250 ))  ;","SELECT AVG(store_sales.ss_quantity), AVG(store_sales.ss_ext_sales_price), AVG(store_sales.ss_ext_wholesale_cost), SUM(store_sales.ss_ext_wholesale_cost) FROM store_sales, store, customer_demographics, household_demographics, customer_address, date_dim WHERE store.s_store_sk = store_sales.ss_store_sk AND store_sales.ss_sold_date_sk = date_dim.d_date_sk AND date_dim.d_year = 2001 AND (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (customer_demographics.cd_demo_sk = store_sales.ss_cdemo_sk AND customer_demographics.cd_marital_status = 'D') AND (customer_demographics.cd_education_status = '4 yr Degree' AND (store_sales.ss_sales_price >= 100.00 AND store_sales.ss_sales_price <= 150.00 AND household_demographics.hd_dep_count = 3)) OR store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (customer_demographics.cd_demo_sk = store_sales.ss_cdemo_sk AND customer_demographics.cd_marital_status = 'S') AND (customer_demographics.cd_education_status = 'Advanced Degree' AND (store_sales.ss_sales_price >= 50.00 AND store_sales.ss_sales_price <= 100.00 AND household_demographics.hd_dep_count = 1)) OR store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (customer_demographics.cd_demo_sk = store_sales.ss_cdemo_sk AND customer_demographics.cd_marital_status = 'S') AND (customer_demographics.cd_education_status = '2 yr Degree' AND (store_sales.ss_sales_price >= 150.00 AND store_sales.ss_sales_price <= 200.00 AND household_demographics.hd_dep_count = 1))) AND (store_sales.ss_addr_sk = customer_address.ca_address_sk AND customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('GA', 'MD', 'MS') AND (store_sales.ss_net_profit >= 100 AND store_sales.ss_net_profit <= 200) OR store_sales.ss_addr_sk = customer_address.ca_address_sk AND customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('FL', 'IN', 'PA') AND (store_sales.ss_net_profit >= 150 AND store_sales.ss_net_profit <= 300) OR store_sales.ss_addr_sk = customer_address.ca_address_sk AND customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('AL', 'KS', 'TX') AND (store_sales.ss_net_profit >= 50 AND store_sales.ss_net_profit <= 250))","['FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS']",10.14605872,6.318700314,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
1,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'TN', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'KY', 'NE') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CO', 'NM', 'TX') and ss_net_profit between 50 and 250 ))  ;","SELECT AVG(store_sales82.ss_quantity), AVG(store_sales82.ss_ext_sales_price), AVG(store_sales82.ss_ext_wholesale_cost), SUM(store_sales82.ss_ext_wholesale_cost) FROM store_sales AS store_sales82 INNER JOIN store AS store82 ON store_sales82.ss_store_sk = store82.s_store_sk CROSS JOIN customer_demographics AS customer_demographics82 INNER JOIN household_demographics AS household_demographics82 ON store_sales82.ss_hdemo_sk = household_demographics82.hd_demo_sk AND (customer_demographics82.cd_demo_sk = store_sales82.ss_cdemo_sk AND customer_demographics82.cd_marital_status = 'D') AND (customer_demographics82.cd_education_status = '4 yr Degree' AND (store_sales82.ss_sales_price >= 100.00 AND store_sales82.ss_sales_price <= 150.00 AND household_demographics82.hd_dep_count = 3)) OR store_sales82.ss_hdemo_sk = household_demographics82.hd_demo_sk AND (customer_demographics82.cd_demo_sk = store_sales82.ss_cdemo_sk AND customer_demographics82.cd_marital_status = 'S') AND (customer_demographics82.cd_education_status = 'Primary' AND (store_sales82.ss_sales_price >= 50.00 AND store_sales82.ss_sales_price <= 100.00 AND household_demographics82.hd_dep_count = 1)) OR store_sales82.ss_hdemo_sk = household_demographics82.hd_demo_sk AND (customer_demographics82.cd_demo_sk = store_sales82.ss_cdemo_sk AND customer_demographics82.cd_marital_status = 'W') AND (customer_demographics82.cd_education_status = 'Advanced Degree' AND (store_sales82.ss_sales_price >= 150.00 AND store_sales82.ss_sales_price <= 200.00 AND household_demographics82.hd_dep_count = 1)) INNER JOIN customer_address AS customer_address82 ON store_sales82.ss_addr_sk = customer_address82.ca_address_sk AND customer_address82.ca_country = 'United States' AND customer_address82.ca_state IN ('GA', 'TN', 'TX') AND (store_sales82.ss_net_profit >= 100 AND store_sales82.ss_net_profit <= 200) OR store_sales82.ss_addr_sk = customer_address82.ca_address_sk AND customer_address82.ca_country = 'United States' AND customer_address82.ca_state IN ('GA', 'KY', 'NE') AND (store_sales82.ss_net_profit >= 150 AND store_sales82.ss_net_profit <= 300) OR store_sales82.ss_addr_sk = customer_address82.ca_address_sk AND customer_address82.ca_country = 'United States' AND customer_address82.ca_state IN ('CO', 'NM', 'TX') AND (store_sales82.ss_net_profit >= 50 AND store_sales82.ss_net_profit <= 250) INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t387 ON store_sales82.ss_sold_date_sk = t387.d_date_sk",['FILTER_INTO_JOIN'],9.885377328,2.170616388,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
2,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Antioch' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 11990 and ib_upper_bound <= 11990 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;","SELECT customer82.c_customer_id AS customer_id, customer82.c_last_name || ', ' || customer82.c_first_name AS customername FROM customer AS customer82 INNER JOIN (SELECT * FROM customer_address WHERE ca_city = 'Antioch') AS t528 ON customer82.c_current_addr_sk = t528.ca_address_sk INNER JOIN customer_demographics AS customer_demographics82 ON customer82.c_current_cdemo_sk = customer_demographics82.cd_demo_sk INNER JOIN household_demographics AS household_demographics82 ON customer82.c_current_hdemo_sk = household_demographics82.hd_demo_sk INNER JOIN (SELECT * FROM income_band WHERE ib_lower_bound >= 11990 AND ib_upper_bound <= 11990 + 50000) AS t529 ON household_demographics82.hd_income_band_sk = t529.ib_income_band_sk INNER JOIN store_returns AS store_returns82 ON customer_demographics82.cd_demo_sk = store_returns82.sr_cdemo_sk ORDER BY customer82.c_customer_id LIMIT 100",['FILTER_INTO_JOIN'],0.178946733,0.175053994,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
3,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Bridgeport' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 2184 and ib_upper_bound <= 2184 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;","SELECT customer.c_customer_id AS customer_id, customer.c_last_name || ', ' || customer.c_first_name AS customername FROM customer INNER JOIN (SELECT * FROM customer_address WHERE ca_city = 'Bridgeport') AS t ON customer.c_current_addr_sk = t.ca_address_sk INNER JOIN customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk INNER JOIN household_demographics ON customer.c_current_hdemo_sk = household_demographics.hd_demo_sk INNER JOIN (SELECT * FROM income_band WHERE ib_lower_bound >= 2184 AND ib_upper_bound <= 2184 + 50000) AS t0 ON household_demographics.hd_income_band_sk = t0.ib_income_band_sk INNER JOIN store_returns ON customer_demographics.cd_demo_sk = store_returns.sr_cdemo_sk ORDER BY customer.c_customer_id LIMIT 100;","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SET_OP_TRANSPOSE', 'AGGREGATE_REMOVE', 'PROJECT_REDUCE_EXPRESSIONS']",0.179685275,0.176012437,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
4,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Lakeview' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 27129 and ib_upper_bound <= 27129 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;","SELECT t4.c_customer_id AS customer_id, t4.c_last_name || ', ' || t4.c_first_name AS customername FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM customer, (SELECT * FROM customer_address WHERE ca_city = 'Lakeview') AS t WHERE customer.c_current_addr_sk = t.ca_address_sk) AS t0, customer_demographics WHERE customer_demographics.cd_demo_sk = t0.c_current_cdemo_sk) AS t1, household_demographics WHERE household_demographics.hd_demo_sk = t1.c_current_hdemo_sk) AS t2, (SELECT * FROM income_band WHERE ib_lower_bound >= 27129 AND ib_upper_bound <= 27129 + 50000) AS t3 WHERE t3.ib_income_band_sk = t2.hd_income_band_sk) AS t4, store_returns WHERE store_returns.sr_cdemo_sk = t4.cd_demo_sk ORDER BY t4.c_customer_id LIMIT 100;","['FILTER_SCAN', 'FILTER_CORRELATE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']",0.180530787,0.169523398,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
5,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Springdale' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 28254 and ib_upper_bound <= 28254 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;","SELECT t4.c_customer_id AS customer_id, t4.c_last_name || ', ' || t4.c_first_name AS customername FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM customer, (SELECT * FROM customer_address WHERE ca_city = 'Springdale') AS t WHERE customer.c_current_addr_sk = t.ca_address_sk) AS t0, customer_demographics WHERE customer_demographics.cd_demo_sk = t0.c_current_cdemo_sk) AS t1, household_demographics WHERE household_demographics.hd_demo_sk = t1.c_current_hdemo_sk) AS t2, (SELECT * FROM income_band WHERE ib_lower_bound >= 28254 AND ib_upper_bound <= 28254 + 50000) AS t3 WHERE t3.ib_income_band_sk = t2.hd_income_band_sk) AS t4, store_returns WHERE store_returns.sr_cdemo_sk = t4.cd_demo_sk ORDER BY t4.c_customer_id LIMIT 100;","['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'JOIN_EXTRACT_FILTER', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_PROJECT_MERGE']",0.187077045,0.175132672,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
6,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Union Hill' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 9365 and ib_upper_bound <= 9365 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;","SELECT t4.c_customer_id AS customer_id, t4.c_last_name || ', ' || t4.c_first_name AS customername FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM customer, (SELECT * FROM customer_address WHERE ca_city = 'Union Hill') AS t WHERE customer.c_current_addr_sk = t.ca_address_sk) AS t0, customer_demographics WHERE customer_demographics.cd_demo_sk = t0.c_current_cdemo_sk) AS t1, household_demographics WHERE household_demographics.hd_demo_sk = t1.c_current_hdemo_sk) AS t2, (SELECT * FROM income_band WHERE ib_lower_bound >= 9365 AND ib_upper_bound <= 9365 + 50000) AS t3 WHERE t3.ib_income_band_sk = t2.hd_income_band_sk) AS t4, store_returns WHERE store_returns.sr_cdemo_sk = t4.cd_demo_sk ORDER BY t4.c_customer_id LIMIT 100;","['FILTER_SCAN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_MERGE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_LEFT_TRANSPOSE']",0.260300239,0.177526712,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
7,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 1 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;","SELECT call_center.cc_call_center_id AS Call_Center, call_center.cc_name AS Call_Center_Name, call_center.cc_manager AS Manager, SUM(catalog_returns.cr_net_loss) AS Returns_Loss FROM call_center, catalog_returns, date_dim, customer, customer_address, customer_demographics, household_demographics WHERE catalog_returns.cr_call_center_sk = call_center.cc_call_center_sk AND catalog_returns.cr_returned_date_sk = date_dim.d_date_sk AND (catalog_returns.cr_returning_customer_sk = customer.c_customer_sk AND (customer_demographics.cd_demo_sk = customer.c_current_cdemo_sk AND household_demographics.hd_demo_sk = customer.c_current_hdemo_sk)) AND (customer_address.ca_address_sk = customer.c_current_addr_sk AND (date_dim.d_year = 1998 AND date_dim.d_moy = 1) AND ((customer_demographics.cd_marital_status = 'M' AND customer_demographics.cd_education_status = 'Unknown' OR customer_demographics.cd_marital_status = 'W' AND customer_demographics.cd_education_status = 'Advanced Degree') AND (household_demographics.hd_buy_potential LIKE '0-500%' AND customer_address.ca_gmt_offset = -6))) GROUP BY call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, customer_demographics.cd_marital_status, customer_demographics.cd_education_status ORDER BY SUM(catalog_returns.cr_net_loss) DESC","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS']",0.090425968,0.089796384,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
8,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 11 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;","SELECT call_center.cc_call_center_id AS Call_Center, call_center.cc_name AS Call_Center_Name, call_center.cc_manager AS Manager, SUM(catalog_returns.cr_net_loss) AS Returns_Loss FROM call_center INNER JOIN catalog_returns ON call_center.cc_call_center_sk = catalog_returns.cr_call_center_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy = 11) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer ON catalog_returns.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_gmt_offset = -7) AS t0 ON customer.c_current_addr_sk = t0.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree') AS t1 ON customer.c_current_cdemo_sk = t1.cd_demo_sk INNER JOIN (SELECT * FROM household_demographics WHERE hd_buy_potential LIKE '1001-5000%') AS t2 ON customer.c_current_hdemo_sk = t2.hd_demo_sk GROUP BY call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, t1.cd_marital_status, t1.cd_education_status ORDER BY SUM(catalog_returns.cr_net_loss) DESC;","['AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']",0.151118914,0.125223557,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
9,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;","SELECT t276.cc_call_center_id AS Call_Center, t276.cc_name AS Call_Center_Name, t276.cc_manager AS Manager, SUM(t276.cr_net_loss) AS Returns_Loss FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM call_center AS call_center18, catalog_returns AS catalog_returns18 WHERE catalog_returns18.cr_call_center_sk = call_center18.cc_call_center_sk) AS t269, (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy = 3) AS t270 WHERE t269.cr_returned_date_sk = t270.d_date_sk) AS t271, customer AS customer18 WHERE t271.cr_returning_customer_sk = customer18.c_customer_sk) AS t272, (SELECT * FROM customer_address WHERE ca_gmt_offset = -7) AS t273 WHERE t273.ca_address_sk = t272.c_current_addr_sk) AS t274, (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree') AS t275 WHERE t275.cd_demo_sk = t274.c_current_cdemo_sk) AS t276, (SELECT * FROM household_demographics WHERE hd_buy_potential LIKE '0-500%') AS t277 WHERE t277.hd_demo_sk = t276.c_current_hdemo_sk GROUP BY t276.cc_call_center_id, t276.cc_name, t276.cc_manager, t276.cd_marital_status, t276.cd_education_status ORDER BY SUM(t276.cr_net_loss) DESC","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC']",0.095000664,0.087839603,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
10,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 4 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;","SELECT t550.cc_call_center_id AS Call_Center, t550.cc_name AS Call_Center_Name, t550.cc_manager AS Manager, SUM(t550.cr_net_loss) AS Returns_Loss FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM call_center AS call_center42, catalog_returns AS catalog_returns42 WHERE catalog_returns42.cr_call_center_sk = call_center42.cc_call_center_sk) AS t543, (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy = 4) AS t544 WHERE t543.cr_returned_date_sk = t544.d_date_sk) AS t545, customer AS customer42 WHERE t545.cr_returning_customer_sk = customer42.c_customer_sk) AS t546, (SELECT * FROM customer_address WHERE ca_gmt_offset = -6) AS t547 WHERE t547.ca_address_sk = t546.c_current_addr_sk) AS t548, (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree') AS t549 WHERE t549.cd_demo_sk = t548.c_current_cdemo_sk) AS t550, (SELECT * FROM household_demographics WHERE hd_buy_potential LIKE '>10000%') AS t551 WHERE t551.hd_demo_sk = t550.c_current_hdemo_sk GROUP BY t550.cc_call_center_id, t550.cc_name, t550.cc_manager, t550.cd_marital_status, t550.cd_education_status ORDER BY SUM(t550.cr_net_loss) DESC","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC']",0.103054285,0.084388018,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
11,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 5 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;","SELECT t1194.cc_call_center_id AS Call_Center, t1194.cc_name AS Call_Center_Name, t1194.cc_manager AS Manager, SUM(t1194.cr_net_loss) AS Returns_Loss FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM call_center AS call_center102, catalog_returns AS catalog_returns102 WHERE catalog_returns102.cr_call_center_sk = call_center102.cc_call_center_sk) AS t1187, (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy = 5) AS t1188 WHERE t1187.cr_returned_date_sk = t1188.d_date_sk) AS t1189, customer AS customer102 WHERE t1189.cr_returning_customer_sk = customer102.c_customer_sk) AS t1190, (SELECT * FROM customer_address WHERE ca_gmt_offset = -6) AS t1191 WHERE t1191.ca_address_sk = t1190.c_current_addr_sk) AS t1192, (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree') AS t1193 WHERE t1193.cd_demo_sk = t1192.c_current_cdemo_sk) AS t1194, (SELECT * FROM household_demographics WHERE hd_buy_potential LIKE 'Unknown%') AS t1195 WHERE t1195.hd_demo_sk = t1194.c_current_hdemo_sk GROUP BY t1194.cc_call_center_id, t1194.cc_name, t1194.cc_manager, t1194.cd_marital_status, t1194.cd_education_status ORDER BY SUM(t1194.cr_net_loss) DESC","['FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']",0.103205681,0.100877523,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
12,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;","SELECT call_center.cc_call_center_id AS Call_Center, call_center.cc_name AS Call_Center_Name, call_center.cc_manager AS Manager, SUM(catalog_returns.cr_net_loss) AS Returns_Loss FROM call_center, catalog_returns, date_dim, customer, customer_address, customer_demographics, household_demographics WHERE catalog_returns.cr_call_center_sk = call_center.cc_call_center_sk AND catalog_returns.cr_returned_date_sk = date_dim.d_date_sk AND (catalog_returns.cr_returning_customer_sk = customer.c_customer_sk AND (customer_demographics.cd_demo_sk = customer.c_current_cdemo_sk AND household_demographics.hd_demo_sk = customer.c_current_hdemo_sk)) AND (customer_address.ca_address_sk = customer.c_current_addr_sk AND (date_dim.d_year = 1998 AND date_dim.d_moy = 8) AND ((customer_demographics.cd_marital_status = 'M' AND customer_demographics.cd_education_status = 'Unknown' OR customer_demographics.cd_marital_status = 'W' AND customer_demographics.cd_education_status = 'Advanced Degree') AND (household_demographics.hd_buy_potential LIKE 'Unknown%' AND customer_address.ca_gmt_offset = -7))) GROUP BY call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, customer_demographics.cd_marital_status, customer_demographics.cd_education_status ORDER BY SUM(catalog_returns.cr_net_loss) DESC","['SORT_PROJECT_TRANSPOSE', 'FILTER_MERGE']",0.111168702,0.109184742,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
13,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 9 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;","SELECT call_center103.cc_call_center_id AS Call_Center, call_center103.cc_name AS Call_Center_Name, call_center103.cc_manager AS Manager, SUM(catalog_returns103.cr_net_loss) AS Returns_Loss FROM call_center AS call_center103 INNER JOIN catalog_returns AS catalog_returns103 ON call_center103.cc_call_center_sk = catalog_returns103.cr_call_center_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy = 9) AS t1218 ON catalog_returns103.cr_returned_date_sk = t1218.d_date_sk INNER JOIN customer AS customer103 ON catalog_returns103.cr_returning_customer_sk = customer103.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_gmt_offset = -7) AS t1219 ON customer103.c_current_addr_sk = t1219.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree') AS t1220 ON customer103.c_current_cdemo_sk = t1220.cd_demo_sk INNER JOIN (SELECT * FROM household_demographics WHERE hd_buy_potential LIKE '0-500%') AS t1221 ON customer103.c_current_hdemo_sk = t1221.hd_demo_sk GROUP BY call_center103.cc_call_center_id, call_center103.cc_name, call_center103.cc_manager, t1220.cd_marital_status, t1220.cd_education_status ORDER BY SUM(catalog_returns103.cr_net_loss) DESC","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']",0.113008022,0.109006246,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
14,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;","SELECT call_center19.cc_call_center_id AS Call_Center, call_center19.cc_name AS Call_Center_Name, call_center19.cc_manager AS Manager, SUM(catalog_returns19.cr_net_loss) AS Returns_Loss FROM call_center AS call_center19 INNER JOIN catalog_returns AS catalog_returns19 ON call_center19.cc_call_center_sk = catalog_returns19.cr_call_center_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy = 8) AS t215 ON catalog_returns19.cr_returned_date_sk = t215.d_date_sk INNER JOIN customer AS customer19 ON catalog_returns19.cr_returning_customer_sk = customer19.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_gmt_offset = -7) AS t216 ON customer19.c_current_addr_sk = t216.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree') AS t217 ON customer19.c_current_cdemo_sk = t217.cd_demo_sk INNER JOIN (SELECT * FROM household_demographics WHERE hd_buy_potential LIKE '501-1000%') AS t218 ON customer19.c_current_hdemo_sk = t218.hd_demo_sk GROUP BY call_center19.cc_call_center_id, call_center19.cc_name, call_center19.cc_manager, t217.cd_marital_status, t217.cd_education_status ORDER BY SUM(catalog_returns19.cr_net_loss) DESC","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']",0.118554036,0.111906926,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
15,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 10 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;","SELECT call_center.cc_call_center_id AS Call_Center, call_center.cc_name AS Call_Center_Name, call_center.cc_manager AS Manager, SUM(catalog_returns.cr_net_loss) AS Returns_Loss FROM call_center INNER JOIN catalog_returns ON call_center.cc_call_center_sk = catalog_returns.cr_call_center_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy = 10) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer ON catalog_returns.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_gmt_offset = -7) AS t0 ON customer.c_current_addr_sk = t0.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree') AS t1 ON customer.c_current_cdemo_sk = t1.cd_demo_sk INNER JOIN (SELECT * FROM household_demographics WHERE hd_buy_potential LIKE '501-1000%') AS t2 ON customer.c_current_hdemo_sk = t2.hd_demo_sk GROUP BY call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, t1.cd_marital_status, t1.cd_education_status ORDER BY SUM(catalog_returns.cr_net_loss) DESC",['FILTER_INTO_JOIN'],0.121884664,0.112958431,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
16,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;","SELECT t518.cc_call_center_id AS Call_Center, t518.cc_name AS Call_Center_Name, t518.cc_manager AS Manager, SUM(t518.cr_net_loss) AS Returns_Loss FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM call_center AS call_center40, catalog_returns AS catalog_returns40 WHERE catalog_returns40.cr_call_center_sk = call_center40.cc_call_center_sk) AS t511, (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy = 12) AS t512 WHERE t511.cr_returned_date_sk = t512.d_date_sk) AS t513, customer AS customer40 WHERE t513.cr_returning_customer_sk = customer40.c_customer_sk) AS t514, (SELECT * FROM customer_address WHERE ca_gmt_offset = -7) AS t515 WHERE t515.ca_address_sk = t514.c_current_addr_sk) AS t516, (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree') AS t517 WHERE t517.cd_demo_sk = t516.c_current_cdemo_sk) AS t518, (SELECT * FROM household_demographics WHERE hd_buy_potential LIKE 'Unknown%') AS t519 WHERE t519.hd_demo_sk = t518.c_current_hdemo_sk GROUP BY t518.cc_call_center_id, t518.cc_name, t518.cc_manager, t518.cd_marital_status, t518.cd_education_status ORDER BY SUM(t518.cr_net_loss) DESC","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER']",0.134429614,0.127921343,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
17,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 11 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;","SELECT call_center.cc_call_center_id AS Call_Center, call_center.cc_name AS Call_Center_Name, call_center.cc_manager AS Manager, SUM(catalog_returns.cr_net_loss) AS Returns_Loss FROM call_center INNER JOIN catalog_returns ON call_center.cc_call_center_sk = catalog_returns.cr_call_center_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002 AND d_moy = 11) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer ON catalog_returns.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_gmt_offset = -7) AS t0 ON customer.c_current_addr_sk = t0.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree') AS t1 ON customer.c_current_cdemo_sk = t1.cd_demo_sk INNER JOIN (SELECT * FROM household_demographics WHERE hd_buy_potential LIKE '>10000%') AS t2 ON customer.c_current_hdemo_sk = t2.hd_demo_sk GROUP BY call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, t1.cd_marital_status, t1.cd_education_status ORDER BY SUM(catalog_returns.cr_net_loss) DESC","['FILTER_INTO_JOIN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE']",0.150071621,0.129869699,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
18,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('AK','NV','NY') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'S', 'S') and cd_education_status in ('2 yr Degree', 'Secondary') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 8 and 8+2  and ss_list_price between 119 and 208 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 8 and 8+2  and ws_list_price between 119 and 208  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 8 and 8+2  and cs_list_price between 119 and 208)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;","SELECT t44.cd_gender, t44.cd_marital_status, t44.cd_education_status, COUNT(*) AS cnt1, t44.cd_purchase_estimate, COUNT(*) AS cnt2, t44.cd_credit_rating, COUNT(*) AS cnt3 FROM (SELECT t39.c_customer_sk, t39.c_current_hdemo_sk, t39.c_current_addr_sk, t39.c_first_shipto_date_sk, t39.c_first_sales_date_sk, t39.c_birth_day, t39.c_birth_month, t39.c_birth_year, t39.c_last_review_date_sk, t39.c_current_cdemo_sk, t39.c_customer_id, t39.c_last_name, t39.c_preferred_cust_flag, t39.c_birth_country, t39.c_login, t39.c_email_address, t39.c_salutation, t39.c_first_name, t39.ca_gmt_offset, t39.ca_address_sk, t39.ca_street_number, t39.ca_street_name, t39.ca_street_type, t39.ca_suite_number, t39.ca_city, t39.ca_county, t39.ca_state, t39.ca_zip, t39.ca_country, t39.ca_location_type, t39.ca_address_id, t39.cd_dep_college_count, t39.cd_purchase_estimate, t39.cd_dep_count, t39.cd_dep_employed_count, t39.cd_demo_sk, t39.cd_gender, t39.cd_marital_status, t39.cd_education_status, t39.cd_credit_rating, t39.f0, t42.f0 AS f041 FROM (SELECT customer1.c_customer_sk, customer1.c_current_hdemo_sk, customer1.c_current_addr_sk, customer1.c_first_shipto_date_sk, customer1.c_first_sales_date_sk, customer1.c_birth_day, customer1.c_birth_month, customer1.c_birth_year, customer1.c_last_review_date_sk, customer1.c_current_cdemo_sk, customer1.c_customer_id, customer1.c_last_name, customer1.c_preferred_cust_flag, customer1.c_birth_country, customer1.c_login, customer1.c_email_address, customer1.c_salutation, customer1.c_first_name, customer_address1.ca_gmt_offset, customer_address1.ca_address_sk, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_street_type, customer_address1.ca_suite_number, customer_address1.ca_city, customer_address1.ca_county, customer_address1.ca_state, customer_address1.ca_zip, customer_address1.ca_country, customer_address1.ca_location_type, customer_address1.ca_address_id, customer_demographics1.cd_dep_college_count, customer_demographics1.cd_purchase_estimate, customer_demographics1.cd_dep_count, customer_demographics1.cd_dep_employed_count, customer_demographics1.cd_demo_sk, customer_demographics1.cd_gender, customer_demographics1.cd_marital_status, customer_demographics1.cd_education_status, customer_demographics1.cd_credit_rating, t38.f0 FROM customer AS customer1 CROSS JOIN customer_address AS customer_address1 CROSS JOIN customer_demographics AS customer_demographics1 LEFT JOIN (SELECT t36.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM store_sales WHERE ss_list_price >= 119 AND ss_list_price <= 208) AS t36 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy >= 8 AND d_moy <= 8 + 2) AS t37 ON t36.ss_sold_date_sk = t37.d_date_sk) AS t38 ON customer1.c_customer_sk = t38.ss_customer_sk) AS t39 LEFT JOIN (SELECT t40.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM web_sales WHERE ws_list_price >= 119 AND ws_list_price <= 208) AS t40 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy >= 8 AND d_moy <= 8 + 2) AS t41 ON t40.ws_sold_date_sk = t41.d_date_sk) AS t42 ON t39.c_customer_sk = t42.ws_bill_customer_sk WHERE t39.c_current_addr_sk = t39.ca_address_sk AND (t39.ca_state IN ('AK', 'NV', 'NY') AND t39.cd_demo_sk = t39.c_current_cdemo_sk) AND (t39.cd_marital_status = 'S' AND t39.cd_education_status IN ('2 yr Degree', 'Secondary') AND (t42.f0 IS NULL AND t39.f0 IS NOT NULL))) AS t44 LEFT JOIN (SELECT t45.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 119 AND cs_list_price <= 208) AS t45 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy >= 8 AND d_moy <= 8 + 2) AS t46 ON t45.cs_sold_date_sk = t46.d_date_sk) AS t47 ON t44.c_customer_sk = t47.cs_ship_customer_sk WHERE t47.f0 IS NULL GROUP BY t44.cd_gender, t44.cd_marital_status, t44.cd_education_status, t44.cd_purchase_estimate, t44.cd_credit_rating ORDER BY t44.cd_gender, t44.cd_marital_status, t44.cd_education_status, t44.cd_purchase_estimate, t44.cd_credit_rating LIMIT 100",['PROJECT_TO_CALC'],18.33788586,6.543284098,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
19,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('AL','IL','VA') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'W', 'S') and cd_education_status in ('2 yr Degree', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 7 and 7+2  and ss_list_price between 59 and 148 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 7 and 7+2  and ws_list_price between 59 and 148  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 7 and 7+2  and cs_list_price between 59 and 148)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;","SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM (SELECT t1784.c_customer_sk, t1784.c_current_hdemo_sk, t1784.c_current_addr_sk, t1784.c_first_shipto_date_sk, t1784.c_first_sales_date_sk, t1784.c_birth_day, t1784.c_birth_month, t1784.c_birth_year, t1784.c_last_review_date_sk, t1784.c_current_cdemo_sk, t1784.c_customer_id, t1784.c_last_name, t1784.c_preferred_cust_flag, t1784.c_birth_country, t1784.c_login, t1784.c_email_address, t1784.c_salutation, t1784.c_first_name, t1784.ca_gmt_offset, t1784.ca_address_sk, t1784.ca_street_number, t1784.ca_street_name, t1784.ca_street_type, t1784.ca_suite_number, t1784.ca_city, t1784.ca_county, t1784.ca_state, t1784.ca_zip, t1784.ca_country, t1784.ca_location_type, t1784.ca_address_id, t1784.cd_dep_college_count, t1784.cd_purchase_estimate, t1784.cd_dep_count, t1784.cd_dep_employed_count, t1784.cd_demo_sk, t1784.cd_gender, t1784.cd_marital_status, t1784.cd_education_status, t1784.cd_credit_rating, CAST(t1784.f0 AS BOOLEAN) AS f0, t1784.ws_bill_customer_sk, t1784.f00, t1788.cs_ship_customer_sk, t1788.f0 AS f01 FROM (SELECT * FROM (SELECT t1778.c_customer_sk, t1778.c_current_hdemo_sk, t1778.c_current_addr_sk, t1778.c_first_shipto_date_sk, t1778.c_first_sales_date_sk, t1778.c_birth_day, t1778.c_birth_month, t1778.c_birth_year, t1778.c_last_review_date_sk, t1778.c_current_cdemo_sk, t1778.c_customer_id, t1778.c_last_name, t1778.c_preferred_cust_flag, t1778.c_birth_country, t1778.c_login, t1778.c_email_address, t1778.c_salutation, t1778.c_first_name, t1778.ca_gmt_offset, t1778.ca_address_sk, t1778.ca_street_number, t1778.ca_street_name, t1778.ca_street_type, t1778.ca_suite_number, t1778.ca_city, t1778.ca_county, t1778.ca_state, t1778.ca_zip, t1778.ca_country, t1778.ca_location_type, t1778.ca_address_id, t1778.cd_dep_college_count, t1778.cd_purchase_estimate, t1778.cd_dep_count, t1778.cd_dep_employed_count, t1778.cd_demo_sk, t1778.cd_gender, t1778.cd_marital_status, t1778.cd_education_status, t1778.cd_credit_rating, t1778.ss_customer_sk, TRUE AS f0, t1782.ws_bill_customer_sk, t1782.f0 AS f00 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM customer AS customer86, (SELECT * FROM customer_address WHERE ca_state IN ('AL', 'IL', 'VA')) AS t1771 WHERE customer86.c_current_addr_sk = t1771.ca_address_sk) AS t1772, (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('S', 'W') AND cd_education_status IN ('2 yr Degree', '4 yr Degree')) AS t1773 WHERE t1773.cd_demo_sk = t1772.c_current_cdemo_sk) AS t1774, (SELECT * FROM (SELECT * FROM store_sales WHERE ss_list_price >= 59 AND ss_list_price <= 148) AS t1775, (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy >= 7 AND d_moy <= 7 + 2) AS t1776 WHERE t1775.ss_sold_date_sk = t1776.d_date_sk) AS t1777 WHERE t1774.c_customer_sk = t1777.ss_customer_sk) AS t1778 LEFT JOIN (SELECT t1779.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM web_sales WHERE ws_list_price >= 59 AND ws_list_price <= 148) AS t1779, (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy >= 7 AND d_moy <= 7 + 2) AS t1780 WHERE t1779.ws_sold_date_sk = t1780.d_date_sk) AS t1782 ON t1778.c_customer_sk = t1782.ws_bill_customer_sk) AS t1783 WHERE t1783.f00 IS NULL) AS t1784 LEFT JOIN (SELECT t1785.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 59 AND cs_list_price <= 148) AS t1785, (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy >= 7 AND d_moy <= 7 + 2) AS t1786 WHERE t1785.cs_sold_date_sk = t1786.d_date_sk) AS t1788 ON t1784.c_customer_sk = t1788.cs_ship_customer_sk) AS t1790 WHERE t1790.f01 IS NULL GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100","['FILTER_INTO_JOIN', 'JOIN_PROJECT_TRANSPOSE_RULE(_PROJECT-_PROJ', 'FILTER_INTO_JOIN', 'JOIN_PROJECT_TRANSPOSE_RULE(_PROJECT-_PROJ']",16.23463694,11.20005854,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
20,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('CA','NJ','OH') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'S', 'W') and cd_education_status in ('Secondary', '2 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 and 6+2  and ss_list_price between 34 and 123 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 and 6+2  and ws_list_price between 34 and 123  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 and 6+2  and cs_list_price between 34 and 123)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;","SELECT t1321.cd_gender, t1321.cd_marital_status, t1321.cd_education_status, COUNT(*) AS cnt1, t1321.cd_purchase_estimate, COUNT(*) AS cnt2, t1321.cd_credit_rating, COUNT(*) AS cnt3 FROM (SELECT t1316.c_customer_sk, t1316.c_current_hdemo_sk, t1316.c_current_addr_sk, t1316.c_first_shipto_date_sk, t1316.c_first_sales_date_sk, t1316.c_birth_day, t1316.c_birth_month, t1316.c_birth_year, t1316.c_last_review_date_sk, t1316.c_current_cdemo_sk, t1316.c_customer_id, t1316.c_last_name, t1316.c_preferred_cust_flag, t1316.c_birth_country, t1316.c_login, t1316.c_email_address, t1316.c_salutation, t1316.c_first_name, t1316.ca_gmt_offset, t1316.ca_address_sk, t1316.ca_street_number, t1316.ca_street_name, t1316.ca_street_type, t1316.ca_suite_number, t1316.ca_city, t1316.ca_county, t1316.ca_state, t1316.ca_zip, t1316.ca_country, t1316.ca_location_type, t1316.ca_address_id, t1316.cd_dep_college_count, t1316.cd_purchase_estimate, t1316.cd_dep_count, t1316.cd_dep_employed_count, t1316.cd_demo_sk, t1316.cd_gender, t1316.cd_marital_status, t1316.cd_education_status, t1316.cd_credit_rating, t1316.f0, t1319.f0 AS f041 FROM (SELECT customer68.c_customer_sk, customer68.c_current_hdemo_sk, customer68.c_current_addr_sk, customer68.c_first_shipto_date_sk, customer68.c_first_sales_date_sk, customer68.c_birth_day, customer68.c_birth_month, customer68.c_birth_year, customer68.c_last_review_date_sk, customer68.c_current_cdemo_sk, customer68.c_customer_id, customer68.c_last_name, customer68.c_preferred_cust_flag, customer68.c_birth_country, customer68.c_login, customer68.c_email_address, customer68.c_salutation, customer68.c_first_name, t1311.ca_gmt_offset, t1311.ca_address_sk, t1311.ca_street_number, t1311.ca_street_name, t1311.ca_street_type, t1311.ca_suite_number, t1311.ca_city, t1311.ca_county, t1311.ca_state, t1311.ca_zip, t1311.ca_country, t1311.ca_location_type, t1311.ca_address_id, t1312.cd_dep_college_count, t1312.cd_purchase_estimate, t1312.cd_dep_count, t1312.cd_dep_employed_count, t1312.cd_demo_sk, t1312.cd_gender, t1312.cd_marital_status, t1312.cd_education_status, t1312.cd_credit_rating, CAST(t1315.f0 AS BOOLEAN) AS f0 FROM customer AS customer68 INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('CA', 'NJ', 'OH')) AS t1311 ON customer68.c_current_addr_sk = t1311.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('S', 'W') AND cd_education_status IN ('2 yr Degree', 'Secondary')) AS t1312 ON customer68.c_current_cdemo_sk = t1312.cd_demo_sk INNER JOIN (SELECT t1313.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM store_sales WHERE ss_list_price >= 34 AND ss_list_price <= 123) AS t1313 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy >= 6 AND d_moy <= 6 + 2) AS t1314 ON t1313.ss_sold_date_sk = t1314.d_date_sk) AS t1315 ON customer68.c_customer_sk = t1315.ss_customer_sk) AS t1316 LEFT JOIN (SELECT t1317.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM web_sales WHERE ws_list_price >= 34 AND ws_list_price <= 123) AS t1317 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy >= 6 AND d_moy <= 6 + 2) AS t1318 ON t1317.ws_sold_date_sk = t1318.d_date_sk) AS t1319 ON t1316.c_customer_sk = t1319.ws_bill_customer_sk WHERE t1319.f0 IS NULL) AS t1321 LEFT JOIN (SELECT t1322.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 34 AND cs_list_price <= 123) AS t1322 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy >= 6 AND d_moy <= 6 + 2) AS t1323 ON t1322.cs_sold_date_sk = t1323.d_date_sk) AS t1324 ON t1321.c_customer_sk = t1324.cs_ship_customer_sk WHERE t1324.f0 IS NULL GROUP BY t1321.cd_gender, t1321.cd_marital_status, t1321.cd_education_status, t1321.cd_purchase_estimate, t1321.cd_credit_rating ORDER BY t1321.cd_gender, t1321.cd_marital_status, t1321.cd_education_status, t1321.cd_purchase_estimate, t1321.cd_credit_rating LIMIT 100","['FILTER_INTO_JOIN', 'PROJECT_TO_CALC']",13.10368498,9.857025703,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
21,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('FL','NC','UT') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'S', 'M') and cd_education_status in ('Unknown', 'Advanced Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+2  and ss_list_price between 199 and 288 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+2  and ws_list_price between 199 and 288  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+2  and cs_list_price between 199 and 288)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;","SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM (SELECT t389.c_customer_sk, t389.c_current_hdemo_sk, t389.c_current_addr_sk, t389.c_first_shipto_date_sk, t389.c_first_sales_date_sk, t389.c_birth_day, t389.c_birth_month, t389.c_birth_year, t389.c_last_review_date_sk, t389.c_current_cdemo_sk, t389.c_customer_id, t389.c_last_name, t389.c_preferred_cust_flag, t389.c_birth_country, t389.c_login, t389.c_email_address, t389.c_salutation, t389.c_first_name, t389.ca_gmt_offset, t389.ca_address_sk, t389.ca_street_number, t389.ca_street_name, t389.ca_street_type, t389.ca_suite_number, t389.ca_city, t389.ca_county, t389.ca_state, t389.ca_zip, t389.ca_country, t389.ca_location_type, t389.ca_address_id, t389.cd_dep_college_count, t389.cd_purchase_estimate, t389.cd_dep_count, t389.cd_dep_employed_count, t389.cd_demo_sk, t389.cd_gender, t389.cd_marital_status, t389.cd_education_status, t389.cd_credit_rating, t389.f0, t389.f00 AS f041, t393.cs_ship_customer_sk, t393.f0 AS f00 FROM (SELECT * FROM (SELECT t382.c_customer_sk, t382.c_current_hdemo_sk, t382.c_current_addr_sk, t382.c_first_shipto_date_sk, t382.c_first_sales_date_sk, t382.c_birth_day, t382.c_birth_month, t382.c_birth_year, t382.c_last_review_date_sk, t382.c_current_cdemo_sk, t382.c_customer_id, t382.c_last_name, t382.c_preferred_cust_flag, t382.c_birth_country, t382.c_login, t382.c_email_address, t382.c_salutation, t382.c_first_name, t382.ca_gmt_offset, t382.ca_address_sk, t382.ca_street_number, t382.ca_street_name, t382.ca_street_type, t382.ca_suite_number, t382.ca_city, t382.ca_county, t382.ca_state, t382.ca_zip, t382.ca_country, t382.ca_location_type, t382.ca_address_id, t382.cd_dep_college_count, t382.cd_purchase_estimate, t382.cd_dep_count, t382.cd_dep_employed_count, t382.cd_demo_sk, t382.cd_gender, t382.cd_marital_status, t382.cd_education_status, t382.cd_credit_rating, CAST(t382.f0 AS BOOLEAN) AS f0, t386.ws_bill_customer_sk, t386.f0 AS f00 FROM (SELECT * FROM (SELECT t377.c_customer_sk, t377.c_current_hdemo_sk, t377.c_current_addr_sk, t377.c_first_shipto_date_sk, t377.c_first_sales_date_sk, t377.c_birth_day, t377.c_birth_month, t377.c_birth_year, t377.c_last_review_date_sk, t377.c_current_cdemo_sk, t377.c_customer_id, t377.c_last_name, t377.c_preferred_cust_flag, t377.c_birth_country, t377.c_login, t377.c_email_address, t377.c_salutation, t377.c_first_name, t377.ca_gmt_offset, t377.ca_address_sk, t377.ca_street_number, t377.ca_street_name, t377.ca_street_type, t377.ca_suite_number, t377.ca_city, t377.ca_county, t377.ca_state, t377.ca_zip, t377.ca_country, t377.ca_location_type, t377.ca_address_id, t377.cd_dep_college_count, t377.cd_purchase_estimate, t377.cd_dep_count, t377.cd_dep_employed_count, t377.cd_demo_sk, t377.cd_gender, t377.cd_marital_status, t377.cd_education_status, t377.cd_credit_rating, t380.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM customer AS customer20, (SELECT * FROM customer_address WHERE ca_state IN ('FL', 'NC', 'UT')) AS t374 WHERE customer20.c_current_addr_sk = t374.ca_address_sk) AS t375, (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('M', 'S', 'W') AND cd_education_status IN ('Advanced Degree', 'Unknown')) AS t376 WHERE t376.cd_demo_sk = t375.c_current_cdemo_sk) AS t377, (SELECT * FROM (SELECT * FROM store_sales WHERE ss_list_price >= 199 AND ss_list_price <= 288) AS t378, (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy >= 7 AND d_moy <= 7 + 2) AS t379 WHERE t378.ss_sold_date_sk = t379.d_date_sk) AS t380) AS t381 WHERE t381.c_customer_sk = t381.ss_customer_sk) AS t382 LEFT JOIN (SELECT t383.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM web_sales WHERE ws_list_price >= 199 AND ws_list_price <= 288) AS t383, (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy >= 7 AND d_moy <= 7 + 2) AS t384 WHERE t383.ws_sold_date_sk = t384.d_date_sk) AS t386 ON t382.c_customer_sk = t386.ws_bill_customer_sk) AS t388 WHERE t388.f00 IS NULL) AS t389 LEFT JOIN (SELECT t390.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 199 AND cs_list_price <= 288) AS t390, (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy >= 7 AND d_moy <= 7 + 2) AS t391 WHERE t390.cs_sold_date_sk = t391.d_date_sk) AS t393 ON t389.c_customer_sk = t393.cs_ship_customer_sk) AS t394 WHERE t394.f00 IS NULL GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100","['FILTER_INTO_JOIN', 'JOIN_PROJECT_TRANSPOSE_RULE(_PROJECT-_PROJ']",9.077722947,8.128577391,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
22,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('GA','MO','VA') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'S', 'M') and cd_education_status in ('Secondary', '2 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 and 9+2  and ss_list_price between 119 and 208 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 and 9+2  and ws_list_price between 119 and 208  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 and 9+2  and cs_list_price between 119 and 208)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;","SELECT t1901.cd_gender, t1901.cd_marital_status, t1901.cd_education_status, COUNT(*) AS cnt1, t1901.cd_purchase_estimate, COUNT(*) AS cnt2, t1901.cd_credit_rating, COUNT(*) AS cnt3 FROM (SELECT t1895.c_customer_sk, t1895.c_current_hdemo_sk, t1895.c_current_addr_sk, t1895.c_first_shipto_date_sk, t1895.c_first_sales_date_sk, t1895.c_birth_day, t1895.c_birth_month, t1895.c_birth_year, t1895.c_last_review_date_sk, t1895.c_current_cdemo_sk, t1895.c_customer_id, t1895.c_last_name, t1895.c_preferred_cust_flag, t1895.c_birth_country, t1895.c_login, t1895.c_email_address, t1895.c_salutation, t1895.c_first_name, t1895.ca_gmt_offset, t1895.ca_address_sk, t1895.ca_street_number, t1895.ca_street_name, t1895.ca_street_type, t1895.ca_suite_number, t1895.ca_city, t1895.ca_county, t1895.ca_state, t1895.ca_zip, t1895.ca_country, t1895.ca_location_type, t1895.ca_address_id, t1895.cd_dep_college_count, t1895.cd_purchase_estimate, t1895.cd_dep_count, t1895.cd_dep_employed_count, t1895.cd_demo_sk, t1895.cd_gender, t1895.cd_marital_status, t1895.cd_education_status, t1895.cd_credit_rating, t1895.f0, t1899.f0 AS f041 FROM (SELECT t1889.c_customer_sk, t1889.c_current_hdemo_sk, t1889.c_current_addr_sk, t1889.c_first_shipto_date_sk, t1889.c_first_sales_date_sk, t1889.c_birth_day, t1889.c_birth_month, t1889.c_birth_year, t1889.c_last_review_date_sk, t1889.c_current_cdemo_sk, t1889.c_customer_id, t1889.c_last_name, t1889.c_preferred_cust_flag, t1889.c_birth_country, t1889.c_login, t1889.c_email_address, t1889.c_salutation, t1889.c_first_name, t1889.ca_gmt_offset, t1889.ca_address_sk, t1889.ca_street_number, t1889.ca_street_name, t1889.ca_street_type, t1889.ca_suite_number, t1889.ca_city, t1889.ca_county, t1889.ca_state, t1889.ca_zip, t1889.ca_country, t1889.ca_location_type, t1889.ca_address_id, t1889.cd_dep_college_count, t1889.cd_purchase_estimate, t1889.cd_dep_count, t1889.cd_dep_employed_count, t1889.cd_demo_sk, t1889.cd_gender, t1889.cd_marital_status, t1889.cd_education_status, t1889.cd_credit_rating, CAST(t1893.f0 AS BOOLEAN) AS f0 FROM (SELECT * FROM (SELECT * FROM customer AS customer97, (SELECT * FROM customer_address WHERE ca_state IN ('GA', 'MO', 'VA')) AS t1886 WHERE customer97.c_current_addr_sk = t1886.ca_address_sk) AS t1887, (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('M', 'S') AND cd_education_status IN ('2 yr Degree', 'Secondary')) AS t1888 WHERE t1888.cd_demo_sk = t1887.c_current_cdemo_sk) AS t1889, (SELECT t1890.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM store_sales WHERE ss_list_price >= 119 AND ss_list_price <= 208) AS t1890, (SELECT * FROM date_dim WHERE d_year = 2002 AND d_moy >= 9 AND d_moy <= 9 + 2) AS t1891 WHERE t1890.ss_sold_date_sk = t1891.d_date_sk) AS t1893 WHERE t1889.c_customer_sk = t1893.ss_customer_sk) AS t1895 LEFT JOIN (SELECT t1896.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM web_sales WHERE ws_list_price >= 119 AND ws_list_price <= 208) AS t1896, (SELECT * FROM date_dim WHERE d_year = 2002 AND d_moy >= 9 AND d_moy <= 9 + 2) AS t1897 WHERE t1896.ws_sold_date_sk = t1897.d_date_sk) AS t1899 ON t1895.c_customer_sk = t1899.ws_bill_customer_sk WHERE t1899.f0 IS NULL) AS t1901 LEFT JOIN (SELECT t1902.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 119 AND cs_list_price <= 208) AS t1902, (SELECT * FROM date_dim WHERE d_year = 2002 AND d_moy >= 9 AND d_moy <= 9 + 2) AS t1903 WHERE t1902.cs_sold_date_sk = t1903.d_date_sk) AS t1905 ON t1901.c_customer_sk = t1905.cs_ship_customer_sk WHERE t1905.f0 IS NULL GROUP BY t1901.cd_gender, t1901.cd_marital_status, t1901.cd_education_status, t1901.cd_purchase_estimate, t1901.cd_credit_rating ORDER BY t1901.cd_gender, t1901.cd_marital_status, t1901.cd_education_status, t1901.cd_purchase_estimate, t1901.cd_credit_rating LIMIT 100","['FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']",23.78836179,13.16030868,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
23,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Anderson County','Baldwin County','Cassia County','Dawson County','Granite County') and c.c_birth_month in (2, 7) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('D', 'M', 'M') and cd_education_status in ('Unknown', 'Unknown', 'Unknown') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 and 8+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and ss_sales_price / ss_list_price BETWEEN 18 * 0.01 AND 28 * 0.01  and i_manager_id BETWEEN 87 and 96  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 ANd 8+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and i_manager_id BETWEEN 87 and 96  and ws_sales_price / ws_list_price BETWEEN 18 * 0.01 AND 28 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 and 8+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and i_manager_id BETWEEN 87 and 96  and cs_sales_price / cs_list_price BETWEEN 18 * 0.01 AND 28 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;","SELECT t2004.cd_gender, t2004.cd_marital_status, t2004.cd_education_status, COUNT(*) AS cnt1, t2004.cd_purchase_estimate, COUNT(*) AS cnt2, t2004.cd_credit_rating, COUNT(*) AS cnt3, t2004.cd_dep_count, COUNT(*) AS cnt4, t2004.cd_dep_employed_count, COUNT(*) AS cnt5, t2004.cd_dep_college_count, COUNT(*) AS cnt6 FROM (SELECT t1998.c_customer_sk, t1998.c_current_hdemo_sk, t1998.c_current_addr_sk, t1998.c_first_shipto_date_sk, t1998.c_first_sales_date_sk, t1998.c_birth_day, t1998.c_birth_month, t1998.c_birth_year, t1998.c_last_review_date_sk, t1998.c_current_cdemo_sk, t1998.c_customer_id, t1998.c_last_name, t1998.c_preferred_cust_flag, t1998.c_birth_country, t1998.c_login, t1998.c_email_address, t1998.c_salutation, t1998.c_first_name, t1998.ca_gmt_offset, t1998.ca_address_sk, t1998.ca_street_number, t1998.ca_street_name, t1998.ca_street_type, t1998.ca_suite_number, t1998.ca_city, t1998.ca_county, t1998.ca_state, t1998.ca_zip, t1998.ca_country, t1998.ca_location_type, t1998.ca_address_id, t1998.cd_dep_college_count, t1998.cd_purchase_estimate, t1998.cd_dep_count, t1998.cd_dep_employed_count, t1998.cd_demo_sk, t1998.cd_gender, t1998.cd_marital_status, t1998.cd_education_status, t1998.cd_credit_rating, t1998.f0, t2002.f0 AS f041 FROM (SELECT customer79.c_customer_sk, customer79.c_current_hdemo_sk, customer79.c_current_addr_sk, customer79.c_first_shipto_date_sk, customer79.c_first_sales_date_sk, customer79.c_birth_day, customer79.c_birth_month, customer79.c_birth_year, customer79.c_last_review_date_sk, customer79.c_current_cdemo_sk, customer79.c_customer_id, customer79.c_last_name, customer79.c_preferred_cust_flag, customer79.c_birth_country, customer79.c_login, customer79.c_email_address, customer79.c_salutation, customer79.c_first_name, customer_address79.ca_gmt_offset, customer_address79.ca_address_sk, customer_address79.ca_street_number, customer_address79.ca_street_name, customer_address79.ca_street_type, customer_address79.ca_suite_number, customer_address79.ca_city, customer_address79.ca_county, customer_address79.ca_state, customer_address79.ca_zip, customer_address79.ca_country, customer_address79.ca_location_type, customer_address79.ca_address_id, customer_demographics79.cd_dep_college_count, customer_demographics79.cd_purchase_estimate, customer_demographics79.cd_dep_count, customer_demographics79.cd_dep_employed_count, customer_demographics79.cd_demo_sk, customer_demographics79.cd_gender, customer_demographics79.cd_marital_status, customer_demographics79.cd_education_status, customer_demographics79.cd_credit_rating, t1997.f0 FROM customer AS customer79 CROSS JOIN customer_address AS customer_address79 CROSS JOIN customer_demographics AS customer_demographics79 LEFT JOIN (SELECT t1994.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 18 * 0.01 AND ss_sales_price / ss_list_price <= 28 * 0.01) AS t1994 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy >= 8 AND d_moy <= 8 + 3) AS t1995 ON t1994.ss_sold_date_sk = t1995.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Home') AND (i_manager_id >= 87 AND i_manager_id <= 96)) AS t1996 ON t1994.ss_item_sk = t1996.i_item_sk) AS t1997 ON customer79.c_customer_sk = t1997.ss_customer_sk) AS t1998 LEFT JOIN (SELECT t1999.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM web_sales WHERE ws_sales_price / ws_list_price >= 18 * 0.01 AND ws_sales_price / ws_list_price <= 28 * 0.01) AS t1999 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy >= 8 AND d_moy <= 8 + 3) AS t2000 ON t1999.ws_sold_date_sk = t2000.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Home') AND (i_manager_id >= 87 AND i_manager_id <= 96)) AS t2001 ON t1999.ws_item_sk = t2001.i_item_sk) AS t2002 ON t1998.c_customer_sk = t2002.ws_bill_customer_sk WHERE t1998.c_current_addr_sk = t1998.ca_address_sk AND t1998.ca_county IN ('Anderson County', 'Baldwin County', 'Cassia County', 'Dawson County', 'Granite County') AND (t1998.c_birth_month IN (2, 7) AND t1998.cd_demo_sk = t1998.c_current_cdemo_sk) AND (t1998.cd_marital_status IN ('D', 'M') AND t1998.cd_education_status = 'Unknown' AND (t1998.cd_gender = 'F' AND t1998.f0 IS NOT NULL))) AS t2004 LEFT JOIN (SELECT t2005.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM catalog_sales WHERE cs_sales_price / cs_list_price >= 18 * 0.01 AND cs_sales_price / cs_list_price <= 28 * 0.01) AS t2005 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy >= 8 AND d_moy <= 8 + 3) AS t2006 ON t2005.cs_sold_date_sk = t2006.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Home') AND (i_manager_id >= 87 AND i_manager_id <= 96)) AS t2007 ON t2005.cs_item_sk = t2007.i_item_sk) AS t2008 ON t2004.c_customer_sk = t2008.cs_ship_customer_sk WHERE t2004.f041 IS NOT NULL OR t2008.f0 IS NOT NULL GROUP BY t2004.cd_gender, t2004.cd_marital_status, t2004.cd_education_status, t2004.cd_purchase_estimate, t2004.cd_credit_rating, t2004.cd_dep_count, t2004.cd_dep_employed_count, t2004.cd_dep_college_count ORDER BY t2004.cd_gender, t2004.cd_marital_status, t2004.cd_education_status, t2004.cd_purchase_estimate, t2004.cd_credit_rating, t2004.cd_dep_count, t2004.cd_dep_employed_count, t2004.cd_dep_college_count LIMIT 100",['PROJECT_TO_CALC'],0.562949975,0.37756443,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
24,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Ashland County','Daggett County','Haines Borough','Iron County','Klamath County') and c.c_birth_month in (5, 9) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'S', 'S') and cd_education_status in ('Secondary', '2 yr Degree', '4 yr Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 9 and 9+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Electronics', 'Music')  and ss_sales_price / ss_list_price BETWEEN 14 * 0.01 AND 24 * 0.01  and i_manager_id BETWEEN 15 and 24  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 9 ANd 9+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Electronics', 'Music')  and i_manager_id BETWEEN 15 and 24  and ws_sales_price / ws_list_price BETWEEN 14 * 0.01 AND 24 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 9 and 9+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Electronics', 'Music')  and i_manager_id BETWEEN 15 and 24  and cs_sales_price / cs_list_price BETWEEN 14 * 0.01 AND 24 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;","SELECT t2026.cd_gender, t2026.cd_marital_status, t2026.cd_education_status, COUNT(*) AS cnt1, t2026.cd_purchase_estimate, COUNT(*) AS cnt2, t2026.cd_credit_rating, COUNT(*) AS cnt3, t2026.cd_dep_count, COUNT(*) AS cnt4, t2026.cd_dep_employed_count, COUNT(*) AS cnt5, t2026.cd_dep_college_count, COUNT(*) AS cnt6 FROM (SELECT t2021.c_customer_sk, t2021.c_current_hdemo_sk, t2021.c_current_addr_sk, t2021.c_first_shipto_date_sk, t2021.c_first_sales_date_sk, t2021.c_birth_day, t2021.c_birth_month, t2021.c_birth_year, t2021.c_last_review_date_sk, t2021.c_current_cdemo_sk, t2021.c_customer_id, t2021.c_last_name, t2021.c_preferred_cust_flag, t2021.c_birth_country, t2021.c_login, t2021.c_email_address, t2021.c_salutation, t2021.c_first_name, t2021.ca_gmt_offset, t2021.ca_address_sk, t2021.ca_street_number, t2021.ca_street_name, t2021.ca_street_type, t2021.ca_suite_number, t2021.ca_city, t2021.ca_county, t2021.ca_state, t2021.ca_zip, t2021.ca_country, t2021.ca_location_type, t2021.ca_address_id, t2021.cd_dep_college_count, t2021.cd_purchase_estimate, t2021.cd_dep_count, t2021.cd_dep_employed_count, t2021.cd_demo_sk, t2021.cd_gender, t2021.cd_marital_status, t2021.cd_education_status, t2021.cd_credit_rating, t2021.f0, t2025.f0 AS f041 FROM (SELECT t2014.c_customer_sk, t2014.c_current_hdemo_sk, t2014.c_current_addr_sk, t2014.c_first_shipto_date_sk, t2014.c_first_sales_date_sk, t2014.c_birth_day, t2014.c_birth_month, t2014.c_birth_year, t2014.c_last_review_date_sk, t2014.c_current_cdemo_sk, t2014.c_customer_id, t2014.c_last_name, t2014.c_preferred_cust_flag, t2014.c_birth_country, t2014.c_login, t2014.c_email_address, t2014.c_salutation, t2014.c_first_name, t2015.ca_gmt_offset, t2015.ca_address_sk, t2015.ca_street_number, t2015.ca_street_name, t2015.ca_street_type, t2015.ca_suite_number, t2015.ca_city, t2015.ca_county, t2015.ca_state, t2015.ca_zip, t2015.ca_country, t2015.ca_location_type, t2015.ca_address_id, t2016.cd_dep_college_count, t2016.cd_purchase_estimate, t2016.cd_dep_count, t2016.cd_dep_employed_count, t2016.cd_demo_sk, t2016.cd_gender, t2016.cd_marital_status, t2016.cd_education_status, t2016.cd_credit_rating, CAST(t2020.ss_customer_sk AS INTEGER) AS ss_customer_sk, CAST(t2020.f0 AS BOOLEAN) AS f0 FROM (SELECT * FROM customer WHERE c_birth_month IN (5, 9)) AS t2014 INNER JOIN (SELECT * FROM customer_address WHERE ca_county IN ('Ashland County', 'Daggett County', 'Haines Borough', 'Iron County', 'Klamath County')) AS t2015 ON t2014.c_current_addr_sk = t2015.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('S', 'W') AND cd_education_status IN ('2 yr Degree', '4 yr Degree', 'Secondary') AND cd_gender = 'M') AS t2016 ON t2014.c_current_cdemo_sk = t2016.cd_demo_sk INNER JOIN (SELECT t2017.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 14 * 0.01 AND ss_sales_price / ss_list_price <= 24 * 0.01) AS t2017 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy >= 9 AND d_moy <= 9 + 3) AS t2018 ON t2017.ss_sold_date_sk = t2018.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Children', 'Electronics', 'Music') AND (i_manager_id >= 15 AND i_manager_id <= 24)) AS t2019 ON t2017.ss_item_sk = t2019.i_item_sk) AS t2020 ON t2014.c_customer_sk = t2020.ss_customer_sk) AS t2021 LEFT JOIN (SELECT t2022.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM web_sales WHERE ws_sales_price / ws_list_price >= 14 * 0.01 AND ws_sales_price / ws_list_price <= 24 * 0.01) AS t2022 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy >= 9 AND d_moy <= 9 + 3) AS t2023 ON t2022.ws_sold_date_sk = t2023.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Children', 'Electronics', 'Music') AND (i_manager_id >= 15 AND i_manager_id <= 24)) AS t2024 ON t2022.ws_item_sk = t2024.i_item_sk) AS t2025 ON t2021.c_customer_sk = t2025.ws_bill_customer_sk) AS t2026 LEFT JOIN (SELECT t2027.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM catalog_sales WHERE cs_sales_price / cs_list_price >= 14 * 0.01 AND cs_sales_price / cs_list_price <= 24 * 0.01) AS t2027 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy >= 9 AND d_moy <= 9 + 3) AS t2028 ON t2027.cs_sold_date_sk = t2028.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Children', 'Electronics', 'Music') AND (i_manager_id >= 15 AND i_manager_id <= 24)) AS t2029 ON t2027.cs_item_sk = t2029.i_item_sk) AS t2030 ON t2026.c_customer_sk = t2030.cs_ship_customer_sk WHERE t2026.f041 IS NOT NULL OR t2030.f0 IS NOT NULL GROUP BY t2026.cd_gender, t2026.cd_marital_status, t2026.cd_education_status, t2026.cd_purchase_estimate, t2026.cd_credit_rating, t2026.cd_dep_count, t2026.cd_dep_employed_count, t2026.cd_dep_college_count ORDER BY t2026.cd_gender, t2026.cd_marital_status, t2026.cd_education_status, t2026.cd_purchase_estimate, t2026.cd_credit_rating, t2026.cd_dep_count, t2026.cd_dep_employed_count, t2026.cd_dep_college_count LIMIT 100","['JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'PROJECT_TO_CALC']",18.14945022,4.222268025,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
25,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Athens County','Beaverhead County','Mitchell County','Pepin County','Roscommon County') and c.c_birth_month in (8, 9) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'M', 'D') and cd_education_status in ('Secondary', 'Secondary', 'Secondary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 and 6+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Men')  and ss_sales_price / ss_list_price BETWEEN 0 * 0.01 AND 10 * 0.01  and i_manager_id BETWEEN 17 and 26  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 ANd 6+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Men')  and i_manager_id BETWEEN 17 and 26  and ws_sales_price / ws_list_price BETWEEN 0 * 0.01 AND 10 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 and 6+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Men')  and i_manager_id BETWEEN 17 and 26  and cs_sales_price / cs_list_price BETWEEN 0 * 0.01 AND 10 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;","SELECT t1967.cd_gender, t1967.cd_marital_status, t1967.cd_education_status, COUNT(*) AS cnt1, t1967.cd_purchase_estimate, COUNT(*) AS cnt2, t1967.cd_credit_rating, COUNT(*) AS cnt3, t1967.cd_dep_count, COUNT(*) AS cnt4, t1967.cd_dep_employed_count, COUNT(*) AS cnt5, t1967.cd_dep_college_count, COUNT(*) AS cnt6 FROM (SELECT t1962.c_customer_sk, t1962.c_current_hdemo_sk, t1962.c_current_addr_sk, t1962.c_first_shipto_date_sk, t1962.c_first_sales_date_sk, t1962.c_birth_day, t1962.c_birth_month, t1962.c_birth_year, t1962.c_last_review_date_sk, t1962.c_current_cdemo_sk, t1962.c_customer_id, t1962.c_last_name, t1962.c_preferred_cust_flag, t1962.c_birth_country, t1962.c_login, t1962.c_email_address, t1962.c_salutation, t1962.c_first_name, t1962.ca_gmt_offset, t1962.ca_address_sk, t1962.ca_street_number, t1962.ca_street_name, t1962.ca_street_type, t1962.ca_suite_number, t1962.ca_city, t1962.ca_county, t1962.ca_state, t1962.ca_zip, t1962.ca_country, t1962.ca_location_type, t1962.ca_address_id, t1962.cd_dep_college_count, t1962.cd_purchase_estimate, t1962.cd_dep_count, t1962.cd_dep_employed_count, t1962.cd_demo_sk, t1962.cd_gender, t1962.cd_marital_status, t1962.cd_education_status, t1962.cd_credit_rating, t1962.f0, t1966.f0 AS f041 FROM (SELECT t1955.c_customer_sk, t1955.c_current_hdemo_sk, t1955.c_current_addr_sk, t1955.c_first_shipto_date_sk, t1955.c_first_sales_date_sk, t1955.c_birth_day, t1955.c_birth_month, t1955.c_birth_year, t1955.c_last_review_date_sk, t1955.c_current_cdemo_sk, t1955.c_customer_id, t1955.c_last_name, t1955.c_preferred_cust_flag, t1955.c_birth_country, t1955.c_login, t1955.c_email_address, t1955.c_salutation, t1955.c_first_name, t1956.ca_gmt_offset, t1956.ca_address_sk, t1956.ca_street_number, t1956.ca_street_name, t1956.ca_street_type, t1956.ca_suite_number, t1956.ca_city, t1956.ca_county, t1956.ca_state, t1956.ca_zip, t1956.ca_country, t1956.ca_location_type, t1956.ca_address_id, t1957.cd_dep_college_count, t1957.cd_purchase_estimate, t1957.cd_dep_count, t1957.cd_dep_employed_count, t1957.cd_demo_sk, t1957.cd_gender, t1957.cd_marital_status, t1957.cd_education_status, t1957.cd_credit_rating, CAST(t1961.f0 AS BOOLEAN) AS f0 FROM (SELECT * FROM customer WHERE c_birth_month IN (8, 9)) AS t1955 INNER JOIN (SELECT * FROM customer_address WHERE ca_county IN ('Athens County', 'Beaverhead County', 'Mitchell County', 'Pepin County', 'Roscommon County')) AS t1956 ON t1955.c_current_addr_sk = t1956.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('D', 'M', 'U') AND cd_education_status = 'Secondary' AND cd_gender = 'M') AS t1957 ON t1955.c_current_cdemo_sk = t1957.cd_demo_sk INNER JOIN (SELECT t1958.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 0 * 0.01 AND ss_sales_price / ss_list_price <= 10 * 0.01) AS t1958 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy >= 6 AND d_moy <= 6 + 3) AS t1959 ON t1958.ss_sold_date_sk = t1959.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Men') AND (i_manager_id >= 17 AND i_manager_id <= 26)) AS t1960 ON t1958.ss_item_sk = t1960.i_item_sk) AS t1961 ON t1955.c_customer_sk = t1961.ss_customer_sk) AS t1962 LEFT JOIN (SELECT t1963.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM web_sales WHERE ws_sales_price / ws_list_price >= 0 * 0.01 AND ws_sales_price / ws_list_price <= 10 * 0.01) AS t1963 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy >= 6 AND d_moy <= 6 + 3) AS t1964 ON t1963.ws_sold_date_sk = t1964.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Men') AND (i_manager_id >= 17 AND i_manager_id <= 26)) AS t1965 ON t1963.ws_item_sk = t1965.i_item_sk) AS t1966 ON t1962.c_customer_sk = t1966.ws_bill_customer_sk) AS t1967 LEFT JOIN (SELECT t1968.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM catalog_sales WHERE cs_sales_price / cs_list_price >= 0 * 0.01 AND cs_sales_price / cs_list_price <= 10 * 0.01) AS t1968 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy >= 6 AND d_moy <= 6 + 3) AS t1969 ON t1968.cs_sold_date_sk = t1969.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Men') AND (i_manager_id >= 17 AND i_manager_id <= 26)) AS t1970 ON t1968.cs_item_sk = t1970.i_item_sk) AS t1971 ON t1967.c_customer_sk = t1971.cs_ship_customer_sk WHERE t1967.f041 IS NOT NULL OR t1971.f0 IS NOT NULL GROUP BY t1967.cd_gender, t1967.cd_marital_status, t1967.cd_education_status, t1967.cd_purchase_estimate, t1967.cd_credit_rating, t1967.cd_dep_count, t1967.cd_dep_employed_count, t1967.cd_dep_college_count ORDER BY t1967.cd_gender, t1967.cd_marital_status, t1967.cd_education_status, t1967.cd_purchase_estimate, t1967.cd_credit_rating, t1967.cd_dep_count, t1967.cd_dep_employed_count, t1967.cd_dep_college_count LIMIT 100","['FILTER_INTO_JOIN', 'PROJECT_TO_CALC']",15.16217319,7.432032665,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
26,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Augusta County','Boone County','Clarke County','Dooly County','Milam County') and c.c_birth_month in (3, 12) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'U', 'U') and cd_education_status in ('Secondary', 'Advanced Degree', 'Secondary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Sports')  and ss_sales_price / ss_list_price BETWEEN 16 * 0.01 AND 26 * 0.01  and i_manager_id BETWEEN 91 and 100  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 ANd 7+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Sports')  and i_manager_id BETWEEN 91 and 100  and ws_sales_price / ws_list_price BETWEEN 16 * 0.01 AND 26 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Sports')  and i_manager_id BETWEEN 91 and 100  and cs_sales_price / cs_list_price BETWEEN 16 * 0.01 AND 26 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;","SELECT t9.cd_gender, t9.cd_marital_status, t9.cd_education_status, COUNT(*) AS cnt1, t9.cd_purchase_estimate, COUNT(*) AS cnt2, t9.cd_credit_rating, COUNT(*) AS cnt3, t9.cd_dep_count, COUNT(*) AS cnt4, t9.cd_dep_employed_count, COUNT(*) AS cnt5, t9.cd_dep_college_count, COUNT(*) AS cnt6 FROM (SELECT * FROM (SELECT customer.c_customer_sk, customer.c_current_hdemo_sk, customer.c_current_addr_sk, customer.c_first_shipto_date_sk, customer.c_first_sales_date_sk, customer.c_birth_day, customer.c_birth_month, customer.c_birth_year, customer.c_last_review_date_sk, customer.c_current_cdemo_sk, customer.c_customer_id, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_country, customer.c_login, customer.c_email_address, customer.c_salutation, customer.c_first_name, customer_address.ca_gmt_offset, customer_address.ca_address_sk, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_street_type, customer_address.ca_suite_number, customer_address.ca_city, customer_address.ca_county, customer_address.ca_state, customer_address.ca_zip, customer_address.ca_country, customer_address.ca_location_type, customer_address.ca_address_id, customer_demographics.cd_dep_college_count, customer_demographics.cd_purchase_estimate, customer_demographics.cd_dep_count, customer_demographics.cd_dep_employed_count, customer_demographics.cd_demo_sk, customer_demographics.cd_gender, customer_demographics.cd_marital_status, customer_demographics.cd_education_status, customer_demographics.cd_credit_rating, t2.f0, t6.f0 AS f041 FROM customer CROSS JOIN customer_address CROSS JOIN customer_demographics LEFT JOIN (SELECT t.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 16 * 0.01 AND ss_sales_price / ss_list_price <= 26 * 0.01) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy >= 7 AND d_moy <= 7 + 3) AS t0 ON t.ss_sold_date_sk = t0.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Children', 'Jewelry', 'Sports') AND (i_manager_id >= 91 AND i_manager_id <= 100)) AS t1 ON t.ss_item_sk = t1.i_item_sk) AS t2 ON customer.c_customer_sk = t2.ss_customer_sk LEFT JOIN (SELECT t3.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM web_sales WHERE ws_sales_price / ws_list_price >= 16 * 0.01 AND ws_sales_price / ws_list_price <= 26 * 0.01) AS t3 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy >= 7 AND d_moy <= 7 + 3) AS t4 ON t3.ws_sold_date_sk = t4.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Children', 'Jewelry', 'Sports') AND (i_manager_id >= 91 AND i_manager_id <= 100)) AS t5 ON t3.ws_item_sk = t5.i_item_sk) AS t6 ON customer.c_customer_sk = t6.ws_bill_customer_sk) AS t8 WHERE t8.c_current_addr_sk = t8.ca_address_sk AND t8.ca_county IN ('Augusta County', 'Boone County', 'Clarke County', 'Dooly County', 'Milam County') AND (t8.c_birth_month IN (3, 12) AND t8.cd_demo_sk = t8.c_current_cdemo_sk) AND (t8.cd_marital_status IN ('S', 'U') AND t8.cd_education_status IN ('Advanced Degree', 'Secondary') AND (t8.cd_gender = 'M' AND t8.f0 IS NOT NULL))) AS t9 LEFT JOIN (SELECT t10.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM catalog_sales WHERE cs_sales_price / cs_list_price >= 16 * 0.01 AND cs_sales_price / cs_list_price <= 26 * 0.01) AS t10 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy >= 7 AND d_moy <= 7 + 3) AS t11 ON t10.cs_sold_date_sk = t11.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Children', 'Jewelry', 'Sports') AND (i_manager_id >= 91 AND i_manager_id <= 100)) AS t12 ON t10.cs_item_sk = t12.i_item_sk) AS t13 ON t9.c_customer_sk = t13.cs_ship_customer_sk WHERE t9.f041 IS NOT NULL OR t13.f0 IS NOT NULL GROUP BY t9.cd_dep_college_count, t9.cd_purchase_estimate, t9.cd_dep_count, t9.cd_dep_employed_count, t9.cd_gender, t9.cd_marital_status, t9.cd_education_status, t9.cd_credit_rating ORDER BY t9.cd_gender, t9.cd_marital_status, t9.cd_education_status, t9.cd_purchase_estimate, t9.cd_credit_rating, t9.cd_dep_count, t9.cd_dep_employed_count, t9.cd_dep_college_count LIMIT 100;","['FILTER_SCAN', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'FILTER_SCAN', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'FILTER_SCAN', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'FILTER_SCAN', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']",8.333304644,3.780585368,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
27,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Barton County','Elliott County','Fairfax County','Madison Parish','Mellette County') and c.c_birth_month in (4, 8) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'S', 'S') and cd_education_status in ('Unknown', '4 yr Degree', '2 yr Degree') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 4 and 4+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Shoes')  and ss_sales_price / ss_list_price BETWEEN 31 * 0.01 AND 41 * 0.01  and i_manager_id BETWEEN 54 and 63  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 4 ANd 4+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Shoes')  and i_manager_id BETWEEN 54 and 63  and ws_sales_price / ws_list_price BETWEEN 31 * 0.01 AND 41 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 4 and 4+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Shoes')  and i_manager_id BETWEEN 54 and 63  and cs_sales_price / cs_list_price BETWEEN 31 * 0.01 AND 41 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;","SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3, cd_dep_count, COUNT(*) AS cnt4, cd_dep_employed_count, COUNT(*) AS cnt5, cd_dep_college_count, COUNT(*) AS cnt6 FROM (SELECT t2289.c_customer_sk, t2289.c_current_hdemo_sk, t2289.c_current_addr_sk, t2289.c_first_shipto_date_sk, t2289.c_first_sales_date_sk, t2289.c_birth_day, t2289.c_birth_month, t2289.c_birth_year, t2289.c_last_review_date_sk, t2289.c_current_cdemo_sk, t2289.c_customer_id, t2289.c_last_name, t2289.c_preferred_cust_flag, t2289.c_birth_country, t2289.c_login, t2289.c_email_address, t2289.c_salutation, t2289.c_first_name, t2289.ca_gmt_offset, t2289.ca_address_sk, t2289.ca_street_number, t2289.ca_street_name, t2289.ca_street_type, t2289.ca_suite_number, t2289.ca_city, t2289.ca_county, t2289.ca_state, t2289.ca_zip, t2289.ca_country, t2289.ca_location_type, t2289.ca_address_id, t2289.cd_dep_college_count, t2289.cd_purchase_estimate, t2289.cd_dep_count, t2289.cd_dep_employed_count, t2289.cd_demo_sk, t2289.cd_gender, t2289.cd_marital_status, t2289.cd_education_status, t2289.cd_credit_rating, CAST(t2289.f0 AS BOOLEAN) AS f0, t2295.f0 AS f041, t2301.cs_ship_customer_sk, t2301.f0 AS f00 FROM (SELECT * FROM (SELECT t2282.c_customer_sk, t2282.c_current_hdemo_sk, t2282.c_current_addr_sk, t2282.c_first_shipto_date_sk, t2282.c_first_sales_date_sk, t2282.c_birth_day, t2282.c_birth_month, t2282.c_birth_year, t2282.c_last_review_date_sk, t2282.c_current_cdemo_sk, t2282.c_customer_id, t2282.c_last_name, t2282.c_preferred_cust_flag, t2282.c_birth_country, t2282.c_login, t2282.c_email_address, t2282.c_salutation, t2282.c_first_name, t2282.ca_gmt_offset, t2282.ca_address_sk, t2282.ca_street_number, t2282.ca_street_name, t2282.ca_street_type, t2282.ca_suite_number, t2282.ca_city, t2282.ca_county, t2282.ca_state, t2282.ca_zip, t2282.ca_country, t2282.ca_location_type, t2282.ca_address_id, t2282.cd_dep_college_count, t2282.cd_purchase_estimate, t2282.cd_dep_count, t2282.cd_dep_employed_count, t2282.cd_demo_sk, t2282.cd_gender, t2282.cd_marital_status, t2282.cd_education_status, t2282.cd_credit_rating, t2287.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM customer WHERE c_birth_month IN (4, 8)) AS t2278, (SELECT * FROM customer_address WHERE ca_county IN ('Barton County', 'Elliott County', 'Fairfax County', 'Madison Parish', 'Mellette County')) AS t2279 WHERE t2278.c_current_addr_sk = t2279.ca_address_sk) AS t2280, (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('M', 'S') AND cd_education_status IN ('2 yr Degree', '4 yr Degree', 'Unknown') AND cd_gender = 'F') AS t2281 WHERE t2281.cd_demo_sk = t2280.c_current_cdemo_sk) AS t2282, (SELECT * FROM (SELECT * FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 31 * 0.01 AND ss_sales_price / ss_list_price <= 41 * 0.01) AS t2283, (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy >= 4 AND d_moy <= 4 + 3) AS t2284 WHERE t2283.ss_sold_date_sk = t2284.d_date_sk) AS t2285, (SELECT * FROM item WHERE i_category IN ('Children', 'Home', 'Shoes') AND (i_manager_id >= 54 AND i_manager_id <= 63)) AS t2286 WHERE t2285.ss_item_sk = t2286.i_item_sk) AS t2287) AS t2288 WHERE t2288.c_customer_sk = t2288.ss_customer_sk) AS t2289 LEFT JOIN (SELECT t2292.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM web_sales WHERE ws_sales_price / ws_list_price >= 31 * 0.01 AND ws_sales_price / ws_list_price <= 41 * 0.01) AS t2290, (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy >= 4 AND d_moy <= 4 + 3) AS t2291 WHERE t2290.ws_sold_date_sk = t2291.d_date_sk) AS t2292, (SELECT * FROM item WHERE i_category IN ('Children', 'Home', 'Shoes') AND (i_manager_id >= 54 AND i_manager_id <= 63)) AS t2293 WHERE t2292.ws_item_sk = t2293.i_item_sk) AS t2295 ON t2289.c_customer_sk = t2295.ws_bill_customer_sk LEFT JOIN (SELECT t2298.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_sales_price / cs_list_price >= 31 * 0.01 AND cs_sales_price / cs_list_price <= 41 * 0.01) AS t2296, (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy >= 4 AND d_moy <= 4 + 3) AS t2297 WHERE t2296.cs_sold_date_sk = t2297.d_date_sk) AS t2298, (SELECT * FROM item WHERE i_category IN ('Children', 'Home', 'Shoes') AND (i_manager_id >= 54 AND i_manager_id <= 63)) AS t2299 WHERE t2298.cs_item_sk = t2299.i_item_sk) AS t2301 ON t2289.c_customer_sk = t2301.cs_ship_customer_sk) AS t2304 WHERE t2304.f041 IS NOT NULL OR t2304.f00 IS NOT NULL GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100","['JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_PROJECT_TRANSPOSE_RULE(_PROJECT-_PROJ']",13.90349563,3.818445444,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
28,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Bee County','Bell County','Comanche County','Hardin County','Twin Falls County') and c.c_birth_month in (2, 3) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'S', 'S') and cd_education_status in ('4 yr Degree', 'Advanced Degree', '4 yr Degree') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 3 and 3+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and ss_sales_price / ss_list_price BETWEEN 15 * 0.01 AND 25 * 0.01  and i_manager_id BETWEEN 34 and 43  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 3 ANd 3+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and i_manager_id BETWEEN 34 and 43  and ws_sales_price / ws_list_price BETWEEN 15 * 0.01 AND 25 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 3 and 3+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and i_manager_id BETWEEN 34 and 43  and cs_sales_price / cs_list_price BETWEEN 15 * 0.01 AND 25 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;","SELECT t2362.cd_gender, t2362.cd_marital_status, t2362.cd_education_status, COUNT(*) AS cnt1, t2362.cd_purchase_estimate, COUNT(*) AS cnt2, t2362.cd_credit_rating, COUNT(*) AS cnt3, t2362.cd_dep_count, COUNT(*) AS cnt4, t2362.cd_dep_employed_count, COUNT(*) AS cnt5, t2362.cd_dep_college_count, COUNT(*) AS cnt6 FROM (SELECT t2355.c_customer_sk, t2355.c_current_hdemo_sk, t2355.c_current_addr_sk, t2355.c_first_shipto_date_sk, t2355.c_first_sales_date_sk, t2355.c_birth_day, t2355.c_birth_month, t2355.c_birth_year, t2355.c_last_review_date_sk, t2355.c_current_cdemo_sk, t2355.c_customer_id, t2355.c_last_name, t2355.c_preferred_cust_flag, t2355.c_birth_country, t2355.c_login, t2355.c_email_address, t2355.c_salutation, t2355.c_first_name, t2355.ca_gmt_offset, t2355.ca_address_sk, t2355.ca_street_number, t2355.ca_street_name, t2355.ca_street_type, t2355.ca_suite_number, t2355.ca_city, t2355.ca_county, t2355.ca_state, t2355.ca_zip, t2355.ca_country, t2355.ca_location_type, t2355.ca_address_id, t2355.cd_dep_college_count, t2355.cd_purchase_estimate, t2355.cd_dep_count, t2355.cd_dep_employed_count, t2355.cd_demo_sk, t2355.cd_gender, t2355.cd_marital_status, t2355.cd_education_status, t2355.cd_credit_rating, t2355.f0, t2361.f0 AS f041 FROM (SELECT t2347.c_customer_sk, t2347.c_current_hdemo_sk, t2347.c_current_addr_sk, t2347.c_first_shipto_date_sk, t2347.c_first_sales_date_sk, t2347.c_birth_day, t2347.c_birth_month, t2347.c_birth_year, t2347.c_last_review_date_sk, t2347.c_current_cdemo_sk, t2347.c_customer_id, t2347.c_last_name, t2347.c_preferred_cust_flag, t2347.c_birth_country, t2347.c_login, t2347.c_email_address, t2347.c_salutation, t2347.c_first_name, t2347.ca_gmt_offset, t2347.ca_address_sk, t2347.ca_street_number, t2347.ca_street_name, t2347.ca_street_type, t2347.ca_suite_number, t2347.ca_city, t2347.ca_county, t2347.ca_state, t2347.ca_zip, t2347.ca_country, t2347.ca_location_type, t2347.ca_address_id, t2347.cd_dep_college_count, t2347.cd_purchase_estimate, t2347.cd_dep_count, t2347.cd_dep_employed_count, t2347.cd_demo_sk, t2347.cd_gender, t2347.cd_marital_status, t2347.cd_education_status, t2347.cd_credit_rating, CAST(t2353.f0 AS BOOLEAN) AS f0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM customer WHERE c_birth_month IN (2, 3)) AS t2343, (SELECT * FROM customer_address WHERE ca_county IN ('Bee County', 'Bell County', 'Comanche County', 'Hardin County', 'Twin Falls County')) AS t2344 WHERE t2343.c_current_addr_sk = t2344.ca_address_sk) AS t2345, (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('S', 'W') AND cd_education_status IN ('4 yr Degree', 'Advanced Degree') AND cd_gender = 'F') AS t2346 WHERE t2346.cd_demo_sk = t2345.c_current_cdemo_sk) AS t2347, (SELECT t2350.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 15 * 0.01 AND ss_sales_price / ss_list_price <= 25 * 0.01) AS t2348, (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy >= 3 AND d_moy <= 3 + 3) AS t2349 WHERE t2348.ss_sold_date_sk = t2349.d_date_sk) AS t2350, (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Home') AND (i_manager_id >= 34 AND i_manager_id <= 43)) AS t2351 WHERE t2350.ss_item_sk = t2351.i_item_sk) AS t2353 WHERE t2347.c_customer_sk = t2353.ss_customer_sk) AS t2355 LEFT JOIN (SELECT t2358.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM web_sales WHERE ws_sales_price / ws_list_price >= 15 * 0.01 AND ws_sales_price / ws_list_price <= 25 * 0.01) AS t2356, (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy >= 3 AND d_moy <= 3 + 3) AS t2357 WHERE t2356.ws_sold_date_sk = t2357.d_date_sk) AS t2358, (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Home') AND (i_manager_id >= 34 AND i_manager_id <= 43)) AS t2359 WHERE t2358.ws_item_sk = t2359.i_item_sk) AS t2361 ON t2355.c_customer_sk = t2361.ws_bill_customer_sk) AS t2362 LEFT JOIN (SELECT t2365.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_sales_price / cs_list_price >= 15 * 0.01 AND cs_sales_price / cs_list_price <= 25 * 0.01) AS t2363, (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy >= 3 AND d_moy <= 3 + 3) AS t2364 WHERE t2363.cs_sold_date_sk = t2364.d_date_sk) AS t2365, (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Home') AND (i_manager_id >= 34 AND i_manager_id <= 43)) AS t2366 WHERE t2365.cs_item_sk = t2366.i_item_sk) AS t2368 ON t2362.c_customer_sk = t2368.cs_ship_customer_sk WHERE t2362.f041 IS NOT NULL OR t2368.f0 IS NOT NULL GROUP BY t2362.cd_gender, t2362.cd_marital_status, t2362.cd_education_status, t2362.cd_purchase_estimate, t2362.cd_credit_rating, t2362.cd_dep_count, t2362.cd_dep_employed_count, t2362.cd_dep_college_count ORDER BY t2362.cd_gender, t2362.cd_marital_status, t2362.cd_education_status, t2362.cd_purchase_estimate, t2362.cd_credit_rating, t2362.cd_dep_count, t2362.cd_dep_employed_count, t2362.cd_dep_college_count LIMIT 100","['FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']",19.81988319,4.078652302,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
29,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Blaine County','Calhoun County','Lafayette County','Lincoln County','Nicollet County') and c.c_birth_month in (5, 10) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'S', 'S') and cd_education_status in ('4 yr Degree', 'Primary', '2 yr Degree') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 9 and 9+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Shoes')  and ss_sales_price / ss_list_price BETWEEN 42 * 0.01 AND 52 * 0.01  and i_manager_id BETWEEN 42 and 51  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 9 ANd 9+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Shoes')  and i_manager_id BETWEEN 42 and 51  and ws_sales_price / ws_list_price BETWEEN 42 * 0.01 AND 52 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 9 and 9+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Shoes')  and i_manager_id BETWEEN 42 and 51  and cs_sales_price / cs_list_price BETWEEN 42 * 0.01 AND 52 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;","SELECT t2312.cd_gender, t2312.cd_marital_status, t2312.cd_education_status, COUNT(*) AS cnt1, t2312.cd_purchase_estimate, COUNT(*) AS cnt2, t2312.cd_credit_rating, COUNT(*) AS cnt3, t2312.cd_dep_count, COUNT(*) AS cnt4, t2312.cd_dep_employed_count, COUNT(*) AS cnt5, t2312.cd_dep_college_count, COUNT(*) AS cnt6 FROM (SELECT customer97.c_customer_sk, customer97.c_current_hdemo_sk, customer97.c_current_addr_sk, customer97.c_first_shipto_date_sk, customer97.c_first_sales_date_sk, customer97.c_birth_day, customer97.c_birth_month, customer97.c_birth_year, customer97.c_last_review_date_sk, customer97.c_current_cdemo_sk, customer97.c_customer_id, customer97.c_last_name, customer97.c_preferred_cust_flag, customer97.c_birth_country, customer97.c_login, customer97.c_email_address, customer97.c_salutation, customer97.c_first_name, customer_address97.ca_gmt_offset, customer_address97.ca_address_sk, customer_address97.ca_street_number, customer_address97.ca_street_name, customer_address97.ca_street_type, customer_address97.ca_suite_number, customer_address97.ca_city, customer_address97.ca_county, customer_address97.ca_state, customer_address97.ca_zip, customer_address97.ca_country, customer_address97.ca_location_type, customer_address97.ca_address_id, customer_demographics97.cd_dep_college_count, customer_demographics97.cd_purchase_estimate, customer_demographics97.cd_dep_count, customer_demographics97.cd_dep_employed_count, customer_demographics97.cd_demo_sk, customer_demographics97.cd_gender, customer_demographics97.cd_marital_status, customer_demographics97.cd_education_status, customer_demographics97.cd_credit_rating, t2304.f0, t2310.f0 AS f041 FROM customer AS customer97 CROSS JOIN customer_address AS customer_address97 CROSS JOIN customer_demographics AS customer_demographics97 LEFT JOIN (SELECT t2301.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 42 * 0.01 AND ss_sales_price / ss_list_price <= 52 * 0.01) AS t2299, (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy >= 9 AND d_moy <= 9 + 3) AS t2300 WHERE t2299.ss_sold_date_sk = t2300.d_date_sk) AS t2301, (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Shoes') AND (i_manager_id >= 42 AND i_manager_id <= 51)) AS t2302 WHERE t2301.ss_item_sk = t2302.i_item_sk) AS t2304 ON customer97.c_customer_sk = t2304.ss_customer_sk LEFT JOIN (SELECT t2307.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM web_sales WHERE ws_sales_price / ws_list_price >= 42 * 0.01 AND ws_sales_price / ws_list_price <= 52 * 0.01) AS t2305, (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy >= 9 AND d_moy <= 9 + 3) AS t2306 WHERE t2305.ws_sold_date_sk = t2306.d_date_sk) AS t2307, (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Shoes') AND (i_manager_id >= 42 AND i_manager_id <= 51)) AS t2308 WHERE t2307.ws_item_sk = t2308.i_item_sk) AS t2310 ON customer97.c_customer_sk = t2310.ws_bill_customer_sk WHERE customer97.c_current_addr_sk = customer_address97.ca_address_sk AND customer_address97.ca_county IN ('Blaine County', 'Calhoun County', 'Lafayette County', 'Lincoln County', 'Nicollet County') AND (customer97.c_birth_month IN (5, 10) AND customer_demographics97.cd_demo_sk = customer97.c_current_cdemo_sk) AND (customer_demographics97.cd_marital_status IN ('S', 'W') AND customer_demographics97.cd_education_status IN ('2 yr Degree', '4 yr Degree', 'Primary') AND (customer_demographics97.cd_gender = 'F' AND t2304.f0 IS NOT NULL))) AS t2312 LEFT JOIN (SELECT t2315.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_sales_price / cs_list_price >= 42 * 0.01 AND cs_sales_price / cs_list_price <= 52 * 0.01) AS t2313, (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy >= 9 AND d_moy <= 9 + 3) AS t2314 WHERE t2313.cs_sold_date_sk = t2314.d_date_sk) AS t2315, (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Shoes') AND (i_manager_id >= 42 AND i_manager_id <= 51)) AS t2316 WHERE t2315.cs_item_sk = t2316.i_item_sk) AS t2318 ON t2312.c_customer_sk = t2318.cs_ship_customer_sk WHERE t2312.f041 IS NOT NULL OR t2318.f0 IS NOT NULL GROUP BY t2312.cd_gender, t2312.cd_marital_status, t2312.cd_education_status, t2312.cd_purchase_estimate, t2312.cd_credit_rating, t2312.cd_dep_count, t2312.cd_dep_employed_count, t2312.cd_dep_college_count ORDER BY t2312.cd_gender, t2312.cd_marital_status, t2312.cd_education_status, t2312.cd_purchase_estimate, t2312.cd_credit_rating, t2312.cd_dep_count, t2312.cd_dep_employed_count, t2312.cd_dep_college_count LIMIT 100","['JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC']",17.13289769,15.83874671,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
30,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Burlington County','Jefferson County','Scott County','Somerset County','Wilkinson County') and c.c_birth_month in (3, 12) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'U', 'U') and cd_education_status in ('Secondary', 'Advanced Degree', '4 yr Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Sports')  and ss_sales_price / ss_list_price BETWEEN 54 * 0.01 AND 64 * 0.01  and i_manager_id BETWEEN 5 and 14  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 ANd 9+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Sports')  and i_manager_id BETWEEN 5 and 14  and ws_sales_price / ws_list_price BETWEEN 54 * 0.01 AND 64 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Sports')  and i_manager_id BETWEEN 5 and 14  and cs_sales_price / cs_list_price BETWEEN 54 * 0.01 AND 64 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;","SELECT t2244.cd_gender, t2244.cd_marital_status, t2244.cd_education_status, COUNT(*) AS cnt1, t2244.cd_purchase_estimate, COUNT(*) AS cnt2, t2244.cd_credit_rating, COUNT(*) AS cnt3, t2244.cd_dep_count, COUNT(*) AS cnt4, t2244.cd_dep_employed_count, COUNT(*) AS cnt5, t2244.cd_dep_college_count, COUNT(*) AS cnt6 FROM (SELECT customer93.c_customer_sk, customer93.c_current_hdemo_sk, customer93.c_current_addr_sk, customer93.c_first_shipto_date_sk, customer93.c_first_sales_date_sk, customer93.c_birth_day, customer93.c_birth_month, customer93.c_birth_year, customer93.c_last_review_date_sk, customer93.c_current_cdemo_sk, customer93.c_customer_id, customer93.c_last_name, customer93.c_preferred_cust_flag, customer93.c_birth_country, customer93.c_login, customer93.c_email_address, customer93.c_salutation, customer93.c_first_name, customer_address93.ca_gmt_offset, customer_address93.ca_address_sk, customer_address93.ca_street_number, customer_address93.ca_street_name, customer_address93.ca_street_type, customer_address93.ca_suite_number, customer_address93.ca_city, customer_address93.ca_county, customer_address93.ca_state, customer_address93.ca_zip, customer_address93.ca_country, customer_address93.ca_location_type, customer_address93.ca_address_id, customer_demographics93.cd_dep_college_count, customer_demographics93.cd_purchase_estimate, customer_demographics93.cd_dep_count, customer_demographics93.cd_dep_employed_count, customer_demographics93.cd_demo_sk, customer_demographics93.cd_gender, customer_demographics93.cd_marital_status, customer_demographics93.cd_education_status, customer_demographics93.cd_credit_rating, t2238.f0, t2242.f0 AS f041 FROM customer AS customer93 CROSS JOIN customer_address AS customer_address93 CROSS JOIN customer_demographics AS customer_demographics93 LEFT JOIN (SELECT t2235.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 54 * 0.01 AND ss_sales_price / ss_list_price <= 64 * 0.01) AS t2235 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy >= 9 AND d_moy <= 9 + 3) AS t2236 ON t2235.ss_sold_date_sk = t2236.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Sports') AND (i_manager_id >= 5 AND i_manager_id <= 14)) AS t2237 ON t2235.ss_item_sk = t2237.i_item_sk) AS t2238 ON customer93.c_customer_sk = t2238.ss_customer_sk LEFT JOIN (SELECT t2239.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM web_sales WHERE ws_sales_price / ws_list_price >= 54 * 0.01 AND ws_sales_price / ws_list_price <= 64 * 0.01) AS t2239 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy >= 9 AND d_moy <= 9 + 3) AS t2240 ON t2239.ws_sold_date_sk = t2240.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Sports') AND (i_manager_id >= 5 AND i_manager_id <= 14)) AS t2241 ON t2239.ws_item_sk = t2241.i_item_sk) AS t2242 ON customer93.c_customer_sk = t2242.ws_bill_customer_sk WHERE customer93.c_current_addr_sk = customer_address93.ca_address_sk AND customer_address93.ca_county IN ('Burlington County', 'Jefferson County', 'Scott County', 'Somerset County', 'Wilkinson County') AND (customer93.c_birth_month IN (3, 12) AND customer_demographics93.cd_demo_sk = customer93.c_current_cdemo_sk) AND (customer_demographics93.cd_marital_status = 'U' AND customer_demographics93.cd_education_status IN ('4 yr Degree', 'Advanced Degree', 'Secondary') AND (customer_demographics93.cd_gender = 'M' AND t2238.f0 IS NOT NULL))) AS t2244 LEFT JOIN (SELECT t2245.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM catalog_sales WHERE cs_sales_price / cs_list_price >= 54 * 0.01 AND cs_sales_price / cs_list_price <= 64 * 0.01) AS t2245 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy >= 9 AND d_moy <= 9 + 3) AS t2246 ON t2245.cs_sold_date_sk = t2246.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Sports') AND (i_manager_id >= 5 AND i_manager_id <= 14)) AS t2247 ON t2245.cs_item_sk = t2247.i_item_sk) AS t2248 ON t2244.c_customer_sk = t2248.cs_ship_customer_sk WHERE t2244.f041 IS NOT NULL OR t2248.f0 IS NOT NULL GROUP BY t2244.cd_gender, t2244.cd_marital_status, t2244.cd_education_status, t2244.cd_purchase_estimate, t2244.cd_credit_rating, t2244.cd_dep_count, t2244.cd_dep_employed_count, t2244.cd_dep_college_count ORDER BY t2244.cd_gender, t2244.cd_marital_status, t2244.cd_education_status, t2244.cd_purchase_estimate, t2244.cd_credit_rating, t2244.cd_dep_count, t2244.cd_dep_employed_count, t2244.cd_dep_college_count LIMIT 100","['JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']",17.27906513,14.2825857,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
31,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Caddo Parish','El Paso County','Franklin Parish','Jones County','York County') and c.c_birth_month in (1, 8) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'W', 'S') and cd_education_status in ('Primary', 'Primary', '4 yr Degree') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 7 and 7+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Men')  and ss_sales_price / ss_list_price BETWEEN 42 * 0.01 AND 52 * 0.01  and i_manager_id BETWEEN 32 and 41  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 7 ANd 7+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Men')  and i_manager_id BETWEEN 32 and 41  and ws_sales_price / ws_list_price BETWEEN 42 * 0.01 AND 52 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 7 and 7+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Men')  and i_manager_id BETWEEN 32 and 41  and cs_sales_price / cs_list_price BETWEEN 42 * 0.01 AND 52 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;","SELECT t1288.cd_gender, t1288.cd_marital_status, t1288.cd_education_status, COUNT(*) AS cnt1, t1288.cd_purchase_estimate, COUNT(*) AS cnt2, t1288.cd_credit_rating, COUNT(*) AS cnt3, t1288.cd_dep_count, COUNT(*) AS cnt4, t1288.cd_dep_employed_count, COUNT(*) AS cnt5, t1288.cd_dep_college_count, COUNT(*) AS cnt6 FROM (SELECT t1280.c_customer_sk, t1280.c_current_hdemo_sk, t1280.c_current_addr_sk, t1280.c_first_shipto_date_sk, t1280.c_first_sales_date_sk, t1280.c_birth_day, t1280.c_birth_month, t1280.c_birth_year, t1280.c_last_review_date_sk, t1280.c_current_cdemo_sk, t1280.c_customer_id, t1280.c_last_name, t1280.c_preferred_cust_flag, t1280.c_birth_country, t1280.c_login, t1280.c_email_address, t1280.c_salutation, t1280.c_first_name, t1280.ca_gmt_offset, t1280.ca_address_sk, t1280.ca_street_number, t1280.ca_street_name, t1280.ca_street_type, t1280.ca_suite_number, t1280.ca_city, t1280.ca_county, t1280.ca_state, t1280.ca_zip, t1280.ca_country, t1280.ca_location_type, t1280.ca_address_id, t1280.cd_dep_college_count, t1280.cd_purchase_estimate, t1280.cd_dep_count, t1280.cd_dep_employed_count, t1280.cd_demo_sk, t1280.cd_gender, t1280.cd_marital_status, t1280.cd_education_status, t1280.cd_credit_rating, t1280.f0, t1286.f0 AS f041 FROM (SELECT customer51.c_customer_sk, customer51.c_current_hdemo_sk, customer51.c_current_addr_sk, customer51.c_first_shipto_date_sk, customer51.c_first_sales_date_sk, customer51.c_birth_day, customer51.c_birth_month, customer51.c_birth_year, customer51.c_last_review_date_sk, customer51.c_current_cdemo_sk, customer51.c_customer_id, customer51.c_last_name, customer51.c_preferred_cust_flag, customer51.c_birth_country, customer51.c_login, customer51.c_email_address, customer51.c_salutation, customer51.c_first_name, customer_address51.ca_gmt_offset, customer_address51.ca_address_sk, customer_address51.ca_street_number, customer_address51.ca_street_name, customer_address51.ca_street_type, customer_address51.ca_suite_number, customer_address51.ca_city, customer_address51.ca_county, customer_address51.ca_state, customer_address51.ca_zip, customer_address51.ca_country, customer_address51.ca_location_type, customer_address51.ca_address_id, customer_demographics51.cd_dep_college_count, customer_demographics51.cd_purchase_estimate, customer_demographics51.cd_dep_count, customer_demographics51.cd_dep_employed_count, customer_demographics51.cd_demo_sk, customer_demographics51.cd_gender, customer_demographics51.cd_marital_status, customer_demographics51.cd_education_status, customer_demographics51.cd_credit_rating, t1279.f0 FROM customer AS customer51 CROSS JOIN customer_address AS customer_address51 CROSS JOIN customer_demographics AS customer_demographics51 LEFT JOIN (SELECT t1276.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 42 * 0.01 AND ss_sales_price / ss_list_price <= 52 * 0.01) AS t1274, (SELECT * FROM date_dim WHERE d_year = 2002 AND d_moy >= 7 AND d_moy <= 7 + 3) AS t1275 WHERE t1274.ss_sold_date_sk = t1275.d_date_sk) AS t1276, (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Men') AND (i_manager_id >= 32 AND i_manager_id <= 41)) AS t1277 WHERE t1276.ss_item_sk = t1277.i_item_sk) AS t1279 ON customer51.c_customer_sk = t1279.ss_customer_sk) AS t1280 LEFT JOIN (SELECT t1283.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM web_sales WHERE ws_sales_price / ws_list_price >= 42 * 0.01 AND ws_sales_price / ws_list_price <= 52 * 0.01) AS t1281, (SELECT * FROM date_dim WHERE d_year = 2002 AND d_moy >= 7 AND d_moy <= 7 + 3) AS t1282 WHERE t1281.ws_sold_date_sk = t1282.d_date_sk) AS t1283, (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Men') AND (i_manager_id >= 32 AND i_manager_id <= 41)) AS t1284 WHERE t1283.ws_item_sk = t1284.i_item_sk) AS t1286 ON t1280.c_customer_sk = t1286.ws_bill_customer_sk WHERE t1280.c_current_addr_sk = t1280.ca_address_sk AND t1280.ca_county IN ('Caddo Parish', 'El Paso County', 'Franklin Parish', 'Jones County', 'York County') AND (t1280.c_birth_month IN (1, 8) AND t1280.cd_demo_sk = t1280.c_current_cdemo_sk) AND (t1280.cd_marital_status IN ('S', 'U', 'W') AND t1280.cd_education_status IN ('4 yr Degree', 'Primary') AND (t1280.cd_gender = 'F' AND t1280.f0 IS NOT NULL))) AS t1288 LEFT JOIN (SELECT t1291.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_sales_price / cs_list_price >= 42 * 0.01 AND cs_sales_price / cs_list_price <= 52 * 0.01) AS t1289, (SELECT * FROM date_dim WHERE d_year = 2002 AND d_moy >= 7 AND d_moy <= 7 + 3) AS t1290 WHERE t1289.cs_sold_date_sk = t1290.d_date_sk) AS t1291, (SELECT * FROM item WHERE i_category IN ('Books', 'Children', 'Men') AND (i_manager_id >= 32 AND i_manager_id <= 41)) AS t1292 WHERE t1291.cs_item_sk = t1292.i_item_sk) AS t1294 ON t1288.c_customer_sk = t1294.cs_ship_customer_sk WHERE t1288.f041 IS NOT NULL OR t1294.f0 IS NOT NULL GROUP BY t1288.cd_gender, t1288.cd_marital_status, t1288.cd_education_status, t1288.cd_purchase_estimate, t1288.cd_credit_rating, t1288.cd_dep_count, t1288.cd_dep_employed_count, t1288.cd_dep_college_count ORDER BY t1288.cd_gender, t1288.cd_marital_status, t1288.cd_education_status, t1288.cd_purchase_estimate, t1288.cd_credit_rating, t1288.cd_dep_count, t1288.cd_dep_employed_count, t1288.cd_dep_college_count LIMIT 100","['PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']",20.83288074,3.741639296,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
32,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Cannon County','Gasconade County','Kewaunee County','Mobile County','Poquoson city') and c.c_birth_month in (3, 4) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('D', 'M', 'S') and cd_education_status in ('Unknown', '2 yr Degree', '4 yr Degree') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 3 and 3+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Shoes')  and ss_sales_price / ss_list_price BETWEEN 44 * 0.01 AND 54 * 0.01  and i_manager_id BETWEEN 91 and 100  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 3 ANd 3+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Shoes')  and i_manager_id BETWEEN 91 and 100  and ws_sales_price / ws_list_price BETWEEN 44 * 0.01 AND 54 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 3 and 3+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Shoes')  and i_manager_id BETWEEN 91 and 100  and cs_sales_price / cs_list_price BETWEEN 44 * 0.01 AND 54 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;","SELECT t827.cd_gender, t827.cd_marital_status, t827.cd_education_status, COUNT(*) AS cnt1, t827.cd_purchase_estimate, COUNT(*) AS cnt2, t827.cd_credit_rating, COUNT(*) AS cnt3, t827.cd_dep_count, COUNT(*) AS cnt4, t827.cd_dep_employed_count, COUNT(*) AS cnt5, t827.cd_dep_college_count, COUNT(*) AS cnt6 FROM (SELECT t820.c_customer_sk, t820.c_current_hdemo_sk, t820.c_current_addr_sk, t820.c_first_shipto_date_sk, t820.c_first_sales_date_sk, t820.c_birth_day, t820.c_birth_month, t820.c_birth_year, t820.c_last_review_date_sk, t820.c_current_cdemo_sk, t820.c_customer_id, t820.c_last_name, t820.c_preferred_cust_flag, t820.c_birth_country, t820.c_login, t820.c_email_address, t820.c_salutation, t820.c_first_name, t820.ca_gmt_offset, t820.ca_address_sk, t820.ca_street_number, t820.ca_street_name, t820.ca_street_type, t820.ca_suite_number, t820.ca_city, t820.ca_county, t820.ca_state, t820.ca_zip, t820.ca_country, t820.ca_location_type, t820.ca_address_id, t820.cd_dep_college_count, t820.cd_purchase_estimate, t820.cd_dep_count, t820.cd_dep_employed_count, t820.cd_demo_sk, t820.cd_gender, t820.cd_marital_status, t820.cd_education_status, t820.cd_credit_rating, t825.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM customer WHERE c_birth_month IN (3, 4)) AS t816, (SELECT * FROM customer_address WHERE ca_county IN ('Cannon County', 'Gasconade County', 'Kewaunee County', 'Mobile County', 'Poquoson city')) AS t817 WHERE t816.c_current_addr_sk = t817.ca_address_sk) AS t818, (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('D', 'M', 'S') AND cd_education_status IN ('2 yr Degree', '4 yr Degree', 'Unknown') AND cd_gender = 'F') AS t819 WHERE t819.cd_demo_sk = t818.c_current_cdemo_sk) AS t820, (SELECT * FROM (SELECT * FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 44 * 0.01 AND ss_sales_price / ss_list_price <= 54 * 0.01) AS t821, (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy >= 3 AND d_moy <= 3 + 3) AS t822 WHERE t821.ss_sold_date_sk = t822.d_date_sk) AS t823, (SELECT * FROM item WHERE i_category IN ('Children', 'Jewelry', 'Shoes') AND (i_manager_id >= 91 AND i_manager_id <= 100)) AS t824 WHERE t823.ss_item_sk = t824.i_item_sk) AS t825 WHERE t820.c_customer_sk = t825.ss_customer_sk) AS t827 LEFT JOIN (SELECT t830.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM web_sales WHERE ws_sales_price / ws_list_price >= 44 * 0.01 AND ws_sales_price / ws_list_price <= 54 * 0.01) AS t828, (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy >= 3 AND d_moy <= 3 + 3) AS t829 WHERE t828.ws_sold_date_sk = t829.d_date_sk) AS t830, (SELECT * FROM item WHERE i_category IN ('Children', 'Jewelry', 'Shoes') AND (i_manager_id >= 91 AND i_manager_id <= 100)) AS t831 WHERE t830.ws_item_sk = t831.i_item_sk) AS t833 ON t827.c_customer_sk = t833.ws_bill_customer_sk LEFT JOIN (SELECT t836.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_sales_price / cs_list_price >= 44 * 0.01 AND cs_sales_price / cs_list_price <= 54 * 0.01) AS t834, (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy >= 3 AND d_moy <= 3 + 3) AS t835 WHERE t834.cs_sold_date_sk = t835.d_date_sk) AS t836, (SELECT * FROM item WHERE i_category IN ('Children', 'Jewelry', 'Shoes') AND (i_manager_id >= 91 AND i_manager_id <= 100)) AS t837 WHERE t836.cs_item_sk = t837.i_item_sk) AS t839 ON t827.c_customer_sk = t839.cs_ship_customer_sk WHERE t833.f0 IS NOT NULL OR t839.f0 IS NOT NULL GROUP BY t827.cd_gender, t827.cd_marital_status, t827.cd_education_status, t827.cd_purchase_estimate, t827.cd_credit_rating, t827.cd_dep_count, t827.cd_dep_employed_count, t827.cd_dep_college_count ORDER BY t827.cd_gender, t827.cd_marital_status, t827.cd_education_status, t827.cd_purchase_estimate, t827.cd_credit_rating, t827.cd_dep_count, t827.cd_dep_employed_count, t827.cd_dep_college_count LIMIT 100","['JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_PROJECT_TRANSPOSE_RULE(_PROJECT-_PROJ', 'PROJECT_MERGE']",6.258318742,0.300460815,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
33,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Columbia County','Forsyth County','Kearney County','Martin County','Powell County') and c.c_birth_month in (8, 12) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'M', 'M') and cd_education_status in ('Unknown', 'Unknown', 'Unknown') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 and 3+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Jewelry')  and ss_sales_price / ss_list_price BETWEEN 22 * 0.01 AND 32 * 0.01  and i_manager_id BETWEEN 24 and 33  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 ANd 3+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Jewelry')  and i_manager_id BETWEEN 24 and 33  and ws_sales_price / ws_list_price BETWEEN 22 * 0.01 AND 32 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 and 3+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Jewelry')  and i_manager_id BETWEEN 24 and 33  and cs_sales_price / cs_list_price BETWEEN 22 * 0.01 AND 32 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;","SELECT t580.cd_gender, t580.cd_marital_status, t580.cd_education_status, COUNT(*) AS cnt1, t580.cd_purchase_estimate, COUNT(*) AS cnt2, t580.cd_credit_rating, COUNT(*) AS cnt3, t580.cd_dep_count, COUNT(*) AS cnt4, t580.cd_dep_employed_count, COUNT(*) AS cnt5, t580.cd_dep_college_count, COUNT(*) AS cnt6 FROM (SELECT t574.c_customer_sk, t574.c_current_hdemo_sk, t574.c_current_addr_sk, t574.c_first_shipto_date_sk, t574.c_first_sales_date_sk, t574.c_birth_day, t574.c_birth_month, t574.c_birth_year, t574.c_last_review_date_sk, t574.c_current_cdemo_sk, t574.c_customer_id, t574.c_last_name, t574.c_preferred_cust_flag, t574.c_birth_country, t574.c_login, t574.c_email_address, t574.c_salutation, t574.c_first_name, t574.ca_gmt_offset, t574.ca_address_sk, t574.ca_street_number, t574.ca_street_name, t574.ca_street_type, t574.ca_suite_number, t574.ca_city, t574.ca_county, t574.ca_state, t574.ca_zip, t574.ca_country, t574.ca_location_type, t574.ca_address_id, t574.cd_dep_college_count, t574.cd_purchase_estimate, t574.cd_dep_count, t574.cd_dep_employed_count, t574.cd_demo_sk, t574.cd_gender, t574.cd_marital_status, t574.cd_education_status, t574.cd_credit_rating, t574.f0, t578.f0 AS f041 FROM (SELECT t567.c_customer_sk, t567.c_current_hdemo_sk, t567.c_current_addr_sk, t567.c_first_shipto_date_sk, t567.c_first_sales_date_sk, t567.c_birth_day, t567.c_birth_month, t567.c_birth_year, t567.c_last_review_date_sk, t567.c_current_cdemo_sk, t567.c_customer_id, t567.c_last_name, t567.c_preferred_cust_flag, t567.c_birth_country, t567.c_login, t567.c_email_address, t567.c_salutation, t567.c_first_name, t568.ca_gmt_offset, t568.ca_address_sk, t568.ca_street_number, t568.ca_street_name, t568.ca_street_type, t568.ca_suite_number, t568.ca_city, t568.ca_county, t568.ca_state, t568.ca_zip, t568.ca_country, t568.ca_location_type, t568.ca_address_id, t569.cd_dep_college_count, t569.cd_purchase_estimate, t569.cd_dep_count, t569.cd_dep_employed_count, t569.cd_demo_sk, t569.cd_gender, t569.cd_marital_status, t569.cd_education_status, t569.cd_credit_rating, CAST(t573.ss_customer_sk AS INTEGER) AS ss_customer_sk, CAST(t573.f0 AS BOOLEAN) AS f0 FROM (SELECT * FROM customer WHERE c_birth_month IN (8, 12)) AS t567 INNER JOIN (SELECT * FROM customer_address WHERE ca_county IN ('Columbia County', 'Forsyth County', 'Kearney County', 'Martin County', 'Powell County')) AS t568 ON t567.c_current_addr_sk = t568.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' AND cd_gender = 'F') AS t569 ON t567.c_current_cdemo_sk = t569.cd_demo_sk INNER JOIN (SELECT t570.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 22 * 0.01 AND ss_sales_price / ss_list_price <= 32 * 0.01) AS t570 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy >= 3 AND d_moy <= 3 + 3) AS t571 ON t570.ss_sold_date_sk = t571.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Books', 'Home', 'Jewelry') AND (i_manager_id >= 24 AND i_manager_id <= 33)) AS t572 ON t570.ss_item_sk = t572.i_item_sk) AS t573 ON t567.c_customer_sk = t573.ss_customer_sk) AS t574 LEFT JOIN (SELECT t575.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM web_sales WHERE ws_sales_price / ws_list_price >= 22 * 0.01 AND ws_sales_price / ws_list_price <= 32 * 0.01) AS t575 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy >= 3 AND d_moy <= 3 + 3) AS t576 ON t575.ws_sold_date_sk = t576.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Books', 'Home', 'Jewelry') AND (i_manager_id >= 24 AND i_manager_id <= 33)) AS t577 ON t575.ws_item_sk = t577.i_item_sk) AS t578 ON t574.c_customer_sk = t578.ws_bill_customer_sk) AS t580 LEFT JOIN (SELECT t581.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM catalog_sales WHERE cs_sales_price / cs_list_price >= 22 * 0.01 AND cs_sales_price / cs_list_price <= 32 * 0.01) AS t581 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy >= 3 AND d_moy <= 3 + 3) AS t582 ON t581.cs_sold_date_sk = t582.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category IN ('Books', 'Home', 'Jewelry') AND (i_manager_id >= 24 AND i_manager_id <= 33)) AS t583 ON t581.cs_item_sk = t583.i_item_sk) AS t584 ON t580.c_customer_sk = t584.cs_ship_customer_sk WHERE t580.f041 IS NOT NULL OR t584.f0 IS NOT NULL GROUP BY t580.cd_gender, t580.cd_marital_status, t580.cd_education_status, t580.cd_purchase_estimate, t580.cd_credit_rating, t580.cd_dep_count, t580.cd_dep_employed_count, t580.cd_dep_college_count ORDER BY t580.cd_gender, t580.cd_marital_status, t580.cd_education_status, t580.cd_purchase_estimate, t580.cd_credit_rating, t580.cd_dep_count, t580.cd_dep_employed_count, t580.cd_dep_college_count LIMIT 100","['JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN']",15.13521353,6.581179619,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
34,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Grant County','Iron County','Macon County','Noxubee County','Piatt County') and c.c_birth_month in (4, 6) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'W', 'W') and cd_education_status in ('2 yr Degree', '4 yr Degree', '4 yr Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 1 and 1+3 and  ss_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Women')  and ss_sales_price / ss_list_price BETWEEN 9 * 0.01 AND 19 * 0.01  and i_manager_id BETWEEN 53 and 62  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 1 ANd 1+3 and  ws_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Women')  and i_manager_id BETWEEN 53 and 62  and ws_sales_price / ws_list_price BETWEEN 9 * 0.01 AND 19 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 1 and 1+3 and  cs_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Women')  and i_manager_id BETWEEN 53 and 62  and cs_sales_price / cs_list_price BETWEEN 9 * 0.01 AND 19 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;","SELECT t13.cd_gender, t13.cd_marital_status, t13.cd_education_status, COUNT(*) AS cnt1, t13.cd_purchase_estimate, COUNT(*) AS cnt2, t13.cd_credit_rating, COUNT(*) AS cnt3, t13.cd_dep_count, COUNT(*) AS cnt4, t13.cd_dep_employed_count, COUNT(*) AS cnt5, t13.cd_dep_college_count, COUNT(*) AS cnt6 FROM (SELECT customer.c_customer_sk, customer.c_current_hdemo_sk, customer.c_current_addr_sk, customer.c_first_shipto_date_sk, customer.c_first_sales_date_sk, customer.c_birth_day, customer.c_birth_month, customer.c_birth_year, customer.c_last_review_date_sk, customer.c_current_cdemo_sk, customer.c_customer_id, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_country, customer.c_login, customer.c_email_address, customer.c_salutation, customer.c_first_name, customer_address.ca_gmt_offset, customer_address.ca_address_sk, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_street_type, customer_address.ca_suite_number, customer_address.ca_city, customer_address.ca_county, customer_address.ca_state, customer_address.ca_zip, customer_address.ca_country, customer_address.ca_location_type, customer_address.ca_address_id, customer_demographics.cd_dep_college_count, customer_demographics.cd_purchase_estimate, customer_demographics.cd_dep_count, customer_demographics.cd_dep_employed_count, customer_demographics.cd_demo_sk, customer_demographics.cd_gender, customer_demographics.cd_marital_status, customer_demographics.cd_education_status, customer_demographics.cd_credit_rating, t4.f0, t10.f0 AS f041 FROM customer CROSS JOIN customer_address CROSS JOIN customer_demographics LEFT JOIN (SELECT t1.ss_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 9 * 0.01 AND ss_sales_price / ss_list_price <= 19 * 0.01) AS t, (SELECT * FROM date_dim WHERE d_year = 2002 AND d_moy >= 1 AND d_moy <= 1 + 3) AS t0 WHERE t.ss_sold_date_sk = t0.d_date_sk) AS t1, (SELECT * FROM item WHERE i_category IN ('Home', 'Jewelry', 'Women') AND (i_manager_id >= 53 AND i_manager_id <= 62)) AS t2 WHERE t1.ss_item_sk = t2.i_item_sk) AS t4 ON customer.c_customer_sk = t4.ss_customer_sk LEFT JOIN (SELECT t7.ws_bill_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM web_sales WHERE ws_sales_price / ws_list_price >= 9 * 0.01 AND ws_sales_price / ws_list_price <= 19 * 0.01) AS t5, (SELECT * FROM date_dim WHERE d_year = 2002 AND d_moy >= 1 AND d_moy <= 1 + 3) AS t6 WHERE t5.ws_sold_date_sk = t6.d_date_sk) AS t7, (SELECT * FROM item WHERE i_category IN ('Home', 'Jewelry', 'Women') AND (i_manager_id >= 53 AND i_manager_id <= 62)) AS t8 WHERE t7.ws_item_sk = t8.i_item_sk) AS t10 ON customer.c_customer_sk = t10.ws_bill_customer_sk WHERE customer.c_current_addr_sk = customer_address.ca_address_sk AND customer_address.ca_county IN ('Grant County', 'Iron County', 'Macon County', 'Noxubee County', 'Piatt County') AND (customer.c_birth_month IN (4, 6) AND customer_demographics.cd_demo_sk = customer.c_current_cdemo_sk) AND (customer_demographics.cd_marital_status IN ('M', 'W') AND customer_demographics.cd_education_status IN ('2 yr Degree', '4 yr Degree') AND (customer_demographics.cd_gender = 'M' AND t4.f0 IS NOT NULL))) AS t13 LEFT JOIN (SELECT t16.cs_ship_customer_sk, TRUE AS f0 FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_sales_price / cs_list_price >= 9 * 0.01 AND cs_sales_price / cs_list_price <= 19 * 0.01) AS t14, (SELECT * FROM date_dim WHERE d_year = 2002 AND d_moy >= 1 AND d_moy <= 1 + 3) AS t15 WHERE t14.cs_sold_date_sk = t15.d_date_sk) AS t16, (SELECT * FROM item WHERE i_category IN ('Home', 'Jewelry', 'Women') AND (i_manager_id >= 53 AND i_manager_id <= 62)) AS t17 WHERE t16.cs_item_sk = t17.i_item_sk) AS t19 ON t13.c_customer_sk = t19.cs_ship_customer_sk WHERE t13.f041 IS NOT NULL OR t19.f0 IS NOT NULL GROUP BY t13.cd_gender, t13.cd_marital_status, t13.cd_education_status, t13.cd_purchase_estimate, t13.cd_credit_rating, t13.cd_dep_count, t13.cd_dep_employed_count, t13.cd_dep_college_count ORDER BY t13.cd_gender, t13.cd_marital_status, t13.cd_education_status, t13.cd_purchase_estimate, t13.cd_credit_rating, t13.cd_dep_count, t13.cd_dep_employed_count, t13.cd_dep_college_count LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_EXTRACT_FILTER', 'SORT_PROJECT_TRANSPOSE']",20.91903408,8.397926887,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]"
35,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1177 and 1177 + 11 and c_birth_month in (3, 5, 8, 11) and ss_list_price between 150 and 209 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1177 and 1177 + 11 and c_birth_month in (3, 5, 8, 11) and cs_list_price between 150 and 209 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1177 and 1177 + 11 and c_birth_month in (3, 5, 8, 11) and ws_list_price between 150 and 209 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;","SELECT COUNT(*) FROM (SELECT * FROM (SELECT t1919.c_last_name, t1919.c_first_name, t1918.d_date FROM (SELECT * FROM store_sales WHERE ss_list_price >= 150 AND ss_list_price <= 209 AND (ss_wholesale_cost >= 80 AND ss_wholesale_cost <= 100)) AS t1917 INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1177 AND d_month_seq <= 1177 + 11) AS t1918 ON t1917.ss_sold_date_sk = t1918.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month IN (3, 5, 8, 11)) AS t1919 ON t1917.ss_customer_sk = t1919.c_customer_sk INTERSECT SELECT t1923.c_last_name, t1923.c_first_name, t1922.d_date FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 150 AND cs_list_price <= 209 AND (cs_wholesale_cost >= 80 AND cs_wholesale_cost <= 100)) AS t1921 INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1177 AND d_month_seq <= 1177 + 11) AS t1922 ON t1921.cs_sold_date_sk = t1922.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month IN (3, 5, 8, 11)) AS t1923 ON t1921.cs_bill_customer_sk = t1923.c_customer_sk) AS t INTERSECT SELECT t1928.c_last_name, t1928.c_first_name, t1927.d_date FROM (SELECT * FROM web_sales WHERE ws_list_price >= 150 AND ws_list_price <= 209 AND (ws_wholesale_cost >= 80 AND ws_wholesale_cost <= 100)) AS t1926 INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1177 AND d_month_seq <= 1177 + 11) AS t1927 ON t1926.ws_sold_date_sk = t1927.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month IN (3, 5, 8, 11)) AS t1928 ON t1926.ws_bill_customer_sk = t1928.c_customer_sk) AS t1930 LIMIT 100",['FILTER_INTO_JOIN'],11.01893409,9.132482449,"['LogicalSort', ['LogicalAggregate', ['LogicalIntersect', ['LogicalIntersect', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
36,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1190 and 1190 + 11 and c_birth_month in (2, 3, 9, 12) and ss_list_price between 181 and 240 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1190 and 1190 + 11 and c_birth_month in (2, 3, 9, 12) and cs_list_price between 181 and 240 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1190 and 1190 + 11 and c_birth_month in (2, 3, 9, 12) and ws_list_price between 181 and 240 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;","SELECT COUNT(*) FROM (SELECT * FROM (SELECT t2.c_last_name, t2.c_first_name, t1.d_date FROM (SELECT * FROM (SELECT * FROM store_sales WHERE ss_list_price >= 181 AND ss_list_price <= 240 AND (ss_wholesale_cost >= 80 AND ss_wholesale_cost <= 100)) AS t, (SELECT * FROM date_dim WHERE d_month_seq >= 1190 AND d_month_seq <= 1190 + 11) AS t0 WHERE t.ss_sold_date_sk = t0.d_date_sk) AS t1, (SELECT * FROM customer WHERE c_birth_month IN (2, 3, 9, 12)) AS t2 WHERE t1.ss_customer_sk = t2.c_customer_sk INTERSECT SELECT t8.c_last_name, t8.c_first_name, t7.d_date FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 181 AND cs_list_price <= 240 AND (cs_wholesale_cost >= 80 AND cs_wholesale_cost <= 100)) AS t5, (SELECT * FROM date_dim WHERE d_month_seq >= 1190 AND d_month_seq <= 1190 + 11) AS t6 WHERE t5.cs_sold_date_sk = t6.d_date_sk) AS t7, (SELECT * FROM customer WHERE c_birth_month IN (2, 3, 9, 12)) AS t8 WHERE t7.cs_bill_customer_sk = t8.c_customer_sk) AS t INTERSECT SELECT t15.c_last_name, t15.c_first_name, t14.d_date FROM (SELECT * FROM (SELECT * FROM web_sales WHERE ws_list_price >= 181 AND ws_list_price <= 240 AND (ws_wholesale_cost >= 80 AND ws_wholesale_cost <= 100)) AS t12, (SELECT * FROM date_dim WHERE d_month_seq >= 1190 AND d_month_seq <= 1190 + 11) AS t13 WHERE t12.ws_sold_date_sk = t13.d_date_sk) AS t14, (SELECT * FROM customer WHERE c_birth_month IN (2, 3, 9, 12)) AS t15 WHERE t14.ws_bill_customer_sk = t15.c_customer_sk) AS t18 LIMIT 100;","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SET_OP_TRANSPOSE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_PROJECT_LEFT_TRANSPOSE', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'SEMI_JOIN_REMOVE', 'JOIN_REDUCE_EXPRESSIONS', 'UNION_MERGE', 'UNION_REMOVE', 'UNION_TO_DISTINCT', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']",21.95412914,17.45725266,"['LogicalSort', ['LogicalAggregate', ['LogicalIntersect', ['LogicalIntersect', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
37,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1176 and 1176+11 and ss_list_price between 23 and 52 and c_birth_year BETWEEN 1927 AND 1933 and ss_wholesale_cost BETWEEN 66 AND 76 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1176 and 1176+11 and cs_list_price between 23 and 52 and c_birth_year BETWEEN 1927 AND 1933 and cs_wholesale_cost BETWEEN 66 AND 76 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1176 and 1176+11 and ws_list_price between 23 and 52 and c_birth_year BETWEEN 1927 AND 1933 and ws_wholesale_cost BETWEEN 66 AND 76 ) ) cool_cust  ;","SELECT COUNT(*) FROM (SELECT * FROM (SELECT t1447.c_last_name, t1447.c_first_name, t1446.d_date FROM (SELECT * FROM store_sales WHERE ss_list_price >= 23 AND ss_list_price <= 52 AND (ss_wholesale_cost >= 66 AND ss_wholesale_cost <= 76)) AS t1445 INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1176 AND d_month_seq <= 1176 + 11) AS t1446 ON t1445.ss_sold_date_sk = t1446.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1927 AND c_birth_year <= 1933) AS t1447 ON t1445.ss_customer_sk = t1447.c_customer_sk EXCEPT SELECT t1451.c_last_name, t1451.c_first_name, t1450.d_date FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 23 AND cs_list_price <= 52 AND (cs_wholesale_cost >= 66 AND cs_wholesale_cost <= 76)) AS t1449 INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1176 AND d_month_seq <= 1176 + 11) AS t1450 ON t1449.cs_sold_date_sk = t1450.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1927 AND c_birth_year <= 1933) AS t1451 ON t1449.cs_bill_customer_sk = t1451.c_customer_sk) AS t EXCEPT SELECT t1456.c_last_name, t1456.c_first_name, t1455.d_date FROM (SELECT * FROM web_sales WHERE ws_list_price >= 23 AND ws_list_price <= 52 AND (ws_wholesale_cost >= 66 AND ws_wholesale_cost <= 76)) AS t1454 INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1176 AND d_month_seq <= 1176 + 11) AS t1455 ON t1454.ws_sold_date_sk = t1455.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1927 AND c_birth_year <= 1933) AS t1456 ON t1454.ws_bill_customer_sk = t1456.c_customer_sk) AS t1458",['FILTER_INTO_JOIN'],18.00193874,9.469143709,"['LogicalAggregate', ['LogicalMinus', ['LogicalMinus', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]"
38,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1223 and 1223+11 and ss_list_price between 149 and 178 and c_birth_year BETWEEN 1980 AND 1986 and ss_wholesale_cost BETWEEN 74 AND 84 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1223 and 1223+11 and cs_list_price between 149 and 178 and c_birth_year BETWEEN 1980 AND 1986 and cs_wholesale_cost BETWEEN 74 AND 84 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1223 and 1223+11 and ws_list_price between 149 and 178 and c_birth_year BETWEEN 1980 AND 1986 and ws_wholesale_cost BETWEEN 74 AND 84 ) ) cool_cust  ;","SELECT COUNT(*) FROM (SELECT * FROM (SELECT t1.c_last_name, t1.c_first_name, t0.d_date FROM (SELECT * FROM store_sales WHERE ss_list_price >= 149 AND ss_list_price <= 178 AND (ss_wholesale_cost >= 74 AND ss_wholesale_cost <= 84)) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1223 AND d_month_seq <= 1223 + 11) AS t0 ON t.ss_sold_date_sk = t0.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1980 AND c_birth_year <= 1986) AS t1 ON t.ss_customer_sk = t1.c_customer_sk EXCEPT SELECT t5.c_last_name, t5.c_first_name, t4.d_date FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 149 AND cs_list_price <= 178 AND (cs_wholesale_cost >= 74 AND cs_wholesale_cost <= 84)) AS t3 INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1223 AND d_month_seq <= 1223 + 11) AS t4 ON t3.cs_sold_date_sk = t4.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1980 AND c_birth_year <= 1986) AS t5 ON t3.cs_bill_customer_sk = t5.c_customer_sk) AS t EXCEPT SELECT t10.c_last_name, t10.c_first_name, t9.d_date FROM (SELECT * FROM web_sales WHERE ws_list_price >= 149 AND ws_list_price <= 178 AND (ws_wholesale_cost >= 74 AND ws_wholesale_cost <= 84)) AS t8 INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1223 AND d_month_seq <= 1223 + 11) AS t9 ON t8.ws_sold_date_sk = t9.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1980 AND c_birth_year <= 1986) AS t10 ON t8.ws_bill_customer_sk = t10.c_customer_sk) AS t12;","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS']",20.61043151,17.24174102,"['LogicalAggregate', ['LogicalMinus', ['LogicalMinus', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]"
39,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,avg(ss_net_profit) as store_sales_profit ,avg(sr_net_loss) as store_returns_loss ,avg(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 1 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 1 and 1 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 1 and 1 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;","SELECT item99.i_item_id, item99.i_item_desc, store99.s_store_id, store99.s_store_name, AVG(store_sales99.ss_net_profit) AS store_sales_profit, AVG(store_returns99.sr_net_loss) AS store_returns_loss, AVG(catalog_sales99.cs_net_profit) AS catalog_sales_profit FROM store_sales AS store_sales99 INNER JOIN store_returns AS store_returns99 ON store_sales99.ss_customer_sk = store_returns99.sr_customer_sk AND store_sales99.ss_item_sk = store_returns99.sr_item_sk AND store_sales99.ss_ticket_number = store_returns99.sr_ticket_number INNER JOIN catalog_sales AS catalog_sales99 ON store_returns99.sr_customer_sk = catalog_sales99.cs_bill_customer_sk AND store_returns99.sr_item_sk = catalog_sales99.cs_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_moy = 1 AND d_year = 2000) AS t913 ON store_sales99.ss_sold_date_sk = t913.d_date_sk INNER JOIN (SELECT * FROM date_dim WHERE d_moy >= 1 AND d_moy <= 1 + 2 AND d_year = 2000) AS t914 ON store_returns99.sr_returned_date_sk = t914.d_date_sk INNER JOIN (SELECT * FROM date_dim WHERE d_moy >= 1 AND d_moy <= 1 + 2 AND d_year = 2000) AS t915 ON catalog_sales99.cs_sold_date_sk = t915.d_date_sk INNER JOIN store AS store99 ON store_sales99.ss_store_sk = store99.s_store_sk INNER JOIN item AS item99 ON store_sales99.ss_item_sk = item99.i_item_sk GROUP BY item99.i_item_id, item99.i_item_desc, store99.s_store_id, store99.s_store_name ORDER BY item99.i_item_id, item99.i_item_desc, store99.s_store_id, store99.s_store_name LIMIT 100",['FILTER_INTO_JOIN'],300,27.3230714,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
40,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,max(ss_net_profit) as store_sales_profit ,max(sr_net_loss) as store_returns_loss ,max(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;","SELECT item50.i_item_id, item50.i_item_desc, t704.s_store_id, t704.s_store_name, MAX(t704.ss_net_profit) AS store_sales_profit, MAX(t704.sr_net_loss) AS store_returns_loss, MAX(t704.cs_net_profit) AS catalog_sales_profit FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM store_sales AS store_sales50, store_returns AS store_returns50 WHERE store_sales50.ss_customer_sk = store_returns50.sr_customer_sk AND store_sales50.ss_item_sk = store_returns50.sr_item_sk AND store_sales50.ss_ticket_number = store_returns50.sr_ticket_number) AS t696, catalog_sales AS catalog_sales50 WHERE t696.sr_customer_sk = catalog_sales50.cs_bill_customer_sk AND t696.sr_item_sk = catalog_sales50.cs_item_sk) AS t697, (SELECT * FROM date_dim WHERE d_moy = 5 AND d_year = 2000) AS t698 WHERE t698.d_date_sk = t697.ss_sold_date_sk) AS t699, (SELECT * FROM date_dim WHERE d_moy >= 5 AND d_moy <= 5 + 2 AND d_year = 2000) AS t700 WHERE t699.sr_returned_date_sk = t700.d_date_sk) AS t701, (SELECT * FROM date_dim WHERE d_moy >= 5 AND d_moy <= 5 + 2 AND d_year = 2000) AS t702 WHERE t701.cs_sold_date_sk = t702.d_date_sk) AS t703, store AS store50 WHERE store50.s_store_sk = t703.ss_store_sk) AS t704, item AS item50 WHERE item50.i_item_sk = t704.ss_item_sk GROUP BY item50.i_item_id, item50.i_item_desc, t704.s_store_id, t704.s_store_name ORDER BY item50.i_item_id, item50.i_item_desc, t704.s_store_id, t704.s_store_name LIMIT 100","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER']",22.98680592,22.16748627,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
41,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 3 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 3 and 3 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 3 and 3 + 2 and d3.d_year  = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;","SELECT item.i_item_id, item.i_item_desc, store.s_store_id, store.s_store_name, MIN(store_sales.ss_net_profit) AS store_sales_profit, MIN(store_returns.sr_net_loss) AS store_returns_loss, MIN(catalog_sales.cs_net_profit) AS catalog_sales_profit FROM store_sales, store_returns, catalog_sales, date_dim, date_dim AS date_dim0, date_dim AS date_dim1, store, item WHERE date_dim.d_moy = 3 AND date_dim.d_year = 2002 AND (date_dim.d_date_sk = store_sales.ss_sold_date_sk AND item.i_item_sk = store_sales.ss_item_sk) AND (store.s_store_sk = store_sales.ss_store_sk AND store_sales.ss_customer_sk = store_returns.sr_customer_sk AND (store_sales.ss_item_sk = store_returns.sr_item_sk AND (store_sales.ss_ticket_number = store_returns.sr_ticket_number AND store_returns.sr_returned_date_sk = date_dim0.d_date_sk))) AND (date_dim0.d_moy >= 3 AND date_dim0.d_moy <= 3 + 2 AND (date_dim0.d_year = 2002 AND store_returns.sr_customer_sk = catalog_sales.cs_bill_customer_sk) AND (store_returns.sr_item_sk = catalog_sales.cs_item_sk AND catalog_sales.cs_sold_date_sk = date_dim1.d_date_sk AND (date_dim1.d_moy >= 3 AND (date_dim1.d_moy <= 3 + 2 AND date_dim1.d_year = 2002)))) GROUP BY store.s_store_id, store.s_store_name, item.i_item_id, item.i_item_desc ORDER BY item.i_item_id, item.i_item_desc, store.s_store_id, store.s_store_name LIMIT 100;","['AGGREGATE_PROJECT_MERGE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE', 'JOIN_CONDITION_PUSH']",300,33.39822698,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
42,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;","SELECT t1038.i_item_id, t1038.i_item_desc, t1037.s_store_id, t1037.s_store_name, MIN(t1037.store_sales_profit) AS store_sales_profit, MIN(t1037.store_returns_loss) AS store_returns_loss, MIN(t1037.catalog_sales_profit) AS catalog_sales_profit FROM (SELECT t1034.ss_item_sk, t1035.s_store_id, t1035.s_store_name, MIN(t1034.store_sales_profit) AS store_sales_profit, MIN(t1034.store_returns_loss) AS store_returns_loss, MIN(t1034.catalog_sales_profit) AS catalog_sales_profit FROM (SELECT t1030.ss_item_sk, t1030.ss_store_sk, MIN(t1030.store_sales_profit) AS store_sales_profit, MIN(t1030.store_returns_loss) AS store_returns_loss, MIN(t1030.catalog_sales_profit) AS catalog_sales_profit FROM (SELECT t1026.ss_item_sk, t1026.ss_store_sk, t1026.cs_sold_date_sk, MIN(t1026.store_sales_profit) AS store_sales_profit, MIN(t1026.store_returns_loss) AS store_returns_loss, MIN(t1026.catalog_sales_profit) AS catalog_sales_profit FROM (SELECT t1022.ss_item_sk, t1022.ss_store_sk, t1022.sr_returned_date_sk, t1022.cs_sold_date_sk, MIN(t1022.store_sales_profit) AS store_sales_profit, MIN(t1022.store_returns_loss) AS store_returns_loss, MIN(t1022.catalog_sales_profit) AS catalog_sales_profit FROM (SELECT t1019.ss_sold_date_sk, t1019.ss_item_sk, t1019.ss_store_sk, t1019.sr_returned_date_sk, t1020.cs_sold_date_sk, MIN(t1019.store_sales_profit) AS store_sales_profit, MIN(t1019.store_returns_loss) AS store_returns_loss, MIN(t1020.catalog_sales_profit) AS catalog_sales_profit FROM (SELECT t1016.ss_sold_date_sk, t1016.ss_item_sk, t1016.ss_store_sk, t1017.sr_returned_date_sk, t1017.sr_item_sk, t1017.sr_customer_sk, MIN(t1016.store_sales_profit) AS store_sales_profit, MIN(t1017.store_returns_loss) AS store_returns_loss FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number, MIN(ss_net_profit) AS store_sales_profit FROM store_sales GROUP BY ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number) AS t1016, (SELECT sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number, MIN(sr_net_loss) AS store_returns_loss FROM store_returns GROUP BY sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number) AS t1017 WHERE t1016.ss_customer_sk = t1017.sr_customer_sk AND t1016.ss_item_sk = t1017.sr_item_sk AND t1016.ss_ticket_number = t1017.sr_ticket_number GROUP BY t1016.ss_sold_date_sk, t1016.ss_item_sk, t1016.ss_store_sk, t1017.sr_returned_date_sk, t1017.sr_item_sk, t1017.sr_customer_sk) AS t1019, (SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk, MIN(cs_net_profit) AS catalog_sales_profit FROM catalog_sales GROUP BY cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk) AS t1020 WHERE t1019.sr_customer_sk = t1020.cs_bill_customer_sk AND t1019.sr_item_sk = t1020.cs_item_sk GROUP BY t1019.ss_sold_date_sk, t1019.ss_item_sk, t1019.ss_store_sk, t1019.sr_returned_date_sk, t1020.cs_sold_date_sk) AS t1022, (SELECT d_date_sk FROM date_dim WHERE d_moy = 6 AND d_year = 2000 GROUP BY d_date_sk) AS t1024 WHERE t1024.d_date_sk = t1022.ss_sold_date_sk GROUP BY t1022.ss_item_sk, t1022.ss_store_sk, t1022.sr_returned_date_sk, t1022.cs_sold_date_sk) AS t1026, (SELECT d_date_sk FROM date_dim WHERE d_moy >= 6 AND d_moy <= 6 + 2 AND d_year = 2000 GROUP BY d_date_sk) AS t1028 WHERE t1026.sr_returned_date_sk = t1028.d_date_sk GROUP BY t1026.ss_item_sk, t1026.ss_store_sk, t1026.cs_sold_date_sk) AS t1030, (SELECT d_date_sk FROM date_dim WHERE d_moy >= 6 AND d_moy <= 6 + 2 AND d_year = 2000 GROUP BY d_date_sk) AS t1032 WHERE t1030.cs_sold_date_sk = t1032.d_date_sk GROUP BY t1030.ss_item_sk, t1030.ss_store_sk) AS t1034, (SELECT s_store_sk, s_store_id, s_store_name FROM store GROUP BY s_store_sk, s_store_id, s_store_name) AS t1035 WHERE t1035.s_store_sk = t1034.ss_store_sk GROUP BY t1034.ss_item_sk, t1035.s_store_id, t1035.s_store_name) AS t1037, (SELECT i_item_sk, i_item_id, i_item_desc FROM item GROUP BY i_item_sk, i_item_id, i_item_desc) AS t1038 WHERE t1038.i_item_sk = t1037.ss_item_sk GROUP BY t1037.s_store_id, t1037.s_store_name, t1038.i_item_id, t1038.i_item_desc ORDER BY t1038.i_item_id, t1038.i_item_desc, t1037.s_store_id, t1037.s_store_name LIMIT 100","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE', 'JOIN_EXTRACT_FILTER']",300,80.4783593,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
43,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 2001 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;","SELECT t1786.i_item_id, t1786.i_item_desc, t1785.s_store_id, t1785.s_store_name, MIN(t1785.store_sales_profit) AS store_sales_profit, MIN(t1785.store_returns_loss) AS store_returns_loss, MIN(t1785.catalog_sales_profit) AS catalog_sales_profit FROM (SELECT t1783.ss_item_sk, t1784.s_store_id, t1784.s_store_name, MIN(t1783.store_sales_profit) AS store_sales_profit, MIN(t1783.store_returns_loss) AS store_returns_loss, MIN(t1783.catalog_sales_profit) AS catalog_sales_profit FROM (SELECT t1780.ss_item_sk, t1780.ss_store_sk, MIN(t1780.store_sales_profit) AS store_sales_profit, MIN(t1780.store_returns_loss) AS store_returns_loss, MIN(t1780.catalog_sales_profit) AS catalog_sales_profit FROM (SELECT t1777.ss_item_sk, t1777.ss_store_sk, t1777.cs_sold_date_sk, MIN(t1777.store_sales_profit) AS store_sales_profit, MIN(t1777.store_returns_loss) AS store_returns_loss, MIN(t1777.catalog_sales_profit) AS catalog_sales_profit FROM (SELECT t1774.ss_item_sk, t1774.ss_store_sk, t1774.sr_returned_date_sk, t1774.cs_sold_date_sk, MIN(t1774.store_sales_profit) AS store_sales_profit, MIN(t1774.store_returns_loss) AS store_returns_loss, MIN(t1774.catalog_sales_profit) AS catalog_sales_profit FROM (SELECT t1772.ss_sold_date_sk, t1772.ss_item_sk, t1772.ss_store_sk, t1772.sr_returned_date_sk, t1773.cs_sold_date_sk, MIN(t1772.store_sales_profit) AS store_sales_profit, MIN(t1772.store_returns_loss) AS store_returns_loss, MIN(t1773.catalog_sales_profit) AS catalog_sales_profit FROM (SELECT t1770.ss_sold_date_sk, t1770.ss_item_sk, t1770.ss_store_sk, t1771.sr_returned_date_sk, t1771.sr_item_sk, t1771.sr_customer_sk, MIN(t1770.store_sales_profit) AS store_sales_profit, MIN(t1771.store_returns_loss) AS store_returns_loss FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number, MIN(ss_net_profit) AS store_sales_profit FROM store_sales GROUP BY ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number) AS t1770 INNER JOIN (SELECT sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number, MIN(sr_net_loss) AS store_returns_loss FROM store_returns GROUP BY sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number) AS t1771 ON t1770.ss_customer_sk = t1771.sr_customer_sk AND t1770.ss_item_sk = t1771.sr_item_sk AND t1770.ss_ticket_number = t1771.sr_ticket_number GROUP BY t1770.ss_sold_date_sk, t1770.ss_item_sk, t1770.ss_store_sk, t1771.sr_returned_date_sk, t1771.sr_item_sk, t1771.sr_customer_sk) AS t1772 INNER JOIN (SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk, MIN(cs_net_profit) AS catalog_sales_profit FROM catalog_sales GROUP BY cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk) AS t1773 ON t1772.sr_customer_sk = t1773.cs_bill_customer_sk AND t1772.sr_item_sk = t1773.cs_item_sk GROUP BY t1772.ss_sold_date_sk, t1772.ss_item_sk, t1772.ss_store_sk, t1772.sr_returned_date_sk, t1773.cs_sold_date_sk) AS t1774 INNER JOIN (SELECT d_date_sk FROM date_dim WHERE d_moy = 6 AND d_year = 2001 GROUP BY d_date_sk) AS t1776 ON t1774.ss_sold_date_sk = t1776.d_date_sk GROUP BY t1774.ss_item_sk, t1774.ss_store_sk, t1774.sr_returned_date_sk, t1774.cs_sold_date_sk) AS t1777 INNER JOIN (SELECT d_date_sk FROM date_dim WHERE d_moy >= 6 AND d_moy <= 6 + 2 AND d_year = 2001 GROUP BY d_date_sk) AS t1779 ON t1777.sr_returned_date_sk = t1779.d_date_sk GROUP BY t1777.ss_item_sk, t1777.ss_store_sk, t1777.cs_sold_date_sk) AS t1780 INNER JOIN (SELECT d_date_sk FROM date_dim WHERE d_moy >= 6 AND d_moy <= 6 + 2 AND d_year = 2001 GROUP BY d_date_sk) AS t1782 ON t1780.cs_sold_date_sk = t1782.d_date_sk GROUP BY t1780.ss_item_sk, t1780.ss_store_sk) AS t1783 INNER JOIN (SELECT s_store_sk, s_store_id, s_store_name FROM store GROUP BY s_store_sk, s_store_id, s_store_name) AS t1784 ON t1783.ss_store_sk = t1784.s_store_sk GROUP BY t1783.ss_item_sk, t1784.s_store_id, t1784.s_store_name) AS t1785 INNER JOIN (SELECT i_item_sk, i_item_id, i_item_desc FROM item GROUP BY i_item_sk, i_item_id, i_item_desc) AS t1786 ON t1785.ss_item_sk = t1786.i_item_sk GROUP BY t1785.s_store_id, t1785.s_store_name, t1786.i_item_id, t1786.i_item_desc ORDER BY t1786.i_item_id, t1786.i_item_desc, t1785.s_store_id, t1785.s_store_name LIMIT 100","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE']",300,66.29639633,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
44,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;","SELECT item.i_item_id, item.i_item_desc, store.s_store_id, store.s_store_name, MIN(store_sales.ss_net_profit) AS store_sales_profit, MIN(store_returns.sr_net_loss) AS store_returns_loss, MIN(catalog_sales.cs_net_profit) AS catalog_sales_profit FROM store_sales INNER JOIN store_returns ON store_sales.ss_customer_sk = store_returns.sr_customer_sk AND store_sales.ss_item_sk = store_returns.sr_item_sk AND store_sales.ss_ticket_number = store_returns.sr_ticket_number INNER JOIN catalog_sales ON store_returns.sr_customer_sk = catalog_sales.cs_bill_customer_sk AND store_returns.sr_item_sk = catalog_sales.cs_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_moy = 7 AND d_year = 2000) AS t ON store_sales.ss_sold_date_sk = t.d_date_sk INNER JOIN (SELECT * FROM date_dim WHERE d_moy >= 7 AND d_moy <= 7 + 2 AND d_year = 2000) AS t0 ON store_returns.sr_returned_date_sk = t0.d_date_sk INNER JOIN (SELECT * FROM date_dim WHERE d_moy >= 7 AND d_moy <= 7 + 2 AND d_year = 2000) AS t1 ON catalog_sales.cs_sold_date_sk = t1.d_date_sk INNER JOIN store ON store_sales.ss_store_sk = store.s_store_sk INNER JOIN item ON store_sales.ss_item_sk = item.i_item_sk GROUP BY store.s_store_id, store.s_store_name, item.i_item_id, item.i_item_desc ORDER BY item.i_item_id, item.i_item_desc, store.s_store_id, store.s_store_name LIMIT 100;","['FILTER_MERGE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']",26.5612607,25.37901235,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
45,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = '2 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 3 and ca_state in ('GA', 'ME', 'NC') and cs_wholesale_cost BETWEEN 84 AND 89 AND i_category = 'Books' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;","SELECT t1170.i_item_id, t1168.ca_country, t1168.ca_state, t1168.ca_county, AVG(CAST(t1165.cs_quantity AS DECIMAL(12, 2))) AS agg1, AVG(CAST(t1165.cs_list_price AS DECIMAL(12, 2))) AS agg2, AVG(CAST(t1165.cs_coupon_amt AS DECIMAL(12, 2))) AS agg3, AVG(CAST(t1165.cs_sales_price AS DECIMAL(12, 2))) AS agg4, AVG(CAST(t1165.cs_net_profit AS DECIMAL(12, 2))) AS agg5, AVG(CAST(t1167.c_birth_year AS DECIMAL(12, 2))) AS agg6 FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 84 AND cs_wholesale_cost <= 89) AS t1165 INNER JOIN (SELECT * FROM customer_demographics WHERE cd_gender = 'F' AND cd_education_status = '2 yr Degree') AS t1166 ON t1165.cs_bill_cdemo_sk = t1166.cd_demo_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 3) AS t1167 ON t1165.cs_bill_customer_sk = t1167.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('GA', 'ME', 'NC')) AS t1168 ON t1167.c_current_addr_sk = t1168.ca_address_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t1169 ON t1165.cs_sold_date_sk = t1169.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category = 'Books') AS t1170 ON t1165.cs_item_sk = t1170.i_item_sk GROUP BY ROLLUP(t1170.i_item_id, t1168.ca_country, t1168.ca_state, t1168.ca_county) ORDER BY t1168.ca_country, t1168.ca_state, t1168.ca_county, t1170.i_item_id LIMIT 100",['FILTER_INTO_JOIN'],0.835584799,0.834848722,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
46,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = '2 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2002 and c_birth_month = 6 and ca_state in ('KS', 'MO', 'MS') and cs_wholesale_cost BETWEEN 56 AND 61 AND i_category = 'Women' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;","SELECT t4.i_item_id, t2.ca_country, t2.ca_state, t2.ca_county, AVG(CAST(t.cs_quantity AS DECIMAL(12, 2))) AS agg1, AVG(CAST(t.cs_list_price AS DECIMAL(12, 2))) AS agg2, AVG(CAST(t.cs_coupon_amt AS DECIMAL(12, 2))) AS agg3, AVG(CAST(t.cs_sales_price AS DECIMAL(12, 2))) AS agg4, AVG(CAST(t.cs_net_profit AS DECIMAL(12, 2))) AS agg5, AVG(CAST(t1.c_birth_year AS DECIMAL(12, 2))) AS agg6 FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 56 AND cs_wholesale_cost <= 61) AS t INNER JOIN (SELECT * FROM customer_demographics WHERE cd_gender = 'M' AND cd_education_status = '2 yr Degree') AS t0 ON t.cs_bill_cdemo_sk = t0.cd_demo_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 6) AS t1 ON t.cs_bill_customer_sk = t1.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('KS', 'MO', 'MS')) AS t2 ON t1.c_current_addr_sk = t2.ca_address_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t3 ON t.cs_sold_date_sk = t3.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category = 'Women') AS t4 ON t.cs_item_sk = t4.i_item_sk GROUP BY ROLLUP(t4.i_item_id, t2.ca_country, t2.ca_state, t2.ca_county) ORDER BY t2.ca_country, t2.ca_state, t2.ca_county, t4.i_item_id LIMIT 100;","['AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN', 'FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE']",3.17186602,0.872234583,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
47,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Advanced Degree' and c_current_addr_sk = ca_address_sk and d_year = 2001 and c_birth_month = 7 and ca_state in ('CA', 'NJ', 'SC') and cs_wholesale_cost BETWEEN 67 AND 72 AND i_category = 'Women' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;","SELECT t8.i_item_id, t7.ca_country, t7.ca_state, t7.ca_county, AVG(CAST(t7.cs_quantity AS DECIMAL(12, 2))) AS agg1, AVG(CAST(t7.cs_list_price AS DECIMAL(12, 2))) AS agg2, AVG(CAST(t7.cs_coupon_amt AS DECIMAL(12, 2))) AS agg3, AVG(CAST(t7.cs_sales_price AS DECIMAL(12, 2))) AS agg4, AVG(CAST(t7.cs_net_profit AS DECIMAL(12, 2))) AS agg5, AVG(CAST(t7.c_birth_year AS DECIMAL(12, 2))) AS agg6 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 67 AND cs_wholesale_cost <= 72) AS t, (SELECT * FROM customer_demographics WHERE cd_gender = 'M' AND cd_education_status = 'Advanced Degree') AS t0 WHERE t.cs_bill_cdemo_sk = t0.cd_demo_sk) AS t1, (SELECT * FROM customer WHERE c_birth_month = 7) AS t2 WHERE t1.cs_bill_customer_sk = t2.c_customer_sk) AS t3, (SELECT * FROM customer_address WHERE ca_state IN ('CA', 'NJ', 'SC')) AS t4 WHERE t3.c_current_addr_sk = t4.ca_address_sk) AS t5, (SELECT * FROM date_dim WHERE d_year = 2001) AS t6 WHERE t5.cs_sold_date_sk = t6.d_date_sk) AS t7, (SELECT * FROM item WHERE i_category = 'Women') AS t8 WHERE t7.cs_item_sk = t8.i_item_sk GROUP BY ROLLUP(t8.i_item_id, t7.ca_country, t7.ca_state, t7.ca_county) ORDER BY t7.ca_country, t7.ca_state, t7.ca_county, t8.i_item_id LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_INTO_JOIN', 'FILTER_MERGE', 'JOIN_EXTRACT_FILTER']",5.18667229,0.871817748,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
48,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = '4 yr Degree' and d_year = 1998 and s_state = 'IN' and i_category = 'Books' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT item.i_item_id, store.s_state, GROUPING(store.s_state) AS g_state, AVG(store_sales.ss_quantity) AS agg1, AVG(store_sales.ss_list_price) AS agg2, AVG(store_sales.ss_coupon_amt) AS agg3, AVG(store_sales.ss_sales_price) AS agg4 FROM store_sales, customer_demographics, date_dim, store, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk AND (store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND customer_demographics.cd_gender = 'F')) AND (customer_demographics.cd_marital_status = 'D' AND customer_demographics.cd_education_status = '4 yr Degree' AND (date_dim.d_year = 1998 AND (store.s_state = 'IN' AND item.i_category = 'Books'))) GROUP BY ROLLUP(store.s_state, item.i_item_id) ORDER BY item.i_item_id, store.s_state LIMIT 100","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_UNION_AGGREGATE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'SORT_REMOVE']",0.01716574,0.016583204,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
49,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Unknown' and d_year = 2000 and s_state = 'AZ' and i_category = 'Books' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT t885.i_item_id, t884.s_state, GROUPING(t884.s_state) AS g_state, AVG(store_sales100.ss_quantity) AS agg1, AVG(store_sales100.ss_list_price) AS agg2, AVG(store_sales100.ss_coupon_amt) AS agg3, AVG(store_sales100.ss_sales_price) AS agg4 FROM store_sales AS store_sales100 INNER JOIN (SELECT * FROM customer_demographics WHERE cd_gender = 'F' AND cd_marital_status = 'D' AND cd_education_status = 'Unknown') AS t882 ON store_sales100.ss_cdemo_sk = t882.cd_demo_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t883 ON store_sales100.ss_sold_date_sk = t883.d_date_sk INNER JOIN (SELECT * FROM store WHERE s_state = 'AZ') AS t884 ON store_sales100.ss_store_sk = t884.s_store_sk INNER JOIN (SELECT * FROM item WHERE i_category = 'Books') AS t885 ON store_sales100.ss_item_sk = t885.i_item_sk GROUP BY ROLLUP(t885.i_item_id, t884.s_state) ORDER BY t885.i_item_id, t884.s_state LIMIT 100",['FILTER_INTO_JOIN'],0.010893106,0.007771889,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
50,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = '2 yr Degree' and d_year = 2002 and s_state = 'TX' and i_category = 'Children' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT item.i_item_id, store.s_state, GROUPING(store.s_state) AS g_state, AVG(store_sales.ss_quantity) AS agg1, AVG(store_sales.ss_list_price) AS agg2, AVG(store_sales.ss_coupon_amt) AS agg3, AVG(store_sales.ss_sales_price) AS agg4 FROM store_sales, customer_demographics, date_dim, store, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk AND (store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND customer_demographics.cd_gender = 'F')) AND (customer_demographics.cd_marital_status = 'M' AND customer_demographics.cd_education_status = '2 yr Degree' AND (date_dim.d_year = 2002 AND (store.s_state = 'TX' AND item.i_category = 'Children'))) GROUP BY ROLLUP(store.s_state, item.i_item_id) ORDER BY item.i_item_id, store.s_state LIMIT 100","['FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN']",0.016915957,0.01623702,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
51,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'Unknown' and d_year = 2002 and s_state = 'NC' and i_category = 'Shoes' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT t2.i_item_id, t1.s_state, GROUPING(t1.s_state) AS g_state, AVG(store_sales.ss_quantity) AS agg1, AVG(store_sales.ss_list_price) AS agg2, AVG(store_sales.ss_coupon_amt) AS agg3, AVG(store_sales.ss_sales_price) AS agg4 FROM store_sales INNER JOIN (SELECT * FROM customer_demographics WHERE cd_gender = 'F' AND cd_marital_status = 'M' AND cd_education_status = 'Unknown') AS t ON store_sales.ss_cdemo_sk = t.cd_demo_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON store_sales.ss_sold_date_sk = t0.d_date_sk INNER JOIN (SELECT * FROM store WHERE s_state = 'NC') AS t1 ON store_sales.ss_store_sk = t1.s_store_sk INNER JOIN (SELECT * FROM item WHERE i_category = 'Shoes') AS t2 ON store_sales.ss_item_sk = t2.i_item_sk GROUP BY ROLLUP(t2.i_item_id, t1.s_state) ORDER BY t2.i_item_id, t1.s_state LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_INTO_JOIN']",0.01741147,0.017297824,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
52,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and d_year = 1999 and s_state = 'KS' and i_category = 'Shoes' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT item.i_item_id, store.s_state, GROUPING(store.s_state) AS g_state, AVG(store_sales.ss_quantity) AS agg1, AVG(store_sales.ss_list_price) AS agg2, AVG(store_sales.ss_coupon_amt) AS agg3, AVG(store_sales.ss_sales_price) AS agg4 FROM store_sales, customer_demographics, date_dim, store, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk AND (store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND customer_demographics.cd_gender = 'F')) AND (customer_demographics.cd_marital_status = 'S' AND customer_demographics.cd_education_status = '2 yr Degree' AND (date_dim.d_year = 1999 AND (store.s_state = 'KS' AND item.i_category = 'Shoes'))) GROUP BY ROLLUP(item.i_item_id, store.s_state) ORDER BY item.i_item_id, store.s_state LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'FILTER_AGGREGATE_TRANSPOSE']",0.017482996,0.014145295,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
53,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'S' and cd_education_status = 'Unknown' and d_year = 1998 and s_state = 'OK' and i_category = 'Shoes' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT t2.i_item_id, t1.s_state, GROUPING(t1.s_state) AS g_state, AVG(store_sales.ss_quantity) AS agg1, AVG(store_sales.ss_list_price) AS agg2, AVG(store_sales.ss_coupon_amt) AS agg3, AVG(store_sales.ss_sales_price) AS agg4 FROM store_sales INNER JOIN (SELECT * FROM customer_demographics WHERE cd_gender = 'F' AND cd_marital_status = 'S' AND cd_education_status = 'Unknown') AS t ON store_sales.ss_cdemo_sk = t.cd_demo_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t0 ON store_sales.ss_sold_date_sk = t0.d_date_sk INNER JOIN (SELECT * FROM store WHERE s_state = 'OK') AS t1 ON store_sales.ss_store_sk = t1.s_store_sk INNER JOIN (SELECT * FROM item WHERE i_category = 'Shoes') AS t2 ON store_sales.ss_item_sk = t2.i_item_sk GROUP BY ROLLUP(t2.i_item_id, t1.s_state) ORDER BY t2.i_item_id, t1.s_state LIMIT 100","['FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED']",0.020612558,0.01799806,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
54,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and d_year = 2000 and s_state = 'GA' and i_category = 'Home' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT item.i_item_id, store.s_state, GROUPING(store.s_state) AS g_state, AVG(store_sales.ss_quantity) AS agg1, AVG(store_sales.ss_list_price) AS agg2, AVG(store_sales.ss_coupon_amt) AS agg3, AVG(store_sales.ss_sales_price) AS agg4 FROM store_sales, customer_demographics, date_dim, store, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk AND (store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND customer_demographics.cd_gender = 'M')) AND (customer_demographics.cd_marital_status = 'M' AND customer_demographics.cd_education_status = '4 yr Degree' AND (date_dim.d_year = 2000 AND (store.s_state = 'GA' AND item.i_category = 'Home'))) GROUP BY ROLLUP(store.s_state, item.i_item_id) ORDER BY item.i_item_id, store.s_state LIMIT 100;","['AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'JOIN_CONDITION_PUSH']",0.018994331,0.01738294,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
55,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'M' and cd_education_status = 'Primary' and d_year = 2000 and s_state = 'KS' and i_category = 'Women' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT item.i_item_id, store.s_state, GROUPING(store.s_state) AS g_state, AVG(store_sales.ss_quantity) AS agg1, AVG(store_sales.ss_list_price) AS agg2, AVG(store_sales.ss_coupon_amt) AS agg3, AVG(store_sales.ss_sales_price) AS agg4 FROM store_sales, customer_demographics, date_dim, store, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk AND (store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND customer_demographics.cd_gender = 'M')) AND (customer_demographics.cd_marital_status = 'M' AND customer_demographics.cd_education_status = 'Primary' AND (date_dim.d_year = 2000 AND (store.s_state = 'KS' AND item.i_category = 'Women'))) GROUP BY ROLLUP(store.s_state, item.i_item_id) ORDER BY item.i_item_id, store.s_state LIMIT 100","['AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'JOIN_CONDITION_PUSH', 'FILTER_SCAN']",0.017926931,0.016763051,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
56,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'M' and cd_education_status = 'Primary' and d_year = 2000 and s_state = 'VA' and i_category = 'Jewelry' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT item.i_item_id, store.s_state, GROUPING(store.s_state) AS g_state, AVG(store_sales.ss_quantity) AS agg1, AVG(store_sales.ss_list_price) AS agg2, AVG(store_sales.ss_coupon_amt) AS agg3, AVG(store_sales.ss_sales_price) AS agg4 FROM store_sales, customer_demographics, date_dim, store, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk AND (store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND customer_demographics.cd_gender = 'M')) AND (customer_demographics.cd_marital_status = 'M' AND customer_demographics.cd_education_status = 'Primary' AND (date_dim.d_year = 2000 AND (store.s_state = 'VA' AND item.i_category = 'Jewelry'))) GROUP BY ROLLUP(store.s_state, item.i_item_id) ORDER BY item.i_item_id, store.s_state LIMIT 100","['AGGREGATE_PROJECT_MERGE', 'FILTER_MERGE', 'JOIN_LEFT_UNION_TRANSPOSE', 'FILTER_CORRELATE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'FILTER_SCAN']",0.018306017,0.016025702,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
57,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and d_year = 1998 and s_state = 'NH' and i_category = 'Home' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT item.i_item_id, store.s_state, GROUPING(store.s_state) AS g_state, AVG(store_sales.ss_quantity) AS agg1, AVG(store_sales.ss_list_price) AS agg2, AVG(store_sales.ss_coupon_amt) AS agg3, AVG(store_sales.ss_sales_price) AS agg4 FROM store_sales, customer_demographics, date_dim, store, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk AND (store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND customer_demographics.cd_gender = 'M')) AND (customer_demographics.cd_marital_status = 'S' AND customer_demographics.cd_education_status = '4 yr Degree' AND (date_dim.d_year = 1998 AND (store.s_state = 'NH' AND item.i_category = 'Home'))) GROUP BY ROLLUP(store.s_state, item.i_item_id) ORDER BY item.i_item_id, store.s_state LIMIT 100;","['AGGREGATE_PROJECT_MERGE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'FILTER_SCAN']",0.018544594,0.015943766,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
58,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and d_year = 2000 and s_state = 'KY' and i_category = 'Jewelry' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT t5.i_item_id, t4.s_state, GROUPING(t4.s_state) AS g_state, AVG(t4.ss_quantity) AS agg1, AVG(t4.ss_list_price) AS agg2, AVG(t4.ss_coupon_amt) AS agg3, AVG(t4.ss_sales_price) AS agg4 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM store_sales, (SELECT * FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = '4 yr Degree') AS t WHERE store_sales.ss_cdemo_sk = t.cd_demo_sk) AS t0, (SELECT * FROM date_dim WHERE d_year = 2000) AS t1 WHERE t0.ss_sold_date_sk = t1.d_date_sk) AS t2, (SELECT * FROM store WHERE s_state = 'KY') AS t3 WHERE t2.ss_store_sk = t3.s_store_sk) AS t4, (SELECT * FROM item WHERE i_category = 'Jewelry') AS t5 WHERE t4.ss_item_sk = t5.i_item_sk GROUP BY ROLLUP(t5.i_item_id, t4.s_state) ORDER BY t5.i_item_id, t4.s_state LIMIT 100","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_MERGE', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE']",0.021744808,0.017979463,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
59,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and d_year = 2000 and s_state = 'NM' and i_category = 'Jewelry' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT item.i_item_id, store.s_state, GROUPING(store.s_state) AS g_state, AVG(store_sales.ss_quantity) AS agg1, AVG(store_sales.ss_list_price) AS agg2, AVG(store_sales.ss_coupon_amt) AS agg3, AVG(store_sales.ss_sales_price) AS agg4 FROM store_sales, customer_demographics, date_dim, store, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk AND (store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND customer_demographics.cd_gender = 'M')) AND (customer_demographics.cd_marital_status = 'U' AND customer_demographics.cd_education_status = '4 yr Degree' AND (date_dim.d_year = 2000 AND (store.s_state = 'NM' AND item.i_category = 'Jewelry'))) GROUP BY ROLLUP(item.i_item_id, store.s_state) ORDER BY item.i_item_id, store.s_state LIMIT 100","['AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'PROJECT_REDUCE_EXPRESSIONS', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_SCAN', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_REMOVE', 'FILTER_AGGREGATE_TRANSPOSE']",0.018997351,0.015236934,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
60,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and d_year = 1999 and s_state = 'MN' and i_category = 'Jewelry' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT t5.i_item_id, t4.s_state, GROUPING(t4.s_state) AS g_state, AVG(t4.ss_quantity) AS agg1, AVG(t4.ss_list_price) AS agg2, AVG(t4.ss_coupon_amt) AS agg3, AVG(t4.ss_sales_price) AS agg4 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM store_sales, (SELECT * FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'U' AND cd_education_status = 'Advanced Degree') AS t WHERE store_sales.ss_cdemo_sk = t.cd_demo_sk) AS t0, (SELECT * FROM date_dim WHERE d_year = 1999) AS t1 WHERE t0.ss_sold_date_sk = t1.d_date_sk) AS t2, (SELECT * FROM store WHERE s_state = 'MN') AS t3 WHERE t2.ss_store_sk = t3.s_store_sk) AS t4, (SELECT * FROM item WHERE i_category = 'Jewelry') AS t5 WHERE t4.ss_item_sk = t5.i_item_sk GROUP BY ROLLUP(t4.s_state, t5.i_item_id) ORDER BY t5.i_item_id, t4.s_state LIMIT 100;","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_PROJECT_LEFT_TRANSPOSE', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'FILTER_MERGE', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SET_OP_TRANSPOSE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_REDUCE_EXPRESSIONS', 'UNION_MERGE', 'UNION_REMOVE', 'UNION_TO_DISTINCT', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_UNION_AGGREGATE', 'AGGREGATE_UNION_TRANSPOSE', 'AGGREGATE_VALUES', 'AGGREGATE_REMOVE']",0.020950556,0.015333335,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
61,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'U' and cd_education_status = 'Primary' and d_year = 1998 and s_state = 'AK' and i_category = 'Women' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT item.i_item_id, store.s_state, GROUPING(store.s_state) AS g_state, AVG(store_sales.ss_quantity) AS agg1, AVG(store_sales.ss_list_price) AS agg2, AVG(store_sales.ss_coupon_amt) AS agg3, AVG(store_sales.ss_sales_price) AS agg4 FROM store_sales, customer_demographics, date_dim, store, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk AND (store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND customer_demographics.cd_gender = 'M')) AND (customer_demographics.cd_marital_status = 'U' AND customer_demographics.cd_education_status = 'Primary' AND (date_dim.d_year = 1998 AND (store.s_state = 'AK' AND item.i_category = 'Women'))) GROUP BY ROLLUP(store.s_state, item.i_item_id) ORDER BY item.i_item_id, store.s_state LIMIT 100;","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_AGGREGATE_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'AGGREGATE_PROJECT_MERGE']",0.018458764,0.015749693,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
62,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'U' and cd_education_status = 'Primary' and d_year = 1998 and s_state = 'MS' and i_category = 'Women' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT item.i_item_id, store.s_state, GROUPING(store.s_state) AS g_state, AVG(store_sales.ss_quantity) AS agg1, AVG(store_sales.ss_list_price) AS agg2, AVG(store_sales.ss_coupon_amt) AS agg3, AVG(store_sales.ss_sales_price) AS agg4 FROM store_sales, customer_demographics, date_dim, store, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk AND (store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND customer_demographics.cd_gender = 'M')) AND (customer_demographics.cd_marital_status = 'U' AND customer_demographics.cd_education_status = 'Primary' AND (date_dim.d_year = 1998 AND (store.s_state = 'MS' AND item.i_category = 'Women'))) GROUP BY ROLLUP(store.s_state, item.i_item_id) ORDER BY item.i_item_id, store.s_state LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE']",0.020384868,0.016155481,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
63,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'U' and cd_education_status = 'Secondary' and d_year = 2001 and s_state = 'MO' and i_category = 'Electronics' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT item.i_item_id, store.s_state, GROUPING(store.s_state) AS g_state, AVG(store_sales.ss_quantity) AS agg1, AVG(store_sales.ss_list_price) AS agg2, AVG(store_sales.ss_coupon_amt) AS agg3, AVG(store_sales.ss_sales_price) AS agg4 FROM store_sales, customer_demographics, date_dim, store, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk AND (store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND customer_demographics.cd_gender = 'M')) AND (customer_demographics.cd_marital_status = 'U' AND customer_demographics.cd_education_status = 'Secondary' AND (date_dim.d_year = 2001 AND (store.s_state = 'MO' AND item.i_category = 'Electronics'))) GROUP BY ROLLUP(store.s_state, item.i_item_id) ORDER BY item.i_item_id, store.s_state LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']",0.018378337,0.017676989,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
64,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'W' and cd_education_status = 'Primary' and d_year = 2000 and s_state = 'IN' and i_category = 'Home' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;","SELECT t2.i_item_id, t1.s_state, GROUPING(t1.s_state) AS g_state, AVG(store_sales.ss_quantity) AS agg1, AVG(store_sales.ss_list_price) AS agg2, AVG(store_sales.ss_coupon_amt) AS agg3, AVG(store_sales.ss_sales_price) AS agg4 FROM store_sales INNER JOIN (SELECT * FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'W' AND cd_education_status = 'Primary') AS t ON store_sales.ss_cdemo_sk = t.cd_demo_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t0 ON store_sales.ss_sold_date_sk = t0.d_date_sk INNER JOIN (SELECT * FROM store WHERE s_state = 'IN') AS t1 ON store_sales.ss_store_sk = t1.s_store_sk INNER JOIN (SELECT * FROM item WHERE i_category = 'Home') AS t2 ON store_sales.ss_item_sk = t2.i_item_sk GROUP BY ROLLUP(t1.s_state, t2.i_item_id) ORDER BY t2.i_item_id, t1.s_state LIMIT 100;","['AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_REMOVE', 'AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN', 'FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']",0.017230272,0.016561747,"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
65,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Children') and item2.i_manager_id between 26 and 45 and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 107 and 121 and s2.ss_list_price between 107 and 121 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT item.i_item_sk, item0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM item, item AS item0, store_sales, store_sales AS store_sales0, date_dim, customer, customer_address, customer_demographics WHERE item.i_item_sk < item0.i_item_sk AND store_sales.ss_ticket_number = store_sales0.ss_ticket_number AND (store_sales.ss_item_sk = item.i_item_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (store_sales.ss_customer_sk = customer.c_customer_sk AND customer.c_current_addr_sk = customer_address.ca_address_sk AND (customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk AND (date_dim.d_year >= 1998 AND date_dim.d_year <= 1998 + 1))) AND (date_dim.d_date_sk = store_sales.ss_sold_date_sk AND (item.i_category = 'Books' OR item.i_category = 'Children') AND (item0.i_manager_id >= 26 AND (item0.i_manager_id <= 45 AND customer_demographics.cd_marital_status = 'U')) AND (customer_demographics.cd_education_status = 'Advanced Degree' AND store_sales.ss_list_price >= 107 AND (store_sales.ss_list_price <= 121 AND (store_sales0.ss_list_price >= 107 AND store_sales0.ss_list_price <= 121)))) GROUP BY item.i_item_sk, item0.i_item_sk ORDER BY COUNT(*);","['AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN']",3.029647112,2.989958366,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
66,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Home') and item2.i_manager_id between 30 and 49 and cd_marital_status = 'S' and cd_education_status = 'Unknown' and s1.ss_list_price between 206 and 220 and s2.ss_list_price between 206 and 220 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT item.i_item_sk, item0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM item, item AS item0, store_sales, store_sales AS store_sales0, date_dim, customer, customer_address, customer_demographics WHERE item.i_item_sk < item0.i_item_sk AND store_sales.ss_ticket_number = store_sales0.ss_ticket_number AND (store_sales.ss_item_sk = item.i_item_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (store_sales.ss_customer_sk = customer.c_customer_sk AND customer.c_current_addr_sk = customer_address.ca_address_sk AND (customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk AND (date_dim.d_year >= 1998 AND date_dim.d_year <= 1998 + 1))) AND (date_dim.d_date_sk = store_sales.ss_sold_date_sk AND (item.i_category = 'Books' OR item.i_category = 'Home') AND (item0.i_manager_id >= 30 AND (item0.i_manager_id <= 49 AND customer_demographics.cd_marital_status = 'S')) AND (customer_demographics.cd_education_status = 'Unknown' AND store_sales.ss_list_price >= 206 AND (store_sales.ss_list_price <= 220 AND (store_sales0.ss_list_price >= 206 AND store_sales0.ss_list_price <= 220)))) GROUP BY item.i_item_sk, item0.i_item_sk ORDER BY COUNT(*)",['AGGREGATE_PROJECT_MERGE'],8.624646425,4.426796357,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
67,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Home') and item2.i_manager_id between 47 and 66 and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 97 and 111 and s2.ss_list_price between 97 and 111 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT item.i_item_sk, item0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM item, item AS item0, store_sales, store_sales AS store_sales0, date_dim, customer, customer_address, customer_demographics WHERE item.i_item_sk < item0.i_item_sk AND store_sales.ss_ticket_number = store_sales0.ss_ticket_number AND (store_sales.ss_item_sk = item.i_item_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (store_sales.ss_customer_sk = customer.c_customer_sk AND customer.c_current_addr_sk = customer_address.ca_address_sk AND (customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk AND (date_dim.d_year >= 1998 AND date_dim.d_year <= 1998 + 1))) AND (date_dim.d_date_sk = store_sales.ss_sold_date_sk AND (item.i_category = 'Books' OR item.i_category = 'Home') AND (item0.i_manager_id >= 47 AND (item0.i_manager_id <= 66 AND customer_demographics.cd_marital_status = 'M')) AND (customer_demographics.cd_education_status = '4 yr Degree' AND store_sales.ss_list_price >= 97 AND (store_sales.ss_list_price <= 111 AND (store_sales0.ss_list_price >= 97 AND store_sales0.ss_list_price <= 111)))) GROUP BY item.i_item_sk, item0.i_item_sk ORDER BY COUNT(*);","['FILTER_SCAN', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_EXTRACT_FILTER', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED']",13.42263532,7.745019992,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
68,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Shoes') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = 'Unknown' and s1.ss_list_price between 153 and 167 and s2.ss_list_price between 153 and 167 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT item.i_item_sk, item0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM item, item AS item0, store_sales, store_sales AS store_sales0, date_dim, customer, customer_address, customer_demographics WHERE item.i_item_sk < item0.i_item_sk AND store_sales.ss_ticket_number = store_sales0.ss_ticket_number AND (store_sales.ss_item_sk = item.i_item_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (store_sales.ss_customer_sk = customer.c_customer_sk AND customer.c_current_addr_sk = customer_address.ca_address_sk AND (customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk AND (date_dim.d_year >= 1998 AND date_dim.d_year <= 1998 + 1))) AND (date_dim.d_date_sk = store_sales.ss_sold_date_sk AND (item.i_category = 'Books' OR item.i_category = 'Shoes') AND (item0.i_manager_id >= 81 AND (item0.i_manager_id <= 100 AND customer_demographics.cd_marital_status = 'M')) AND (customer_demographics.cd_education_status = 'Unknown' AND store_sales.ss_list_price >= 153 AND (store_sales.ss_list_price <= 167 AND (store_sales0.ss_list_price >= 153 AND store_sales0.ss_list_price <= 167)))) GROUP BY item.i_item_sk, item0.i_item_sk ORDER BY COUNT(*);","['JOIN_CONDITION_PUSH', 'FILTER_SCAN', 'JOIN_EXTRACT_FILTER']",19.14235059,14.73311877,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
69,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 17 and 36 and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 94 and 108 and s2.ss_list_price between 94 and 108 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT item.i_item_sk, item0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM item, item AS item0, store_sales, store_sales AS store_sales0, date_dim, customer, customer_address, customer_demographics WHERE item.i_item_sk < item0.i_item_sk AND store_sales.ss_ticket_number = store_sales0.ss_ticket_number AND (store_sales.ss_item_sk = item.i_item_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (store_sales.ss_customer_sk = customer.c_customer_sk AND customer.c_current_addr_sk = customer_address.ca_address_sk AND (customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk AND (date_dim.d_year >= 1998 AND date_dim.d_year <= 1998 + 1))) AND (date_dim.d_date_sk = store_sales.ss_sold_date_sk AND (item.i_category = 'Children' OR item.i_category = 'Jewelry') AND (item0.i_manager_id >= 17 AND (item0.i_manager_id <= 36 AND customer_demographics.cd_marital_status = 'W')) AND (customer_demographics.cd_education_status = '2 yr Degree' AND store_sales.ss_list_price >= 94 AND (store_sales.ss_list_price <= 108 AND (store_sales0.ss_list_price >= 94 AND store_sales0.ss_list_price <= 108)))) GROUP BY item.i_item_sk, item0.i_item_sk ORDER BY COUNT(*);","['JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'AGGREGATE_REMOVE']",7.28465422,3.65174071,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
70,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 40 and 59 and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 196 and 210 and s2.ss_list_price between 196 and 210 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT item.i_item_sk, item0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM item, item AS item0, store_sales, store_sales AS store_sales0, date_dim, customer, customer_address, customer_demographics WHERE item.i_item_sk < item0.i_item_sk AND store_sales.ss_ticket_number = store_sales0.ss_ticket_number AND (store_sales.ss_item_sk = item.i_item_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (store_sales.ss_customer_sk = customer.c_customer_sk AND customer.c_current_addr_sk = customer_address.ca_address_sk AND (customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk AND date_dim.d_year >= 1998)) AND (date_dim.d_year <= 1998 + 1 AND date_dim.d_date_sk = store_sales.ss_sold_date_sk AND (item.i_category IN ('Children', 'Jewelry') AND (item0.i_manager_id >= 40 AND item0.i_manager_id <= 59)) AND (customer_demographics.cd_marital_status = 'S' AND customer_demographics.cd_education_status = '4 yr Degree' AND (store_sales.ss_list_price >= 196 AND store_sales.ss_list_price <= 210 AND (store_sales0.ss_list_price >= 196 AND store_sales0.ss_list_price <= 210)))) GROUP BY item.i_item_sk, item0.i_item_sk ORDER BY COUNT(*);","['JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES']",4.066237609,1.533115546,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
71,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'W' and cd_education_status = 'Primary' and s1.ss_list_price between 203 and 217 and s2.ss_list_price between 203 and 217 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT item.i_item_sk, item0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM item, item AS item0, store_sales, store_sales AS store_sales0, date_dim, customer, customer_address, customer_demographics WHERE item.i_item_sk < item0.i_item_sk AND store_sales.ss_ticket_number = store_sales0.ss_ticket_number AND (store_sales.ss_item_sk = item.i_item_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (store_sales.ss_customer_sk = customer.c_customer_sk AND customer.c_current_addr_sk = customer_address.ca_address_sk AND (customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk AND (date_dim.d_year >= 1998 AND date_dim.d_year <= 1998 + 1))) AND (date_dim.d_date_sk = store_sales.ss_sold_date_sk AND (item.i_category = 'Children' OR item.i_category = 'Jewelry') AND (item0.i_manager_id >= 81 AND (item0.i_manager_id <= 100 AND customer_demographics.cd_marital_status = 'W')) AND (customer_demographics.cd_education_status = 'Primary' AND store_sales.ss_list_price >= 203 AND (store_sales.ss_list_price <= 217 AND (store_sales0.ss_list_price >= 203 AND store_sales0.ss_list_price <= 217)))) GROUP BY item.i_item_sk, item0.i_item_sk ORDER BY COUNT(*);",['JOIN_PROJECT_BOTH_TRANSPOSE'],7.059456269,4.811200698,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
72,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 46 and 65 and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 14 and 28 and s2.ss_list_price between 14 and 28 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT item.i_item_sk, item0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM item, item AS item0, store_sales, store_sales AS store_sales0, date_dim, customer, customer_address, customer_demographics WHERE item.i_item_sk < item0.i_item_sk AND store_sales.ss_ticket_number = store_sales0.ss_ticket_number AND (store_sales.ss_item_sk = item.i_item_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (store_sales.ss_customer_sk = customer.c_customer_sk AND customer.c_current_addr_sk = customer_address.ca_address_sk AND (customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk AND date_dim.d_year >= 1998)) AND (date_dim.d_year <= 1998 + 1 AND date_dim.d_date_sk = store_sales.ss_sold_date_sk AND (item.i_category IN ('Children', 'Women') AND (item0.i_manager_id >= 46 AND item0.i_manager_id <= 65)) AND (customer_demographics.cd_marital_status = 'S' AND customer_demographics.cd_education_status = '2 yr Degree' AND (store_sales.ss_list_price >= 14 AND store_sales.ss_list_price <= 28 AND (store_sales0.ss_list_price >= 14 AND store_sales0.ss_list_price <= 28)))) GROUP BY item.i_item_sk, item0.i_item_sk ORDER BY COUNT(*);","['FILTER_AGGREGATE_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'FILTER_REDUCE_EXPRESSIONS']",16.30120397,10.71963859,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
73,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Jewelry') and item2.i_manager_id between 51 and 70 and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 86 and 100 and s2.ss_list_price between 86 and 100 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT item.i_item_sk, item0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM item, item AS item0, store_sales, store_sales AS store_sales0, date_dim, customer, customer_address, customer_demographics WHERE item.i_item_sk < item0.i_item_sk AND store_sales.ss_ticket_number = store_sales0.ss_ticket_number AND (store_sales.ss_item_sk = item.i_item_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (store_sales.ss_customer_sk = customer.c_customer_sk AND customer.c_current_addr_sk = customer_address.ca_address_sk AND (customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk AND (date_dim.d_year >= 1999 AND date_dim.d_year <= 1999 + 1))) AND (date_dim.d_date_sk = store_sales.ss_sold_date_sk AND (item.i_category = 'Books' OR item.i_category = 'Jewelry') AND (item0.i_manager_id >= 51 AND (item0.i_manager_id <= 70 AND customer_demographics.cd_marital_status = 'U')) AND (customer_demographics.cd_education_status = 'Advanced Degree' AND store_sales.ss_list_price >= 86 AND (store_sales.ss_list_price <= 100 AND (store_sales0.ss_list_price >= 86 AND store_sales0.ss_list_price <= 100)))) GROUP BY item.i_item_sk, item0.i_item_sk ORDER BY COUNT(*);","['JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS']",11.25100732,9.608053446,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
74,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Jewelry') and item2.i_manager_id between 52 and 71 and cd_marital_status = 'M' and cd_education_status = 'Primary' and s1.ss_list_price between 63 and 77 and s2.ss_list_price between 63 and 77 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT item.i_item_sk, item0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM item, item AS item0, store_sales, store_sales AS store_sales0, date_dim, customer, customer_address, customer_demographics WHERE item.i_item_sk < item0.i_item_sk AND store_sales.ss_ticket_number = store_sales0.ss_ticket_number AND (store_sales.ss_item_sk = item.i_item_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (store_sales.ss_customer_sk = customer.c_customer_sk AND customer.c_current_addr_sk = customer_address.ca_address_sk AND (customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk AND (date_dim.d_year >= 1999 AND date_dim.d_year <= 1999 + 1))) AND (date_dim.d_date_sk = store_sales.ss_sold_date_sk AND (item.i_category = 'Books' OR item.i_category = 'Jewelry') AND (item0.i_manager_id >= 52 AND (item0.i_manager_id <= 71 AND customer_demographics.cd_marital_status = 'M')) AND (customer_demographics.cd_education_status = 'Primary' AND store_sales.ss_list_price >= 63 AND (store_sales.ss_list_price <= 77 AND (store_sales0.ss_list_price >= 63 AND store_sales0.ss_list_price <= 77)))) GROUP BY item.i_item_sk, item0.i_item_sk ORDER BY COUNT(*);","['JOIN_CONDITION_PUSH', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_SCAN', 'JOIN_REDUCE_EXPRESSIONS']",11.77209441,9.853020032,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
75,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Jewelry') and item2.i_manager_id between 55 and 74 and cd_marital_status = 'U' and cd_education_status = 'Secondary' and s1.ss_list_price between 251 and 265 and s2.ss_list_price between 251 and 265 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT t1347.i_item_sk, t1347.i_item_sk0, COALESCE(SUM(t1347.cnt * t1349.cnt), 0) AS cnt FROM (SELECT t1344.i_item_sk, t1344.i_item_sk0, t1344.c_current_cdemo_sk, COALESCE(SUM(t1344.cnt * t1345.cnt), 0) AS cnt FROM (SELECT t1341.i_item_sk, t1341.i_item_sk0, t1342.c_current_addr_sk, t1342.c_current_cdemo_sk, COALESCE(SUM(t1341.cnt * t1342.cnt), 0) AS cnt FROM (SELECT t1337.i_item_sk, t1337.i_item_sk0, t1337.ss_customer_sk, COALESCE(SUM(t1337.cnt * t1339.cnt), 0) AS cnt FROM (SELECT t1329.i_item_sk, t1329.i_item_sk0, t1331.ss_sold_date_sk, t1331.ss_customer_sk, COALESCE(SUM(t1329.cnt * t1331.cnt * t1333.cnt), 0) AS cnt FROM (SELECT t1327.i_item_sk, t1328.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM (SELECT * FROM item WHERE i_category IN ('Books', 'Jewelry')) AS t1327 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 55 AND i_manager_id <= 74) AS t1328 ON t1327.i_item_sk < t1328.i_item_sk GROUP BY t1327.i_item_sk, t1328.i_item_sk) AS t1329 INNER JOIN (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_ticket_number, COUNT(*) AS cnt FROM store_sales WHERE ss_list_price >= 251 AND ss_list_price <= 265 GROUP BY ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_ticket_number) AS t1331 ON t1329.i_item_sk = t1331.ss_item_sk CROSS JOIN (SELECT ss_item_sk, ss_ticket_number, COUNT(*) AS cnt FROM store_sales WHERE ss_list_price >= 251 AND ss_list_price <= 265 GROUP BY ss_item_sk, ss_ticket_number) AS t1333 WHERE t1331.ss_ticket_number = t1333.ss_ticket_number AND t1333.ss_item_sk = t1329.i_item_sk0 GROUP BY t1329.i_item_sk, t1329.i_item_sk0, t1331.ss_sold_date_sk, t1331.ss_customer_sk) AS t1337 INNER JOIN (SELECT d_date_sk, COUNT(*) AS cnt FROM date_dim WHERE d_year >= 1999 AND d_year <= 1999 + 1 GROUP BY d_date_sk) AS t1339 ON t1337.ss_sold_date_sk = t1339.d_date_sk GROUP BY t1337.i_item_sk, t1337.i_item_sk0, t1337.ss_customer_sk) AS t1341 INNER JOIN (SELECT c_customer_sk, c_current_addr_sk, c_current_cdemo_sk, COUNT(*) AS cnt FROM customer GROUP BY c_customer_sk, c_current_addr_sk, c_current_cdemo_sk) AS t1342 ON t1341.ss_customer_sk = t1342.c_customer_sk GROUP BY t1341.i_item_sk, t1341.i_item_sk0, t1342.c_current_addr_sk, t1342.c_current_cdemo_sk) AS t1344 INNER JOIN (SELECT ca_address_sk, COUNT(*) AS cnt FROM customer_address GROUP BY ca_address_sk) AS t1345 ON t1344.c_current_addr_sk = t1345.ca_address_sk GROUP BY t1344.i_item_sk, t1344.i_item_sk0, t1344.c_current_cdemo_sk) AS t1347 INNER JOIN (SELECT cd_demo_sk, COUNT(*) AS cnt FROM customer_demographics WHERE cd_marital_status = 'U' AND cd_education_status = 'Secondary' GROUP BY cd_demo_sk) AS t1349 ON t1347.c_current_cdemo_sk = t1349.cd_demo_sk GROUP BY t1347.i_item_sk, t1347.i_item_sk0 ORDER BY COALESCE(SUM(t1347.cnt * t1349.cnt), 0)","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']",4.229517063,1.475516558,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
76,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 78 and 97 and cd_marital_status = 'M' and cd_education_status = 'Unknown' and s1.ss_list_price between 205 and 219 and s2.ss_list_price between 205 and 219 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT item.i_item_sk, item0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM item, item AS item0, store_sales, store_sales AS store_sales0, date_dim, customer, customer_address, customer_demographics WHERE item.i_item_sk < item0.i_item_sk AND store_sales.ss_ticket_number = store_sales0.ss_ticket_number AND (store_sales.ss_item_sk = item.i_item_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (store_sales.ss_customer_sk = customer.c_customer_sk AND customer.c_current_addr_sk = customer_address.ca_address_sk AND (customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk AND (date_dim.d_year >= 1999 AND date_dim.d_year <= 1999 + 1))) AND (date_dim.d_date_sk = store_sales.ss_sold_date_sk AND (item.i_category = 'Children' OR item.i_category = 'Jewelry') AND (item0.i_manager_id >= 78 AND (item0.i_manager_id <= 97 AND customer_demographics.cd_marital_status = 'M')) AND (customer_demographics.cd_education_status = 'Unknown' AND store_sales.ss_list_price >= 205 AND (store_sales.ss_list_price <= 219 AND (store_sales0.ss_list_price >= 205 AND store_sales0.ss_list_price <= 219)))) GROUP BY item.i_item_sk, item0.i_item_sk ORDER BY COUNT(*);","['JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'FILTER_SCAN', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']",2.297051748,1.072381258,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
77,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 35 and 54 and cd_marital_status = 'U' and cd_education_status = 'Primary' and s1.ss_list_price between 286 and 300 and s2.ss_list_price between 286 and 300 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT item.i_item_sk, item0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM item, item AS item0, store_sales, store_sales AS store_sales0, date_dim, customer, customer_address, customer_demographics WHERE item.i_item_sk < item0.i_item_sk AND store_sales.ss_ticket_number = store_sales0.ss_ticket_number AND (store_sales.ss_item_sk = item.i_item_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (store_sales.ss_customer_sk = customer.c_customer_sk AND customer.c_current_addr_sk = customer_address.ca_address_sk AND (customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk AND date_dim.d_year >= 1999)) AND (date_dim.d_year <= 1999 + 1 AND date_dim.d_date_sk = store_sales.ss_sold_date_sk AND (item.i_category IN ('Children', 'Women') AND (item0.i_manager_id >= 35 AND item0.i_manager_id <= 54)) AND (customer_demographics.cd_marital_status = 'U' AND customer_demographics.cd_education_status = 'Primary' AND (store_sales.ss_list_price >= 286 AND store_sales.ss_list_price <= 300 AND (store_sales0.ss_list_price >= 286 AND store_sales0.ss_list_price <= 300)))) GROUP BY item.i_item_sk, item0.i_item_sk ORDER BY COUNT(*);","['JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']",1.393493096,1.079556704,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
78,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Jewelry') and item2.i_manager_id between 75 and 94 and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 66 and 80 and s2.ss_list_price between 66 and 80 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT t1762.i_item_sk, t1763.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM (SELECT * FROM item WHERE i_category IN ('Home', 'Jewelry')) AS t1762 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 75 AND i_manager_id <= 94) AS t1763 ON t1762.i_item_sk < t1763.i_item_sk INNER JOIN (SELECT * FROM store_sales WHERE ss_list_price >= 66 AND ss_list_price <= 80) AS t1764 ON t1762.i_item_sk = t1764.ss_item_sk INNER JOIN (SELECT * FROM store_sales WHERE ss_list_price >= 66 AND ss_list_price <= 80) AS t1765 ON t1764.ss_ticket_number = t1765.ss_ticket_number AND t1763.i_item_sk = t1765.ss_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year >= 1999 AND d_year <= 1999 + 1) AS t1766 ON t1764.ss_sold_date_sk = t1766.d_date_sk INNER JOIN customer AS customer88 ON t1764.ss_customer_sk = customer88.c_customer_sk INNER JOIN customer_address AS customer_address88 ON customer88.c_current_addr_sk = customer_address88.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'U' AND cd_education_status = '4 yr Degree') AS t1767 ON customer88.c_current_cdemo_sk = t1767.cd_demo_sk GROUP BY t1762.i_item_sk, t1763.i_item_sk ORDER BY COUNT(*)",['FILTER_INTO_JOIN'],3.083424409,2.80749774,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
79,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Shoes') and item2.i_manager_id between 40 and 59 and cd_marital_status = 'W' and cd_education_status = 'Unknown' and s1.ss_list_price between 162 and 176 and s2.ss_list_price between 162 and 176 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT t.i_item_sk, t0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM (SELECT * FROM item WHERE i_category IN ('Home', 'Shoes')) AS t INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 40 AND i_manager_id <= 59) AS t0 ON t.i_item_sk < t0.i_item_sk INNER JOIN (SELECT * FROM store_sales WHERE ss_list_price >= 162 AND ss_list_price <= 176) AS t1 ON t.i_item_sk = t1.ss_item_sk INNER JOIN (SELECT * FROM store_sales WHERE ss_list_price >= 162 AND ss_list_price <= 176) AS t2 ON t1.ss_ticket_number = t2.ss_ticket_number AND t0.i_item_sk = t2.ss_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year >= 1999 AND d_year <= 1999 + 1) AS t3 ON t1.ss_sold_date_sk = t3.d_date_sk INNER JOIN customer ON t1.ss_customer_sk = customer.c_customer_sk INNER JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'W' AND cd_education_status = 'Unknown') AS t4 ON customer.c_current_cdemo_sk = t4.cd_demo_sk GROUP BY t.i_item_sk, t0.i_item_sk ORDER BY COUNT(*);","['JOIN_CONDITION_PUSH', 'FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']",15.6199584,10.53984237,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
80,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Shoes') and item2.i_manager_id between 68 and 87 and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 125 and 139 and s2.ss_list_price between 125 and 139 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT item.i_item_sk, item0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM item, item AS item0, store_sales, store_sales AS store_sales0, date_dim, customer, customer_address, customer_demographics WHERE item.i_item_sk < item0.i_item_sk AND store_sales.ss_ticket_number = store_sales0.ss_ticket_number AND (store_sales.ss_item_sk = item.i_item_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (store_sales.ss_customer_sk = customer.c_customer_sk AND customer.c_current_addr_sk = customer_address.ca_address_sk AND (customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk AND date_dim.d_year >= 1999)) AND (date_dim.d_year <= 1999 + 1 AND date_dim.d_date_sk = store_sales.ss_sold_date_sk AND (item.i_category IN ('Home', 'Shoes') AND (item0.i_manager_id >= 68 AND item0.i_manager_id <= 87)) AND (customer_demographics.cd_marital_status = 'S' AND customer_demographics.cd_education_status = '2 yr Degree' AND (store_sales.ss_list_price >= 125 AND store_sales.ss_list_price <= 139 AND (store_sales0.ss_list_price >= 125 AND store_sales0.ss_list_price <= 139)))) GROUP BY item.i_item_sk, item0.i_item_sk ORDER BY COUNT(*);","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'FILTER_CORRELATE']",6.376154184,6.260229747,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
81,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Women') and item2.i_manager_id between 67 and 86 and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 126 and 140 and s2.ss_list_price between 126 and 140 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT item.i_item_sk, item0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM item, item AS item0, store_sales, store_sales AS store_sales0, date_dim, customer, customer_address, customer_demographics WHERE item.i_item_sk < item0.i_item_sk AND store_sales.ss_ticket_number = store_sales0.ss_ticket_number AND (store_sales.ss_item_sk = item.i_item_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (store_sales.ss_customer_sk = customer.c_customer_sk AND customer.c_current_addr_sk = customer_address.ca_address_sk AND (customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk AND date_dim.d_year >= 1999)) AND (date_dim.d_year <= 1999 + 1 AND date_dim.d_date_sk = store_sales.ss_sold_date_sk AND (item.i_category IN ('Jewelry', 'Women') AND (item0.i_manager_id >= 67 AND item0.i_manager_id <= 86)) AND (customer_demographics.cd_marital_status = 'S' AND customer_demographics.cd_education_status = 'Advanced Degree' AND (store_sales.ss_list_price >= 126 AND store_sales.ss_list_price <= 140 AND (store_sales0.ss_list_price >= 126 AND store_sales0.ss_list_price <= 140)))) GROUP BY item.i_item_sk, item0.i_item_sk ORDER BY COUNT(*);","['JOIN_CONDITION_PUSH', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']",13.79498935,2.409168164,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
82,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Home') and item2.i_manager_id between 53 and 72 and cd_marital_status = 'M' and cd_education_status = 'Secondary' and s1.ss_list_price between 89 and 103 and s2.ss_list_price between 89 and 103 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT t.i_item_sk, t0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM (SELECT * FROM item WHERE i_category IN ('Children', 'Home')) AS t INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 53 AND i_manager_id <= 72) AS t0 ON t.i_item_sk < t0.i_item_sk INNER JOIN (SELECT * FROM store_sales WHERE ss_list_price >= 89 AND ss_list_price <= 103) AS t1 ON t.i_item_sk = t1.ss_item_sk INNER JOIN (SELECT * FROM store_sales WHERE ss_list_price >= 89 AND ss_list_price <= 103) AS t2 ON t1.ss_ticket_number = t2.ss_ticket_number AND t0.i_item_sk = t2.ss_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year >= 2000 AND d_year <= 2000 + 1) AS t3 ON t1.ss_sold_date_sk = t3.d_date_sk INNER JOIN customer ON t1.ss_customer_sk = customer.c_customer_sk INNER JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Secondary') AS t4 ON customer.c_current_cdemo_sk = t4.cd_demo_sk GROUP BY t.i_item_sk, t0.i_item_sk ORDER BY COUNT(*);","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_MERGE']",12.55825973,7.968823353,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
83,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 46 and 65 and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 256 and 270 and s2.ss_list_price between 256 and 270 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT t.i_item_sk, t0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM (SELECT * FROM item WHERE i_category IN ('Children', 'Jewelry')) AS t INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 46 AND i_manager_id <= 65) AS t0 ON t.i_item_sk < t0.i_item_sk INNER JOIN (SELECT * FROM store_sales WHERE ss_list_price >= 256 AND ss_list_price <= 270) AS t1 ON t.i_item_sk = t1.ss_item_sk INNER JOIN (SELECT * FROM store_sales WHERE ss_list_price >= 256 AND ss_list_price <= 270) AS t2 ON t1.ss_ticket_number = t2.ss_ticket_number AND t0.i_item_sk = t2.ss_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year >= 2000 AND d_year <= 2000 + 1) AS t3 ON t1.ss_sold_date_sk = t3.d_date_sk INNER JOIN customer ON t1.ss_customer_sk = customer.c_customer_sk INNER JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'W' AND cd_education_status = '4 yr Degree') AS t4 ON customer.c_current_cdemo_sk = t4.cd_demo_sk GROUP BY t.i_item_sk, t0.i_item_sk ORDER BY COUNT(*);","['JOIN_CONDITION_PUSH', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_PROJECT_MERGE']",3.853149652,2.879501661,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
84,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Men') and item2.i_manager_id between 38 and 57 and cd_marital_status = 'M' and cd_education_status = 'Secondary' and s1.ss_list_price between 278 and 292 and s2.ss_list_price between 278 and 292 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT t1984.i_item_sk, t1984.i_item_sk0, COALESCE(SUM(t1984.cnt * t1986.cnt), 0) AS cnt FROM (SELECT t1981.i_item_sk, t1981.i_item_sk0, t1981.c_current_cdemo_sk, COALESCE(SUM(t1981.cnt * t1982.cnt), 0) AS cnt FROM (SELECT t1978.i_item_sk, t1978.i_item_sk0, t1979.c_current_addr_sk, t1979.c_current_cdemo_sk, COALESCE(SUM(t1978.cnt * t1979.cnt), 0) AS cnt FROM (SELECT t1974.i_item_sk, t1974.i_item_sk0, t1974.ss_customer_sk, COALESCE(SUM(t1974.cnt * t1976.cnt), 0) AS cnt FROM (SELECT t1970.i_item_sk, t1970.i_item_sk0, t1970.ss_sold_date_sk, t1970.ss_customer_sk, COALESCE(SUM(t1970.f8 * t1972.cnt), 0) AS cnt FROM (SELECT t1967.i_item_sk, t1967.i_item_sk0, t1969.ss_sold_date_sk, t1969.ss_customer_sk, t1969.ss_ticket_number, t1967.cnt * t1969.cnt AS f8 FROM (SELECT t1965.i_item_sk, t1966.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM (SELECT * FROM item WHERE i_category IN ('Children', 'Men')) AS t1965 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 38 AND i_manager_id <= 57) AS t1966 ON t1965.i_item_sk < t1966.i_item_sk GROUP BY t1965.i_item_sk, t1966.i_item_sk) AS t1967 INNER JOIN (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_ticket_number, COUNT(*) AS cnt FROM store_sales WHERE ss_list_price >= 278 AND ss_list_price <= 292 GROUP BY ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_ticket_number) AS t1969 ON t1967.i_item_sk = t1969.ss_item_sk) AS t1970 INNER JOIN (SELECT ss_item_sk, ss_ticket_number, COUNT(*) AS cnt FROM store_sales WHERE ss_list_price >= 278 AND ss_list_price <= 292 GROUP BY ss_item_sk, ss_ticket_number) AS t1972 ON t1970.ss_ticket_number = t1972.ss_ticket_number AND t1970.i_item_sk0 = t1972.ss_item_sk GROUP BY t1970.i_item_sk, t1970.i_item_sk0, t1970.ss_sold_date_sk, t1970.ss_customer_sk) AS t1974 INNER JOIN (SELECT d_date_sk, COUNT(*) AS cnt FROM date_dim WHERE d_year >= 2000 AND d_year <= 2000 + 1 GROUP BY d_date_sk) AS t1976 ON t1974.ss_sold_date_sk = t1976.d_date_sk GROUP BY t1974.i_item_sk, t1974.i_item_sk0, t1974.ss_customer_sk) AS t1978 INNER JOIN (SELECT c_customer_sk, c_current_addr_sk, c_current_cdemo_sk, COUNT(*) AS cnt FROM customer GROUP BY c_customer_sk, c_current_addr_sk, c_current_cdemo_sk) AS t1979 ON t1978.ss_customer_sk = t1979.c_customer_sk GROUP BY t1978.i_item_sk, t1978.i_item_sk0, t1979.c_current_addr_sk, t1979.c_current_cdemo_sk) AS t1981 INNER JOIN (SELECT ca_address_sk, COUNT(*) AS cnt FROM customer_address GROUP BY ca_address_sk) AS t1982 ON t1981.c_current_addr_sk = t1982.ca_address_sk GROUP BY t1981.i_item_sk, t1981.i_item_sk0, t1981.c_current_cdemo_sk) AS t1984 INNER JOIN (SELECT cd_demo_sk, COUNT(*) AS cnt FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Secondary' GROUP BY cd_demo_sk) AS t1986 ON t1984.c_current_cdemo_sk = t1986.cd_demo_sk GROUP BY t1984.i_item_sk, t1984.i_item_sk0 ORDER BY COALESCE(SUM(t1984.cnt * t1986.cnt), 0)","['FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE', 'PROJECT_TO_CALC']",3.631645044,1.361471176,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
85,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Women') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 119 and 133 and s2.ss_list_price between 119 and 133 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;","SELECT item.i_item_sk, item0.i_item_sk AS i_item_sk0, COUNT(*) AS cnt FROM item, item AS item0, store_sales, store_sales AS store_sales0, date_dim, customer, customer_address, customer_demographics WHERE item.i_item_sk < item0.i_item_sk AND store_sales.ss_ticket_number = store_sales0.ss_ticket_number AND (store_sales.ss_item_sk = item.i_item_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (store_sales.ss_customer_sk = customer.c_customer_sk AND customer.c_current_addr_sk = customer_address.ca_address_sk AND (customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk AND (date_dim.d_year >= 2000 AND date_dim.d_year <= 2000 + 1))) AND (date_dim.d_date_sk = store_sales.ss_sold_date_sk AND (item.i_category = 'Jewelry' OR item.i_category = 'Women') AND (item0.i_manager_id >= 81 AND (item0.i_manager_id <= 100 AND customer_demographics.cd_marital_status = 'M')) AND (customer_demographics.cd_education_status = 'Advanced Degree' AND store_sales.ss_list_price >= 119 AND (store_sales.ss_list_price <= 133 AND (store_sales0.ss_list_price >= 119 AND store_sales0.ss_list_price <= 133)))) GROUP BY item.i_item_sk, item0.i_item_sk ORDER BY COUNT(*);","['JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_JOIN_TRANSPOSE']",22.98396357,19.54727944,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
86,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 5 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -7  ;","SELECT MIN(call_center73.cc_call_center_id), MIN(call_center73.cc_name), MIN(call_center73.cc_manager), MIN(catalog_returns73.cr_net_loss), MIN(catalog_returns73.cr_item_sk), MIN(catalog_returns73.cr_order_number) FROM call_center AS call_center73 INNER JOIN catalog_returns AS catalog_returns73 ON call_center73.cc_call_center_sk = catalog_returns73.cr_call_center_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy = 5) AS t866 ON catalog_returns73.cr_returned_date_sk = t866.d_date_sk INNER JOIN customer AS customer73 ON catalog_returns73.cr_returning_customer_sk = customer73.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_gmt_offset = -7) AS t867 ON customer73.c_current_addr_sk = t867.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree') AS t868 ON customer73.c_current_cdemo_sk = t868.cd_demo_sk INNER JOIN (SELECT * FROM household_demographics WHERE hd_buy_potential LIKE '>10000%') AS t869 ON customer73.c_current_hdemo_sk = t869.hd_demo_sk",['FILTER_INTO_JOIN'],0.103585243,0.101479689,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
87,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 9 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -7  ;","SELECT MIN(call_center.cc_call_center_id), MIN(call_center.cc_name), MIN(call_center.cc_manager), MIN(catalog_returns.cr_net_loss), MIN(catalog_returns.cr_item_sk), MIN(catalog_returns.cr_order_number) FROM call_center INNER JOIN catalog_returns ON call_center.cc_call_center_sk = catalog_returns.cr_call_center_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy = 9) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer ON catalog_returns.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_gmt_offset = -7) AS t0 ON customer.c_current_addr_sk = t0.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree') AS t1 ON customer.c_current_cdemo_sk = t1.cd_demo_sk INNER JOIN (SELECT * FROM household_demographics WHERE hd_buy_potential LIKE '0-500%') AS t2 ON customer.c_current_hdemo_sk = t2.hd_demo_sk","['FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS']",0.111792485,0.105145534,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
88,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 1 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7  ;","SELECT MIN(call_center.cc_call_center_id), MIN(call_center.cc_name), MIN(call_center.cc_manager), MIN(catalog_returns.cr_net_loss), MIN(catalog_returns.cr_item_sk), MIN(catalog_returns.cr_order_number) FROM call_center, catalog_returns, date_dim, customer, customer_address, customer_demographics, household_demographics WHERE catalog_returns.cr_call_center_sk = call_center.cc_call_center_sk AND catalog_returns.cr_returned_date_sk = date_dim.d_date_sk AND (catalog_returns.cr_returning_customer_sk = customer.c_customer_sk AND (customer_demographics.cd_demo_sk = customer.c_current_cdemo_sk AND household_demographics.hd_demo_sk = customer.c_current_hdemo_sk)) AND (customer_address.ca_address_sk = customer.c_current_addr_sk AND (date_dim.d_year = 1999 AND date_dim.d_moy = 1) AND ((customer_demographics.cd_marital_status = 'M' AND customer_demographics.cd_education_status = 'Unknown' OR customer_demographics.cd_marital_status = 'W' AND customer_demographics.cd_education_status = 'Advanced Degree') AND (household_demographics.hd_buy_potential LIKE '501-1000%' AND customer_address.ca_gmt_offset = -7)))","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'FILTER_REDUCE_EXPRESSIONS']",0.13894399,0.136921167,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
89,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7  ;","SELECT MIN(call_center.cc_call_center_id), MIN(call_center.cc_name), MIN(call_center.cc_manager), MIN(catalog_returns.cr_net_loss), MIN(catalog_returns.cr_item_sk), MIN(catalog_returns.cr_order_number) FROM call_center INNER JOIN catalog_returns ON call_center.cc_call_center_sk = catalog_returns.cr_call_center_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy = 8) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer ON catalog_returns.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_gmt_offset = -7) AS t0 ON customer.c_current_addr_sk = t0.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree') AS t1 ON customer.c_current_cdemo_sk = t1.cd_demo_sk INNER JOIN (SELECT * FROM household_demographics WHERE hd_buy_potential LIKE '501-1000%') AS t2 ON customer.c_current_hdemo_sk = t2.hd_demo_sk","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE']",0.1113801,0.110200008,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
90,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 9 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -6  ;","SELECT MIN(call_center.cc_call_center_id), MIN(call_center.cc_name), MIN(call_center.cc_manager), MIN(catalog_returns.cr_net_loss), MIN(catalog_returns.cr_item_sk), MIN(catalog_returns.cr_order_number) FROM call_center INNER JOIN catalog_returns ON call_center.cc_call_center_sk = catalog_returns.cr_call_center_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy = 9) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer ON catalog_returns.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_gmt_offset = -6) AS t0 ON customer.c_current_addr_sk = t0.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree') AS t1 ON customer.c_current_cdemo_sk = t1.cd_demo_sk INNER JOIN (SELECT * FROM household_demographics WHERE hd_buy_potential LIKE '501-1000%') AS t2 ON customer.c_current_hdemo_sk = t2.hd_demo_sk;","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH']",0.128503323,0.124410391,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
91,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7  ;","SELECT MIN(call_center.cc_call_center_id), MIN(call_center.cc_name), MIN(call_center.cc_manager), MIN(catalog_returns.cr_net_loss), MIN(catalog_returns.cr_item_sk), MIN(catalog_returns.cr_order_number) FROM call_center, catalog_returns, date_dim, customer, customer_address, customer_demographics, household_demographics WHERE catalog_returns.cr_call_center_sk = call_center.cc_call_center_sk AND catalog_returns.cr_returned_date_sk = date_dim.d_date_sk AND (catalog_returns.cr_returning_customer_sk = customer.c_customer_sk AND (customer_demographics.cd_demo_sk = customer.c_current_cdemo_sk AND household_demographics.hd_demo_sk = customer.c_current_hdemo_sk)) AND (customer_address.ca_address_sk = customer.c_current_addr_sk AND (date_dim.d_year = 2001 AND date_dim.d_moy = 3) AND ((customer_demographics.cd_marital_status = 'M' AND customer_demographics.cd_education_status = 'Unknown' OR customer_demographics.cd_marital_status = 'W' AND customer_demographics.cd_education_status = 'Advanced Degree') AND (household_demographics.hd_buy_potential LIKE '501-1000%' AND customer_address.ca_gmt_offset = -7)))",['AGGREGATE_EXPAND_DISTINCT_AGGREGATES'],0.147847335,0.145630995,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
92,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 10 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -7  ;","SELECT MIN(call_center.cc_call_center_id), MIN(call_center.cc_name), MIN(call_center.cc_manager), MIN(catalog_returns.cr_net_loss), MIN(catalog_returns.cr_item_sk), MIN(catalog_returns.cr_order_number) FROM call_center INNER JOIN catalog_returns ON call_center.cc_call_center_sk = catalog_returns.cr_call_center_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002 AND d_moy = 10) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer ON catalog_returns.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_gmt_offset = -7) AS t0 ON customer.c_current_addr_sk = t0.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree') AS t1 ON customer.c_current_cdemo_sk = t1.cd_demo_sk INNER JOIN (SELECT * FROM household_demographics WHERE hd_buy_potential LIKE 'Unknown%') AS t2 ON customer.c_current_hdemo_sk = t2.hd_demo_sk;","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']",0.249397755,0.138940255,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
93,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -7  ;","SELECT MIN(call_center.cc_call_center_id), MIN(call_center.cc_name), MIN(call_center.cc_manager), MIN(catalog_returns.cr_net_loss), MIN(catalog_returns.cr_item_sk), MIN(catalog_returns.cr_order_number) FROM call_center INNER JOIN catalog_returns ON call_center.cc_call_center_sk = catalog_returns.cr_call_center_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002 AND d_moy = 3) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer ON catalog_returns.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_gmt_offset = -7) AS t0 ON customer.c_current_addr_sk = t0.ca_address_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' OR cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree') AS t1 ON customer.c_current_cdemo_sk = t1.cd_demo_sk INNER JOIN (SELECT * FROM household_demographics WHERE hd_buy_potential LIKE '1001-5000%') AS t2 ON customer.c_current_hdemo_sk = t2.hd_demo_sk;","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']",0.152249813,0.140561978,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
94,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 1 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 1 and 1 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 1 and 1 + 2 and d3.d_year  = 2000  ;","SELECT MIN(t801.EXPR0), MIN(t801.EXPR1), MIN(t800.EXPR2), MIN(t800.EXPR3), MIN(t800.EXPR4), MIN(t800.EXPR5), MIN(t800.EXPR6), MIN(t800.EXPR7), MIN(t800.EXPR8), MIN(t800.EXPR9) FROM (SELECT t798.ss_item_sk, MIN(t799.EXPR2) AS EXPR2, MIN(t799.EXPR3) AS EXPR3, MIN(t798.EXPR4) AS EXPR4, MIN(t798.EXPR5) AS EXPR5, MIN(t798.EXPR6) AS EXPR6, MIN(t798.EXPR7) AS EXPR7, MIN(t798.EXPR8) AS EXPR8, MIN(t798.EXPR9) AS EXPR9 FROM (SELECT t795.ss_item_sk, t795.ss_store_sk, MIN(t795.EXPR4) AS EXPR4, MIN(t795.EXPR5) AS EXPR5, MIN(t795.EXPR6) AS EXPR6, MIN(t795.EXPR7) AS EXPR7, MIN(t795.EXPR8) AS EXPR8, MIN(t795.EXPR9) AS EXPR9 FROM (SELECT t792.ss_item_sk, t792.ss_store_sk, t792.cs_sold_date_sk, MIN(t792.EXPR4) AS EXPR4, MIN(t792.EXPR5) AS EXPR5, MIN(t792.EXPR6) AS EXPR6, MIN(t792.EXPR7) AS EXPR7, MIN(t792.EXPR8) AS EXPR8, MIN(t792.EXPR9) AS EXPR9 FROM (SELECT t789.ss_item_sk, t789.ss_store_sk, t789.sr_returned_date_sk, t789.cs_sold_date_sk, MIN(t789.EXPR4) AS EXPR4, MIN(t789.EXPR5) AS EXPR5, MIN(t789.EXPR6) AS EXPR6, MIN(t789.EXPR7) AS EXPR7, MIN(t789.EXPR8) AS EXPR8, MIN(t789.EXPR9) AS EXPR9 FROM (SELECT t787.ss_sold_date_sk, t787.ss_item_sk, t787.ss_store_sk, t787.sr_returned_date_sk, t788.cs_sold_date_sk, MIN(t787.EXPR4) AS EXPR4, MIN(t787.EXPR5) AS EXPR5, MIN(t788.EXPR6) AS EXPR6, MIN(t787.EXPR7) AS EXPR7, MIN(t787.EXPR8) AS EXPR8, MIN(t788.EXPR9) AS EXPR9 FROM (SELECT t785.ss_sold_date_sk, t785.ss_item_sk, t785.ss_store_sk, t786.sr_returned_date_sk, t786.sr_item_sk, t786.sr_customer_sk, MIN(t785.EXPR4) AS EXPR4, MIN(t786.EXPR5) AS EXPR5, MIN(t785.EXPR7) AS EXPR7, MIN(t786.EXPR8) AS EXPR8 FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number, MIN(ss_net_profit) AS EXPR4, MIN(ss_item_sk) AS EXPR7 FROM store_sales GROUP BY ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number) AS t785 INNER JOIN (SELECT sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number, MIN(sr_net_loss) AS EXPR5, MIN(sr_ticket_number) AS EXPR8 FROM store_returns GROUP BY sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number) AS t786 ON t785.ss_customer_sk = t786.sr_customer_sk AND t785.ss_item_sk = t786.sr_item_sk AND t785.ss_ticket_number = t786.sr_ticket_number GROUP BY t785.ss_sold_date_sk, t785.ss_item_sk, t785.ss_store_sk, t786.sr_returned_date_sk, t786.sr_item_sk, t786.sr_customer_sk) AS t787 INNER JOIN (SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk, MIN(cs_net_profit) AS EXPR6, MIN(cs_order_number) AS EXPR9 FROM catalog_sales GROUP BY cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk) AS t788 ON t787.sr_customer_sk = t788.cs_bill_customer_sk AND t787.sr_item_sk = t788.cs_item_sk GROUP BY t787.ss_sold_date_sk, t787.ss_item_sk, t787.ss_store_sk, t787.sr_returned_date_sk, t788.cs_sold_date_sk) AS t789 INNER JOIN (SELECT d_date_sk FROM date_dim WHERE d_moy = 1 AND d_year = 2000 GROUP BY d_date_sk) AS t791 ON t789.ss_sold_date_sk = t791.d_date_sk GROUP BY t789.ss_item_sk, t789.ss_store_sk, t789.sr_returned_date_sk, t789.cs_sold_date_sk) AS t792 INNER JOIN (SELECT d_date_sk FROM date_dim WHERE d_moy >= 1 AND d_moy <= 1 + 2 AND d_year = 2000 GROUP BY d_date_sk) AS t794 ON t792.sr_returned_date_sk = t794.d_date_sk GROUP BY t792.ss_item_sk, t792.ss_store_sk, t792.cs_sold_date_sk) AS t795 INNER JOIN (SELECT d_date_sk FROM date_dim WHERE d_moy >= 1 AND d_moy <= 1 + 2 AND d_year = 2000 GROUP BY d_date_sk) AS t797 ON t795.cs_sold_date_sk = t797.d_date_sk GROUP BY t795.ss_item_sk, t795.ss_store_sk) AS t798 INNER JOIN (SELECT s_store_sk, MIN(s_store_id) AS EXPR2, MIN(s_store_name) AS EXPR3 FROM store GROUP BY s_store_sk) AS t799 ON t798.ss_store_sk = t799.s_store_sk GROUP BY t798.ss_item_sk) AS t800 INNER JOIN (SELECT i_item_sk, MIN(i_item_id) AS EXPR0, MIN(i_item_desc) AS EXPR1 FROM item GROUP BY i_item_sk) AS t801 ON t800.ss_item_sk = t801.i_item_sk","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE']",300,71.54612501,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
95,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 1 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 1 and 1 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 1 and 1 + 2 and d3.d_year  = 2002  ;","SELECT MIN(t1105.EXPR0), MIN(t1105.EXPR1), MIN(t1104.EXPR2), MIN(t1104.EXPR3), MIN(t1104.EXPR4), MIN(t1104.EXPR5), MIN(t1104.EXPR6), MIN(t1104.EXPR7), MIN(t1104.EXPR8), MIN(t1104.EXPR9) FROM (SELECT t1101.ss_item_sk, MIN(t1102.EXPR2) AS EXPR2, MIN(t1102.EXPR3) AS EXPR3, MIN(t1101.EXPR4) AS EXPR4, MIN(t1101.EXPR5) AS EXPR5, MIN(t1101.EXPR6) AS EXPR6, MIN(t1101.EXPR7) AS EXPR7, MIN(t1101.EXPR8) AS EXPR8, MIN(t1101.EXPR9) AS EXPR9 FROM (SELECT t1097.ss_item_sk, t1097.ss_store_sk, MIN(t1097.EXPR4) AS EXPR4, MIN(t1097.EXPR5) AS EXPR5, MIN(t1097.EXPR6) AS EXPR6, MIN(t1097.EXPR7) AS EXPR7, MIN(t1097.EXPR8) AS EXPR8, MIN(t1097.EXPR9) AS EXPR9 FROM (SELECT t1093.ss_item_sk, t1093.ss_store_sk, t1093.cs_sold_date_sk, MIN(t1093.EXPR4) AS EXPR4, MIN(t1093.EXPR5) AS EXPR5, MIN(t1093.EXPR6) AS EXPR6, MIN(t1093.EXPR7) AS EXPR7, MIN(t1093.EXPR8) AS EXPR8, MIN(t1093.EXPR9) AS EXPR9 FROM (SELECT t1089.ss_item_sk, t1089.ss_store_sk, t1089.sr_returned_date_sk, t1089.cs_sold_date_sk, MIN(t1089.EXPR4) AS EXPR4, MIN(t1089.EXPR5) AS EXPR5, MIN(t1089.EXPR6) AS EXPR6, MIN(t1089.EXPR7) AS EXPR7, MIN(t1089.EXPR8) AS EXPR8, MIN(t1089.EXPR9) AS EXPR9 FROM (SELECT t1086.ss_sold_date_sk, t1086.ss_item_sk, t1086.ss_store_sk, t1086.sr_returned_date_sk, t1087.cs_sold_date_sk, MIN(t1086.EXPR4) AS EXPR4, MIN(t1086.EXPR5) AS EXPR5, MIN(t1087.EXPR6) AS EXPR6, MIN(t1086.EXPR7) AS EXPR7, MIN(t1086.EXPR8) AS EXPR8, MIN(t1087.EXPR9) AS EXPR9 FROM (SELECT t1083.ss_sold_date_sk, t1083.ss_item_sk, t1083.ss_store_sk, t1084.sr_returned_date_sk, t1084.sr_item_sk, t1084.sr_customer_sk, MIN(t1083.EXPR4) AS EXPR4, MIN(t1084.EXPR5) AS EXPR5, MIN(t1083.EXPR7) AS EXPR7, MIN(t1084.EXPR8) AS EXPR8 FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number, MIN(ss_net_profit) AS EXPR4, MIN(ss_item_sk) AS EXPR7 FROM store_sales GROUP BY ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number) AS t1083, (SELECT sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number, MIN(sr_net_loss) AS EXPR5, MIN(sr_ticket_number) AS EXPR8 FROM store_returns GROUP BY sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number) AS t1084 WHERE t1083.ss_customer_sk = t1084.sr_customer_sk AND t1083.ss_item_sk = t1084.sr_item_sk AND t1083.ss_ticket_number = t1084.sr_ticket_number GROUP BY t1083.ss_sold_date_sk, t1083.ss_item_sk, t1083.ss_store_sk, t1084.sr_returned_date_sk, t1084.sr_item_sk, t1084.sr_customer_sk) AS t1086, (SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk, MIN(cs_net_profit) AS EXPR6, MIN(cs_order_number) AS EXPR9 FROM catalog_sales GROUP BY cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk) AS t1087 WHERE t1086.sr_customer_sk = t1087.cs_bill_customer_sk AND t1086.sr_item_sk = t1087.cs_item_sk GROUP BY t1086.ss_sold_date_sk, t1086.ss_item_sk, t1086.ss_store_sk, t1086.sr_returned_date_sk, t1087.cs_sold_date_sk) AS t1089, (SELECT d_date_sk FROM date_dim WHERE d_moy = 1 AND d_year = 2002 GROUP BY d_date_sk) AS t1091 WHERE t1091.d_date_sk = t1089.ss_sold_date_sk GROUP BY t1089.ss_item_sk, t1089.ss_store_sk, t1089.sr_returned_date_sk, t1089.cs_sold_date_sk) AS t1093, (SELECT d_date_sk FROM date_dim WHERE d_moy >= 1 AND d_moy <= 1 + 2 AND d_year = 2002 GROUP BY d_date_sk) AS t1095 WHERE t1093.sr_returned_date_sk = t1095.d_date_sk GROUP BY t1093.ss_item_sk, t1093.ss_store_sk, t1093.cs_sold_date_sk) AS t1097, (SELECT d_date_sk FROM date_dim WHERE d_moy >= 1 AND d_moy <= 1 + 2 AND d_year = 2002 GROUP BY d_date_sk) AS t1099 WHERE t1097.cs_sold_date_sk = t1099.d_date_sk GROUP BY t1097.ss_item_sk, t1097.ss_store_sk) AS t1101, (SELECT s_store_sk, MIN(s_store_id) AS EXPR2, MIN(s_store_name) AS EXPR3 FROM store GROUP BY s_store_sk) AS t1102 WHERE t1102.s_store_sk = t1101.ss_store_sk GROUP BY t1101.ss_item_sk) AS t1104, (SELECT i_item_sk, MIN(i_item_id) AS EXPR0, MIN(i_item_desc) AS EXPR1 FROM item GROUP BY i_item_sk) AS t1105 WHERE t1105.i_item_sk = t1104.ss_item_sk","['FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE', 'JOIN_EXTRACT_FILTER']",300,70.6885306,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
96,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 1998  ;","SELECT MIN(t830.EXPR0), MIN(t830.EXPR1), MIN(t829.EXPR2), MIN(t829.EXPR3), MIN(t829.EXPR4), MIN(t829.EXPR5), MIN(t829.EXPR6), MIN(t829.EXPR7), MIN(t829.EXPR8), MIN(t829.EXPR9) FROM (SELECT t826.ss_item_sk, MIN(t827.EXPR2) AS EXPR2, MIN(t827.EXPR3) AS EXPR3, MIN(t826.EXPR4) AS EXPR4, MIN(t826.EXPR5) AS EXPR5, MIN(t826.EXPR6) AS EXPR6, MIN(t826.EXPR7) AS EXPR7, MIN(t826.EXPR8) AS EXPR8, MIN(t826.EXPR9) AS EXPR9 FROM (SELECT t822.ss_item_sk, t822.ss_store_sk, MIN(t822.EXPR4) AS EXPR4, MIN(t822.EXPR5) AS EXPR5, MIN(t822.EXPR6) AS EXPR6, MIN(t822.EXPR7) AS EXPR7, MIN(t822.EXPR8) AS EXPR8, MIN(t822.EXPR9) AS EXPR9 FROM (SELECT t818.ss_item_sk, t818.ss_store_sk, t818.cs_sold_date_sk, MIN(t818.EXPR4) AS EXPR4, MIN(t818.EXPR5) AS EXPR5, MIN(t818.EXPR6) AS EXPR6, MIN(t818.EXPR7) AS EXPR7, MIN(t818.EXPR8) AS EXPR8, MIN(t818.EXPR9) AS EXPR9 FROM (SELECT t814.ss_item_sk, t814.ss_store_sk, t814.sr_returned_date_sk, t814.cs_sold_date_sk, MIN(t814.EXPR4) AS EXPR4, MIN(t814.EXPR5) AS EXPR5, MIN(t814.EXPR6) AS EXPR6, MIN(t814.EXPR7) AS EXPR7, MIN(t814.EXPR8) AS EXPR8, MIN(t814.EXPR9) AS EXPR9 FROM (SELECT t811.ss_sold_date_sk, t811.ss_item_sk, t811.ss_store_sk, t811.sr_returned_date_sk, t812.cs_sold_date_sk, MIN(t811.EXPR4) AS EXPR4, MIN(t811.EXPR5) AS EXPR5, MIN(t812.EXPR6) AS EXPR6, MIN(t811.EXPR7) AS EXPR7, MIN(t811.EXPR8) AS EXPR8, MIN(t812.EXPR9) AS EXPR9 FROM (SELECT t808.ss_sold_date_sk, t808.ss_item_sk, t808.ss_store_sk, t809.sr_returned_date_sk, t809.sr_item_sk, t809.sr_customer_sk, MIN(t808.EXPR4) AS EXPR4, MIN(t809.EXPR5) AS EXPR5, MIN(t808.EXPR7) AS EXPR7, MIN(t809.EXPR8) AS EXPR8 FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number, MIN(ss_net_profit) AS EXPR4, MIN(ss_item_sk) AS EXPR7 FROM store_sales GROUP BY ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number) AS t808, (SELECT sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number, MIN(sr_net_loss) AS EXPR5, MIN(sr_ticket_number) AS EXPR8 FROM store_returns GROUP BY sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number) AS t809 WHERE t808.ss_customer_sk = t809.sr_customer_sk AND t808.ss_item_sk = t809.sr_item_sk AND t808.ss_ticket_number = t809.sr_ticket_number GROUP BY t808.ss_sold_date_sk, t808.ss_item_sk, t808.ss_store_sk, t809.sr_returned_date_sk, t809.sr_item_sk, t809.sr_customer_sk) AS t811, (SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk, MIN(cs_net_profit) AS EXPR6, MIN(cs_order_number) AS EXPR9 FROM catalog_sales GROUP BY cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk) AS t812 WHERE t811.sr_customer_sk = t812.cs_bill_customer_sk AND t811.sr_item_sk = t812.cs_item_sk GROUP BY t811.ss_sold_date_sk, t811.ss_item_sk, t811.ss_store_sk, t811.sr_returned_date_sk, t812.cs_sold_date_sk) AS t814, (SELECT d_date_sk FROM date_dim WHERE d_moy = 10 AND d_year = 1998 GROUP BY d_date_sk) AS t816 WHERE t816.d_date_sk = t814.ss_sold_date_sk GROUP BY t814.ss_item_sk, t814.ss_store_sk, t814.sr_returned_date_sk, t814.cs_sold_date_sk) AS t818, (SELECT d_date_sk FROM date_dim WHERE d_moy >= 10 AND d_moy <= 10 + 2 AND d_year = 1998 GROUP BY d_date_sk) AS t820 WHERE t818.sr_returned_date_sk = t820.d_date_sk GROUP BY t818.ss_item_sk, t818.ss_store_sk, t818.cs_sold_date_sk) AS t822, (SELECT d_date_sk FROM date_dim WHERE d_moy >= 10 AND d_moy <= 10 + 2 AND d_year = 1998 GROUP BY d_date_sk) AS t824 WHERE t822.cs_sold_date_sk = t824.d_date_sk GROUP BY t822.ss_item_sk, t822.ss_store_sk) AS t826, (SELECT s_store_sk, MIN(s_store_id) AS EXPR2, MIN(s_store_name) AS EXPR3 FROM store GROUP BY s_store_sk) AS t827 WHERE t827.s_store_sk = t826.ss_store_sk GROUP BY t826.ss_item_sk) AS t829, (SELECT i_item_sk, MIN(i_item_id) AS EXPR0, MIN(i_item_desc) AS EXPR1 FROM item GROUP BY i_item_sk) AS t830 WHERE t830.i_item_sk = t829.ss_item_sk","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE', 'JOIN_EXTRACT_FILTER']",300,70.92969839,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
97,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 1999  ;","SELECT MIN(t1134.EXPR0), MIN(t1134.EXPR1), MIN(t1133.EXPR2), MIN(t1133.EXPR3), MIN(t1133.EXPR4), MIN(t1133.EXPR5), MIN(t1133.EXPR6), MIN(t1133.EXPR7), MIN(t1133.EXPR8), MIN(t1133.EXPR9) FROM (SELECT t1131.ss_item_sk, MIN(t1132.EXPR2) AS EXPR2, MIN(t1132.EXPR3) AS EXPR3, MIN(t1131.EXPR4) AS EXPR4, MIN(t1131.EXPR5) AS EXPR5, MIN(t1131.EXPR6) AS EXPR6, MIN(t1131.EXPR7) AS EXPR7, MIN(t1131.EXPR8) AS EXPR8, MIN(t1131.EXPR9) AS EXPR9 FROM (SELECT t1128.ss_item_sk, t1128.ss_store_sk, MIN(t1128.EXPR4) AS EXPR4, MIN(t1128.EXPR5) AS EXPR5, MIN(t1128.EXPR6) AS EXPR6, MIN(t1128.EXPR7) AS EXPR7, MIN(t1128.EXPR8) AS EXPR8, MIN(t1128.EXPR9) AS EXPR9 FROM (SELECT t1125.ss_item_sk, t1125.ss_store_sk, t1125.cs_sold_date_sk, MIN(t1125.EXPR4) AS EXPR4, MIN(t1125.EXPR5) AS EXPR5, MIN(t1125.EXPR6) AS EXPR6, MIN(t1125.EXPR7) AS EXPR7, MIN(t1125.EXPR8) AS EXPR8, MIN(t1125.EXPR9) AS EXPR9 FROM (SELECT t1122.ss_item_sk, t1122.ss_store_sk, t1122.sr_returned_date_sk, t1122.cs_sold_date_sk, MIN(t1122.EXPR4) AS EXPR4, MIN(t1122.EXPR5) AS EXPR5, MIN(t1122.EXPR6) AS EXPR6, MIN(t1122.EXPR7) AS EXPR7, MIN(t1122.EXPR8) AS EXPR8, MIN(t1122.EXPR9) AS EXPR9 FROM (SELECT t1120.ss_sold_date_sk, t1120.ss_item_sk, t1120.ss_store_sk, t1120.sr_returned_date_sk, t1121.cs_sold_date_sk, MIN(t1120.EXPR4) AS EXPR4, MIN(t1120.EXPR5) AS EXPR5, MIN(t1121.EXPR6) AS EXPR6, MIN(t1120.EXPR7) AS EXPR7, MIN(t1120.EXPR8) AS EXPR8, MIN(t1121.EXPR9) AS EXPR9 FROM (SELECT t1118.ss_sold_date_sk, t1118.ss_item_sk, t1118.ss_store_sk, t1119.sr_returned_date_sk, t1119.sr_item_sk, t1119.sr_customer_sk, MIN(t1118.EXPR4) AS EXPR4, MIN(t1119.EXPR5) AS EXPR5, MIN(t1118.EXPR7) AS EXPR7, MIN(t1119.EXPR8) AS EXPR8 FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number, MIN(ss_net_profit) AS EXPR4, MIN(ss_item_sk) AS EXPR7 FROM store_sales GROUP BY ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number) AS t1118 INNER JOIN (SELECT sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number, MIN(sr_net_loss) AS EXPR5, MIN(sr_ticket_number) AS EXPR8 FROM store_returns GROUP BY sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number) AS t1119 ON t1118.ss_customer_sk = t1119.sr_customer_sk AND t1118.ss_item_sk = t1119.sr_item_sk AND t1118.ss_ticket_number = t1119.sr_ticket_number GROUP BY t1118.ss_sold_date_sk, t1118.ss_item_sk, t1118.ss_store_sk, t1119.sr_returned_date_sk, t1119.sr_item_sk, t1119.sr_customer_sk) AS t1120 INNER JOIN (SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk, MIN(cs_net_profit) AS EXPR6, MIN(cs_order_number) AS EXPR9 FROM catalog_sales GROUP BY cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk) AS t1121 ON t1120.sr_customer_sk = t1121.cs_bill_customer_sk AND t1120.sr_item_sk = t1121.cs_item_sk GROUP BY t1120.ss_sold_date_sk, t1120.ss_item_sk, t1120.ss_store_sk, t1120.sr_returned_date_sk, t1121.cs_sold_date_sk) AS t1122 INNER JOIN (SELECT d_date_sk FROM date_dim WHERE d_moy = 10 AND d_year = 1999 GROUP BY d_date_sk) AS t1124 ON t1122.ss_sold_date_sk = t1124.d_date_sk GROUP BY t1122.ss_item_sk, t1122.ss_store_sk, t1122.sr_returned_date_sk, t1122.cs_sold_date_sk) AS t1125 INNER JOIN (SELECT d_date_sk FROM date_dim WHERE d_moy >= 10 AND d_moy <= 10 + 2 AND d_year = 1999 GROUP BY d_date_sk) AS t1127 ON t1125.sr_returned_date_sk = t1127.d_date_sk GROUP BY t1125.ss_item_sk, t1125.ss_store_sk, t1125.cs_sold_date_sk) AS t1128 INNER JOIN (SELECT d_date_sk FROM date_dim WHERE d_moy >= 10 AND d_moy <= 10 + 2 AND d_year = 1999 GROUP BY d_date_sk) AS t1130 ON t1128.cs_sold_date_sk = t1130.d_date_sk GROUP BY t1128.ss_item_sk, t1128.ss_store_sk) AS t1131 INNER JOIN (SELECT s_store_sk, MIN(s_store_id) AS EXPR2, MIN(s_store_name) AS EXPR3 FROM store GROUP BY s_store_sk) AS t1132 ON t1131.ss_store_sk = t1132.s_store_sk GROUP BY t1131.ss_item_sk) AS t1133 INNER JOIN (SELECT i_item_sk, MIN(i_item_id) AS EXPR0, MIN(i_item_desc) AS EXPR1 FROM item GROUP BY i_item_sk) AS t1134 ON t1133.ss_item_sk = t1134.i_item_sk","['FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE']",300,70.11296932,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
98,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 2 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 2 and 2 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 2 and 2 + 2 and d3.d_year  = 1998  ;","SELECT MIN(t780.EXPR0), MIN(t780.EXPR1), MIN(t779.EXPR2), MIN(t779.EXPR3), MIN(t779.EXPR4), MIN(t779.EXPR5), MIN(t779.EXPR6), MIN(t779.EXPR7), MIN(t779.EXPR8), MIN(t779.EXPR9) FROM (SELECT t776.ss_item_sk, MIN(t777.EXPR2) AS EXPR2, MIN(t777.EXPR3) AS EXPR3, MIN(t776.EXPR4) AS EXPR4, MIN(t776.EXPR5) AS EXPR5, MIN(t776.EXPR6) AS EXPR6, MIN(t776.EXPR7) AS EXPR7, MIN(t776.EXPR8) AS EXPR8, MIN(t776.EXPR9) AS EXPR9 FROM (SELECT t772.ss_item_sk, t772.ss_store_sk, MIN(t772.EXPR4) AS EXPR4, MIN(t772.EXPR5) AS EXPR5, MIN(t772.EXPR6) AS EXPR6, MIN(t772.EXPR7) AS EXPR7, MIN(t772.EXPR8) AS EXPR8, MIN(t772.EXPR9) AS EXPR9 FROM (SELECT t768.ss_item_sk, t768.ss_store_sk, t768.cs_sold_date_sk, MIN(t768.EXPR4) AS EXPR4, MIN(t768.EXPR5) AS EXPR5, MIN(t768.EXPR6) AS EXPR6, MIN(t768.EXPR7) AS EXPR7, MIN(t768.EXPR8) AS EXPR8, MIN(t768.EXPR9) AS EXPR9 FROM (SELECT t764.ss_item_sk, t764.ss_store_sk, t764.sr_returned_date_sk, t764.cs_sold_date_sk, MIN(t764.EXPR4) AS EXPR4, MIN(t764.EXPR5) AS EXPR5, MIN(t764.EXPR6) AS EXPR6, MIN(t764.EXPR7) AS EXPR7, MIN(t764.EXPR8) AS EXPR8, MIN(t764.EXPR9) AS EXPR9 FROM (SELECT t761.ss_sold_date_sk, t761.ss_item_sk, t761.ss_store_sk, t761.sr_returned_date_sk, t762.cs_sold_date_sk, MIN(t761.EXPR4) AS EXPR4, MIN(t761.EXPR5) AS EXPR5, MIN(t762.EXPR6) AS EXPR6, MIN(t761.EXPR7) AS EXPR7, MIN(t761.EXPR8) AS EXPR8, MIN(t762.EXPR9) AS EXPR9 FROM (SELECT t758.ss_sold_date_sk, t758.ss_item_sk, t758.ss_store_sk, t759.sr_returned_date_sk, t759.sr_item_sk, t759.sr_customer_sk, MIN(t758.EXPR4) AS EXPR4, MIN(t759.EXPR5) AS EXPR5, MIN(t758.EXPR7) AS EXPR7, MIN(t759.EXPR8) AS EXPR8 FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number, MIN(ss_net_profit) AS EXPR4, MIN(ss_item_sk) AS EXPR7 FROM store_sales GROUP BY ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number) AS t758, (SELECT sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number, MIN(sr_net_loss) AS EXPR5, MIN(sr_ticket_number) AS EXPR8 FROM store_returns GROUP BY sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number) AS t759 WHERE t758.ss_customer_sk = t759.sr_customer_sk AND t758.ss_item_sk = t759.sr_item_sk AND t758.ss_ticket_number = t759.sr_ticket_number GROUP BY t758.ss_sold_date_sk, t758.ss_item_sk, t758.ss_store_sk, t759.sr_returned_date_sk, t759.sr_item_sk, t759.sr_customer_sk) AS t761, (SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk, MIN(cs_net_profit) AS EXPR6, MIN(cs_order_number) AS EXPR9 FROM catalog_sales GROUP BY cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk) AS t762 WHERE t761.sr_customer_sk = t762.cs_bill_customer_sk AND t761.sr_item_sk = t762.cs_item_sk GROUP BY t761.ss_sold_date_sk, t761.ss_item_sk, t761.ss_store_sk, t761.sr_returned_date_sk, t762.cs_sold_date_sk) AS t764, (SELECT d_date_sk FROM date_dim WHERE d_moy = 2 AND d_year = 1998 GROUP BY d_date_sk) AS t766 WHERE t766.d_date_sk = t764.ss_sold_date_sk GROUP BY t764.ss_item_sk, t764.ss_store_sk, t764.sr_returned_date_sk, t764.cs_sold_date_sk) AS t768, (SELECT d_date_sk FROM date_dim WHERE d_moy >= 2 AND d_moy <= 2 + 2 AND d_year = 1998 GROUP BY d_date_sk) AS t770 WHERE t768.sr_returned_date_sk = t770.d_date_sk GROUP BY t768.ss_item_sk, t768.ss_store_sk, t768.cs_sold_date_sk) AS t772, (SELECT d_date_sk FROM date_dim WHERE d_moy >= 2 AND d_moy <= 2 + 2 AND d_year = 1998 GROUP BY d_date_sk) AS t774 WHERE t772.cs_sold_date_sk = t774.d_date_sk GROUP BY t772.ss_item_sk, t772.ss_store_sk) AS t776, (SELECT s_store_sk, MIN(s_store_id) AS EXPR2, MIN(s_store_name) AS EXPR3 FROM store GROUP BY s_store_sk) AS t777 WHERE t777.s_store_sk = t776.ss_store_sk GROUP BY t776.ss_item_sk) AS t779, (SELECT i_item_sk, MIN(i_item_id) AS EXPR0, MIN(i_item_desc) AS EXPR1 FROM item GROUP BY i_item_sk) AS t780 WHERE t780.i_item_sk = t779.ss_item_sk","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE', 'JOIN_EXTRACT_FILTER']",300,74.56292359,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
99,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 2001  ;","SELECT MIN(item.i_item_id), MIN(item.i_item_desc), MIN(t7.s_store_id), MIN(t7.s_store_name), MIN(t7.ss_net_profit), MIN(t7.sr_net_loss), MIN(t7.cs_net_profit), MIN(t7.ss_item_sk), MIN(t7.sr_ticket_number), MIN(t7.cs_order_number) FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM store_sales, store_returns WHERE store_sales.ss_customer_sk = store_returns.sr_customer_sk AND store_sales.ss_item_sk = store_returns.sr_item_sk AND store_sales.ss_ticket_number = store_returns.sr_ticket_number) AS t, catalog_sales WHERE t.sr_customer_sk = catalog_sales.cs_bill_customer_sk AND t.sr_item_sk = catalog_sales.cs_item_sk) AS t0, (SELECT * FROM date_dim WHERE d_moy = 4 AND d_year = 2001) AS t1 WHERE t1.d_date_sk = t0.ss_sold_date_sk) AS t2, (SELECT * FROM date_dim WHERE d_moy >= 4 AND d_moy <= 4 + 2 AND d_year = 2001) AS t3 WHERE t2.sr_returned_date_sk = t3.d_date_sk) AS t4, (SELECT * FROM date_dim WHERE d_moy >= 4 AND d_moy <= 4 + 2 AND d_year = 2001) AS t5 WHERE t4.cs_sold_date_sk = t5.d_date_sk) AS t6, store WHERE store.s_store_sk = t6.ss_store_sk) AS t7, item WHERE item.i_item_sk = t7.ss_item_sk;","['JOIN_CONDITION_PUSH', 'FILTER_INTO_JOIN', 'FILTER_MERGE', 'JOIN_EXTRACT_FILTER', 'AGGREGATE_PROJECT_MERGE']",40.84263023,40.46327011,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
100,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 2002  ;","SELECT MIN(item50.i_item_id), MIN(item50.i_item_desc), MIN(t659.s_store_id), MIN(t659.s_store_name), MIN(t659.ss_net_profit), MIN(t659.sr_net_loss), MIN(t659.cs_net_profit), MIN(t659.ss_item_sk), MIN(t659.sr_ticket_number), MIN(t659.cs_order_number) FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM store_sales AS store_sales50, store_returns AS store_returns50 WHERE store_sales50.ss_customer_sk = store_returns50.sr_customer_sk AND store_sales50.ss_item_sk = store_returns50.sr_item_sk AND store_sales50.ss_ticket_number = store_returns50.sr_ticket_number) AS t651, catalog_sales AS catalog_sales50 WHERE t651.sr_customer_sk = catalog_sales50.cs_bill_customer_sk AND t651.sr_item_sk = catalog_sales50.cs_item_sk) AS t652, (SELECT * FROM date_dim WHERE d_moy = 5 AND d_year = 2002) AS t653 WHERE t653.d_date_sk = t652.ss_sold_date_sk) AS t654, (SELECT * FROM date_dim WHERE d_moy >= 5 AND d_moy <= 5 + 2 AND d_year = 2002) AS t655 WHERE t654.sr_returned_date_sk = t655.d_date_sk) AS t656, (SELECT * FROM date_dim WHERE d_moy >= 5 AND d_moy <= 5 + 2 AND d_year = 2002) AS t657 WHERE t656.cs_sold_date_sk = t657.d_date_sk) AS t658, store AS store50 WHERE store50.s_store_sk = t658.ss_store_sk) AS t659, item AS item50 WHERE item50.i_item_sk = t659.ss_item_sk","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER']",300,27.46607033,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
101,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 2002  ;","SELECT MIN(t313.EXPR0), MIN(t313.EXPR1), MIN(t312.EXPR2), MIN(t312.EXPR3), MIN(t312.EXPR4), MIN(t312.EXPR5), MIN(t312.EXPR6), MIN(t312.EXPR7), MIN(t312.EXPR8), MIN(t312.EXPR9) FROM (SELECT t309.ss_item_sk, MIN(t310.EXPR2) AS EXPR2, MIN(t310.EXPR3) AS EXPR3, MIN(t309.EXPR4) AS EXPR4, MIN(t309.EXPR5) AS EXPR5, MIN(t309.EXPR6) AS EXPR6, MIN(t309.EXPR7) AS EXPR7, MIN(t309.EXPR8) AS EXPR8, MIN(t309.EXPR9) AS EXPR9 FROM (SELECT t305.ss_item_sk, t305.ss_store_sk, MIN(t305.EXPR4) AS EXPR4, MIN(t305.EXPR5) AS EXPR5, MIN(t305.EXPR6) AS EXPR6, MIN(t305.EXPR7) AS EXPR7, MIN(t305.EXPR8) AS EXPR8, MIN(t305.EXPR9) AS EXPR9 FROM (SELECT t301.ss_item_sk, t301.ss_store_sk, t301.cs_sold_date_sk, MIN(t301.EXPR4) AS EXPR4, MIN(t301.EXPR5) AS EXPR5, MIN(t301.EXPR6) AS EXPR6, MIN(t301.EXPR7) AS EXPR7, MIN(t301.EXPR8) AS EXPR8, MIN(t301.EXPR9) AS EXPR9 FROM (SELECT t297.ss_item_sk, t297.ss_store_sk, t297.sr_returned_date_sk, t297.cs_sold_date_sk, MIN(t297.EXPR4) AS EXPR4, MIN(t297.EXPR5) AS EXPR5, MIN(t297.EXPR6) AS EXPR6, MIN(t297.EXPR7) AS EXPR7, MIN(t297.EXPR8) AS EXPR8, MIN(t297.EXPR9) AS EXPR9 FROM (SELECT t294.ss_sold_date_sk, t294.ss_item_sk, t294.ss_store_sk, t294.sr_returned_date_sk, t295.cs_sold_date_sk, MIN(t294.EXPR4) AS EXPR4, MIN(t294.EXPR5) AS EXPR5, MIN(t295.EXPR6) AS EXPR6, MIN(t294.EXPR7) AS EXPR7, MIN(t294.EXPR8) AS EXPR8, MIN(t295.EXPR9) AS EXPR9 FROM (SELECT t291.ss_sold_date_sk, t291.ss_item_sk, t291.ss_store_sk, t292.sr_returned_date_sk, t292.sr_item_sk, t292.sr_customer_sk, MIN(t291.EXPR4) AS EXPR4, MIN(t292.EXPR5) AS EXPR5, MIN(t291.EXPR7) AS EXPR7, MIN(t292.EXPR8) AS EXPR8 FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number, MIN(ss_net_profit) AS EXPR4, MIN(ss_item_sk) AS EXPR7 FROM store_sales GROUP BY ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number) AS t291, (SELECT sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number, MIN(sr_net_loss) AS EXPR5, MIN(sr_ticket_number) AS EXPR8 FROM store_returns GROUP BY sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number) AS t292 WHERE t291.ss_customer_sk = t292.sr_customer_sk AND t291.ss_item_sk = t292.sr_item_sk AND t291.ss_ticket_number = t292.sr_ticket_number GROUP BY t291.ss_sold_date_sk, t291.ss_item_sk, t291.ss_store_sk, t292.sr_returned_date_sk, t292.sr_item_sk, t292.sr_customer_sk) AS t294, (SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk, MIN(cs_net_profit) AS EXPR6, MIN(cs_order_number) AS EXPR9 FROM catalog_sales GROUP BY cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk) AS t295 WHERE t294.sr_customer_sk = t295.cs_bill_customer_sk AND t294.sr_item_sk = t295.cs_item_sk GROUP BY t294.ss_sold_date_sk, t294.ss_item_sk, t294.ss_store_sk, t294.sr_returned_date_sk, t295.cs_sold_date_sk) AS t297, (SELECT d_date_sk FROM date_dim WHERE d_moy = 7 AND d_year = 2002 GROUP BY d_date_sk) AS t299 WHERE t299.d_date_sk = t297.ss_sold_date_sk GROUP BY t297.ss_item_sk, t297.ss_store_sk, t297.sr_returned_date_sk, t297.cs_sold_date_sk) AS t301, (SELECT d_date_sk FROM date_dim WHERE d_moy >= 7 AND d_moy <= 7 + 2 AND d_year = 2002 GROUP BY d_date_sk) AS t303 WHERE t301.sr_returned_date_sk = t303.d_date_sk GROUP BY t301.ss_item_sk, t301.ss_store_sk, t301.cs_sold_date_sk) AS t305, (SELECT d_date_sk FROM date_dim WHERE d_moy >= 7 AND d_moy <= 7 + 2 AND d_year = 2002 GROUP BY d_date_sk) AS t307 WHERE t305.cs_sold_date_sk = t307.d_date_sk GROUP BY t305.ss_item_sk, t305.ss_store_sk) AS t309, (SELECT s_store_sk, MIN(s_store_id) AS EXPR2, MIN(s_store_name) AS EXPR3 FROM store GROUP BY s_store_sk) AS t310 WHERE t310.s_store_sk = t309.ss_store_sk GROUP BY t309.ss_item_sk) AS t312, (SELECT i_item_sk, MIN(i_item_id) AS EXPR0, MIN(i_item_desc) AS EXPR1 FROM item GROUP BY i_item_sk) AS t313 WHERE t313.i_item_sk = t312.ss_item_sk","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE', 'JOIN_EXTRACT_FILTER']",300,70.97998238,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
102,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 8 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 8 and 8 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 8 and 8 + 2 and d3.d_year  = 2002  ;","SELECT MIN(item70.i_item_id), MIN(item70.i_item_desc), MIN(store70.s_store_id), MIN(store70.s_store_name), MIN(store_sales70.ss_net_profit), MIN(store_returns70.sr_net_loss), MIN(catalog_sales70.cs_net_profit), MIN(store_sales70.ss_item_sk), MIN(store_returns70.sr_ticket_number), MIN(catalog_sales70.cs_order_number) FROM store_sales AS store_sales70 INNER JOIN store_returns AS store_returns70 ON store_sales70.ss_customer_sk = store_returns70.sr_customer_sk AND store_sales70.ss_item_sk = store_returns70.sr_item_sk AND store_sales70.ss_ticket_number = store_returns70.sr_ticket_number INNER JOIN catalog_sales AS catalog_sales70 ON store_returns70.sr_customer_sk = catalog_sales70.cs_bill_customer_sk AND store_returns70.sr_item_sk = catalog_sales70.cs_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_moy = 8 AND d_year = 2002) AS t1094 ON store_sales70.ss_sold_date_sk = t1094.d_date_sk INNER JOIN (SELECT * FROM date_dim WHERE d_moy >= 8 AND d_moy <= 8 + 2 AND d_year = 2002) AS t1095 ON store_returns70.sr_returned_date_sk = t1095.d_date_sk INNER JOIN (SELECT * FROM date_dim WHERE d_moy >= 8 AND d_moy <= 8 + 2 AND d_year = 2002) AS t1096 ON catalog_sales70.cs_sold_date_sk = t1096.d_date_sk INNER JOIN store AS store70 ON store_sales70.ss_store_sk = store70.s_store_sk INNER JOIN item AS item70 ON store_sales70.ss_item_sk = item70.i_item_sk",['FILTER_INTO_JOIN'],28.12263306,26.09917696,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
103,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = '2 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 3 and  ca_state in ('GA', 'ME', 'NC')  and cs_wholesale_cost BETWEEN 84 AND 89  AND i_category = 'Books'  ;","SELECT MIN(t1114.EXPR0), MIN(t1112.EXPR1), MIN(t1112.EXPR2), MIN(t1112.EXPR3), MIN(t1112.EXPR4), MIN(t1112.EXPR5), MIN(t1112.EXPR6), MIN(t1112.EXPR7), MIN(t1112.EXPR8), MIN(t1112.EXPR9), MIN(t1112.EXPR10) FROM (SELECT t1109.cs_item_sk, MIN(t1109.EXPR1) AS EXPR1, MIN(t1109.EXPR2) AS EXPR2, MIN(t1109.EXPR3) AS EXPR3, MIN(t1109.EXPR4) AS EXPR4, MIN(t1109.EXPR5) AS EXPR5, MIN(t1109.EXPR6) AS EXPR6, MIN(t1109.EXPR7) AS EXPR7, MIN(t1109.EXPR8) AS EXPR8, MIN(t1109.EXPR9) AS EXPR9, MIN(t1109.EXPR10) AS EXPR10 FROM (SELECT t1106.cs_sold_date_sk, t1106.cs_item_sk, MIN(t1108.EXPR1) AS EXPR1, MIN(t1108.EXPR2) AS EXPR2, MIN(t1108.EXPR3) AS EXPR3, MIN(t1106.EXPR4) AS EXPR4, MIN(t1106.EXPR5) AS EXPR5, MIN(t1106.EXPR6) AS EXPR6, MIN(t1106.EXPR7) AS EXPR7, MIN(t1106.EXPR8) AS EXPR8, MIN(t1106.EXPR9) AS EXPR9, MIN(t1106.EXPR10) AS EXPR10 FROM (SELECT t1103.cs_sold_date_sk, t1103.cs_item_sk, t1105.c_current_addr_sk, MIN(t1103.EXPR4) AS EXPR4, MIN(t1103.EXPR5) AS EXPR5, MIN(t1103.EXPR6) AS EXPR6, MIN(t1103.EXPR7) AS EXPR7, MIN(t1103.EXPR8) AS EXPR8, MIN(t1105.EXPR9) AS EXPR9, MIN(t1103.EXPR10) AS EXPR10 FROM (SELECT t1100.cs_sold_date_sk, t1100.cs_bill_customer_sk, t1100.cs_item_sk, MIN(t1100.EXPR4) AS EXPR4, MIN(t1100.EXPR5) AS EXPR5, MIN(t1100.EXPR6) AS EXPR6, MIN(t1100.EXPR7) AS EXPR7, MIN(t1100.EXPR8) AS EXPR8, MIN(t1102.EXPR10) AS EXPR10 FROM (SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_bill_cdemo_sk, cs_item_sk, MIN(cs_quantity) AS EXPR4, MIN(cs_list_price) AS EXPR5, MIN(cs_coupon_amt) AS EXPR6, MIN(cs_sales_price) AS EXPR7, MIN(cs_net_profit) AS EXPR8 FROM catalog_sales WHERE cs_wholesale_cost >= 84 AND cs_wholesale_cost <= 89 GROUP BY cs_sold_date_sk, cs_bill_customer_sk, cs_bill_cdemo_sk, cs_item_sk) AS t1100 INNER JOIN (SELECT cd_demo_sk, MIN(cd_dep_count) AS EXPR10 FROM customer_demographics WHERE cd_gender = 'F' AND cd_education_status = '2 yr Degree' GROUP BY cd_demo_sk) AS t1102 ON t1100.cs_bill_cdemo_sk = t1102.cd_demo_sk GROUP BY t1100.cs_sold_date_sk, t1100.cs_bill_customer_sk, t1100.cs_item_sk) AS t1103 INNER JOIN (SELECT c_customer_sk, c_current_addr_sk, MIN(c_birth_year) AS EXPR9 FROM customer WHERE c_birth_month = 3 GROUP BY c_customer_sk, c_current_addr_sk) AS t1105 ON t1103.cs_bill_customer_sk = t1105.c_customer_sk GROUP BY t1103.cs_sold_date_sk, t1103.cs_item_sk, t1105.c_current_addr_sk) AS t1106 INNER JOIN (SELECT ca_address_sk, MIN(ca_country) AS EXPR1, MIN(ca_state) AS EXPR2, MIN(ca_county) AS EXPR3 FROM customer_address WHERE ca_state IN ('GA', 'ME', 'NC') GROUP BY ca_address_sk) AS t1108 ON t1106.c_current_addr_sk = t1108.ca_address_sk GROUP BY t1106.cs_sold_date_sk, t1106.cs_item_sk) AS t1109 INNER JOIN (SELECT d_date_sk FROM date_dim WHERE d_year = 2000 GROUP BY d_date_sk) AS t1111 ON t1109.cs_sold_date_sk = t1111.d_date_sk GROUP BY t1109.cs_item_sk) AS t1112 INNER JOIN (SELECT i_item_sk, MIN(i_item_id) AS EXPR0 FROM item WHERE i_category = 'Books' GROUP BY i_item_sk) AS t1114 ON t1112.cs_item_sk = t1114.i_item_sk","['FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE']",6.357739846,4.008591334,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
104,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = '2 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2001 and  c_birth_month = 11 and  ca_state in ('MN', 'OK', 'WV')  and cs_wholesale_cost BETWEEN 43 AND 48  AND i_category = 'Home'  ;","SELECT MIN(t245.EXPR0), MIN(t243.EXPR1), MIN(t243.EXPR2), MIN(t243.EXPR3), MIN(t243.EXPR4), MIN(t243.EXPR5), MIN(t243.EXPR6), MIN(t243.EXPR7), MIN(t243.EXPR8), MIN(t243.EXPR9), MIN(t243.EXPR10) FROM (SELECT t239.cs_item_sk, MIN(t239.EXPR1) AS EXPR1, MIN(t239.EXPR2) AS EXPR2, MIN(t239.EXPR3) AS EXPR3, MIN(t239.EXPR4) AS EXPR4, MIN(t239.EXPR5) AS EXPR5, MIN(t239.EXPR6) AS EXPR6, MIN(t239.EXPR7) AS EXPR7, MIN(t239.EXPR8) AS EXPR8, MIN(t239.EXPR9) AS EXPR9, MIN(t239.EXPR10) AS EXPR10 FROM (SELECT t235.cs_sold_date_sk, t235.cs_item_sk, MIN(t237.EXPR1) AS EXPR1, MIN(t237.EXPR2) AS EXPR2, MIN(t237.EXPR3) AS EXPR3, MIN(t235.EXPR4) AS EXPR4, MIN(t235.EXPR5) AS EXPR5, MIN(t235.EXPR6) AS EXPR6, MIN(t235.EXPR7) AS EXPR7, MIN(t235.EXPR8) AS EXPR8, MIN(t235.EXPR9) AS EXPR9, MIN(t235.EXPR10) AS EXPR10 FROM (SELECT t231.cs_sold_date_sk, t231.cs_item_sk, t233.c_current_addr_sk, MIN(t231.EXPR4) AS EXPR4, MIN(t231.EXPR5) AS EXPR5, MIN(t231.EXPR6) AS EXPR6, MIN(t231.EXPR7) AS EXPR7, MIN(t231.EXPR8) AS EXPR8, MIN(t233.EXPR9) AS EXPR9, MIN(t231.EXPR10) AS EXPR10 FROM (SELECT t227.cs_sold_date_sk, t227.cs_bill_customer_sk, t227.cs_item_sk, MIN(t227.EXPR4) AS EXPR4, MIN(t227.EXPR5) AS EXPR5, MIN(t227.EXPR6) AS EXPR6, MIN(t227.EXPR7) AS EXPR7, MIN(t227.EXPR8) AS EXPR8, MIN(t229.EXPR10) AS EXPR10 FROM (SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_bill_cdemo_sk, cs_item_sk, MIN(cs_quantity) AS EXPR4, MIN(cs_list_price) AS EXPR5, MIN(cs_coupon_amt) AS EXPR6, MIN(cs_sales_price) AS EXPR7, MIN(cs_net_profit) AS EXPR8 FROM catalog_sales WHERE cs_wholesale_cost >= 43 AND cs_wholesale_cost <= 48 GROUP BY cs_sold_date_sk, cs_bill_customer_sk, cs_bill_cdemo_sk, cs_item_sk) AS t227, (SELECT cd_demo_sk, MIN(cd_dep_count) AS EXPR10 FROM customer_demographics WHERE cd_gender = 'F' AND cd_education_status = '2 yr Degree' GROUP BY cd_demo_sk) AS t229 WHERE t227.cs_bill_cdemo_sk = t229.cd_demo_sk GROUP BY t227.cs_sold_date_sk, t227.cs_bill_customer_sk, t227.cs_item_sk) AS t231, (SELECT c_customer_sk, c_current_addr_sk, MIN(c_birth_year) AS EXPR9 FROM customer WHERE c_birth_month = 11 GROUP BY c_customer_sk, c_current_addr_sk) AS t233 WHERE t231.cs_bill_customer_sk = t233.c_customer_sk GROUP BY t231.cs_sold_date_sk, t231.cs_item_sk, t233.c_current_addr_sk) AS t235, (SELECT ca_address_sk, MIN(ca_country) AS EXPR1, MIN(ca_state) AS EXPR2, MIN(ca_county) AS EXPR3 FROM customer_address WHERE ca_state IN ('MN', 'OK', 'WV') GROUP BY ca_address_sk) AS t237 WHERE t235.c_current_addr_sk = t237.ca_address_sk GROUP BY t235.cs_sold_date_sk, t235.cs_item_sk) AS t239, (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 GROUP BY d_date_sk) AS t241 WHERE t239.cs_sold_date_sk = t241.d_date_sk GROUP BY t239.cs_item_sk) AS t243, (SELECT i_item_sk, MIN(i_item_id) AS EXPR0 FROM item WHERE i_category = 'Home' GROUP BY i_item_sk) AS t245 WHERE t243.cs_item_sk = t245.i_item_sk","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE', 'JOIN_EXTRACT_FILTER']",4.369611581,1.595992327,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
105,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 1998 and  c_birth_month = 6 and  ca_state in ('AR', 'CT', 'MI')  and cs_wholesale_cost BETWEEN 23 AND 28  AND i_category = 'Books'  ;","SELECT MIN(t274.EXPR0), MIN(t272.EXPR1), MIN(t272.EXPR2), MIN(t272.EXPR3), MIN(t272.EXPR4), MIN(t272.EXPR5), MIN(t272.EXPR6), MIN(t272.EXPR7), MIN(t272.EXPR8), MIN(t272.EXPR9), MIN(t272.EXPR10) FROM (SELECT t268.cs_item_sk, MIN(t268.EXPR1) AS EXPR1, MIN(t268.EXPR2) AS EXPR2, MIN(t268.EXPR3) AS EXPR3, MIN(t268.EXPR4) AS EXPR4, MIN(t268.EXPR5) AS EXPR5, MIN(t268.EXPR6) AS EXPR6, MIN(t268.EXPR7) AS EXPR7, MIN(t268.EXPR8) AS EXPR8, MIN(t268.EXPR9) AS EXPR9, MIN(t268.EXPR10) AS EXPR10 FROM (SELECT t264.cs_sold_date_sk, t264.cs_item_sk, MIN(t266.EXPR1) AS EXPR1, MIN(t266.EXPR2) AS EXPR2, MIN(t266.EXPR3) AS EXPR3, MIN(t264.EXPR4) AS EXPR4, MIN(t264.EXPR5) AS EXPR5, MIN(t264.EXPR6) AS EXPR6, MIN(t264.EXPR7) AS EXPR7, MIN(t264.EXPR8) AS EXPR8, MIN(t264.EXPR9) AS EXPR9, MIN(t264.EXPR10) AS EXPR10 FROM (SELECT t260.cs_sold_date_sk, t260.cs_item_sk, t262.c_current_addr_sk, MIN(t260.EXPR4) AS EXPR4, MIN(t260.EXPR5) AS EXPR5, MIN(t260.EXPR6) AS EXPR6, MIN(t260.EXPR7) AS EXPR7, MIN(t260.EXPR8) AS EXPR8, MIN(t262.EXPR9) AS EXPR9, MIN(t260.EXPR10) AS EXPR10 FROM (SELECT t256.cs_sold_date_sk, t256.cs_bill_customer_sk, t256.cs_item_sk, MIN(t256.EXPR4) AS EXPR4, MIN(t256.EXPR5) AS EXPR5, MIN(t256.EXPR6) AS EXPR6, MIN(t256.EXPR7) AS EXPR7, MIN(t256.EXPR8) AS EXPR8, MIN(t258.EXPR10) AS EXPR10 FROM (SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_bill_cdemo_sk, cs_item_sk, MIN(cs_quantity) AS EXPR4, MIN(cs_list_price) AS EXPR5, MIN(cs_coupon_amt) AS EXPR6, MIN(cs_sales_price) AS EXPR7, MIN(cs_net_profit) AS EXPR8 FROM catalog_sales WHERE cs_wholesale_cost >= 23 AND cs_wholesale_cost <= 28 GROUP BY cs_sold_date_sk, cs_bill_customer_sk, cs_bill_cdemo_sk, cs_item_sk) AS t256, (SELECT cd_demo_sk, MIN(cd_dep_count) AS EXPR10 FROM customer_demographics WHERE cd_gender = 'F' AND cd_education_status = '4 yr Degree' GROUP BY cd_demo_sk) AS t258 WHERE t256.cs_bill_cdemo_sk = t258.cd_demo_sk GROUP BY t256.cs_sold_date_sk, t256.cs_bill_customer_sk, t256.cs_item_sk) AS t260, (SELECT c_customer_sk, c_current_addr_sk, MIN(c_birth_year) AS EXPR9 FROM customer WHERE c_birth_month = 6 GROUP BY c_customer_sk, c_current_addr_sk) AS t262 WHERE t260.cs_bill_customer_sk = t262.c_customer_sk GROUP BY t260.cs_sold_date_sk, t260.cs_item_sk, t262.c_current_addr_sk) AS t264, (SELECT ca_address_sk, MIN(ca_country) AS EXPR1, MIN(ca_state) AS EXPR2, MIN(ca_county) AS EXPR3 FROM customer_address WHERE ca_state IN ('AR', 'CT', 'MI') GROUP BY ca_address_sk) AS t266 WHERE t264.c_current_addr_sk = t266.ca_address_sk GROUP BY t264.cs_sold_date_sk, t264.cs_item_sk) AS t268, (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 GROUP BY d_date_sk) AS t270 WHERE t268.cs_sold_date_sk = t270.d_date_sk GROUP BY t268.cs_item_sk) AS t272, (SELECT i_item_sk, MIN(i_item_id) AS EXPR0 FROM item WHERE i_category = 'Books' GROUP BY i_item_sk) AS t274 WHERE t272.cs_item_sk = t274.i_item_sk","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE', 'JOIN_EXTRACT_FILTER']",7.454763015,2.033634822,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
106,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 1999 and  c_birth_month = 10 and  ca_state in ('NC', 'SC', 'TX')  and cs_wholesale_cost BETWEEN 89 AND 94  AND i_category = 'Home'  ;","SELECT MIN(t4.i_item_id), MIN(t2.ca_country), MIN(t2.ca_state), MIN(t2.ca_county), MIN(t.cs_quantity), MIN(t.cs_list_price), MIN(t.cs_coupon_amt), MIN(t.cs_sales_price), MIN(t.cs_net_profit), MIN(t1.c_birth_year), MIN(t0.cd_dep_count) FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 89 AND cs_wholesale_cost <= 94) AS t INNER JOIN (SELECT * FROM customer_demographics WHERE cd_gender = 'M' AND cd_education_status = '4 yr Degree') AS t0 ON t.cs_bill_cdemo_sk = t0.cd_demo_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 10) AS t1 ON t.cs_bill_customer_sk = t1.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('NC', 'SC', 'TX')) AS t2 ON t1.c_current_addr_sk = t2.ca_address_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t3 ON t.cs_sold_date_sk = t3.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category = 'Home') AS t4 ON t.cs_item_sk = t4.i_item_sk","['FILTER_INTO_JOIN', 'FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE']",3.702497403,0.910486539,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
107,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2001 and  c_birth_month = 6 and  ca_state in ('GA', 'IL', 'TX')  and cs_wholesale_cost BETWEEN 7 AND 12  AND i_category = 'Children'  ;","SELECT MIN(t4.i_item_id), MIN(t2.ca_country), MIN(t2.ca_state), MIN(t2.ca_county), MIN(t.cs_quantity), MIN(t.cs_list_price), MIN(t.cs_coupon_amt), MIN(t.cs_sales_price), MIN(t.cs_net_profit), MIN(t1.c_birth_year), MIN(t0.cd_dep_count) FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 7 AND cs_wholesale_cost <= 12) AS t INNER JOIN (SELECT * FROM customer_demographics WHERE cd_gender = 'M' AND cd_education_status = '4 yr Degree') AS t0 ON t.cs_bill_cdemo_sk = t0.cd_demo_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 6) AS t1 ON t.cs_bill_customer_sk = t1.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('GA', 'IL', 'TX')) AS t2 ON t1.c_current_addr_sk = t2.ca_address_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t3 ON t.cs_sold_date_sk = t3.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category = 'Children') AS t4 ON t.cs_item_sk = t4.i_item_sk;","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_REDUCE_EXPRESSIONS']",6.686550697,3.396081368,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
108,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Unknown' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 7 and  ca_state in ('GA', 'KS', 'MI')  and cs_wholesale_cost BETWEEN 1 AND 6  AND i_category = 'Music'  ;","SELECT MIN(t4.i_item_id), MIN(t2.ca_country), MIN(t2.ca_state), MIN(t2.ca_county), MIN(t.cs_quantity), MIN(t.cs_list_price), MIN(t.cs_coupon_amt), MIN(t.cs_sales_price), MIN(t.cs_net_profit), MIN(t1.c_birth_year), MIN(t0.cd_dep_count) FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 1 AND cs_wholesale_cost <= 6) AS t INNER JOIN (SELECT * FROM customer_demographics WHERE cd_gender = 'M' AND cd_education_status = 'Unknown') AS t0 ON t.cs_bill_cdemo_sk = t0.cd_demo_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 7) AS t1 ON t.cs_bill_customer_sk = t1.c_customer_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('GA', 'KS', 'MI')) AS t2 ON t1.c_current_addr_sk = t2.ca_address_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t3 ON t.cs_sold_date_sk = t3.d_date_sk INNER JOIN (SELECT * FROM item WHERE i_category = 'Music') AS t4 ON t.cs_item_sk = t4.i_item_sk;","['JOIN_CONDITION_PUSH', 'FILTER_INTO_JOIN']",7.781458775,4.14113005,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
109,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'D' and  cd_education_status = '4 yr Degree' and  d_year = 1998 and  s_state = 'IN' and i_category = 'Books'  ;","SELECT MIN(t758.i_item_id), MIN(t757.s_state), MIN(store_sales76.ss_quantity), MIN(store_sales76.ss_list_price), MIN(store_sales76.ss_coupon_amt), MIN(store_sales76.ss_sales_price), MIN(store_sales76.ss_item_sk), MIN(store_sales76.ss_ticket_number) FROM store_sales AS store_sales76 INNER JOIN (SELECT * FROM customer_demographics WHERE cd_gender = 'F' AND cd_marital_status = 'D' AND cd_education_status = '4 yr Degree') AS t755 ON store_sales76.ss_cdemo_sk = t755.cd_demo_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t756 ON store_sales76.ss_sold_date_sk = t756.d_date_sk INNER JOIN (SELECT * FROM store WHERE s_state = 'IN') AS t757 ON store_sales76.ss_store_sk = t757.s_store_sk INNER JOIN (SELECT * FROM item WHERE i_category = 'Books') AS t758 ON store_sales76.ss_item_sk = t758.i_item_sk",['FILTER_INTO_JOIN'],0.018645604,0.014029344,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
110,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'M' and  cd_education_status = 'Primary' and  d_year = 1999 and  s_state = 'MI' and i_category = 'Home'  ;","SELECT MIN(item.i_item_id), MIN(store.s_state), MIN(store_sales.ss_quantity), MIN(store_sales.ss_list_price), MIN(store_sales.ss_coupon_amt), MIN(store_sales.ss_sales_price), MIN(store_sales.ss_item_sk), MIN(store_sales.ss_ticket_number) FROM store_sales, customer_demographics, date_dim, store, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk AND (store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND customer_demographics.cd_gender = 'F')) AND (customer_demographics.cd_marital_status = 'M' AND customer_demographics.cd_education_status = 'Primary' AND (date_dim.d_year = 1999 AND (store.s_state = 'MI' AND item.i_category = 'Home')))",['AGGREGATE_REMOVE'],0.017944654,0.016774336,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
111,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'S' and  cd_education_status = '2 yr Degree' and  d_year = 1999 and  s_state = 'MO' and i_category = 'Books'  ;","SELECT MIN(t5.i_item_id), MIN(t4.s_state), MIN(t4.ss_quantity), MIN(t4.ss_list_price), MIN(t4.ss_coupon_amt), MIN(t4.ss_sales_price), MIN(t4.ss_item_sk), MIN(t4.ss_ticket_number) FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM store_sales, (SELECT * FROM customer_demographics WHERE cd_gender = 'F' AND cd_marital_status = 'S' AND cd_education_status = '2 yr Degree') AS t WHERE store_sales.ss_cdemo_sk = t.cd_demo_sk) AS t0, (SELECT * FROM date_dim WHERE d_year = 1999) AS t1 WHERE t0.ss_sold_date_sk = t1.d_date_sk) AS t2, (SELECT * FROM store WHERE s_state = 'MO') AS t3 WHERE t2.ss_store_sk = t3.s_store_sk) AS t4, (SELECT * FROM item WHERE i_category = 'Books') AS t5 WHERE t4.ss_item_sk = t5.i_item_sk","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER']",0.01996994,0.015599012,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
112,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'S' and  cd_education_status = 'Unknown' and  d_year = 2001 and  s_state = 'MN' and i_category = 'Shoes'  ;","SELECT MIN(t2.i_item_id), MIN(t1.s_state), MIN(store_sales.ss_quantity), MIN(store_sales.ss_list_price), MIN(store_sales.ss_coupon_amt), MIN(store_sales.ss_sales_price), MIN(store_sales.ss_item_sk), MIN(store_sales.ss_ticket_number) FROM store_sales INNER JOIN (SELECT * FROM customer_demographics WHERE cd_gender = 'F' AND cd_marital_status = 'S' AND cd_education_status = 'Unknown') AS t ON store_sales.ss_cdemo_sk = t.cd_demo_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t0 ON store_sales.ss_sold_date_sk = t0.d_date_sk INNER JOIN (SELECT * FROM store WHERE s_state = 'MN') AS t1 ON store_sales.ss_store_sk = t1.s_store_sk INNER JOIN (SELECT * FROM item WHERE i_category = 'Shoes') AS t2 ON store_sales.ss_item_sk = t2.i_item_sk;","['FILTER_SCAN', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS']",0.02783068,0.02486221,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
113,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'D' and  cd_education_status = '2 yr Degree' and  d_year = 2002 and  s_state = 'NV' and i_category = 'Children'  ;","SELECT MIN(item.i_item_id), MIN(store.s_state), MIN(store_sales.ss_quantity), MIN(store_sales.ss_list_price), MIN(store_sales.ss_coupon_amt), MIN(store_sales.ss_sales_price), MIN(store_sales.ss_item_sk), MIN(store_sales.ss_ticket_number) FROM store_sales, customer_demographics, date_dim, store, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk AND (store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND customer_demographics.cd_gender = 'M')) AND (customer_demographics.cd_marital_status = 'D' AND customer_demographics.cd_education_status = '2 yr Degree' AND (date_dim.d_year = 2002 AND (store.s_state = 'NV' AND item.i_category = 'Children')))","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']",0.01853625,0.016324759,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
114,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'M' and  cd_education_status = 'Primary' and  d_year = 2000 and  s_state = 'KS' and i_category = 'Women'  ;","SELECT MIN(t2.i_item_id), MIN(t1.s_state), MIN(store_sales.ss_quantity), MIN(store_sales.ss_list_price), MIN(store_sales.ss_coupon_amt), MIN(store_sales.ss_sales_price), MIN(store_sales.ss_item_sk), MIN(store_sales.ss_ticket_number) FROM store_sales INNER JOIN (SELECT * FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'M' AND cd_education_status = 'Primary') AS t ON store_sales.ss_cdemo_sk = t.cd_demo_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t0 ON store_sales.ss_sold_date_sk = t0.d_date_sk INNER JOIN (SELECT * FROM store WHERE s_state = 'KS') AS t1 ON store_sales.ss_store_sk = t1.s_store_sk INNER JOIN (SELECT * FROM item WHERE i_category = 'Women') AS t2 ON store_sales.ss_item_sk = t2.i_item_sk","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']",0.018272956,0.017641385,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
115,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'M' and  cd_education_status = 'Primary' and  d_year = 2000 and  s_state = 'VA' and i_category = 'Jewelry'  ;","SELECT MIN(t2.i_item_id), MIN(t1.s_state), MIN(store_sales.ss_quantity), MIN(store_sales.ss_list_price), MIN(store_sales.ss_coupon_amt), MIN(store_sales.ss_sales_price), MIN(store_sales.ss_item_sk), MIN(store_sales.ss_ticket_number) FROM store_sales INNER JOIN (SELECT * FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'M' AND cd_education_status = 'Primary') AS t ON store_sales.ss_cdemo_sk = t.cd_demo_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t0 ON store_sales.ss_sold_date_sk = t0.d_date_sk INNER JOIN (SELECT * FROM store WHERE s_state = 'VA') AS t1 ON store_sales.ss_store_sk = t1.s_store_sk INNER JOIN (SELECT * FROM item WHERE i_category = 'Jewelry') AS t2 ON store_sales.ss_item_sk = t2.i_item_sk;","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS']",0.016996384,0.016843319,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
116,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'M' and  cd_education_status = 'Secondary' and  d_year = 2002 and  s_state = 'KS' and i_category = 'Jewelry'  ;","SELECT MIN(item.i_item_id), MIN(store.s_state), MIN(store_sales.ss_quantity), MIN(store_sales.ss_list_price), MIN(store_sales.ss_coupon_amt), MIN(store_sales.ss_sales_price), MIN(store_sales.ss_item_sk), MIN(store_sales.ss_ticket_number) FROM store_sales, customer_demographics, date_dim, store, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk AND (store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND customer_demographics.cd_gender = 'M')) AND (customer_demographics.cd_marital_status = 'M' AND customer_demographics.cd_education_status = 'Secondary' AND (date_dim.d_year = 2002 AND (store.s_state = 'KS' AND item.i_category = 'Jewelry')))",['AGGREGATE_PROJECT_MERGE'],0.020396709,0.020193338,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
117,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'S' and  cd_education_status = '4 yr Degree' and  d_year = 1999 and  s_state = 'GA' and i_category = 'Home'  ;","SELECT MIN(item.i_item_id), MIN(store.s_state), MIN(store_sales.ss_quantity), MIN(store_sales.ss_list_price), MIN(store_sales.ss_coupon_amt), MIN(store_sales.ss_sales_price), MIN(store_sales.ss_item_sk), MIN(store_sales.ss_ticket_number) FROM store_sales, customer_demographics, date_dim, store, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk AND (store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND customer_demographics.cd_gender = 'M')) AND (customer_demographics.cd_marital_status = 'S' AND customer_demographics.cd_education_status = '4 yr Degree' AND (date_dim.d_year = 1999 AND (store.s_state = 'GA' AND item.i_category = 'Home')))","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_SCAN']",0.019240618,0.016831319,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
118,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'W' and  cd_education_status = 'Primary' and  d_year = 2000 and  s_state = 'IN' and i_category = 'Home'  ;","SELECT MIN(t2.i_item_id), MIN(t1.s_state), MIN(store_sales.ss_quantity), MIN(store_sales.ss_list_price), MIN(store_sales.ss_coupon_amt), MIN(store_sales.ss_sales_price), MIN(store_sales.ss_item_sk), MIN(store_sales.ss_ticket_number) FROM store_sales INNER JOIN (SELECT * FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'W' AND cd_education_status = 'Primary') AS t ON store_sales.ss_cdemo_sk = t.cd_demo_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t0 ON store_sales.ss_sold_date_sk = t0.d_date_sk INNER JOIN (SELECT * FROM store WHERE s_state = 'IN') AS t1 ON store_sales.ss_store_sk = t1.s_store_sk INNER JOIN (SELECT * FROM item WHERE i_category = 'Home') AS t2 ON store_sales.ss_item_sk = t2.i_item_sk;","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'JOIN_PROJECT_LEFT_TRANSPOSE']",0.019412518,0.018855731,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
119,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'W' and  cd_education_status = 'Secondary' and  d_year = 2001 and  s_state = 'GA' and i_category = 'Jewelry'  ;","select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'W' and  cd_education_status = 'Secondary' and  d_year = 2001 and  s_state = 'GA' and i_category = 'Jewelry'  ",[],0.017642975,0.016756376,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
120,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Electronics', 'Jewelry') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = 'Secondary' and s1.ss_list_price between 216 and 230 and s2.ss_list_price between 216 and 230  ;","SELECT MIN(t593.EXPR0), MIN(t593.EXPR1), MIN(t593.EXPR2), MIN(t593.EXPR3) FROM (SELECT t590.c_current_cdemo_sk, MIN(t590.EXPR0) AS EXPR0, MIN(t590.EXPR1) AS EXPR1, MIN(t590.EXPR2) AS EXPR2, MIN(t590.EXPR3) AS EXPR3 FROM (SELECT t588.c_current_addr_sk, t588.c_current_cdemo_sk, MIN(t587.EXPR0) AS EXPR0, MIN(t587.EXPR1) AS EXPR1, MIN(t587.EXPR2) AS EXPR2, MIN(t587.EXPR3) AS EXPR3 FROM (SELECT t583.ss_customer_sk, MIN(t583.EXPR0) AS EXPR0, MIN(t583.EXPR1) AS EXPR1, MIN(t583.EXPR2) AS EXPR2, MIN(t583.EXPR3) AS EXPR3 FROM (SELECT t579.ss_sold_date_sk, t579.ss_customer_sk, MIN(t579.EXPR0) AS EXPR0, MIN(t579.EXPR1) AS EXPR1, MIN(t579.EXPR2) AS EXPR2, MIN(t579.EXPR3) AS EXPR3 FROM (SELECT t575.i_item_sk0, t577.ss_sold_date_sk, t577.ss_customer_sk, t577.ss_ticket_number, MIN(t575.EXPR0) AS EXPR0, MIN(t575.EXPR1) AS EXPR1, MIN(t577.EXPR2) AS EXPR2, MIN(t577.EXPR3) AS EXPR3 FROM (SELECT t572.i_item_sk, t573.i_item_sk AS i_item_sk0, MIN(t572.i_item_sk) AS EXPR0, MIN(t573.i_item_sk) AS EXPR1 FROM (SELECT * FROM item WHERE i_category IN ('Electronics', 'Jewelry')) AS t572, (SELECT * FROM item WHERE i_manager_id >= 81 AND i_manager_id <= 100) AS t573 WHERE t572.i_item_sk < t573.i_item_sk GROUP BY t572.i_item_sk, t573.i_item_sk) AS t575, (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_ticket_number, MIN(ss_ticket_number) AS EXPR2, MIN(ss_item_sk) AS EXPR3 FROM store_sales WHERE ss_list_price >= 216 AND ss_list_price <= 230 GROUP BY ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_ticket_number) AS t577 WHERE t577.ss_item_sk = t575.i_item_sk GROUP BY t575.i_item_sk0, t577.ss_sold_date_sk, t577.ss_customer_sk, t577.ss_ticket_number) AS t579, (SELECT ss_item_sk, ss_ticket_number FROM store_sales WHERE ss_list_price >= 216 AND ss_list_price <= 230 GROUP BY ss_item_sk, ss_ticket_number) AS t581 WHERE t579.ss_ticket_number = t581.ss_ticket_number AND t581.ss_item_sk = t579.i_item_sk0 GROUP BY t579.ss_sold_date_sk, t579.ss_customer_sk) AS t583, (SELECT d_date_sk FROM date_dim WHERE d_year >= 1998 AND d_year <= 1998 + 1 GROUP BY d_date_sk) AS t585 WHERE t585.d_date_sk = t583.ss_sold_date_sk GROUP BY t583.ss_customer_sk) AS t587, (SELECT c_customer_sk, c_current_addr_sk, c_current_cdemo_sk FROM customer GROUP BY c_customer_sk, c_current_addr_sk, c_current_cdemo_sk) AS t588 WHERE t587.ss_customer_sk = t588.c_customer_sk GROUP BY t588.c_current_addr_sk, t588.c_current_cdemo_sk) AS t590, (SELECT ca_address_sk FROM customer_address GROUP BY ca_address_sk) AS t591 WHERE t590.c_current_addr_sk = t591.ca_address_sk GROUP BY t590.c_current_cdemo_sk) AS t593, (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Secondary' GROUP BY cd_demo_sk) AS t595 WHERE t593.c_current_cdemo_sk = t595.cd_demo_sk","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE', 'JOIN_EXTRACT_FILTER']",4.936506669,1.673791885,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
121,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 35 and 54 and cd_marital_status = 'U' and cd_education_status = 'Primary' and s1.ss_list_price between 286 and 300 and s2.ss_list_price between 286 and 300  ;","SELECT MIN(t1106.EXPR0), MIN(t1106.EXPR1), MIN(t1106.EXPR2), MIN(t1106.EXPR3) FROM (SELECT t1104.c_current_cdemo_sk, MIN(t1104.EXPR0) AS EXPR0, MIN(t1104.EXPR1) AS EXPR1, MIN(t1104.EXPR2) AS EXPR2, MIN(t1104.EXPR3) AS EXPR3 FROM (SELECT t1103.c_current_addr_sk, t1103.c_current_cdemo_sk, MIN(t1102.EXPR0) AS EXPR0, MIN(t1102.EXPR1) AS EXPR1, MIN(t1102.EXPR2) AS EXPR2, MIN(t1102.EXPR3) AS EXPR3 FROM (SELECT t1099.ss_customer_sk, MIN(t1099.EXPR0) AS EXPR0, MIN(t1099.EXPR1) AS EXPR1, MIN(t1099.EXPR2) AS EXPR2, MIN(t1099.EXPR3) AS EXPR3 FROM (SELECT t1096.ss_sold_date_sk, t1096.ss_customer_sk, MIN(t1096.EXPR0) AS EXPR0, MIN(t1096.EXPR1) AS EXPR1, MIN(t1096.EXPR2) AS EXPR2, MIN(t1096.EXPR3) AS EXPR3 FROM (SELECT t1093.i_item_sk0, t1095.ss_sold_date_sk, t1095.ss_customer_sk, t1095.ss_ticket_number, MIN(t1093.EXPR0) AS EXPR0, MIN(t1093.EXPR1) AS EXPR1, MIN(t1095.EXPR2) AS EXPR2, MIN(t1095.EXPR3) AS EXPR3 FROM (SELECT t1091.i_item_sk, t1092.i_item_sk AS i_item_sk0, MIN(t1091.i_item_sk) AS EXPR0, MIN(t1092.i_item_sk) AS EXPR1 FROM (SELECT * FROM item WHERE i_category IN ('Children', 'Women')) AS t1091 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 35 AND i_manager_id <= 54) AS t1092 ON t1091.i_item_sk < t1092.i_item_sk GROUP BY t1091.i_item_sk, t1092.i_item_sk) AS t1093 INNER JOIN (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_ticket_number, MIN(ss_ticket_number) AS EXPR2, MIN(ss_item_sk) AS EXPR3 FROM store_sales WHERE ss_list_price >= 286 AND ss_list_price <= 300 GROUP BY ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_ticket_number) AS t1095 ON t1093.i_item_sk = t1095.ss_item_sk GROUP BY t1093.i_item_sk0, t1095.ss_sold_date_sk, t1095.ss_customer_sk, t1095.ss_ticket_number) AS t1096 INNER JOIN (SELECT ss_item_sk, ss_ticket_number FROM store_sales WHERE ss_list_price >= 286 AND ss_list_price <= 300 GROUP BY ss_item_sk, ss_ticket_number) AS t1098 ON t1096.ss_ticket_number = t1098.ss_ticket_number AND t1096.i_item_sk0 = t1098.ss_item_sk GROUP BY t1096.ss_sold_date_sk, t1096.ss_customer_sk) AS t1099 INNER JOIN (SELECT d_date_sk FROM date_dim WHERE d_year >= 1999 AND d_year <= 1999 + 1 GROUP BY d_date_sk) AS t1101 ON t1099.ss_sold_date_sk = t1101.d_date_sk GROUP BY t1099.ss_customer_sk) AS t1102 INNER JOIN (SELECT c_customer_sk, c_current_addr_sk, c_current_cdemo_sk FROM customer GROUP BY c_customer_sk, c_current_addr_sk, c_current_cdemo_sk) AS t1103 ON t1102.ss_customer_sk = t1103.c_customer_sk GROUP BY t1103.c_current_addr_sk, t1103.c_current_cdemo_sk) AS t1104 INNER JOIN (SELECT ca_address_sk FROM customer_address GROUP BY ca_address_sk) AS t1105 ON t1104.c_current_addr_sk = t1105.ca_address_sk GROUP BY t1104.c_current_cdemo_sk) AS t1106 INNER JOIN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'U' AND cd_education_status = 'Primary' GROUP BY cd_demo_sk) AS t1108 ON t1106.c_current_cdemo_sk = t1108.cd_demo_sk","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE']",5.046871742,3.396603187,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
122,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'MD', 'MS') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'IN', 'PA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'KS', 'TX') and ss_net_profit between 50 and 250 ))  ;","SELECT MIN(t453.ss_quantity), MIN(t453.ss_ext_sales_price), MIN(t453.ss_ext_wholesale_cost), MIN(t453.ss_ext_wholesale_cost) FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM store_sales AS store_sales81, store AS store81 WHERE store81.s_store_sk = store_sales81.ss_store_sk) AS t451, customer_demographics AS customer_demographics81, household_demographics AS household_demographics81 WHERE t451.ss_hdemo_sk = household_demographics81.hd_demo_sk AND (customer_demographics81.cd_demo_sk = t451.ss_cdemo_sk AND customer_demographics81.cd_marital_status = 'D') AND (customer_demographics81.cd_education_status = '4 yr Degree' AND (t451.ss_sales_price >= 100.00 AND t451.ss_sales_price <= 150.00 AND household_demographics81.hd_dep_count = 3)) OR t451.ss_hdemo_sk = household_demographics81.hd_demo_sk AND (customer_demographics81.cd_demo_sk = t451.ss_cdemo_sk AND customer_demographics81.cd_marital_status = 'S') AND (customer_demographics81.cd_education_status = 'Advanced Degree' AND (t451.ss_sales_price >= 50.00 AND t451.ss_sales_price <= 100.00 AND household_demographics81.hd_dep_count = 1)) OR t451.ss_hdemo_sk = household_demographics81.hd_demo_sk AND (customer_demographics81.cd_demo_sk = t451.ss_cdemo_sk AND customer_demographics81.cd_marital_status = 'S') AND (customer_demographics81.cd_education_status = '2 yr Degree' AND (t451.ss_sales_price >= 150.00 AND t451.ss_sales_price <= 200.00 AND household_demographics81.hd_dep_count = 1))) AS t452, customer_address AS customer_address81 WHERE t452.ss_addr_sk = customer_address81.ca_address_sk AND customer_address81.ca_country = 'United States' AND customer_address81.ca_state IN ('GA', 'MD', 'MS') AND (t452.ss_net_profit >= 100 AND t452.ss_net_profit <= 200) OR t452.ss_addr_sk = customer_address81.ca_address_sk AND customer_address81.ca_country = 'United States' AND customer_address81.ca_state IN ('FL', 'IN', 'PA') AND (t452.ss_net_profit >= 150 AND t452.ss_net_profit <= 300) OR t452.ss_addr_sk = customer_address81.ca_address_sk AND customer_address81.ca_country = 'United States' AND customer_address81.ca_state IN ('AL', 'KS', 'TX') AND (t452.ss_net_profit >= 50 AND t452.ss_net_profit <= 250)) AS t453, (SELECT * FROM date_dim WHERE d_year = 2001) AS t454 WHERE t453.ss_sold_date_sk = t454.d_date_sk","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']",3.558868726,2.170254072,"['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
123,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'TN', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'KY', 'NE') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CO', 'NM', 'TX') and ss_net_profit between 50 and 250 ))  ;","SELECT MIN(t481.ss_quantity), MIN(t481.ss_ext_sales_price), MIN(t481.ss_ext_wholesale_cost), MIN(t481.ss_ext_wholesale_cost) FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM store_sales AS store_sales82, store AS store82 WHERE store82.s_store_sk = store_sales82.ss_store_sk) AS t479, customer_demographics AS customer_demographics82, household_demographics AS household_demographics82 WHERE t479.ss_hdemo_sk = household_demographics82.hd_demo_sk AND (customer_demographics82.cd_demo_sk = t479.ss_cdemo_sk AND customer_demographics82.cd_marital_status = 'D') AND (customer_demographics82.cd_education_status = '4 yr Degree' AND (t479.ss_sales_price >= 100.00 AND t479.ss_sales_price <= 150.00 AND household_demographics82.hd_dep_count = 3)) OR t479.ss_hdemo_sk = household_demographics82.hd_demo_sk AND (customer_demographics82.cd_demo_sk = t479.ss_cdemo_sk AND customer_demographics82.cd_marital_status = 'S') AND (customer_demographics82.cd_education_status = 'Primary' AND (t479.ss_sales_price >= 50.00 AND t479.ss_sales_price <= 100.00 AND household_demographics82.hd_dep_count = 1)) OR t479.ss_hdemo_sk = household_demographics82.hd_demo_sk AND (customer_demographics82.cd_demo_sk = t479.ss_cdemo_sk AND customer_demographics82.cd_marital_status = 'W') AND (customer_demographics82.cd_education_status = 'Advanced Degree' AND (t479.ss_sales_price >= 150.00 AND t479.ss_sales_price <= 200.00 AND household_demographics82.hd_dep_count = 1))) AS t480, customer_address AS customer_address82 WHERE t480.ss_addr_sk = customer_address82.ca_address_sk AND customer_address82.ca_country = 'United States' AND customer_address82.ca_state IN ('GA', 'TN', 'TX') AND (t480.ss_net_profit >= 100 AND t480.ss_net_profit <= 200) OR t480.ss_addr_sk = customer_address82.ca_address_sk AND customer_address82.ca_country = 'United States' AND customer_address82.ca_state IN ('GA', 'KY', 'NE') AND (t480.ss_net_profit >= 150 AND t480.ss_net_profit <= 300) OR t480.ss_addr_sk = customer_address82.ca_address_sk AND customer_address82.ca_country = 'United States' AND customer_address82.ca_state IN ('CO', 'NM', 'TX') AND (t480.ss_net_profit >= 50 AND t480.ss_net_profit <= 250)) AS t481, (SELECT * FROM date_dim WHERE d_year = 2001) AS t482 WHERE t481.ss_sold_date_sk = t482.d_date_sk","['FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']",10.22441165,2.146191835,"['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
124,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CA', 'MN', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'MO', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'SC', 'TX') and ss_net_profit between 50 and 250 ))  ;","SELECT MIN(store_sales17.ss_quantity), MIN(store_sales17.ss_ext_sales_price), MIN(store_sales17.ss_ext_wholesale_cost), MIN(store_sales17.ss_ext_wholesale_cost) FROM store_sales AS store_sales17 INNER JOIN store AS store17 ON store_sales17.ss_store_sk = store17.s_store_sk CROSS JOIN customer_demographics AS customer_demographics17 INNER JOIN household_demographics AS household_demographics17 ON store_sales17.ss_hdemo_sk = household_demographics17.hd_demo_sk AND (customer_demographics17.cd_demo_sk = store_sales17.ss_cdemo_sk AND customer_demographics17.cd_marital_status = 'M') AND (customer_demographics17.cd_education_status = '2 yr Degree' AND (store_sales17.ss_sales_price >= 100.00 AND store_sales17.ss_sales_price <= 150.00 AND household_demographics17.hd_dep_count = 3)) OR store_sales17.ss_hdemo_sk = household_demographics17.hd_demo_sk AND (customer_demographics17.cd_demo_sk = store_sales17.ss_cdemo_sk AND customer_demographics17.cd_marital_status = 'W') AND (customer_demographics17.cd_education_status = '4 yr Degree' AND (store_sales17.ss_sales_price >= 50.00 AND store_sales17.ss_sales_price <= 100.00 AND household_demographics17.hd_dep_count = 1)) OR store_sales17.ss_hdemo_sk = household_demographics17.hd_demo_sk AND (customer_demographics17.cd_demo_sk = store_sales17.ss_cdemo_sk AND customer_demographics17.cd_marital_status = 'W') AND (customer_demographics17.cd_education_status = '4 yr Degree' AND (store_sales17.ss_sales_price >= 150.00 AND store_sales17.ss_sales_price <= 200.00 AND household_demographics17.hd_dep_count = 1)) INNER JOIN customer_address AS customer_address17 ON store_sales17.ss_addr_sk = customer_address17.ca_address_sk AND customer_address17.ca_country = 'United States' AND customer_address17.ca_state IN ('CA', 'MN', 'TX') AND (store_sales17.ss_net_profit >= 100 AND store_sales17.ss_net_profit <= 200) OR store_sales17.ss_addr_sk = customer_address17.ca_address_sk AND customer_address17.ca_country = 'United States' AND customer_address17.ca_state IN ('GA', 'MO', 'VA') AND (store_sales17.ss_net_profit >= 150 AND store_sales17.ss_net_profit <= 300) OR store_sales17.ss_addr_sk = customer_address17.ca_address_sk AND customer_address17.ca_country = 'United States' AND customer_address17.ca_state IN ('AR', 'SC', 'TX') AND (store_sales17.ss_net_profit >= 50 AND store_sales17.ss_net_profit <= 250) INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t95 ON store_sales17.ss_sold_date_sk = t95.d_date_sk","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']",2.176950455,2.163071076,"['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
125,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'MT', 'NE') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'MS', 'UT') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'SD', 'TX') and ss_net_profit between 50 and 250 ))  ;","SELECT MIN(store_sales.ss_quantity), MIN(store_sales.ss_ext_sales_price), MIN(store_sales.ss_ext_wholesale_cost), MIN(store_sales.ss_ext_wholesale_cost) FROM store_sales INNER JOIN store ON store_sales.ss_store_sk = store.s_store_sk CROSS JOIN customer_demographics INNER JOIN household_demographics ON store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (customer_demographics.cd_demo_sk = store_sales.ss_cdemo_sk AND customer_demographics.cd_marital_status = 'S') AND (customer_demographics.cd_education_status = '4 yr Degree' AND (store_sales.ss_sales_price >= 100.00 AND store_sales.ss_sales_price <= 150.00 AND household_demographics.hd_dep_count = 3)) OR store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (customer_demographics.cd_demo_sk = store_sales.ss_cdemo_sk AND customer_demographics.cd_marital_status = 'S') AND (customer_demographics.cd_education_status = '4 yr Degree' AND (store_sales.ss_sales_price >= 50.00 AND store_sales.ss_sales_price <= 100.00 AND household_demographics.hd_dep_count = 1)) OR store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (customer_demographics.cd_demo_sk = store_sales.ss_cdemo_sk AND customer_demographics.cd_marital_status = 'S') AND (customer_demographics.cd_education_status = '4 yr Degree' AND (store_sales.ss_sales_price >= 150.00 AND store_sales.ss_sales_price <= 200.00 AND household_demographics.hd_dep_count = 1)) INNER JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk AND customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('GA', 'MT', 'NE') AND (store_sales.ss_net_profit >= 100 AND store_sales.ss_net_profit <= 200) OR store_sales.ss_addr_sk = customer_address.ca_address_sk AND customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('MO', 'MS', 'UT') AND (store_sales.ss_net_profit >= 150 AND store_sales.ss_net_profit <= 300) OR store_sales.ss_addr_sk = customer_address.ca_address_sk AND customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('IN', 'SD', 'TX') AND (store_sales.ss_net_profit >= 50 AND store_sales.ss_net_profit <= 250) INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t ON store_sales.ss_sold_date_sk = t.d_date_sk;","['FILTER_INTO_JOIN', 'FILTER_SCAN', 'SORT_JOIN_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']",2.131464243,2.122223695,"['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
126,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1178 and 1178 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 153 and 182 and sm_type = 'REGULAR' and cc_class = 'small' and w_gmt_offset = -5  ;","SELECT MIN(warehouse.w_warehouse_name), MIN(ship_mode.sm_type), MIN(call_center.cc_name), MIN(catalog_sales.cs_order_number), MIN(catalog_sales.cs_item_sk) FROM catalog_sales, warehouse, ship_mode, call_center, date_dim WHERE date_dim.d_month_seq >= 1178 AND date_dim.d_month_seq <= 1178 + 23 AND (catalog_sales.cs_ship_date_sk = date_dim.d_date_sk AND (catalog_sales.cs_warehouse_sk = warehouse.w_warehouse_sk AND catalog_sales.cs_ship_mode_sk = ship_mode.sm_ship_mode_sk)) AND (catalog_sales.cs_call_center_sk = call_center.cc_call_center_sk AND (catalog_sales.cs_list_price >= 153 AND catalog_sales.cs_list_price <= 182) AND (ship_mode.sm_type = 'REGULAR' AND (call_center.cc_class = 'small' AND warehouse.w_gmt_offset = -5)))","['FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH']",0.020816326,0.017330488,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
127,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1178 and 1178 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 64 and 93 and sm_type = 'NEXT DAY' and cc_class = 'small' and w_gmt_offset = -5  ;","SELECT MIN(t0.w_warehouse_name), MIN(t1.sm_type), MIN(t2.cc_name), MIN(t.cs_order_number), MIN(t.cs_item_sk) FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 64 AND cs_list_price <= 93) AS t INNER JOIN (SELECT * FROM warehouse WHERE w_gmt_offset = -5) AS t0 ON t.cs_warehouse_sk = t0.w_warehouse_sk INNER JOIN (SELECT * FROM ship_mode WHERE sm_type = 'NEXT DAY') AS t1 ON t.cs_ship_mode_sk = t1.sm_ship_mode_sk INNER JOIN (SELECT * FROM call_center WHERE cc_class = 'small') AS t2 ON t.cs_call_center_sk = t2.cc_call_center_sk INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1178 AND d_month_seq <= 1178 + 23) AS t3 ON t.cs_ship_date_sk = t3.d_date_sk","['FILTER_INTO_JOIN', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS']",0.018983841,0.016619841,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
128,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1179 and 1179 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 221 and 250 and sm_type = 'TWO DAY' and cc_class = 'medium' and w_gmt_offset = -5  ;","SELECT MIN(warehouse.w_warehouse_name), MIN(ship_mode.sm_type), MIN(call_center.cc_name), MIN(catalog_sales.cs_order_number), MIN(catalog_sales.cs_item_sk) FROM catalog_sales, warehouse, ship_mode, call_center, date_dim WHERE date_dim.d_month_seq >= 1179 AND date_dim.d_month_seq <= 1179 + 23 AND (catalog_sales.cs_ship_date_sk = date_dim.d_date_sk AND (catalog_sales.cs_warehouse_sk = warehouse.w_warehouse_sk AND catalog_sales.cs_ship_mode_sk = ship_mode.sm_ship_mode_sk)) AND (catalog_sales.cs_call_center_sk = call_center.cc_call_center_sk AND (catalog_sales.cs_list_price >= 221 AND catalog_sales.cs_list_price <= 250) AND (ship_mode.sm_type = 'TWO DAY' AND (call_center.cc_class = 'medium' AND warehouse.w_gmt_offset = -5)))","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'SORT_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'FILTER_TABLE_FUNCTION_TRANSPOSE']",0.017789602,0.016837994,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
129,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1180 and 1180 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 29 and 58 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5  ;","SELECT MIN(warehouse.w_warehouse_name), MIN(ship_mode.sm_type), MIN(call_center.cc_name), MIN(catalog_sales.cs_order_number), MIN(catalog_sales.cs_item_sk) FROM catalog_sales, warehouse, ship_mode, call_center, date_dim WHERE date_dim.d_month_seq >= 1180 AND date_dim.d_month_seq <= 1180 + 23 AND (catalog_sales.cs_ship_date_sk = date_dim.d_date_sk AND (catalog_sales.cs_warehouse_sk = warehouse.w_warehouse_sk AND catalog_sales.cs_ship_mode_sk = ship_mode.sm_ship_mode_sk)) AND (catalog_sales.cs_call_center_sk = call_center.cc_call_center_sk AND (catalog_sales.cs_list_price >= 29 AND catalog_sales.cs_list_price <= 58) AND (ship_mode.sm_type = 'LIBRARY' AND (call_center.cc_class = 'large' AND warehouse.w_gmt_offset = -5)))","['FILTER_REDUCE_EXPRESSIONS', 'FILTER_SCAN']",0.020317713,0.015058279,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
130,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1180 and 1180 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 73 and 102 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5  ;","SELECT MIN(t5.w_warehouse_name), MIN(t5.sm_type), MIN(t5.cc_name), MIN(t5.cs_order_number), MIN(t5.cs_item_sk) FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 73 AND cs_list_price <= 102) AS t, (SELECT * FROM warehouse WHERE w_gmt_offset = -5) AS t0 WHERE t.cs_warehouse_sk = t0.w_warehouse_sk) AS t1, (SELECT * FROM ship_mode WHERE sm_type = 'LIBRARY') AS t2 WHERE t1.cs_ship_mode_sk = t2.sm_ship_mode_sk) AS t3, (SELECT * FROM call_center WHERE cc_class = 'large') AS t4 WHERE t3.cs_call_center_sk = t4.cc_call_center_sk) AS t5, (SELECT * FROM date_dim WHERE d_month_seq >= 1180 AND d_month_seq <= 1180 + 23) AS t6 WHERE t5.cs_ship_date_sk = t6.d_date_sk","['PROJECT_TO_CALC', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER']",0.01748538,0.016389926,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
131,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1181 and 1181 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 155 and 184 and sm_type = 'OVERNIGHT' and cc_class = 'medium' and w_gmt_offset = -5  ;","SELECT MIN(t5.w_warehouse_name), MIN(t5.sm_type), MIN(t5.cc_name), MIN(t5.cs_order_number), MIN(t5.cs_item_sk) FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 155 AND cs_list_price <= 184) AS t, (SELECT * FROM warehouse WHERE w_gmt_offset = -5) AS t0 WHERE t.cs_warehouse_sk = t0.w_warehouse_sk) AS t1, (SELECT * FROM ship_mode WHERE sm_type = 'OVERNIGHT') AS t2 WHERE t1.cs_ship_mode_sk = t2.sm_ship_mode_sk) AS t3, (SELECT * FROM call_center WHERE cc_class = 'medium') AS t4 WHERE t3.cs_call_center_sk = t4.cc_call_center_sk) AS t5, (SELECT * FROM date_dim WHERE d_month_seq >= 1181 AND d_month_seq <= 1181 + 23) AS t6 WHERE t5.cs_ship_date_sk = t6.d_date_sk","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER']",0.018738985,0.017303308,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
132,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1191 and 1191 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 271 and 300 and sm_type = 'OVERNIGHT' and cc_class = 'large' and w_gmt_offset = -5  ;","SELECT MIN(t0.w_warehouse_name), MIN(t1.sm_type), MIN(t2.cc_name), MIN(t.cs_order_number), MIN(t.cs_item_sk) FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 271 AND cs_list_price <= 300) AS t INNER JOIN (SELECT * FROM warehouse WHERE w_gmt_offset = -5) AS t0 ON t.cs_warehouse_sk = t0.w_warehouse_sk INNER JOIN (SELECT * FROM ship_mode WHERE sm_type = 'OVERNIGHT') AS t1 ON t.cs_ship_mode_sk = t1.sm_ship_mode_sk INNER JOIN (SELECT * FROM call_center WHERE cc_class = 'large') AS t2 ON t.cs_call_center_sk = t2.cc_call_center_sk INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1191 AND d_month_seq <= 1191 + 23) AS t3 ON t.cs_ship_date_sk = t3.d_date_sk;","['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE']",0.01764822,0.015868028,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
133,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1196 and 1196 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 156 and 185 and sm_type = 'TWO DAY' and cc_class = 'large' and w_gmt_offset = -5  ;","SELECT MIN(t944.EXPR0), MIN(t944.EXPR1), MIN(t944.EXPR2), MIN(t944.EXPR3), MIN(t944.EXPR4) FROM (SELECT t940.cs_ship_date_sk, MIN(t940.EXPR0) AS EXPR0, MIN(t940.EXPR1) AS EXPR1, MIN(t942.EXPR2) AS EXPR2, MIN(t940.EXPR3) AS EXPR3, MIN(t940.EXPR4) AS EXPR4 FROM (SELECT t936.cs_ship_date_sk, t936.cs_call_center_sk, MIN(t936.EXPR0) AS EXPR0, MIN(t938.EXPR1) AS EXPR1, MIN(t936.EXPR3) AS EXPR3, MIN(t936.EXPR4) AS EXPR4 FROM (SELECT t932.cs_ship_date_sk, t932.cs_call_center_sk, t932.cs_ship_mode_sk, MIN(t934.EXPR0) AS EXPR0, MIN(t932.EXPR3) AS EXPR3, MIN(t932.EXPR4) AS EXPR4 FROM (SELECT cs_ship_date_sk, cs_call_center_sk, cs_ship_mode_sk, cs_warehouse_sk, MIN(cs_order_number) AS EXPR3, MIN(cs_item_sk) AS EXPR4 FROM catalog_sales WHERE cs_list_price >= 156 AND cs_list_price <= 185 GROUP BY cs_ship_date_sk, cs_call_center_sk, cs_ship_mode_sk, cs_warehouse_sk) AS t932, (SELECT w_warehouse_sk, MIN(w_warehouse_name) AS EXPR0 FROM warehouse WHERE w_gmt_offset = -5 GROUP BY w_warehouse_sk) AS t934 WHERE t932.cs_warehouse_sk = t934.w_warehouse_sk GROUP BY t932.cs_ship_date_sk, t932.cs_call_center_sk, t932.cs_ship_mode_sk) AS t936, (SELECT sm_ship_mode_sk, MIN(sm_type) AS EXPR1 FROM ship_mode WHERE sm_type = 'TWO DAY' GROUP BY sm_ship_mode_sk) AS t938 WHERE t936.cs_ship_mode_sk = t938.sm_ship_mode_sk GROUP BY t936.cs_ship_date_sk, t936.cs_call_center_sk) AS t940, (SELECT cc_call_center_sk, MIN(cc_name) AS EXPR2 FROM call_center WHERE cc_class = 'large' GROUP BY cc_call_center_sk) AS t942 WHERE t940.cs_call_center_sk = t942.cc_call_center_sk GROUP BY t940.cs_ship_date_sk) AS t944, (SELECT d_date_sk FROM date_dim WHERE d_month_seq >= 1196 AND d_month_seq <= 1196 + 23 GROUP BY d_date_sk) AS t946 WHERE t944.cs_ship_date_sk = t946.d_date_sk","['FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE', 'JOIN_EXTRACT_FILTER']",0.023258527,0.022271077,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
134,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1207 and 1207 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 195 and 224 and sm_type = 'TWO DAY' and cc_class = 'large' and w_gmt_offset = -5  ;","SELECT MIN(t0.w_warehouse_name), MIN(t1.sm_type), MIN(t2.cc_name), MIN(t.cs_order_number), MIN(t.cs_item_sk) FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 195 AND cs_list_price <= 224) AS t INNER JOIN (SELECT * FROM warehouse WHERE w_gmt_offset = -5) AS t0 ON t.cs_warehouse_sk = t0.w_warehouse_sk INNER JOIN (SELECT * FROM ship_mode WHERE sm_type = 'TWO DAY') AS t1 ON t.cs_ship_mode_sk = t1.sm_ship_mode_sk INNER JOIN (SELECT * FROM call_center WHERE cc_class = 'large') AS t2 ON t.cs_call_center_sk = t2.cc_call_center_sk INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1207 AND d_month_seq <= 1207 + 23) AS t3 ON t.cs_ship_date_sk = t3.d_date_sk;","['AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH']",0.019771576,0.017152945,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
135,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1210 and 1210 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 211 and 240 and sm_type = 'NEXT DAY' and cc_class = 'medium' and w_gmt_offset = -5  ;","SELECT MIN(t5.w_warehouse_name), MIN(t5.sm_type), MIN(t5.cc_name), MIN(t5.cs_order_number), MIN(t5.cs_item_sk) FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 211 AND cs_list_price <= 240) AS t, (SELECT * FROM warehouse WHERE w_gmt_offset = -5) AS t0 WHERE t.cs_warehouse_sk = t0.w_warehouse_sk) AS t1, (SELECT * FROM ship_mode WHERE sm_type = 'NEXT DAY') AS t2 WHERE t1.cs_ship_mode_sk = t2.sm_ship_mode_sk) AS t3, (SELECT * FROM call_center WHERE cc_class = 'medium') AS t4 WHERE t3.cs_call_center_sk = t4.cc_call_center_sk) AS t5, (SELECT * FROM date_dim WHERE d_month_seq >= 1210 AND d_month_seq <= 1210 + 23) AS t6 WHERE t5.cs_ship_date_sk = t6.d_date_sk;","['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_MERGE', 'FILTER_MULTI_JOIN_MERGE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_LEFT_TRANSPOSE', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_EXTRACT_FILTER', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_UNION_AGGREGATE', 'AGGREGATE_UNION_TRANSPOSE', 'AGGREGATE_VALUES', 'AGGREGATE_REMOVE', 'UNION_MERGE', 'UNION_REMOVE', 'UNION_TO_DISTINCT']",0.017598073,0.016174396,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
136,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IA', 'OK', 'OR') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'NC', 'NY') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'OK', 'TX') and ws_net_profit between 50 and 250 ) )  ;","SELECT MIN(web_sales.ws_quantity), MIN(web_returns.wr_refunded_cash), MIN(web_returns.wr_fee), MIN(web_sales.ws_item_sk), MIN(web_returns.wr_order_number), MIN(customer_demographics.cd_demo_sk), MIN(customer_demographics0.cd_demo_sk) FROM web_sales INNER JOIN web_returns ON web_sales.ws_item_sk = web_returns.wr_item_sk AND web_sales.ws_order_number = web_returns.wr_order_number INNER JOIN web_page ON web_sales.ws_web_page_sk = web_page.wp_web_page_sk INNER JOIN customer_demographics ON web_returns.wr_refunded_cdemo_sk = customer_demographics.cd_demo_sk INNER JOIN customer_demographics AS customer_demographics0 ON web_returns.wr_returning_cdemo_sk = customer_demographics0.cd_demo_sk AND (customer_demographics.cd_marital_status = 'S' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = 'Secondary' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 100.00 AND web_sales.ws_sales_price <= 150.00) OR customer_demographics.cd_marital_status = 'D' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = '4 yr Degree' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 50.00 AND web_sales.ws_sales_price <= 100.00) OR customer_demographics.cd_marital_status = 'W' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = '2 yr Degree' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 150.00 AND web_sales.ws_sales_price <= 200.00)) INNER JOIN customer_address ON web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk AND (customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('IA', 'OK', 'OR') AND (web_sales.ws_net_profit >= 100 AND web_sales.ws_net_profit <= 200) OR customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('GA', 'NC', 'NY') AND (web_sales.ws_net_profit >= 150 AND web_sales.ws_net_profit <= 300) OR customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('IL', 'OK', 'TX') AND (web_sales.ws_net_profit >= 50 AND web_sales.ws_net_profit <= 250)) INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t ON web_sales.ws_sold_date_sk = t.d_date_sk INNER JOIN reason ON web_returns.wr_reason_sk = reason.r_reason_sk;","['FILTER_INTO_JOIN', 'PROJECT_REDUCE_EXPRESSIONS', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE']",0.485115131,0.303402583,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
137,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('FL', 'PA', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AL', 'VA', 'WY') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'HI', 'ID') and ws_net_profit between 50 and 250 ) )  ;","SELECT MIN(web_sales.ws_quantity), MIN(web_returns.wr_refunded_cash), MIN(web_returns.wr_fee), MIN(web_sales.ws_item_sk), MIN(web_returns.wr_order_number), MIN(customer_demographics.cd_demo_sk), MIN(customer_demographics0.cd_demo_sk) FROM web_sales INNER JOIN web_returns ON web_sales.ws_item_sk = web_returns.wr_item_sk AND web_sales.ws_order_number = web_returns.wr_order_number INNER JOIN web_page ON web_sales.ws_web_page_sk = web_page.wp_web_page_sk INNER JOIN customer_demographics ON web_returns.wr_refunded_cdemo_sk = customer_demographics.cd_demo_sk INNER JOIN customer_demographics AS customer_demographics0 ON web_returns.wr_returning_cdemo_sk = customer_demographics0.cd_demo_sk AND (customer_demographics.cd_marital_status = 'D' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = 'Secondary' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 100.00 AND web_sales.ws_sales_price <= 150.00) OR customer_demographics.cd_marital_status = 'U' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = 'Advanced Degree' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 50.00 AND web_sales.ws_sales_price <= 100.00) OR customer_demographics.cd_marital_status = 'S' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = 'Primary' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 150.00 AND web_sales.ws_sales_price <= 200.00)) INNER JOIN customer_address ON web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk AND (customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('FL', 'PA', 'TX') AND (web_sales.ws_net_profit >= 100 AND web_sales.ws_net_profit <= 200) OR customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('AL', 'VA', 'WY') AND (web_sales.ws_net_profit >= 150 AND web_sales.ws_net_profit <= 300) OR customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('GA', 'HI', 'ID') AND (web_sales.ws_net_profit >= 50 AND web_sales.ws_net_profit <= 250)) INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t ON web_sales.ws_sold_date_sk = t.d_date_sk INNER JOIN reason ON web_returns.wr_reason_sk = reason.r_reason_sk;","['FILTER_INTO_JOIN', 'FILTER_MERGE', 'JOIN_REDUCE_EXPRESSIONS', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']",0.694755634,0.428051154,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
138,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('CA', 'NJ', 'NY') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('KY', 'NE', 'OH') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('MO', 'SC', 'TX') and ws_net_profit between 50 and 250 ) )  ;","SELECT MIN(web_sales.ws_quantity), MIN(web_returns.wr_refunded_cash), MIN(web_returns.wr_fee), MIN(web_sales.ws_item_sk), MIN(web_returns.wr_order_number), MIN(customer_demographics.cd_demo_sk), MIN(customer_demographics0.cd_demo_sk) FROM web_sales INNER JOIN web_returns ON web_sales.ws_item_sk = web_returns.wr_item_sk AND web_sales.ws_order_number = web_returns.wr_order_number INNER JOIN web_page ON web_sales.ws_web_page_sk = web_page.wp_web_page_sk INNER JOIN customer_demographics ON web_returns.wr_refunded_cdemo_sk = customer_demographics.cd_demo_sk INNER JOIN customer_demographics AS customer_demographics0 ON web_returns.wr_returning_cdemo_sk = customer_demographics0.cd_demo_sk AND (customer_demographics.cd_marital_status = 'M' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = 'Advanced Degree' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 100.00 AND web_sales.ws_sales_price <= 150.00) OR customer_demographics.cd_marital_status = 'U' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = 'Primary' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 50.00 AND web_sales.ws_sales_price <= 100.00) OR customer_demographics.cd_marital_status = 'S' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = '4 yr Degree' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 150.00 AND web_sales.ws_sales_price <= 200.00)) INNER JOIN customer_address ON web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk AND (customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('CA', 'NJ', 'NY') AND (web_sales.ws_net_profit >= 100 AND web_sales.ws_net_profit <= 200) OR customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('KY', 'NE', 'OH') AND (web_sales.ws_net_profit >= 150 AND web_sales.ws_net_profit <= 300) OR customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('MO', 'SC', 'TX') AND (web_sales.ws_net_profit >= 50 AND web_sales.ws_net_profit <= 250)) INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t ON web_sales.ws_sold_date_sk = t.d_date_sk INNER JOIN reason ON web_returns.wr_reason_sk = reason.r_reason_sk;","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']",1.898015658,1.849347274,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
139,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'MO', 'RI') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IL', 'MI', 'NE') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AR', 'CT', 'MI') and ws_net_profit between 50 and 250 ) )  ;","SELECT MIN(web_sales.ws_quantity), MIN(web_returns.wr_refunded_cash), MIN(web_returns.wr_fee), MIN(web_sales.ws_item_sk), MIN(web_returns.wr_order_number), MIN(customer_demographics.cd_demo_sk), MIN(customer_demographics0.cd_demo_sk) FROM web_sales INNER JOIN web_returns ON web_sales.ws_item_sk = web_returns.wr_item_sk AND web_sales.ws_order_number = web_returns.wr_order_number INNER JOIN web_page ON web_sales.ws_web_page_sk = web_page.wp_web_page_sk INNER JOIN customer_demographics ON web_returns.wr_refunded_cdemo_sk = customer_demographics.cd_demo_sk INNER JOIN customer_demographics AS customer_demographics0 ON web_returns.wr_returning_cdemo_sk = customer_demographics0.cd_demo_sk AND (customer_demographics.cd_marital_status = 'M' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = 'Unknown' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 100.00 AND web_sales.ws_sales_price <= 150.00) OR customer_demographics.cd_marital_status = 'S' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = 'Primary' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 50.00 AND web_sales.ws_sales_price <= 100.00) OR customer_demographics.cd_marital_status = 'W' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = '4 yr Degree' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 150.00 AND web_sales.ws_sales_price <= 200.00)) INNER JOIN customer_address ON web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk AND (customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('KS', 'MO', 'RI') AND (web_sales.ws_net_profit >= 100 AND web_sales.ws_net_profit <= 200) OR customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('IL', 'MI', 'NE') AND (web_sales.ws_net_profit >= 150 AND web_sales.ws_net_profit <= 300) OR customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('AR', 'CT', 'MI') AND (web_sales.ws_net_profit >= 50 AND web_sales.ws_net_profit <= 250)) INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t ON web_sales.ws_sold_date_sk = t.d_date_sk INNER JOIN reason ON web_returns.wr_reason_sk = reason.r_reason_sk;","['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'FILTER_PROJECT_TRANSPOSE']",0.303704103,0.290840387,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
140,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('CA', 'KS', 'PA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AL', 'ID', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'MD', 'WI') and ws_net_profit between 50 and 250 ) )  ;","SELECT MIN(web_sales.ws_quantity), MIN(web_returns.wr_refunded_cash), MIN(web_returns.wr_fee), MIN(web_sales.ws_item_sk), MIN(web_returns.wr_order_number), MIN(customer_demographics.cd_demo_sk), MIN(customer_demographics0.cd_demo_sk) FROM web_sales INNER JOIN web_returns ON web_sales.ws_item_sk = web_returns.wr_item_sk AND web_sales.ws_order_number = web_returns.wr_order_number INNER JOIN web_page ON web_sales.ws_web_page_sk = web_page.wp_web_page_sk INNER JOIN customer_demographics ON web_returns.wr_refunded_cdemo_sk = customer_demographics.cd_demo_sk INNER JOIN customer_demographics AS customer_demographics0 ON web_returns.wr_returning_cdemo_sk = customer_demographics0.cd_demo_sk AND (customer_demographics.cd_marital_status = 'M' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = '4 yr Degree' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 100.00 AND web_sales.ws_sales_price <= 150.00) OR customer_demographics.cd_marital_status = 'W' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = '2 yr Degree' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 50.00 AND web_sales.ws_sales_price <= 100.00) OR customer_demographics.cd_marital_status = 'S' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = 'Secondary' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 150.00 AND web_sales.ws_sales_price <= 200.00)) INNER JOIN customer_address ON web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk AND (customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('CA', 'KS', 'PA') AND (web_sales.ws_net_profit >= 100 AND web_sales.ws_net_profit <= 200) OR customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('AL', 'ID', 'TX') AND (web_sales.ws_net_profit >= 150 AND web_sales.ws_net_profit <= 300) OR customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('IL', 'MD', 'WI') AND (web_sales.ws_net_profit >= 50 AND web_sales.ws_net_profit <= 250)) INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t ON web_sales.ws_sold_date_sk = t.d_date_sk INNER JOIN reason ON web_returns.wr_reason_sk = reason.r_reason_sk;","['FILTER_INTO_JOIN', 'FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS']",0.512161016,0.490027428,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
141,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('GA', 'LA', 'VA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'ME', 'VA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'KY', 'TX') and ws_net_profit between 50 and 250 ) )  ;","SELECT MIN(web_sales.ws_quantity), MIN(web_returns.wr_refunded_cash), MIN(web_returns.wr_fee), MIN(web_sales.ws_item_sk), MIN(web_returns.wr_order_number), MIN(customer_demographics.cd_demo_sk), MIN(customer_demographics0.cd_demo_sk) FROM web_sales INNER JOIN web_returns ON web_sales.ws_item_sk = web_returns.wr_item_sk AND web_sales.ws_order_number = web_returns.wr_order_number INNER JOIN web_page ON web_sales.ws_web_page_sk = web_page.wp_web_page_sk INNER JOIN customer_demographics ON web_returns.wr_refunded_cdemo_sk = customer_demographics.cd_demo_sk INNER JOIN customer_demographics AS customer_demographics0 ON web_returns.wr_returning_cdemo_sk = customer_demographics0.cd_demo_sk AND (customer_demographics.cd_marital_status = 'M' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = 'Advanced Degree' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 100.00 AND web_sales.ws_sales_price <= 150.00) OR customer_demographics.cd_marital_status = 'S' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = 'Unknown' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 50.00 AND web_sales.ws_sales_price <= 100.00) OR customer_demographics.cd_marital_status = 'U' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = 'Primary' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 150.00 AND web_sales.ws_sales_price <= 200.00)) INNER JOIN customer_address ON web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk AND (customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('GA', 'LA', 'VA') AND (web_sales.ws_net_profit >= 100 AND web_sales.ws_net_profit <= 200) OR customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('GA', 'ME', 'VA') AND (web_sales.ws_net_profit >= 150 AND web_sales.ws_net_profit <= 300) OR customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('IL', 'KY', 'TX') AND (web_sales.ws_net_profit >= 50 AND web_sales.ws_net_profit <= 250)) INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t ON web_sales.ws_sold_date_sk = t.d_date_sk INNER JOIN reason ON web_returns.wr_reason_sk = reason.r_reason_sk;","['JOIN_CONDITION_PUSH', 'FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE']",1.977321386,1.899320682,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
142,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'ND', 'OK') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'LA', 'NC') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'ME', 'MI') and ws_net_profit between 50 and 250 ) )  ;","SELECT MIN(web_sales.ws_quantity), MIN(web_returns.wr_refunded_cash), MIN(web_returns.wr_fee), MIN(web_sales.ws_item_sk), MIN(web_returns.wr_order_number), MIN(customer_demographics.cd_demo_sk), MIN(customer_demographics0.cd_demo_sk) FROM web_sales INNER JOIN web_returns ON web_sales.ws_item_sk = web_returns.wr_item_sk AND web_sales.ws_order_number = web_returns.wr_order_number INNER JOIN web_page ON web_sales.ws_web_page_sk = web_page.wp_web_page_sk INNER JOIN customer_demographics ON web_returns.wr_refunded_cdemo_sk = customer_demographics.cd_demo_sk INNER JOIN customer_demographics AS customer_demographics0 ON web_returns.wr_returning_cdemo_sk = customer_demographics0.cd_demo_sk AND (customer_demographics.cd_marital_status = 'S' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = 'Unknown' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 100.00 AND web_sales.ws_sales_price <= 150.00) OR customer_demographics.cd_marital_status = 'D' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = 'Advanced Degree' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 50.00 AND web_sales.ws_sales_price <= 100.00) OR customer_demographics.cd_marital_status = 'M' AND customer_demographics.cd_marital_status = customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status = 'Secondary' AND customer_demographics.cd_education_status = customer_demographics0.cd_education_status AND (web_sales.ws_sales_price >= 150.00 AND web_sales.ws_sales_price <= 200.00)) INNER JOIN customer_address ON web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk AND (customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('KS', 'ND', 'OK') AND (web_sales.ws_net_profit >= 100 AND web_sales.ws_net_profit <= 200) OR customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('GA', 'LA', 'NC') AND (web_sales.ws_net_profit >= 150 AND web_sales.ws_net_profit <= 300) OR customer_address.ca_country = 'United States' AND customer_address.ca_state IN ('IL', 'ME', 'MI') AND (web_sales.ws_net_profit >= 50 AND web_sales.ws_net_profit <= 250)) INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t ON web_sales.ws_sold_date_sk = t.d_date_sk INNER JOIN reason ON web_returns.wr_reason_sk = reason.r_reason_sk;","['AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH']",0.360850414,0.346470912,"['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]"
143,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1177 and 1177+11 and ss_sales_price / ss_list_price BETWEEN 43 * 0.01 AND 53 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1177 and 1177+11 and ss_sales_price / ss_list_price BETWEEN 43 * 0.01 AND 53 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 43 and 47  and s_state in ('GA','KY','VA') order by s_store_name, i_item_desc limit 100 ;","SELECT store.s_store_name, item.i_item_desc, t6.revenue, item.i_current_price, item.i_wholesale_cost, item.i_brand FROM store, item, (SELECT t2.ss_store_sk, AVG(t2.revenue) AS ave FROM (SELECT store_sales.ss_store_sk, SUM(store_sales.ss_sales_price) AS revenue FROM store_sales, date_dim WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND date_dim.d_month_seq >= 1177 AND date_dim.d_month_seq <= 1177 + 11 AND store_sales.ss_sales_price / store_sales.ss_list_price >= 43 * 0.01 AND store_sales.ss_sales_price / store_sales.ss_list_price <= 53 * 0.01 GROUP BY store_sales.ss_store_sk, store_sales.ss_item_sk) AS t2 GROUP BY t2.ss_store_sk) AS t3, (SELECT store_sales0.ss_store_sk, store_sales0.ss_item_sk, SUM(store_sales0.ss_sales_price) AS revenue FROM store_sales AS store_sales0, date_dim AS date_dim0 WHERE store_sales0.ss_sold_date_sk = date_dim0.d_date_sk AND date_dim0.d_month_seq >= 1177 AND date_dim0.d_month_seq <= 1177 + 11 AND store_sales0.ss_sales_price / store_sales0.ss_list_price >= 43 * 0.01 AND store_sales0.ss_sales_price / store_sales0.ss_list_price <= 53 * 0.01 GROUP BY store_sales0.ss_store_sk, store_sales0.ss_item_sk) AS t6 WHERE t3.ss_store_sk = t6.ss_store_sk AND (t6.revenue <= 0.1 * t3.ave AND store.s_store_sk = t6.ss_store_sk) AND (item.i_item_sk = t6.ss_item_sk AND (item.i_manager_id >= 43 AND item.i_manager_id <= 47 AND store.s_state IN ('GA', 'KY', 'VA'))) ORDER BY store.s_store_name, item.i_item_desc LIMIT 100","['FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE']",7.544745366,6.665253321,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]]]"
144,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1178 and 1178+11 and ss_sales_price / ss_list_price BETWEEN 82 * 0.01 AND 92 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1178 and 1178+11 and ss_sales_price / ss_list_price BETWEEN 82 * 0.01 AND 92 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 84 and 88  and s_state in ('AL','GA','UT') order by s_store_name, i_item_desc limit 100 ;","SELECT t1564.s_store_name, t1565.i_item_desc, t1577.revenue, t1565.i_current_price, t1565.i_wholesale_cost, t1565.i_brand FROM (SELECT * FROM store WHERE s_state IN ('AL', 'GA', 'UT')) AS t1564, (SELECT * FROM item WHERE i_manager_id >= 84 AND i_manager_id <= 88) AS t1565, (SELECT t1571.ss_store_sk, AVG(t1571.revenue) AS ave FROM (SELECT t1566.ss_store_sk, SUM(t1566.ss_sales_price) AS revenue FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 82 * 0.01 AND ss_sales_price / ss_list_price <= 92 * 0.01) AS t1566, (SELECT * FROM date_dim WHERE d_month_seq >= 1178 AND d_month_seq <= 1178 + 11) AS t1567 WHERE t1566.ss_sold_date_sk = t1567.d_date_sk GROUP BY t1566.ss_store_sk, t1566.ss_item_sk) AS t1571 GROUP BY t1571.ss_store_sk) AS t1572, (SELECT t1573.ss_store_sk, t1573.ss_item_sk, SUM(t1573.ss_sales_price) AS revenue FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 82 * 0.01 AND ss_sales_price / ss_list_price <= 92 * 0.01) AS t1573, (SELECT * FROM date_dim WHERE d_month_seq >= 1178 AND d_month_seq <= 1178 + 11) AS t1574 WHERE t1573.ss_sold_date_sk = t1574.d_date_sk GROUP BY t1573.ss_store_sk, t1573.ss_item_sk) AS t1577 WHERE t1572.ss_store_sk = t1577.ss_store_sk AND t1577.revenue <= 0.1 * t1572.ave AND t1564.s_store_sk = t1577.ss_store_sk AND t1565.i_item_sk = t1577.ss_item_sk ORDER BY t1564.s_store_name, t1565.i_item_desc LIMIT 100","['PROJECT_TO_CALC', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER']",6.475800673,6.459508657,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]]]"
145,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1179 and 1179+11 and ss_sales_price / ss_list_price BETWEEN 34 * 0.01 AND 44 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1179 and 1179+11 and ss_sales_price / ss_list_price BETWEEN 34 * 0.01 AND 44 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 46 and 50  and s_state in ('AR','OR','TX') order by s_store_name, i_item_desc limit 100 ;","SELECT t226.s_store_name, t227.i_item_desc, t241.revenue, t227.i_current_price, t227.i_wholesale_cost, t227.i_brand FROM (SELECT * FROM store WHERE s_state IN ('AR', 'OR', 'TX')) AS t226 CROSS JOIN (SELECT * FROM item WHERE i_manager_id >= 46 AND i_manager_id <= 50) AS t227 CROSS JOIN (SELECT t233.ss_store_sk, AVG(t233.revenue) AS ave FROM (SELECT t229.ss_item_sk, t229.ss_store_sk, SUM(t229.revenue * t231.f1) AS revenue FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_store_sk, SUM(ss_sales_price) AS revenue FROM store_sales WHERE ss_sales_price / ss_list_price >= 34 * 0.01 AND ss_sales_price / ss_list_price <= 44 * 0.01 GROUP BY ss_sold_date_sk, ss_item_sk, ss_store_sk) AS t229 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_month_seq >= 1179 AND d_month_seq <= 1179 + 11 GROUP BY d_date_sk) AS t231 ON t229.ss_sold_date_sk = t231.d_date_sk GROUP BY t229.ss_item_sk, t229.ss_store_sk) AS t233 GROUP BY t233.ss_store_sk) AS t234 INNER JOIN (SELECT t236.ss_store_sk, t236.ss_item_sk, SUM(t236.revenue * t238.f1) AS revenue FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_store_sk, SUM(ss_sales_price) AS revenue FROM store_sales WHERE ss_sales_price / ss_list_price >= 34 * 0.01 AND ss_sales_price / ss_list_price <= 44 * 0.01 GROUP BY ss_sold_date_sk, ss_item_sk, ss_store_sk) AS t236 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_month_seq >= 1179 AND d_month_seq <= 1179 + 11 GROUP BY d_date_sk) AS t238 ON t236.ss_sold_date_sk = t238.d_date_sk GROUP BY t236.ss_item_sk, t236.ss_store_sk) AS t241 ON t234.ss_store_sk = t241.ss_store_sk AND t241.revenue <= 0.1 * t234.ave AND t226.s_store_sk = t241.ss_store_sk AND t227.i_item_sk = t241.ss_item_sk ORDER BY t226.s_store_name, t227.i_item_desc LIMIT 100","['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'PROJECT_TO_CALC']",7.848341942,5.620405038,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]]]"
146,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1188 and 1188+11 and ss_sales_price / ss_list_price BETWEEN 38 * 0.01 AND 48 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1188 and 1188+11 and ss_sales_price / ss_list_price BETWEEN 38 * 0.01 AND 48 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 91 and 95  and s_state in ('ID','OK','SD') order by s_store_name, i_item_desc limit 100 ;","SELECT t1553.s_store_name, t1554.i_item_desc, t1568.revenue, t1554.i_current_price, t1554.i_wholesale_cost, t1554.i_brand FROM (SELECT * FROM store WHERE s_state IN ('ID', 'OK', 'SD')) AS t1553 CROSS JOIN (SELECT * FROM item WHERE i_manager_id >= 91 AND i_manager_id <= 95) AS t1554 CROSS JOIN (SELECT t1560.ss_store_sk, AVG(t1560.revenue) AS ave FROM (SELECT t1556.ss_item_sk, t1556.ss_store_sk, SUM(t1556.revenue * t1558.f1) AS revenue FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_store_sk, SUM(ss_sales_price) AS revenue FROM store_sales WHERE ss_sales_price / ss_list_price >= 38 * 0.01 AND ss_sales_price / ss_list_price <= 48 * 0.01 GROUP BY ss_sold_date_sk, ss_item_sk, ss_store_sk) AS t1556 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_month_seq >= 1188 AND d_month_seq <= 1188 + 11 GROUP BY d_date_sk) AS t1558 ON t1556.ss_sold_date_sk = t1558.d_date_sk GROUP BY t1556.ss_item_sk, t1556.ss_store_sk) AS t1560 GROUP BY t1560.ss_store_sk) AS t1561 INNER JOIN (SELECT t1563.ss_store_sk, t1563.ss_item_sk, SUM(t1563.revenue * t1565.f1) AS revenue FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_store_sk, SUM(ss_sales_price) AS revenue FROM store_sales WHERE ss_sales_price / ss_list_price >= 38 * 0.01 AND ss_sales_price / ss_list_price <= 48 * 0.01 GROUP BY ss_sold_date_sk, ss_item_sk, ss_store_sk) AS t1563 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_month_seq >= 1188 AND d_month_seq <= 1188 + 11 GROUP BY d_date_sk) AS t1565 ON t1563.ss_sold_date_sk = t1565.d_date_sk GROUP BY t1563.ss_item_sk, t1563.ss_store_sk) AS t1568 ON t1561.ss_store_sk = t1568.ss_store_sk AND t1568.revenue <= 0.1 * t1561.ave AND t1553.s_store_sk = t1568.ss_store_sk AND t1554.i_item_sk = t1568.ss_item_sk ORDER BY t1553.s_store_name, t1554.i_item_desc LIMIT 100","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'PROJECT_TO_CALC']",14.06977646,11.10134959,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]]]"
147,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1200 and 1200+11 and ss_sales_price / ss_list_price BETWEEN 23 * 0.01 AND 33 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1200 and 1200+11 and ss_sales_price / ss_list_price BETWEEN 23 * 0.01 AND 33 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 80 and 84  and s_state in ('NC','NH','WV') order by s_store_name, i_item_desc limit 100 ;","SELECT t301.s_store_name, t302.i_item_desc, t318.revenue, t302.i_current_price, t302.i_wholesale_cost, t302.i_brand FROM (SELECT * FROM store WHERE s_state IN ('NC', 'NH', 'WV')) AS t301, (SELECT * FROM item WHERE i_manager_id >= 80 AND i_manager_id <= 84) AS t302, (SELECT t309.ss_store_sk, AVG(t309.revenue) AS ave FROM (SELECT t304.ss_item_sk, t304.ss_store_sk, SUM(t304.revenue * t306.f1) AS revenue FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_store_sk, SUM(ss_sales_price) AS revenue FROM store_sales WHERE ss_sales_price / ss_list_price >= 23 * 0.01 AND ss_sales_price / ss_list_price <= 33 * 0.01 GROUP BY ss_sold_date_sk, ss_item_sk, ss_store_sk) AS t304, (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_month_seq >= 1200 AND d_month_seq <= 1200 + 11 GROUP BY d_date_sk) AS t306 WHERE t304.ss_sold_date_sk = t306.d_date_sk GROUP BY t304.ss_item_sk, t304.ss_store_sk) AS t309 GROUP BY t309.ss_store_sk) AS t310, (SELECT t312.ss_store_sk, t312.ss_item_sk, SUM(t312.revenue * t314.f1) AS revenue FROM (SELECT ss_sold_date_sk, ss_item_sk, ss_store_sk, SUM(ss_sales_price) AS revenue FROM store_sales WHERE ss_sales_price / ss_list_price >= 23 * 0.01 AND ss_sales_price / ss_list_price <= 33 * 0.01 GROUP BY ss_sold_date_sk, ss_item_sk, ss_store_sk) AS t312, (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_month_seq >= 1200 AND d_month_seq <= 1200 + 11 GROUP BY d_date_sk) AS t314 WHERE t312.ss_sold_date_sk = t314.d_date_sk GROUP BY t312.ss_item_sk, t312.ss_store_sk) AS t318 WHERE t310.ss_store_sk = t318.ss_store_sk AND t318.revenue <= 0.1 * t310.ave AND t301.s_store_sk = t318.ss_store_sk AND t302.i_item_sk = t318.ss_item_sk ORDER BY t301.s_store_name, t302.i_item_desc LIMIT 100","['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']",12.06033071,5.827379624,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]]]"
148,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1203 and 1203+11 and ss_sales_price / ss_list_price BETWEEN 77 * 0.01 AND 87 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1203 and 1203+11 and ss_sales_price / ss_list_price BETWEEN 77 * 0.01 AND 87 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 72 and 76  and s_state in ('GA','NM','SC') order by s_store_name, i_item_desc limit 100 ;","SELECT store.s_store_name, item.i_item_desc, t4.revenue, item.i_current_price, item.i_wholesale_cost, item.i_brand FROM store, item, (SELECT t0.ss_store_sk, AVG(t0.revenue) AS ave FROM (SELECT store_sales.ss_item_sk, store_sales.ss_store_sk, SUM(store_sales.ss_sales_price) AS revenue FROM store_sales, date_dim WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND date_dim.d_month_seq >= 1203 AND date_dim.d_month_seq <= 1203 + 11 AND store_sales.ss_sales_price / store_sales.ss_list_price >= 77 * 0.01 AND store_sales.ss_sales_price / store_sales.ss_list_price <= 87 * 0.01 GROUP BY store_sales.ss_item_sk, store_sales.ss_store_sk) AS t0 GROUP BY t0.ss_store_sk) AS t1, (SELECT store_sales0.ss_store_sk, store_sales0.ss_item_sk, SUM(store_sales0.ss_sales_price) AS revenue FROM store_sales AS store_sales0, date_dim AS date_dim0 WHERE store_sales0.ss_sold_date_sk = date_dim0.d_date_sk AND date_dim0.d_month_seq >= 1203 AND date_dim0.d_month_seq <= 1203 + 11 AND store_sales0.ss_sales_price / store_sales0.ss_list_price >= 77 * 0.01 AND store_sales0.ss_sales_price / store_sales0.ss_list_price <= 87 * 0.01 GROUP BY store_sales0.ss_item_sk, store_sales0.ss_store_sk) AS t4 WHERE t1.ss_store_sk = t4.ss_store_sk AND (t4.revenue <= 0.1 * t1.ave AND store.s_store_sk = t4.ss_store_sk) AND (item.i_item_sk = t4.ss_item_sk AND item.i_manager_id >= 72 AND (item.i_manager_id <= 76 AND (store.s_state = 'GA' OR store.s_state = 'NM' OR store.s_state = 'SC'))) ORDER BY store.s_store_name, item.i_item_desc LIMIT 100;","['FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'JOIN_PROJECT_LEFT_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']",11.22909927,5.789843639,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]]]"
149,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1212 and 1212+11 and ss_sales_price / ss_list_price BETWEEN 13 * 0.01 AND 23 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1212 and 1212+11 and ss_sales_price / ss_list_price BETWEEN 13 * 0.01 AND 23 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 88 and 92  and s_state in ('KS','NC','RI') order by s_store_name, i_item_desc limit 100 ;","SELECT store.s_store_name, item.i_item_desc, t4.revenue, item.i_current_price, item.i_wholesale_cost, item.i_brand FROM store, item, (SELECT t0.ss_store_sk, AVG(t0.revenue) AS ave FROM (SELECT store_sales.ss_item_sk, store_sales.ss_store_sk, SUM(store_sales.ss_sales_price) AS revenue FROM store_sales, date_dim WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND date_dim.d_month_seq >= 1212 AND date_dim.d_month_seq <= 1212 + 11 AND store_sales.ss_sales_price / store_sales.ss_list_price >= 13 * 0.01 AND store_sales.ss_sales_price / store_sales.ss_list_price <= 23 * 0.01 GROUP BY store_sales.ss_item_sk, store_sales.ss_store_sk) AS t0 GROUP BY t0.ss_store_sk) AS t1, (SELECT store_sales0.ss_store_sk, store_sales0.ss_item_sk, SUM(store_sales0.ss_sales_price) AS revenue FROM store_sales AS store_sales0, date_dim AS date_dim0 WHERE store_sales0.ss_sold_date_sk = date_dim0.d_date_sk AND date_dim0.d_month_seq >= 1212 AND date_dim0.d_month_seq <= 1212 + 11 AND store_sales0.ss_sales_price / store_sales0.ss_list_price >= 13 * 0.01 AND store_sales0.ss_sales_price / store_sales0.ss_list_price <= 23 * 0.01 GROUP BY store_sales0.ss_item_sk, store_sales0.ss_store_sk) AS t4 WHERE t1.ss_store_sk = t4.ss_store_sk AND (t4.revenue <= 0.1 * t1.ave AND store.s_store_sk = t4.ss_store_sk) AND (item.i_item_sk = t4.ss_item_sk AND item.i_manager_id >= 88 AND (item.i_manager_id <= 92 AND (store.s_state = 'KS' OR store.s_state = 'NC' OR store.s_state = 'RI'))) ORDER BY store.s_store_name, item.i_item_desc LIMIT 100;","['AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'JOIN_CONDITION_PUSH']",14.06436356,6.900687615,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]]]]"
150,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 21 AND 41 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 71 and 71 + 10 and p_channel_email = 'Y' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('IN','MI','OH') and ss_wholesale_cost BETWEEN 21 AND 41 and cd1.cd_marital_status in ('W', 'M', 'W') and cd1.cd_education_status in ('Primary', 'Advanced Degree', 'Primary') and cd2.cd_marital_status in ('W', 'M', 'W') and cd2.cd_education_status in ('Primary', 'Advanced Degree', 'Primary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;","SELECT t5.i_product_name AS product_name, t5.s_store_name AS store_name, t5.s_zip AS store_zip, t5.ca_street_number AS b_street_number, t5.ca_street_name AS b_street_name, t5.ca_city AS b_city, t5.ca_zip AS b_zip, t5.ca_street_number0 AS c_street_number, t5.ca_street_name0 AS c_street_name, t5.ca_city0 AS c_city, t5.ca_zip0 AS c_zip, t5.d_year AS syear, t5.cnt, t5.s1 AS s11, t5.s2 AS s21, t5.s3 AS s31, t12.s1 AS s12, t12.s2 AS s22, t12.s3 AS s32, t12.d_year AS syear0, t12.cnt AS cnt0 FROM (SELECT item.i_product_name, item.i_item_sk, store.s_store_name, store.s_zip, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number AS ca_street_number0, customer_address0.ca_street_name AS ca_street_name0, customer_address0.ca_city AS ca_city0, customer_address0.ca_zip AS ca_zip0, date_dim.d_year, date_dim0.d_year AS d_year0, date_dim1.d_year AS d_year1, COUNT(*) AS cnt, SUM(store_sales.ss_wholesale_cost) AS s1, SUM(store_sales.ss_list_price) AS s2, SUM(store_sales.ss_coupon_amt) AS s3 FROM store_sales, store_returns, (SELECT catalog_sales.cs_item_sk, SUM(catalog_sales.cs_ext_list_price) AS sale, SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit) AS refund FROM catalog_sales, catalog_returns WHERE catalog_sales.cs_item_sk = catalog_returns.cr_item_sk AND catalog_sales.cs_order_number = catalog_returns.cr_order_number AND catalog_sales.cs_wholesale_cost >= 21 AND catalog_sales.cs_wholesale_cost <= 41 GROUP BY catalog_sales.cs_item_sk HAVING SUM(catalog_sales.cs_ext_list_price) > 2 * SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit)) AS t2, date_dim, date_dim AS date_dim0, date_dim AS date_dim1, store, customer, customer_demographics, customer_demographics AS customer_demographics0, promotion, household_demographics, household_demographics AS household_demographics0, customer_address, customer_address AS customer_address0, income_band, income_band AS income_band0, item WHERE store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk) AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (store_sales.ss_addr_sk = customer_address.ca_address_sk AND store_sales.ss_item_sk = item.i_item_sk)) AND (store_sales.ss_item_sk = store_returns.sr_item_sk AND store_sales.ss_ticket_number = store_returns.sr_ticket_number AND (store_sales.ss_item_sk = t2.cs_item_sk AND customer.c_current_cdemo_sk = customer_demographics0.cd_demo_sk) AND (customer.c_current_hdemo_sk = household_demographics0.hd_demo_sk AND customer.c_current_addr_sk = customer_address0.ca_address_sk AND (customer.c_first_sales_date_sk = date_dim0.d_date_sk AND customer.c_first_shipto_date_sk = date_dim1.d_date_sk))) AND (store_sales.ss_promo_sk = promotion.p_promo_sk AND household_demographics.hd_income_band_sk = income_band.ib_income_band_sk AND (household_demographics0.hd_income_band_sk = income_band0.ib_income_band_sk AND customer_demographics.cd_marital_status <> customer_demographics0.cd_marital_status) AND (item.i_current_price >= 71 AND item.i_current_price <= 71 + 10 AND (promotion.p_channel_email = 'Y' AND promotion.p_channel_tv = 'Y')) AND (promotion.p_channel_radio = 'Y' AND (customer_address0.ca_state = 'IN' OR customer_address0.ca_state = 'MI' OR customer_address0.ca_state = 'OH') AND (store_sales.ss_wholesale_cost >= 21 AND store_sales.ss_wholesale_cost <= 41) AND ((customer_demographics.cd_marital_status = 'W' OR customer_demographics.cd_marital_status = 'M') AND (customer_demographics.cd_education_status = 'Primary' OR customer_demographics.cd_education_status = 'Advanced Degree') AND ((customer_demographics0.cd_marital_status = 'W' OR customer_demographics0.cd_marital_status = 'M') AND (customer_demographics0.cd_education_status = 'Primary' OR customer_demographics0.cd_education_status = 'Advanced Degree'))))) GROUP BY date_dim.d_year, date_dim0.d_year, date_dim1.d_year, store.s_zip, store.s_store_name, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number, customer_address0.ca_street_name, customer_address0.ca_city, customer_address0.ca_zip, item.i_item_sk, item.i_product_name) AS t5, (SELECT item0.i_product_name, item0.i_item_sk, store0.s_store_name, store0.s_zip, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number AS ca_street_number0, customer_address2.ca_street_name AS ca_street_name0, customer_address2.ca_city AS ca_city0, customer_address2.ca_zip AS ca_zip0, date_dim2.d_year, date_dim3.d_year AS d_year0, date_dim4.d_year AS d_year1, COUNT(*) AS cnt, SUM(store_sales0.ss_wholesale_cost) AS s1, SUM(store_sales0.ss_list_price) AS s2, SUM(store_sales0.ss_coupon_amt) AS s3 FROM store_sales AS store_sales0, store_returns AS store_returns0, (SELECT catalog_sales0.cs_item_sk, SUM(catalog_sales0.cs_ext_list_price) AS sale, SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit) AS refund FROM catalog_sales AS catalog_sales0, catalog_returns AS catalog_returns0 WHERE catalog_sales0.cs_item_sk = catalog_returns0.cr_item_sk AND catalog_sales0.cs_order_number = catalog_returns0.cr_order_number AND catalog_sales0.cs_wholesale_cost >= 21 AND catalog_sales0.cs_wholesale_cost <= 41 GROUP BY catalog_sales0.cs_item_sk HAVING SUM(catalog_sales0.cs_ext_list_price) > 2 * SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit)) AS t9, date_dim AS date_dim2, date_dim AS date_dim3, date_dim AS date_dim4, store AS store0, customer AS customer0, customer_demographics AS customer_demographics1, customer_demographics AS customer_demographics2, promotion AS promotion0, household_demographics AS household_demographics1, household_demographics AS household_demographics2, customer_address AS customer_address1, customer_address AS customer_address2, income_band AS income_band1, income_band AS income_band2, item AS item0 WHERE store_sales0.ss_store_sk = store0.s_store_sk AND (store_sales0.ss_sold_date_sk = date_dim2.d_date_sk AND store_sales0.ss_customer_sk = customer0.c_customer_sk) AND (store_sales0.ss_cdemo_sk = customer_demographics1.cd_demo_sk AND store_sales0.ss_hdemo_sk = household_demographics1.hd_demo_sk AND (store_sales0.ss_addr_sk = customer_address1.ca_address_sk AND store_sales0.ss_item_sk = item0.i_item_sk)) AND (store_sales0.ss_item_sk = store_returns0.sr_item_sk AND store_sales0.ss_ticket_number = store_returns0.sr_ticket_number AND (store_sales0.ss_item_sk = t9.cs_item_sk AND customer0.c_current_cdemo_sk = customer_demographics2.cd_demo_sk) AND (customer0.c_current_hdemo_sk = household_demographics2.hd_demo_sk AND customer0.c_current_addr_sk = customer_address2.ca_address_sk AND (customer0.c_first_sales_date_sk = date_dim3.d_date_sk AND customer0.c_first_shipto_date_sk = date_dim4.d_date_sk))) AND (store_sales0.ss_promo_sk = promotion0.p_promo_sk AND household_demographics1.hd_income_band_sk = income_band1.ib_income_band_sk AND (household_demographics2.hd_income_band_sk = income_band2.ib_income_band_sk AND customer_demographics1.cd_marital_status <> customer_demographics2.cd_marital_status) AND (item0.i_current_price >= 71 AND item0.i_current_price <= 71 + 10 AND (promotion0.p_channel_email = 'Y' AND promotion0.p_channel_tv = 'Y')) AND (promotion0.p_channel_radio = 'Y' AND (customer_address2.ca_state = 'IN' OR customer_address2.ca_state = 'MI' OR customer_address2.ca_state = 'OH') AND (store_sales0.ss_wholesale_cost >= 21 AND store_sales0.ss_wholesale_cost <= 41) AND ((customer_demographics1.cd_marital_status = 'W' OR customer_demographics1.cd_marital_status = 'M') AND (customer_demographics1.cd_education_status = 'Primary' OR customer_demographics1.cd_education_status = 'Advanced Degree') AND ((customer_demographics2.cd_marital_status = 'W' OR customer_demographics2.cd_marital_status = 'M') AND (customer_demographics2.cd_education_status = 'Primary' OR customer_demographics2.cd_education_status = 'Advanced Degree'))))) GROUP BY date_dim2.d_year, date_dim3.d_year, date_dim4.d_year, store0.s_zip, store0.s_store_name, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number, customer_address2.ca_street_name, customer_address2.ca_city, customer_address2.ca_zip, item0.i_item_sk, item0.i_product_name) AS t12 WHERE t5.i_item_sk = t12.i_item_sk AND (t5.d_year = 2001 AND t12.d_year = 2001 + 1) AND (t12.cnt <= t5.cnt AND (t5.s_store_name = t12.s_store_name AND t5.s_zip = t12.s_zip)) ORDER BY t5.i_product_name, t5.s_store_name, t12.cnt, t5.s1, t12.s1","['AGGREGATE_PROJECT_MERGE', 'JOIN_CONDITION_PUSH', 'FILTER_SCAN']",12.31943727,11.8960437,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
151,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 3 AND 23 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 28 and 28 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('AL','KS','PA') and ss_wholesale_cost BETWEEN 3 AND 23 and cd1.cd_marital_status in ('M', 'D', 'S') and cd1.cd_education_status in ('Advanced Degree', 'Unknown', '4 yr Degree') and cd2.cd_marital_status in ('M', 'D', 'S') and cd2.cd_education_status in ('Advanced Degree', 'Unknown', '4 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;","SELECT t5.i_product_name AS product_name, t5.s_store_name AS store_name, t5.s_zip AS store_zip, t5.ca_street_number AS b_street_number, t5.ca_street_name AS b_street_name, t5.ca_city AS b_city, t5.ca_zip AS b_zip, t5.ca_street_number0 AS c_street_number, t5.ca_street_name0 AS c_street_name, t5.ca_city0 AS c_city, t5.ca_zip0 AS c_zip, t5.d_year AS syear, t5.cnt, t5.s1 AS s11, t5.s2 AS s21, t5.s3 AS s31, t12.s1 AS s12, t12.s2 AS s22, t12.s3 AS s32, t12.d_year AS syear0, t12.cnt AS cnt0 FROM (SELECT item.i_product_name, item.i_item_sk, store.s_store_name, store.s_zip, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number AS ca_street_number0, customer_address0.ca_street_name AS ca_street_name0, customer_address0.ca_city AS ca_city0, customer_address0.ca_zip AS ca_zip0, date_dim.d_year, date_dim0.d_year AS d_year0, date_dim1.d_year AS d_year1, COUNT(*) AS cnt, SUM(store_sales.ss_wholesale_cost) AS s1, SUM(store_sales.ss_list_price) AS s2, SUM(store_sales.ss_coupon_amt) AS s3 FROM store_sales, store_returns, (SELECT catalog_sales.cs_item_sk, SUM(catalog_sales.cs_ext_list_price) AS sale, SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit) AS refund FROM catalog_sales, catalog_returns WHERE catalog_sales.cs_item_sk = catalog_returns.cr_item_sk AND catalog_sales.cs_order_number = catalog_returns.cr_order_number AND catalog_sales.cs_wholesale_cost >= 3 AND catalog_sales.cs_wholesale_cost <= 23 GROUP BY catalog_sales.cs_item_sk HAVING SUM(catalog_sales.cs_ext_list_price) > 2 * SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit)) AS t2, date_dim, date_dim AS date_dim0, date_dim AS date_dim1, store, customer, customer_demographics, customer_demographics AS customer_demographics0, promotion, household_demographics, household_demographics AS household_demographics0, customer_address, customer_address AS customer_address0, income_band, income_band AS income_band0, item WHERE store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk) AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (store_sales.ss_addr_sk = customer_address.ca_address_sk AND store_sales.ss_item_sk = item.i_item_sk)) AND (store_sales.ss_item_sk = store_returns.sr_item_sk AND store_sales.ss_ticket_number = store_returns.sr_ticket_number AND (store_sales.ss_item_sk = t2.cs_item_sk AND customer.c_current_cdemo_sk = customer_demographics0.cd_demo_sk) AND (customer.c_current_hdemo_sk = household_demographics0.hd_demo_sk AND customer.c_current_addr_sk = customer_address0.ca_address_sk AND (customer.c_first_sales_date_sk = date_dim0.d_date_sk AND customer.c_first_shipto_date_sk = date_dim1.d_date_sk))) AND (store_sales.ss_promo_sk = promotion.p_promo_sk AND household_demographics.hd_income_band_sk = income_band.ib_income_band_sk AND (household_demographics0.hd_income_band_sk = income_band0.ib_income_band_sk AND customer_demographics.cd_marital_status <> customer_demographics0.cd_marital_status) AND (item.i_current_price >= 28 AND item.i_current_price <= 28 + 10 AND (promotion.p_channel_email = 'Y' AND promotion.p_channel_tv = 'N')) AND (promotion.p_channel_radio = 'Y' AND (customer_address0.ca_state = 'AL' OR customer_address0.ca_state = 'KS' OR customer_address0.ca_state = 'PA') AND (store_sales.ss_wholesale_cost >= 3 AND store_sales.ss_wholesale_cost <= 23) AND ((customer_demographics.cd_marital_status = 'M' OR customer_demographics.cd_marital_status = 'D' OR customer_demographics.cd_marital_status = 'S') AND (customer_demographics.cd_education_status = 'Advanced Degree' OR customer_demographics.cd_education_status = 'Unknown' OR customer_demographics.cd_education_status = '4 yr Degree') AND ((customer_demographics0.cd_marital_status = 'M' OR customer_demographics0.cd_marital_status = 'D' OR customer_demographics0.cd_marital_status = 'S') AND (customer_demographics0.cd_education_status = 'Advanced Degree' OR customer_demographics0.cd_education_status = 'Unknown' OR customer_demographics0.cd_education_status = '4 yr Degree'))))) GROUP BY date_dim.d_year, date_dim0.d_year, date_dim1.d_year, store.s_zip, store.s_store_name, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number, customer_address0.ca_street_name, customer_address0.ca_city, customer_address0.ca_zip, item.i_item_sk, item.i_product_name) AS t5, (SELECT item0.i_product_name, item0.i_item_sk, store0.s_store_name, store0.s_zip, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number AS ca_street_number0, customer_address2.ca_street_name AS ca_street_name0, customer_address2.ca_city AS ca_city0, customer_address2.ca_zip AS ca_zip0, date_dim2.d_year, date_dim3.d_year AS d_year0, date_dim4.d_year AS d_year1, COUNT(*) AS cnt, SUM(store_sales0.ss_wholesale_cost) AS s1, SUM(store_sales0.ss_list_price) AS s2, SUM(store_sales0.ss_coupon_amt) AS s3 FROM store_sales AS store_sales0, store_returns AS store_returns0, (SELECT catalog_sales0.cs_item_sk, SUM(catalog_sales0.cs_ext_list_price) AS sale, SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit) AS refund FROM catalog_sales AS catalog_sales0, catalog_returns AS catalog_returns0 WHERE catalog_sales0.cs_item_sk = catalog_returns0.cr_item_sk AND catalog_sales0.cs_order_number = catalog_returns0.cr_order_number AND catalog_sales0.cs_wholesale_cost >= 3 AND catalog_sales0.cs_wholesale_cost <= 23 GROUP BY catalog_sales0.cs_item_sk HAVING SUM(catalog_sales0.cs_ext_list_price) > 2 * SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit)) AS t9, date_dim AS date_dim2, date_dim AS date_dim3, date_dim AS date_dim4, store AS store0, customer AS customer0, customer_demographics AS customer_demographics1, customer_demographics AS customer_demographics2, promotion AS promotion0, household_demographics AS household_demographics1, household_demographics AS household_demographics2, customer_address AS customer_address1, customer_address AS customer_address2, income_band AS income_band1, income_band AS income_band2, item AS item0 WHERE store_sales0.ss_store_sk = store0.s_store_sk AND (store_sales0.ss_sold_date_sk = date_dim2.d_date_sk AND store_sales0.ss_customer_sk = customer0.c_customer_sk) AND (store_sales0.ss_cdemo_sk = customer_demographics1.cd_demo_sk AND store_sales0.ss_hdemo_sk = household_demographics1.hd_demo_sk AND (store_sales0.ss_addr_sk = customer_address1.ca_address_sk AND store_sales0.ss_item_sk = item0.i_item_sk)) AND (store_sales0.ss_item_sk = store_returns0.sr_item_sk AND store_sales0.ss_ticket_number = store_returns0.sr_ticket_number AND (store_sales0.ss_item_sk = t9.cs_item_sk AND customer0.c_current_cdemo_sk = customer_demographics2.cd_demo_sk) AND (customer0.c_current_hdemo_sk = household_demographics2.hd_demo_sk AND customer0.c_current_addr_sk = customer_address2.ca_address_sk AND (customer0.c_first_sales_date_sk = date_dim3.d_date_sk AND customer0.c_first_shipto_date_sk = date_dim4.d_date_sk))) AND (store_sales0.ss_promo_sk = promotion0.p_promo_sk AND household_demographics1.hd_income_band_sk = income_band1.ib_income_band_sk AND (household_demographics2.hd_income_band_sk = income_band2.ib_income_band_sk AND customer_demographics1.cd_marital_status <> customer_demographics2.cd_marital_status) AND (item0.i_current_price >= 28 AND item0.i_current_price <= 28 + 10 AND (promotion0.p_channel_email = 'Y' AND promotion0.p_channel_tv = 'N')) AND (promotion0.p_channel_radio = 'Y' AND (customer_address2.ca_state = 'AL' OR customer_address2.ca_state = 'KS' OR customer_address2.ca_state = 'PA') AND (store_sales0.ss_wholesale_cost >= 3 AND store_sales0.ss_wholesale_cost <= 23) AND ((customer_demographics1.cd_marital_status = 'M' OR customer_demographics1.cd_marital_status = 'D' OR customer_demographics1.cd_marital_status = 'S') AND (customer_demographics1.cd_education_status = 'Advanced Degree' OR customer_demographics1.cd_education_status = 'Unknown' OR customer_demographics1.cd_education_status = '4 yr Degree') AND ((customer_demographics2.cd_marital_status = 'M' OR customer_demographics2.cd_marital_status = 'D' OR customer_demographics2.cd_marital_status = 'S') AND (customer_demographics2.cd_education_status = 'Advanced Degree' OR customer_demographics2.cd_education_status = 'Unknown' OR customer_demographics2.cd_education_status = '4 yr Degree'))))) GROUP BY date_dim2.d_year, date_dim3.d_year, date_dim4.d_year, store0.s_zip, store0.s_store_name, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number, customer_address2.ca_street_name, customer_address2.ca_city, customer_address2.ca_zip, item0.i_item_sk, item0.i_product_name) AS t12 WHERE t5.i_item_sk = t12.i_item_sk AND (t5.d_year = 1998 AND t12.d_year = 1998 + 1) AND (t12.cnt <= t5.cnt AND (t5.s_store_name = t12.s_store_name AND t5.s_zip = t12.s_zip)) ORDER BY t5.i_product_name, t5.s_store_name, t12.cnt, t5.s1, t12.s1","['JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']",11.99169366,11.91707126,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
152,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 39 AND 59 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 29 and 29 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('AZ','CO','ID') and ss_wholesale_cost BETWEEN 39 AND 59 and cd1.cd_marital_status in ('M', 'S', 'S') and cd1.cd_education_status in ('Unknown', '4 yr Degree', '2 yr Degree') and cd2.cd_marital_status in ('M', 'S', 'S') and cd2.cd_education_status in ('Unknown', '4 yr Degree', '2 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;","SELECT t5.i_product_name AS product_name, t5.s_store_name AS store_name, t5.s_zip AS store_zip, t5.ca_street_number AS b_street_number, t5.ca_street_name AS b_street_name, t5.ca_city AS b_city, t5.ca_zip AS b_zip, t5.ca_street_number0 AS c_street_number, t5.ca_street_name0 AS c_street_name, t5.ca_city0 AS c_city, t5.ca_zip0 AS c_zip, t5.d_year AS syear, t5.cnt, t5.s1 AS s11, t5.s2 AS s21, t5.s3 AS s31, t12.s1 AS s12, t12.s2 AS s22, t12.s3 AS s32, t12.d_year AS syear0, t12.cnt AS cnt0 FROM (SELECT item.i_product_name, item.i_item_sk, store.s_store_name, store.s_zip, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number AS ca_street_number0, customer_address0.ca_street_name AS ca_street_name0, customer_address0.ca_city AS ca_city0, customer_address0.ca_zip AS ca_zip0, date_dim.d_year, date_dim0.d_year AS d_year0, date_dim1.d_year AS d_year1, COUNT(*) AS cnt, SUM(store_sales.ss_wholesale_cost) AS s1, SUM(store_sales.ss_list_price) AS s2, SUM(store_sales.ss_coupon_amt) AS s3 FROM store_sales, store_returns, (SELECT catalog_sales.cs_item_sk, SUM(catalog_sales.cs_ext_list_price) AS sale, SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit) AS refund FROM catalog_sales, catalog_returns WHERE catalog_sales.cs_item_sk = catalog_returns.cr_item_sk AND catalog_sales.cs_order_number = catalog_returns.cr_order_number AND (catalog_sales.cs_wholesale_cost >= 39 AND catalog_sales.cs_wholesale_cost <= 59) GROUP BY catalog_sales.cs_item_sk HAVING SUM(catalog_sales.cs_ext_list_price) > 2 * SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit)) AS t2, date_dim, date_dim AS date_dim0, date_dim AS date_dim1, store, customer, customer_demographics, customer_demographics AS customer_demographics0, promotion, household_demographics, household_demographics AS household_demographics0, customer_address, customer_address AS customer_address0, income_band, income_band AS income_band0, item WHERE store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk) AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (store_sales.ss_addr_sk = customer_address.ca_address_sk AND store_sales.ss_item_sk = item.i_item_sk)) AND (store_sales.ss_item_sk = store_returns.sr_item_sk AND store_sales.ss_ticket_number = store_returns.sr_ticket_number AND (store_sales.ss_item_sk = t2.cs_item_sk AND customer.c_current_cdemo_sk = customer_demographics0.cd_demo_sk) AND (customer.c_current_hdemo_sk = household_demographics0.hd_demo_sk AND customer.c_current_addr_sk = customer_address0.ca_address_sk AND (customer.c_first_sales_date_sk = date_dim0.d_date_sk AND customer.c_first_shipto_date_sk = date_dim1.d_date_sk))) AND (store_sales.ss_promo_sk = promotion.p_promo_sk AND (household_demographics.hd_income_band_sk = income_band.ib_income_band_sk AND household_demographics0.hd_income_band_sk = income_band0.ib_income_band_sk) AND (customer_demographics.cd_marital_status <> customer_demographics0.cd_marital_status AND item.i_current_price >= 29 AND (item.i_current_price <= 29 + 10 AND promotion.p_channel_email = 'N')) AND (promotion.p_channel_tv = 'N' AND promotion.p_channel_radio = 'N' AND (customer_address0.ca_state IN ('AZ', 'CO', 'ID') AND (store_sales.ss_wholesale_cost >= 39 AND store_sales.ss_wholesale_cost <= 59)) AND (customer_demographics.cd_marital_status IN ('M', 'S') AND customer_demographics.cd_education_status IN ('2 yr Degree', '4 yr Degree', 'Unknown') AND (customer_demographics0.cd_marital_status IN ('M', 'S') AND customer_demographics0.cd_education_status IN ('2 yr Degree', '4 yr Degree', 'Unknown'))))) GROUP BY date_dim.d_year, date_dim0.d_year, date_dim1.d_year, store.s_zip, store.s_store_name, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number, customer_address0.ca_street_name, customer_address0.ca_city, customer_address0.ca_zip, item.i_item_sk, item.i_product_name) AS t5, (SELECT item0.i_product_name, item0.i_item_sk, store0.s_store_name, store0.s_zip, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number AS ca_street_number0, customer_address2.ca_street_name AS ca_street_name0, customer_address2.ca_city AS ca_city0, customer_address2.ca_zip AS ca_zip0, date_dim2.d_year, date_dim3.d_year AS d_year0, date_dim4.d_year AS d_year1, COUNT(*) AS cnt, SUM(store_sales0.ss_wholesale_cost) AS s1, SUM(store_sales0.ss_list_price) AS s2, SUM(store_sales0.ss_coupon_amt) AS s3 FROM store_sales AS store_sales0, store_returns AS store_returns0, (SELECT catalog_sales0.cs_item_sk, SUM(catalog_sales0.cs_ext_list_price) AS sale, SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit) AS refund FROM catalog_sales AS catalog_sales0, catalog_returns AS catalog_returns0 WHERE catalog_sales0.cs_item_sk = catalog_returns0.cr_item_sk AND catalog_sales0.cs_order_number = catalog_returns0.cr_order_number AND (catalog_sales0.cs_wholesale_cost >= 39 AND catalog_sales0.cs_wholesale_cost <= 59) GROUP BY catalog_sales0.cs_item_sk HAVING SUM(catalog_sales0.cs_ext_list_price) > 2 * SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit)) AS t9, date_dim AS date_dim2, date_dim AS date_dim3, date_dim AS date_dim4, store AS store0, customer AS customer0, customer_demographics AS customer_demographics1, customer_demographics AS customer_demographics2, promotion AS promotion0, household_demographics AS household_demographics1, household_demographics AS household_demographics2, customer_address AS customer_address1, customer_address AS customer_address2, income_band AS income_band1, income_band AS income_band2, item AS item0 WHERE store_sales0.ss_store_sk = store0.s_store_sk AND (store_sales0.ss_sold_date_sk = date_dim2.d_date_sk AND store_sales0.ss_customer_sk = customer0.c_customer_sk) AND (store_sales0.ss_cdemo_sk = customer_demographics1.cd_demo_sk AND store_sales0.ss_hdemo_sk = household_demographics1.hd_demo_sk AND (store_sales0.ss_addr_sk = customer_address1.ca_address_sk AND store_sales0.ss_item_sk = item0.i_item_sk)) AND (store_sales0.ss_item_sk = store_returns0.sr_item_sk AND store_sales0.ss_ticket_number = store_returns0.sr_ticket_number AND (store_sales0.ss_item_sk = t9.cs_item_sk AND customer0.c_current_cdemo_sk = customer_demographics2.cd_demo_sk) AND (customer0.c_current_hdemo_sk = household_demographics2.hd_demo_sk AND customer0.c_current_addr_sk = customer_address2.ca_address_sk AND (customer0.c_first_sales_date_sk = date_dim3.d_date_sk AND customer0.c_first_shipto_date_sk = date_dim4.d_date_sk))) AND (store_sales0.ss_promo_sk = promotion0.p_promo_sk AND (household_demographics1.hd_income_band_sk = income_band1.ib_income_band_sk AND household_demographics2.hd_income_band_sk = income_band2.ib_income_band_sk) AND (customer_demographics1.cd_marital_status <> customer_demographics2.cd_marital_status AND item0.i_current_price >= 29 AND (item0.i_current_price <= 29 + 10 AND promotion0.p_channel_email = 'N')) AND (promotion0.p_channel_tv = 'N' AND promotion0.p_channel_radio = 'N' AND (customer_address2.ca_state IN ('AZ', 'CO', 'ID') AND (store_sales0.ss_wholesale_cost >= 39 AND store_sales0.ss_wholesale_cost <= 59)) AND (customer_demographics1.cd_marital_status IN ('M', 'S') AND customer_demographics1.cd_education_status IN ('2 yr Degree', '4 yr Degree', 'Unknown') AND (customer_demographics2.cd_marital_status IN ('M', 'S') AND customer_demographics2.cd_education_status IN ('2 yr Degree', '4 yr Degree', 'Unknown'))))) GROUP BY date_dim2.d_year, date_dim3.d_year, date_dim4.d_year, store0.s_zip, store0.s_store_name, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number, customer_address2.ca_street_name, customer_address2.ca_city, customer_address2.ca_zip, item0.i_item_sk, item0.i_product_name) AS t12 WHERE t5.i_item_sk = t12.i_item_sk AND (t5.d_year = 1998 AND t12.d_year = 1998 + 1) AND (t12.cnt <= t5.cnt AND (t5.s_store_name = t12.s_store_name AND t5.s_zip = t12.s_zip)) ORDER BY t5.i_product_name, t5.s_store_name, t12.cnt, t5.s1, t12.s1;","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'FILTER_AGGREGATE_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']",14.84406122,9.570450465,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
153,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 7 AND 27 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 76 and 76 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('AR','IN','TN') and ss_wholesale_cost BETWEEN 7 AND 27 and cd1.cd_marital_status in ('S', 'W', 'W') and cd1.cd_education_status in ('2 yr Degree', '2 yr Degree', 'Secondary') and cd2.cd_marital_status in ('S', 'W', 'W') and cd2.cd_education_status in ('2 yr Degree', '2 yr Degree', 'Secondary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;","SELECT t5.i_product_name AS product_name, t5.s_store_name AS store_name, t5.s_zip AS store_zip, t5.ca_street_number AS b_street_number, t5.ca_street_name AS b_street_name, t5.ca_city AS b_city, t5.ca_zip AS b_zip, t5.ca_street_number0 AS c_street_number, t5.ca_street_name0 AS c_street_name, t5.ca_city0 AS c_city, t5.ca_zip0 AS c_zip, t5.d_year AS syear, t5.cnt, t5.s1 AS s11, t5.s2 AS s21, t5.s3 AS s31, t12.s1 AS s12, t12.s2 AS s22, t12.s3 AS s32, t12.d_year AS syear0, t12.cnt AS cnt0 FROM (SELECT item.i_product_name, item.i_item_sk, store.s_store_name, store.s_zip, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number AS ca_street_number0, customer_address0.ca_street_name AS ca_street_name0, customer_address0.ca_city AS ca_city0, customer_address0.ca_zip AS ca_zip0, date_dim.d_year, date_dim0.d_year AS d_year0, date_dim1.d_year AS d_year1, COUNT(*) AS cnt, SUM(store_sales.ss_wholesale_cost) AS s1, SUM(store_sales.ss_list_price) AS s2, SUM(store_sales.ss_coupon_amt) AS s3 FROM store_sales, store_returns, (SELECT catalog_sales.cs_item_sk, SUM(catalog_sales.cs_ext_list_price) AS sale, SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit) AS refund FROM catalog_sales, catalog_returns WHERE catalog_sales.cs_item_sk = catalog_returns.cr_item_sk AND catalog_sales.cs_order_number = catalog_returns.cr_order_number AND (catalog_sales.cs_wholesale_cost >= 7 AND catalog_sales.cs_wholesale_cost <= 27) GROUP BY catalog_sales.cs_item_sk HAVING SUM(catalog_sales.cs_ext_list_price) > 2 * SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit)) AS t2, date_dim, date_dim AS date_dim0, date_dim AS date_dim1, store, customer, customer_demographics, customer_demographics AS customer_demographics0, promotion, household_demographics, household_demographics AS household_demographics0, customer_address, customer_address AS customer_address0, income_band, income_band AS income_band0, item WHERE store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk) AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (store_sales.ss_addr_sk = customer_address.ca_address_sk AND store_sales.ss_item_sk = item.i_item_sk)) AND (store_sales.ss_item_sk = store_returns.sr_item_sk AND store_sales.ss_ticket_number = store_returns.sr_ticket_number AND (store_sales.ss_item_sk = t2.cs_item_sk AND customer.c_current_cdemo_sk = customer_demographics0.cd_demo_sk) AND (customer.c_current_hdemo_sk = household_demographics0.hd_demo_sk AND customer.c_current_addr_sk = customer_address0.ca_address_sk AND (customer.c_first_sales_date_sk = date_dim0.d_date_sk AND customer.c_first_shipto_date_sk = date_dim1.d_date_sk))) AND (store_sales.ss_promo_sk = promotion.p_promo_sk AND (household_demographics.hd_income_band_sk = income_band.ib_income_band_sk AND household_demographics0.hd_income_band_sk = income_band0.ib_income_band_sk) AND (customer_demographics.cd_marital_status <> customer_demographics0.cd_marital_status AND item.i_current_price >= 76 AND (item.i_current_price <= 76 + 10 AND promotion.p_channel_email = 'N')) AND (promotion.p_channel_tv = 'N' AND promotion.p_channel_radio = 'Y' AND (customer_address0.ca_state IN ('AR', 'IN', 'TN') AND (store_sales.ss_wholesale_cost >= 7 AND store_sales.ss_wholesale_cost <= 27)) AND (customer_demographics.cd_marital_status IN ('S', 'W') AND customer_demographics.cd_education_status IN ('2 yr Degree', 'Secondary') AND (customer_demographics0.cd_marital_status IN ('S', 'W') AND customer_demographics0.cd_education_status IN ('2 yr Degree', 'Secondary'))))) GROUP BY date_dim.d_year, date_dim0.d_year, date_dim1.d_year, store.s_zip, store.s_store_name, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number, customer_address0.ca_street_name, customer_address0.ca_city, customer_address0.ca_zip, item.i_item_sk, item.i_product_name) AS t5, (SELECT item0.i_product_name, item0.i_item_sk, store0.s_store_name, store0.s_zip, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number AS ca_street_number0, customer_address2.ca_street_name AS ca_street_name0, customer_address2.ca_city AS ca_city0, customer_address2.ca_zip AS ca_zip0, date_dim2.d_year, date_dim3.d_year AS d_year0, date_dim4.d_year AS d_year1, COUNT(*) AS cnt, SUM(store_sales0.ss_wholesale_cost) AS s1, SUM(store_sales0.ss_list_price) AS s2, SUM(store_sales0.ss_coupon_amt) AS s3 FROM store_sales AS store_sales0, store_returns AS store_returns0, (SELECT catalog_sales0.cs_item_sk, SUM(catalog_sales0.cs_ext_list_price) AS sale, SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit) AS refund FROM catalog_sales AS catalog_sales0, catalog_returns AS catalog_returns0 WHERE catalog_sales0.cs_item_sk = catalog_returns0.cr_item_sk AND catalog_sales0.cs_order_number = catalog_returns0.cr_order_number AND (catalog_sales0.cs_wholesale_cost >= 7 AND catalog_sales0.cs_wholesale_cost <= 27) GROUP BY catalog_sales0.cs_item_sk HAVING SUM(catalog_sales0.cs_ext_list_price) > 2 * SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit)) AS t9, date_dim AS date_dim2, date_dim AS date_dim3, date_dim AS date_dim4, store AS store0, customer AS customer0, customer_demographics AS customer_demographics1, customer_demographics AS customer_demographics2, promotion AS promotion0, household_demographics AS household_demographics1, household_demographics AS household_demographics2, customer_address AS customer_address1, customer_address AS customer_address2, income_band AS income_band1, income_band AS income_band2, item AS item0 WHERE store_sales0.ss_store_sk = store0.s_store_sk AND (store_sales0.ss_sold_date_sk = date_dim2.d_date_sk AND store_sales0.ss_customer_sk = customer0.c_customer_sk) AND (store_sales0.ss_cdemo_sk = customer_demographics1.cd_demo_sk AND store_sales0.ss_hdemo_sk = household_demographics1.hd_demo_sk AND (store_sales0.ss_addr_sk = customer_address1.ca_address_sk AND store_sales0.ss_item_sk = item0.i_item_sk)) AND (store_sales0.ss_item_sk = store_returns0.sr_item_sk AND store_sales0.ss_ticket_number = store_returns0.sr_ticket_number AND (store_sales0.ss_item_sk = t9.cs_item_sk AND customer0.c_current_cdemo_sk = customer_demographics2.cd_demo_sk) AND (customer0.c_current_hdemo_sk = household_demographics2.hd_demo_sk AND customer0.c_current_addr_sk = customer_address2.ca_address_sk AND (customer0.c_first_sales_date_sk = date_dim3.d_date_sk AND customer0.c_first_shipto_date_sk = date_dim4.d_date_sk))) AND (store_sales0.ss_promo_sk = promotion0.p_promo_sk AND (household_demographics1.hd_income_band_sk = income_band1.ib_income_band_sk AND household_demographics2.hd_income_band_sk = income_band2.ib_income_band_sk) AND (customer_demographics1.cd_marital_status <> customer_demographics2.cd_marital_status AND item0.i_current_price >= 76 AND (item0.i_current_price <= 76 + 10 AND promotion0.p_channel_email = 'N')) AND (promotion0.p_channel_tv = 'N' AND promotion0.p_channel_radio = 'Y' AND (customer_address2.ca_state IN ('AR', 'IN', 'TN') AND (store_sales0.ss_wholesale_cost >= 7 AND store_sales0.ss_wholesale_cost <= 27)) AND (customer_demographics1.cd_marital_status IN ('S', 'W') AND customer_demographics1.cd_education_status IN ('2 yr Degree', 'Secondary') AND (customer_demographics2.cd_marital_status IN ('S', 'W') AND customer_demographics2.cd_education_status IN ('2 yr Degree', 'Secondary'))))) GROUP BY date_dim2.d_year, date_dim3.d_year, date_dim4.d_year, store0.s_zip, store0.s_store_name, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number, customer_address2.ca_street_name, customer_address2.ca_city, customer_address2.ca_zip, item0.i_item_sk, item0.i_product_name) AS t12 WHERE t5.i_item_sk = t12.i_item_sk AND (t5.d_year = 1998 AND t12.d_year = 1998 + 1) AND (t12.cnt <= t5.cnt AND (t5.s_store_name = t12.s_store_name AND t5.s_zip = t12.s_zip)) ORDER BY t5.i_product_name, t5.s_store_name, t12.cnt, t5.s1, t12.s1;","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']",10.72802973,8.136718194,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
154,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 70 AND 90 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 24 and 24 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'N' and ad2.ca_state in ('KS','MI','NE') and ss_wholesale_cost BETWEEN 70 AND 90 and cd1.cd_marital_status in ('M', 'S', 'S') and cd1.cd_education_status in ('2 yr Degree', '2 yr Degree', 'Unknown') and cd2.cd_marital_status in ('M', 'S', 'S') and cd2.cd_education_status in ('2 yr Degree', '2 yr Degree', 'Unknown') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2000 and cs2.syear = 2000 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;","SELECT i_product_name AS product_name, s_store_name AS store_name, s_zip AS store_zip, ca_street_number AS b_street_number, ca_street_name AS b_street_name, ca_city AS b_city, ca_zip AS b_zip, ca_street_number0 AS c_street_number, ca_street_name0 AS c_street_name, ca_city0 AS c_city, ca_zip0 AS c_zip, d_year AS syear, cnt, s1 AS s11, s2 AS s21, s3 AS s31, s10 AS s12, s20 AS s22, s30 AS s32, d_year2 AS syear0, cnt0 FROM (SELECT t4.i_product_name, t4.i_item_sk, t4.s_store_name, t4.s_zip, t4.ca_street_number, t4.ca_street_name, t4.ca_city, t4.ca_zip, t4.ca_street_number0, t4.ca_street_name0, t4.ca_city0, t4.ca_zip0, t4.d_year, t4.d_year0, t4.d_year1, t4.cnt, t4.s1, t4.s2, t4.s3, t10.i_product_name AS i_product_name0, t10.i_item_sk AS i_item_sk0, t10.s_store_name AS s_store_name0, t10.s_zip AS s_zip0, t10.ca_street_number AS ca_street_number1, t10.ca_street_name AS ca_street_name1, t10.ca_city AS ca_city1, t10.ca_zip AS ca_zip1, t10.ca_street_number0 AS ca_street_number00, t10.ca_street_name0 AS ca_street_name00, t10.ca_city0 AS ca_city00, t10.ca_zip0 AS ca_zip00, t10.d_year AS d_year2, t10.d_year0 AS d_year00, t10.d_year1 AS d_year10, t10.cnt AS cnt0, t10.s1 AS s10, t10.s2 AS s20, t10.s3 AS s30 FROM (SELECT date_dim.d_year, date_dim0.d_year AS d_year0, date_dim1.d_year AS d_year1, store.s_zip, store.s_store_name, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number AS ca_street_number0, customer_address0.ca_street_name AS ca_street_name0, customer_address0.ca_city AS ca_city0, customer_address0.ca_zip AS ca_zip0, item.i_item_sk, item.i_product_name, COUNT(*) AS cnt, SUM(store_sales.ss_wholesale_cost) AS s1, SUM(store_sales.ss_list_price) AS s2, SUM(store_sales.ss_coupon_amt) AS s3 FROM store_sales, store_returns, (SELECT catalog_sales.cs_item_sk, SUM(catalog_sales.cs_ext_list_price) AS sale, SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit) AS refund FROM catalog_sales, catalog_returns WHERE catalog_sales.cs_item_sk = catalog_returns.cr_item_sk AND catalog_sales.cs_order_number = catalog_returns.cr_order_number AND catalog_sales.cs_wholesale_cost >= 70 AND catalog_sales.cs_wholesale_cost <= 90 GROUP BY catalog_sales.cs_item_sk HAVING SUM(catalog_sales.cs_ext_list_price) > 2 * SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit)) AS t2, date_dim, date_dim AS date_dim0, date_dim AS date_dim1, store, customer, customer_demographics, customer_demographics AS customer_demographics0, promotion, household_demographics, household_demographics AS household_demographics0, customer_address, customer_address AS customer_address0, income_band, income_band AS income_band0, item WHERE store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk) AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (store_sales.ss_addr_sk = customer_address.ca_address_sk AND store_sales.ss_item_sk = item.i_item_sk)) AND (store_sales.ss_item_sk = store_returns.sr_item_sk AND store_sales.ss_ticket_number = store_returns.sr_ticket_number AND (store_sales.ss_item_sk = t2.cs_item_sk AND customer.c_current_cdemo_sk = customer_demographics0.cd_demo_sk) AND (customer.c_current_hdemo_sk = household_demographics0.hd_demo_sk AND customer.c_current_addr_sk = customer_address0.ca_address_sk AND (customer.c_first_sales_date_sk = date_dim0.d_date_sk AND customer.c_first_shipto_date_sk = date_dim1.d_date_sk))) AND (store_sales.ss_promo_sk = promotion.p_promo_sk AND household_demographics.hd_income_band_sk = income_band.ib_income_band_sk AND (household_demographics0.hd_income_band_sk = income_band0.ib_income_band_sk AND customer_demographics.cd_marital_status <> customer_demographics0.cd_marital_status) AND (item.i_current_price >= 24 AND item.i_current_price <= 24 + 10 AND (promotion.p_channel_email = 'N' AND promotion.p_channel_tv = 'Y')) AND (promotion.p_channel_radio = 'N' AND (customer_address0.ca_state = 'KS' OR customer_address0.ca_state = 'MI' OR customer_address0.ca_state = 'NE') AND (store_sales.ss_wholesale_cost >= 70 AND store_sales.ss_wholesale_cost <= 90) AND ((customer_demographics.cd_marital_status = 'M' OR customer_demographics.cd_marital_status = 'S') AND (customer_demographics.cd_education_status = '2 yr Degree' OR customer_demographics.cd_education_status = 'Unknown') AND ((customer_demographics0.cd_marital_status = 'M' OR customer_demographics0.cd_marital_status = 'S') AND (customer_demographics0.cd_education_status = '2 yr Degree' OR customer_demographics0.cd_education_status = 'Unknown'))))) GROUP BY date_dim.d_year, date_dim0.d_year, date_dim1.d_year, store.s_zip, store.s_store_name, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number, customer_address0.ca_street_name, customer_address0.ca_city, customer_address0.ca_zip, item.i_item_sk, item.i_product_name) AS t4, (SELECT date_dim2.d_year, date_dim3.d_year AS d_year0, date_dim4.d_year AS d_year1, store0.s_zip, store0.s_store_name, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number AS ca_street_number0, customer_address2.ca_street_name AS ca_street_name0, customer_address2.ca_city AS ca_city0, customer_address2.ca_zip AS ca_zip0, item0.i_item_sk, item0.i_product_name, COUNT(*) AS cnt, SUM(store_sales0.ss_wholesale_cost) AS s1, SUM(store_sales0.ss_list_price) AS s2, SUM(store_sales0.ss_coupon_amt) AS s3 FROM store_sales AS store_sales0, store_returns AS store_returns0, (SELECT catalog_sales0.cs_item_sk, SUM(catalog_sales0.cs_ext_list_price) AS sale, SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit) AS refund FROM catalog_sales AS catalog_sales0, catalog_returns AS catalog_returns0 WHERE catalog_sales0.cs_item_sk = catalog_returns0.cr_item_sk AND catalog_sales0.cs_order_number = catalog_returns0.cr_order_number AND catalog_sales0.cs_wholesale_cost >= 70 AND catalog_sales0.cs_wholesale_cost <= 90 GROUP BY catalog_sales0.cs_item_sk HAVING SUM(catalog_sales0.cs_ext_list_price) > 2 * SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit)) AS t8, date_dim AS date_dim2, date_dim AS date_dim3, date_dim AS date_dim4, store AS store0, customer AS customer0, customer_demographics AS customer_demographics1, customer_demographics AS customer_demographics2, promotion AS promotion0, household_demographics AS household_demographics1, household_demographics AS household_demographics2, customer_address AS customer_address1, customer_address AS customer_address2, income_band AS income_band1, income_band AS income_band2, item AS item0 WHERE store_sales0.ss_store_sk = store0.s_store_sk AND (store_sales0.ss_sold_date_sk = date_dim2.d_date_sk AND store_sales0.ss_customer_sk = customer0.c_customer_sk) AND (store_sales0.ss_cdemo_sk = customer_demographics1.cd_demo_sk AND store_sales0.ss_hdemo_sk = household_demographics1.hd_demo_sk AND (store_sales0.ss_addr_sk = customer_address1.ca_address_sk AND store_sales0.ss_item_sk = item0.i_item_sk)) AND (store_sales0.ss_item_sk = store_returns0.sr_item_sk AND store_sales0.ss_ticket_number = store_returns0.sr_ticket_number AND (store_sales0.ss_item_sk = t8.cs_item_sk AND customer0.c_current_cdemo_sk = customer_demographics2.cd_demo_sk) AND (customer0.c_current_hdemo_sk = household_demographics2.hd_demo_sk AND customer0.c_current_addr_sk = customer_address2.ca_address_sk AND (customer0.c_first_sales_date_sk = date_dim3.d_date_sk AND customer0.c_first_shipto_date_sk = date_dim4.d_date_sk))) AND (store_sales0.ss_promo_sk = promotion0.p_promo_sk AND household_demographics1.hd_income_band_sk = income_band1.ib_income_band_sk AND (household_demographics2.hd_income_band_sk = income_band2.ib_income_band_sk AND customer_demographics1.cd_marital_status <> customer_demographics2.cd_marital_status) AND (item0.i_current_price >= 24 AND item0.i_current_price <= 24 + 10 AND (promotion0.p_channel_email = 'N' AND promotion0.p_channel_tv = 'Y')) AND (promotion0.p_channel_radio = 'N' AND (customer_address2.ca_state = 'KS' OR customer_address2.ca_state = 'MI' OR customer_address2.ca_state = 'NE') AND (store_sales0.ss_wholesale_cost >= 70 AND store_sales0.ss_wholesale_cost <= 90) AND ((customer_demographics1.cd_marital_status = 'M' OR customer_demographics1.cd_marital_status = 'S') AND (customer_demographics1.cd_education_status = '2 yr Degree' OR customer_demographics1.cd_education_status = 'Unknown') AND ((customer_demographics2.cd_marital_status = 'M' OR customer_demographics2.cd_marital_status = 'S') AND (customer_demographics2.cd_education_status = '2 yr Degree' OR customer_demographics2.cd_education_status = 'Unknown'))))) GROUP BY date_dim2.d_year, date_dim3.d_year, date_dim4.d_year, store0.s_zip, store0.s_store_name, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number, customer_address2.ca_street_name, customer_address2.ca_city, customer_address2.ca_zip, item0.i_item_sk, item0.i_product_name) AS t10) AS t11 WHERE t11.i_item_sk = t11.i_item_sk0 AND (t11.d_year = 2000 AND t11.d_year2 = 2000 + 1) AND (t11.cnt0 <= t11.cnt AND (t11.s_store_name = t11.s_store_name0 AND t11.s_zip = t11.s_zip0)) ORDER BY i_product_name, s_store_name, cnt0, s1, s10;","['FILTER_AGGREGATE_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'JOIN_EXTRACT_FILTER', 'JOIN_PROJECT_BOTH_TRANSPOSE']",15.87271531,13.14568313,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
155,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 8 AND 28 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 63 and 63 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('GA','OH','TN') and ss_wholesale_cost BETWEEN 8 AND 28 and cd1.cd_marital_status in ('M', 'S', 'M') and cd1.cd_education_status in ('Advanced Degree', 'Secondary', 'Advanced Degree') and cd2.cd_marital_status in ('M', 'S', 'M') and cd2.cd_education_status in ('Advanced Degree', 'Secondary', 'Advanced Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;","SELECT t5.i_product_name AS product_name, t5.s_store_name AS store_name, t5.s_zip AS store_zip, t5.ca_street_number AS b_street_number, t5.ca_street_name AS b_street_name, t5.ca_city AS b_city, t5.ca_zip AS b_zip, t5.ca_street_number0 AS c_street_number, t5.ca_street_name0 AS c_street_name, t5.ca_city0 AS c_city, t5.ca_zip0 AS c_zip, t5.d_year AS syear, t5.cnt, t5.s1 AS s11, t5.s2 AS s21, t5.s3 AS s31, t12.s1 AS s12, t12.s2 AS s22, t12.s3 AS s32, t12.d_year AS syear0, t12.cnt AS cnt0 FROM (SELECT item.i_product_name, item.i_item_sk, store.s_store_name, store.s_zip, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number AS ca_street_number0, customer_address0.ca_street_name AS ca_street_name0, customer_address0.ca_city AS ca_city0, customer_address0.ca_zip AS ca_zip0, date_dim.d_year, date_dim0.d_year AS d_year0, date_dim1.d_year AS d_year1, COUNT(*) AS cnt, SUM(store_sales.ss_wholesale_cost) AS s1, SUM(store_sales.ss_list_price) AS s2, SUM(store_sales.ss_coupon_amt) AS s3 FROM store_sales, store_returns, (SELECT catalog_sales.cs_item_sk, SUM(catalog_sales.cs_ext_list_price) AS sale, SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit) AS refund FROM catalog_sales, catalog_returns WHERE catalog_sales.cs_item_sk = catalog_returns.cr_item_sk AND catalog_sales.cs_order_number = catalog_returns.cr_order_number AND (catalog_sales.cs_wholesale_cost >= 8 AND catalog_sales.cs_wholesale_cost <= 28) GROUP BY catalog_sales.cs_item_sk HAVING SUM(catalog_sales.cs_ext_list_price) > 2 * SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit)) AS t2, date_dim, date_dim AS date_dim0, date_dim AS date_dim1, store, customer, customer_demographics, customer_demographics AS customer_demographics0, promotion, household_demographics, household_demographics AS household_demographics0, customer_address, customer_address AS customer_address0, income_band, income_band AS income_band0, item WHERE store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk) AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (store_sales.ss_addr_sk = customer_address.ca_address_sk AND store_sales.ss_item_sk = item.i_item_sk)) AND (store_sales.ss_item_sk = store_returns.sr_item_sk AND store_sales.ss_ticket_number = store_returns.sr_ticket_number AND (store_sales.ss_item_sk = t2.cs_item_sk AND customer.c_current_cdemo_sk = customer_demographics0.cd_demo_sk) AND (customer.c_current_hdemo_sk = household_demographics0.hd_demo_sk AND customer.c_current_addr_sk = customer_address0.ca_address_sk AND (customer.c_first_sales_date_sk = date_dim0.d_date_sk AND customer.c_first_shipto_date_sk = date_dim1.d_date_sk))) AND (store_sales.ss_promo_sk = promotion.p_promo_sk AND (household_demographics.hd_income_band_sk = income_band.ib_income_band_sk AND household_demographics0.hd_income_band_sk = income_band0.ib_income_band_sk) AND (customer_demographics.cd_marital_status <> customer_demographics0.cd_marital_status AND item.i_current_price >= 63 AND (item.i_current_price <= 63 + 10 AND promotion.p_channel_email = 'N')) AND (promotion.p_channel_tv = 'N' AND promotion.p_channel_radio = 'Y' AND (customer_address0.ca_state IN ('GA', 'OH', 'TN') AND (store_sales.ss_wholesale_cost >= 8 AND store_sales.ss_wholesale_cost <= 28)) AND (customer_demographics.cd_marital_status IN ('M', 'S') AND customer_demographics.cd_education_status IN ('Advanced Degree', 'Secondary') AND (customer_demographics0.cd_marital_status IN ('M', 'S') AND customer_demographics0.cd_education_status IN ('Advanced Degree', 'Secondary'))))) GROUP BY date_dim.d_year, date_dim0.d_year, date_dim1.d_year, store.s_zip, store.s_store_name, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number, customer_address0.ca_street_name, customer_address0.ca_city, customer_address0.ca_zip, item.i_item_sk, item.i_product_name) AS t5, (SELECT item0.i_product_name, item0.i_item_sk, store0.s_store_name, store0.s_zip, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number AS ca_street_number0, customer_address2.ca_street_name AS ca_street_name0, customer_address2.ca_city AS ca_city0, customer_address2.ca_zip AS ca_zip0, date_dim2.d_year, date_dim3.d_year AS d_year0, date_dim4.d_year AS d_year1, COUNT(*) AS cnt, SUM(store_sales0.ss_wholesale_cost) AS s1, SUM(store_sales0.ss_list_price) AS s2, SUM(store_sales0.ss_coupon_amt) AS s3 FROM store_sales AS store_sales0, store_returns AS store_returns0, (SELECT catalog_sales0.cs_item_sk, SUM(catalog_sales0.cs_ext_list_price) AS sale, SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit) AS refund FROM catalog_sales AS catalog_sales0, catalog_returns AS catalog_returns0 WHERE catalog_sales0.cs_item_sk = catalog_returns0.cr_item_sk AND catalog_sales0.cs_order_number = catalog_returns0.cr_order_number AND (catalog_sales0.cs_wholesale_cost >= 8 AND catalog_sales0.cs_wholesale_cost <= 28) GROUP BY catalog_sales0.cs_item_sk HAVING SUM(catalog_sales0.cs_ext_list_price) > 2 * SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit)) AS t9, date_dim AS date_dim2, date_dim AS date_dim3, date_dim AS date_dim4, store AS store0, customer AS customer0, customer_demographics AS customer_demographics1, customer_demographics AS customer_demographics2, promotion AS promotion0, household_demographics AS household_demographics1, household_demographics AS household_demographics2, customer_address AS customer_address1, customer_address AS customer_address2, income_band AS income_band1, income_band AS income_band2, item AS item0 WHERE store_sales0.ss_store_sk = store0.s_store_sk AND (store_sales0.ss_sold_date_sk = date_dim2.d_date_sk AND store_sales0.ss_customer_sk = customer0.c_customer_sk) AND (store_sales0.ss_cdemo_sk = customer_demographics1.cd_demo_sk AND store_sales0.ss_hdemo_sk = household_demographics1.hd_demo_sk AND (store_sales0.ss_addr_sk = customer_address1.ca_address_sk AND store_sales0.ss_item_sk = item0.i_item_sk)) AND (store_sales0.ss_item_sk = store_returns0.sr_item_sk AND store_sales0.ss_ticket_number = store_returns0.sr_ticket_number AND (store_sales0.ss_item_sk = t9.cs_item_sk AND customer0.c_current_cdemo_sk = customer_demographics2.cd_demo_sk) AND (customer0.c_current_hdemo_sk = household_demographics2.hd_demo_sk AND customer0.c_current_addr_sk = customer_address2.ca_address_sk AND (customer0.c_first_sales_date_sk = date_dim3.d_date_sk AND customer0.c_first_shipto_date_sk = date_dim4.d_date_sk))) AND (store_sales0.ss_promo_sk = promotion0.p_promo_sk AND (household_demographics1.hd_income_band_sk = income_band1.ib_income_band_sk AND household_demographics2.hd_income_band_sk = income_band2.ib_income_band_sk) AND (customer_demographics1.cd_marital_status <> customer_demographics2.cd_marital_status AND item0.i_current_price >= 63 AND (item0.i_current_price <= 63 + 10 AND promotion0.p_channel_email = 'N')) AND (promotion0.p_channel_tv = 'N' AND promotion0.p_channel_radio = 'Y' AND (customer_address2.ca_state IN ('GA', 'OH', 'TN') AND (store_sales0.ss_wholesale_cost >= 8 AND store_sales0.ss_wholesale_cost <= 28)) AND (customer_demographics1.cd_marital_status IN ('M', 'S') AND customer_demographics1.cd_education_status IN ('Advanced Degree', 'Secondary') AND (customer_demographics2.cd_marital_status IN ('M', 'S') AND customer_demographics2.cd_education_status IN ('Advanced Degree', 'Secondary'))))) GROUP BY date_dim2.d_year, date_dim3.d_year, date_dim4.d_year, store0.s_zip, store0.s_store_name, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number, customer_address2.ca_street_name, customer_address2.ca_city, customer_address2.ca_zip, item0.i_item_sk, item0.i_product_name) AS t12 WHERE t5.i_item_sk = t12.i_item_sk AND (t5.d_year = 2001 AND t12.d_year = 2001 + 1) AND (t12.cnt <= t5.cnt AND (t5.s_store_name = t12.s_store_name AND t5.s_zip = t12.s_zip)) ORDER BY t5.i_product_name, t5.s_store_name, t12.cnt, t5.s1, t12.s1","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']",25.75846291,10.42999101,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
156,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 80 AND 100 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 23 and 23 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('AL','IN','WV') and ss_wholesale_cost BETWEEN 80 AND 100 and cd1.cd_marital_status in ('M', 'M', 'W') and cd1.cd_education_status in ('4 yr Degree', '4 yr Degree', '2 yr Degree') and cd2.cd_marital_status in ('M', 'M', 'W') and cd2.cd_education_status in ('4 yr Degree', '4 yr Degree', '2 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;","SELECT t5.i_product_name AS product_name, t5.s_store_name AS store_name, t5.s_zip AS store_zip, t5.ca_street_number AS b_street_number, t5.ca_street_name AS b_street_name, t5.ca_city AS b_city, t5.ca_zip AS b_zip, t5.ca_street_number0 AS c_street_number, t5.ca_street_name0 AS c_street_name, t5.ca_city0 AS c_city, t5.ca_zip0 AS c_zip, t5.d_year AS syear, t5.cnt, t5.s1 AS s11, t5.s2 AS s21, t5.s3 AS s31, t12.s1 AS s12, t12.s2 AS s22, t12.s3 AS s32, t12.d_year AS syear0, t12.cnt AS cnt0 FROM (SELECT item.i_product_name, item.i_item_sk, store.s_store_name, store.s_zip, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number AS ca_street_number0, customer_address0.ca_street_name AS ca_street_name0, customer_address0.ca_city AS ca_city0, customer_address0.ca_zip AS ca_zip0, date_dim.d_year, date_dim0.d_year AS d_year0, date_dim1.d_year AS d_year1, COUNT(*) AS cnt, SUM(store_sales.ss_wholesale_cost) AS s1, SUM(store_sales.ss_list_price) AS s2, SUM(store_sales.ss_coupon_amt) AS s3 FROM store_sales, store_returns, (SELECT catalog_sales.cs_item_sk, SUM(catalog_sales.cs_ext_list_price) AS sale, SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit) AS refund FROM catalog_sales, catalog_returns WHERE catalog_sales.cs_item_sk = catalog_returns.cr_item_sk AND catalog_sales.cs_order_number = catalog_returns.cr_order_number AND catalog_sales.cs_wholesale_cost >= 80 AND catalog_sales.cs_wholesale_cost <= 100 GROUP BY catalog_sales.cs_item_sk HAVING SUM(catalog_sales.cs_ext_list_price) > 2 * SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit)) AS t2, date_dim, date_dim AS date_dim0, date_dim AS date_dim1, store, customer, customer_demographics, customer_demographics AS customer_demographics0, promotion, household_demographics, household_demographics AS household_demographics0, customer_address, customer_address AS customer_address0, income_band, income_band AS income_band0, item WHERE store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk) AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (store_sales.ss_addr_sk = customer_address.ca_address_sk AND store_sales.ss_item_sk = item.i_item_sk)) AND (store_sales.ss_item_sk = store_returns.sr_item_sk AND store_sales.ss_ticket_number = store_returns.sr_ticket_number AND (store_sales.ss_item_sk = t2.cs_item_sk AND customer.c_current_cdemo_sk = customer_demographics0.cd_demo_sk) AND (customer.c_current_hdemo_sk = household_demographics0.hd_demo_sk AND customer.c_current_addr_sk = customer_address0.ca_address_sk AND (customer.c_first_sales_date_sk = date_dim0.d_date_sk AND customer.c_first_shipto_date_sk = date_dim1.d_date_sk))) AND (store_sales.ss_promo_sk = promotion.p_promo_sk AND household_demographics.hd_income_band_sk = income_band.ib_income_band_sk AND (household_demographics0.hd_income_band_sk = income_band0.ib_income_band_sk AND customer_demographics.cd_marital_status <> customer_demographics0.cd_marital_status) AND (item.i_current_price >= 23 AND item.i_current_price <= 23 + 10 AND (promotion.p_channel_email = 'Y' AND promotion.p_channel_tv = 'N')) AND (promotion.p_channel_radio = 'Y' AND (customer_address0.ca_state = 'AL' OR customer_address0.ca_state = 'IN' OR customer_address0.ca_state = 'WV') AND (store_sales.ss_wholesale_cost >= 80 AND store_sales.ss_wholesale_cost <= 100) AND ((customer_demographics.cd_marital_status = 'M' OR customer_demographics.cd_marital_status = 'W') AND (customer_demographics.cd_education_status = '4 yr Degree' OR customer_demographics.cd_education_status = '2 yr Degree') AND ((customer_demographics0.cd_marital_status = 'M' OR customer_demographics0.cd_marital_status = 'W') AND (customer_demographics0.cd_education_status = '4 yr Degree' OR customer_demographics0.cd_education_status = '2 yr Degree'))))) GROUP BY date_dim.d_year, date_dim0.d_year, date_dim1.d_year, store.s_zip, store.s_store_name, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number, customer_address0.ca_street_name, customer_address0.ca_city, customer_address0.ca_zip, item.i_item_sk, item.i_product_name) AS t5, (SELECT item0.i_product_name, item0.i_item_sk, store0.s_store_name, store0.s_zip, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number AS ca_street_number0, customer_address2.ca_street_name AS ca_street_name0, customer_address2.ca_city AS ca_city0, customer_address2.ca_zip AS ca_zip0, date_dim2.d_year, date_dim3.d_year AS d_year0, date_dim4.d_year AS d_year1, COUNT(*) AS cnt, SUM(store_sales0.ss_wholesale_cost) AS s1, SUM(store_sales0.ss_list_price) AS s2, SUM(store_sales0.ss_coupon_amt) AS s3 FROM store_sales AS store_sales0, store_returns AS store_returns0, (SELECT catalog_sales0.cs_item_sk, SUM(catalog_sales0.cs_ext_list_price) AS sale, SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit) AS refund FROM catalog_sales AS catalog_sales0, catalog_returns AS catalog_returns0 WHERE catalog_sales0.cs_item_sk = catalog_returns0.cr_item_sk AND catalog_sales0.cs_order_number = catalog_returns0.cr_order_number AND catalog_sales0.cs_wholesale_cost >= 80 AND catalog_sales0.cs_wholesale_cost <= 100 GROUP BY catalog_sales0.cs_item_sk HAVING SUM(catalog_sales0.cs_ext_list_price) > 2 * SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit)) AS t9, date_dim AS date_dim2, date_dim AS date_dim3, date_dim AS date_dim4, store AS store0, customer AS customer0, customer_demographics AS customer_demographics1, customer_demographics AS customer_demographics2, promotion AS promotion0, household_demographics AS household_demographics1, household_demographics AS household_demographics2, customer_address AS customer_address1, customer_address AS customer_address2, income_band AS income_band1, income_band AS income_band2, item AS item0 WHERE store_sales0.ss_store_sk = store0.s_store_sk AND (store_sales0.ss_sold_date_sk = date_dim2.d_date_sk AND store_sales0.ss_customer_sk = customer0.c_customer_sk) AND (store_sales0.ss_cdemo_sk = customer_demographics1.cd_demo_sk AND store_sales0.ss_hdemo_sk = household_demographics1.hd_demo_sk AND (store_sales0.ss_addr_sk = customer_address1.ca_address_sk AND store_sales0.ss_item_sk = item0.i_item_sk)) AND (store_sales0.ss_item_sk = store_returns0.sr_item_sk AND store_sales0.ss_ticket_number = store_returns0.sr_ticket_number AND (store_sales0.ss_item_sk = t9.cs_item_sk AND customer0.c_current_cdemo_sk = customer_demographics2.cd_demo_sk) AND (customer0.c_current_hdemo_sk = household_demographics2.hd_demo_sk AND customer0.c_current_addr_sk = customer_address2.ca_address_sk AND (customer0.c_first_sales_date_sk = date_dim3.d_date_sk AND customer0.c_first_shipto_date_sk = date_dim4.d_date_sk))) AND (store_sales0.ss_promo_sk = promotion0.p_promo_sk AND household_demographics1.hd_income_band_sk = income_band1.ib_income_band_sk AND (household_demographics2.hd_income_band_sk = income_band2.ib_income_band_sk AND customer_demographics1.cd_marital_status <> customer_demographics2.cd_marital_status) AND (item0.i_current_price >= 23 AND item0.i_current_price <= 23 + 10 AND (promotion0.p_channel_email = 'Y' AND promotion0.p_channel_tv = 'N')) AND (promotion0.p_channel_radio = 'Y' AND (customer_address2.ca_state = 'AL' OR customer_address2.ca_state = 'IN' OR customer_address2.ca_state = 'WV') AND (store_sales0.ss_wholesale_cost >= 80 AND store_sales0.ss_wholesale_cost <= 100) AND ((customer_demographics1.cd_marital_status = 'M' OR customer_demographics1.cd_marital_status = 'W') AND (customer_demographics1.cd_education_status = '4 yr Degree' OR customer_demographics1.cd_education_status = '2 yr Degree') AND ((customer_demographics2.cd_marital_status = 'M' OR customer_demographics2.cd_marital_status = 'W') AND (customer_demographics2.cd_education_status = '4 yr Degree' OR customer_demographics2.cd_education_status = '2 yr Degree'))))) GROUP BY date_dim2.d_year, date_dim3.d_year, date_dim4.d_year, store0.s_zip, store0.s_store_name, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number, customer_address2.ca_street_name, customer_address2.ca_city, customer_address2.ca_zip, item0.i_item_sk, item0.i_product_name) AS t12 WHERE t5.i_item_sk = t12.i_item_sk AND (t5.d_year = 1998 AND t12.d_year = 1998 + 1) AND (t12.cnt <= t5.cnt AND (t5.s_store_name = t12.s_store_name AND t5.s_zip = t12.s_zip)) ORDER BY t5.i_product_name, t5.s_store_name, t12.cnt, t5.s1, t12.s1;","['JOIN_EXTRACT_FILTER', 'FILTER_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN']",9.964244922,8.896303654,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
157,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 80 AND 100 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 84 and 84 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'N' and ad2.ca_state in ('GA','SC','TX') and ss_wholesale_cost BETWEEN 80 AND 100 and cd1.cd_marital_status in ('U', 'U', 'W') and cd1.cd_education_status in ('Unknown', 'Secondary', 'Primary') and cd2.cd_marital_status in ('U', 'U', 'W') and cd2.cd_education_status in ('Unknown', 'Secondary', 'Primary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2000 and cs2.syear = 2000 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;","SELECT t5.i_product_name AS product_name, t5.s_store_name AS store_name, t5.s_zip AS store_zip, t5.ca_street_number AS b_street_number, t5.ca_street_name AS b_street_name, t5.ca_city AS b_city, t5.ca_zip AS b_zip, t5.ca_street_number0 AS c_street_number, t5.ca_street_name0 AS c_street_name, t5.ca_city0 AS c_city, t5.ca_zip0 AS c_zip, t5.d_year AS syear, t5.cnt, t5.s1 AS s11, t5.s2 AS s21, t5.s3 AS s31, t12.s1 AS s12, t12.s2 AS s22, t12.s3 AS s32, t12.d_year AS syear0, t12.cnt AS cnt0 FROM (SELECT item.i_product_name, item.i_item_sk, store.s_store_name, store.s_zip, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number AS ca_street_number0, customer_address0.ca_street_name AS ca_street_name0, customer_address0.ca_city AS ca_city0, customer_address0.ca_zip AS ca_zip0, date_dim.d_year, date_dim0.d_year AS d_year0, date_dim1.d_year AS d_year1, COUNT(*) AS cnt, SUM(store_sales.ss_wholesale_cost) AS s1, SUM(store_sales.ss_list_price) AS s2, SUM(store_sales.ss_coupon_amt) AS s3 FROM store_sales, store_returns, (SELECT catalog_sales.cs_item_sk, SUM(catalog_sales.cs_ext_list_price) AS sale, SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit) AS refund FROM catalog_sales, catalog_returns WHERE catalog_sales.cs_item_sk = catalog_returns.cr_item_sk AND catalog_sales.cs_order_number = catalog_returns.cr_order_number AND catalog_sales.cs_wholesale_cost >= 80 AND catalog_sales.cs_wholesale_cost <= 100 GROUP BY catalog_sales.cs_item_sk HAVING SUM(catalog_sales.cs_ext_list_price) > 2 * SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit)) AS t2, date_dim, date_dim AS date_dim0, date_dim AS date_dim1, store, customer, customer_demographics, customer_demographics AS customer_demographics0, promotion, household_demographics, household_demographics AS household_demographics0, customer_address, customer_address AS customer_address0, income_band, income_band AS income_band0, item WHERE store_sales.ss_store_sk = store.s_store_sk AND (store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk) AND (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND (store_sales.ss_addr_sk = customer_address.ca_address_sk AND store_sales.ss_item_sk = item.i_item_sk)) AND (store_sales.ss_item_sk = store_returns.sr_item_sk AND store_sales.ss_ticket_number = store_returns.sr_ticket_number AND (store_sales.ss_item_sk = t2.cs_item_sk AND customer.c_current_cdemo_sk = customer_demographics0.cd_demo_sk) AND (customer.c_current_hdemo_sk = household_demographics0.hd_demo_sk AND customer.c_current_addr_sk = customer_address0.ca_address_sk AND (customer.c_first_sales_date_sk = date_dim0.d_date_sk AND customer.c_first_shipto_date_sk = date_dim1.d_date_sk))) AND (store_sales.ss_promo_sk = promotion.p_promo_sk AND household_demographics.hd_income_band_sk = income_band.ib_income_band_sk AND (household_demographics0.hd_income_band_sk = income_band0.ib_income_band_sk AND customer_demographics.cd_marital_status <> customer_demographics0.cd_marital_status) AND (item.i_current_price >= 84 AND item.i_current_price <= 84 + 10 AND (promotion.p_channel_email = 'N' AND promotion.p_channel_tv = 'Y')) AND (promotion.p_channel_radio = 'N' AND (customer_address0.ca_state = 'GA' OR customer_address0.ca_state = 'SC' OR customer_address0.ca_state = 'TX') AND (store_sales.ss_wholesale_cost >= 80 AND store_sales.ss_wholesale_cost <= 100) AND ((customer_demographics.cd_marital_status = 'U' OR customer_demographics.cd_marital_status = 'W') AND (customer_demographics.cd_education_status = 'Unknown' OR customer_demographics.cd_education_status = 'Secondary' OR customer_demographics.cd_education_status = 'Primary') AND ((customer_demographics0.cd_marital_status = 'U' OR customer_demographics0.cd_marital_status = 'W') AND (customer_demographics0.cd_education_status = 'Unknown' OR customer_demographics0.cd_education_status = 'Secondary' OR customer_demographics0.cd_education_status = 'Primary'))))) GROUP BY date_dim.d_year, date_dim0.d_year, date_dim1.d_year, store.s_zip, store.s_store_name, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number, customer_address0.ca_street_name, customer_address0.ca_city, customer_address0.ca_zip, item.i_item_sk, item.i_product_name) AS t5, (SELECT item0.i_product_name, item0.i_item_sk, store0.s_store_name, store0.s_zip, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number AS ca_street_number0, customer_address2.ca_street_name AS ca_street_name0, customer_address2.ca_city AS ca_city0, customer_address2.ca_zip AS ca_zip0, date_dim2.d_year, date_dim3.d_year AS d_year0, date_dim4.d_year AS d_year1, COUNT(*) AS cnt, SUM(store_sales0.ss_wholesale_cost) AS s1, SUM(store_sales0.ss_list_price) AS s2, SUM(store_sales0.ss_coupon_amt) AS s3 FROM store_sales AS store_sales0, store_returns AS store_returns0, (SELECT catalog_sales0.cs_item_sk, SUM(catalog_sales0.cs_ext_list_price) AS sale, SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit) AS refund FROM catalog_sales AS catalog_sales0, catalog_returns AS catalog_returns0 WHERE catalog_sales0.cs_item_sk = catalog_returns0.cr_item_sk AND catalog_sales0.cs_order_number = catalog_returns0.cr_order_number AND catalog_sales0.cs_wholesale_cost >= 80 AND catalog_sales0.cs_wholesale_cost <= 100 GROUP BY catalog_sales0.cs_item_sk HAVING SUM(catalog_sales0.cs_ext_list_price) > 2 * SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit)) AS t9, date_dim AS date_dim2, date_dim AS date_dim3, date_dim AS date_dim4, store AS store0, customer AS customer0, customer_demographics AS customer_demographics1, customer_demographics AS customer_demographics2, promotion AS promotion0, household_demographics AS household_demographics1, household_demographics AS household_demographics2, customer_address AS customer_address1, customer_address AS customer_address2, income_band AS income_band1, income_band AS income_band2, item AS item0 WHERE store_sales0.ss_store_sk = store0.s_store_sk AND (store_sales0.ss_sold_date_sk = date_dim2.d_date_sk AND store_sales0.ss_customer_sk = customer0.c_customer_sk) AND (store_sales0.ss_cdemo_sk = customer_demographics1.cd_demo_sk AND store_sales0.ss_hdemo_sk = household_demographics1.hd_demo_sk AND (store_sales0.ss_addr_sk = customer_address1.ca_address_sk AND store_sales0.ss_item_sk = item0.i_item_sk)) AND (store_sales0.ss_item_sk = store_returns0.sr_item_sk AND store_sales0.ss_ticket_number = store_returns0.sr_ticket_number AND (store_sales0.ss_item_sk = t9.cs_item_sk AND customer0.c_current_cdemo_sk = customer_demographics2.cd_demo_sk) AND (customer0.c_current_hdemo_sk = household_demographics2.hd_demo_sk AND customer0.c_current_addr_sk = customer_address2.ca_address_sk AND (customer0.c_first_sales_date_sk = date_dim3.d_date_sk AND customer0.c_first_shipto_date_sk = date_dim4.d_date_sk))) AND (store_sales0.ss_promo_sk = promotion0.p_promo_sk AND household_demographics1.hd_income_band_sk = income_band1.ib_income_band_sk AND (household_demographics2.hd_income_band_sk = income_band2.ib_income_band_sk AND customer_demographics1.cd_marital_status <> customer_demographics2.cd_marital_status) AND (item0.i_current_price >= 84 AND item0.i_current_price <= 84 + 10 AND (promotion0.p_channel_email = 'N' AND promotion0.p_channel_tv = 'Y')) AND (promotion0.p_channel_radio = 'N' AND (customer_address2.ca_state = 'GA' OR customer_address2.ca_state = 'SC' OR customer_address2.ca_state = 'TX') AND (store_sales0.ss_wholesale_cost >= 80 AND store_sales0.ss_wholesale_cost <= 100) AND ((customer_demographics1.cd_marital_status = 'U' OR customer_demographics1.cd_marital_status = 'W') AND (customer_demographics1.cd_education_status = 'Unknown' OR customer_demographics1.cd_education_status = 'Secondary' OR customer_demographics1.cd_education_status = 'Primary') AND ((customer_demographics2.cd_marital_status = 'U' OR customer_demographics2.cd_marital_status = 'W') AND (customer_demographics2.cd_education_status = 'Unknown' OR customer_demographics2.cd_education_status = 'Secondary' OR customer_demographics2.cd_education_status = 'Primary'))))) GROUP BY date_dim2.d_year, date_dim3.d_year, date_dim4.d_year, store0.s_zip, store0.s_store_name, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number, customer_address2.ca_street_name, customer_address2.ca_city, customer_address2.ca_zip, item0.i_item_sk, item0.i_product_name) AS t12 WHERE t5.i_item_sk = t12.i_item_sk AND (t5.d_year = 2000 AND t12.d_year = 2000 + 1) AND (t12.cnt <= t5.cnt AND (t5.s_store_name = t12.s_store_name AND t5.s_zip = t12.s_zip)) ORDER BY t5.i_product_name, t5.s_store_name, t12.cnt, t5.s1, t12.s1;","['AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'JOIN_EXTRACT_FILTER']",22.73207704,10.11396273,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
158,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'AK'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk, customer_address.ca_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t0 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'AK') AS t1 INNER JOIN customer ON t1.ca_address_sk = customer.c_current_addr_sk AND t0.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t3.ca_state, AVG(t3.ctr_total_return) AS f1 FROM (SELECT catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t2 ON catalog_returns0.cr_returned_date_sk = t2.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t3 GROUP BY t3.ca_state) AS t4 ON t0.ca_state = t4.ca_state AND t0.ctr_total_return > t4.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return LIMIT 100","['FILTER_CORRELATE', 'FILTER_MERGE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_CORRELATE', 'FILTER_MERGE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_CORRELATE', 'AGGREGATE_PROJECT_MERGE']",300,0.513570627,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
159,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'IL'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk, customer_address.ca_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t0 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'IL') AS t1 INNER JOIN customer ON t1.ca_address_sk = customer.c_current_addr_sk AND t0.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t3.ca_state, AVG(t3.ctr_total_return) AS f1 FROM (SELECT catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t2 ON catalog_returns0.cr_returned_date_sk = t2.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t3 GROUP BY t3.ca_state) AS t4 ON t0.ca_state = t4.ca_state AND t0.ctr_total_return > t4.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_SCAN']",300,0.495823383,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
160,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'NH'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk, customer_address.ca_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t0 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'NH') AS t1 INNER JOIN customer ON t1.ca_address_sk = customer.c_current_addr_sk AND t0.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t3.ca_state, AVG(t3.ctr_total_return) AS f1 FROM (SELECT catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t2 ON catalog_returns0.cr_returned_date_sk = t2.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t3 GROUP BY t3.ca_state) AS t4 ON t0.ca_state = t4.ca_state AND t0.ctr_total_return > t4.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return LIMIT 100","['AGGREGATE_PROJECT_MERGE', 'JOIN_CONDITION_PUSH', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE']",300,0.505146265,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
161,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'SC'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT t5.c_customer_id, t5.c_salutation, t5.c_first_name, t5.c_last_name, t5.ca_street_number, t5.ca_street_name, t5.ca_street_type, t5.ca_suite_number, t5.ca_city, t5.ca_county, t5.ca_state, t5.ca_zip, t5.ca_country, t5.ca_gmt_offset, t5.ca_location_type, t5.ctr_total_return FROM (SELECT * FROM (SELECT t0.cr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, SUM(t0.cr_return_amt_inc_tax) AS ctr_total_return FROM (SELECT * FROM catalog_returns, (SELECT * FROM date_dim WHERE d_year = 1998) AS t WHERE catalog_returns.cr_returned_date_sk = t.d_date_sk) AS t0, customer_address WHERE t0.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY t0.cr_returning_customer_sk, customer_address.ca_state) AS t3, (SELECT * FROM customer_address WHERE ca_state = 'SC') AS t4, customer WHERE t4.ca_address_sk = customer.c_current_addr_sk AND t3.ctr_customer_sk = customer.c_customer_sk) AS t5, (SELECT t11.ctr_state, AVG(t11.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.cr_return_amt_inc_tax) AS ctr_total_return FROM (SELECT * FROM catalog_returns AS catalog_returns0, (SELECT * FROM date_dim WHERE d_year = 1998) AS t6 WHERE catalog_returns0.cr_returned_date_sk = t6.d_date_sk) AS t7, customer_address AS customer_address1 WHERE t7.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY t7.cr_returning_customer_sk, customer_address1.ca_state) AS t11 GROUP BY t11.ctr_state) AS t12 WHERE t5.ctr_state = t12.ctr_state AND t5.ctr_total_return > t12.f1 * 1.2 ORDER BY t5.c_customer_id, t5.c_salutation, t5.c_first_name, t5.c_last_name, t5.ca_street_number, t5.ca_street_name, t5.ca_street_type, t5.ca_suite_number, t5.ca_city, t5.ca_county, t5.ca_state, t5.ca_zip, t5.ca_country, t5.ca_gmt_offset, t5.ca_location_type, t5.ctr_total_return LIMIT 100","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_SCAN']",300,0.514626424,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
162,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'TN'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT t9.c_customer_id, t9.c_salutation, t9.c_first_name, t9.c_last_name, t9.ca_street_number, t9.ca_street_name, t9.ca_street_type, t9.ca_suite_number, t9.ca_city, t9.ca_county, t9.ca_state, t9.ca_zip, t9.ca_country, t9.ca_gmt_offset, t9.ca_location_type, t9.ctr_total_return FROM (SELECT t1.ctr_customer_sk, t1.ctr_state, t1.ctr_total_return, t2.ca_gmt_offset, t2.ca_address_sk, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_location_type, t2.ca_address_id, customer.c_customer_sk, customer.c_current_hdemo_sk, customer.c_current_addr_sk, customer.c_first_shipto_date_sk, customer.c_first_sales_date_sk, customer.c_birth_day, customer.c_birth_month, customer.c_birth_year, customer.c_last_review_date_sk, customer.c_current_cdemo_sk, customer.c_customer_id, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_country, customer.c_login, customer.c_email_address, customer.c_salutation, customer.c_first_name, CAST(t7.ctr_state AS CHAR(1)) AS ctr_state0, CAST(t7.f1 AS DECIMAL(19, 0)) AS f1 FROM (SELECT catalog_returns.cr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t1 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'TN') AS t2 INNER JOIN customer ON t2.ca_address_sk = customer.c_current_addr_sk AND t1.ctr_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t6.ctr_state, AVG(t6.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t3 ON catalog_returns0.cr_returned_date_sk = t3.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t6 GROUP BY t6.ctr_state) AS t7 ON t1.ctr_state = t7.ctr_state AND t1.ctr_total_return > t7.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return LIMIT 100) AS t9","['SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']",300,0.503831704,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
163,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'WV'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t1 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'WV') AS t2 INNER JOIN customer ON t2.ca_address_sk = customer.c_current_addr_sk AND t1.ctr_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t6.ctr_state, AVG(t6.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t3 ON catalog_returns0.cr_returned_date_sk = t3.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t6 GROUP BY t6.ctr_state) AS t7 ON t1.ctr_state = t7.ctr_state AND t1.ctr_total_return > t7.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return LIMIT 100",['AGGREGATE_EXPAND_DISTINCT_AGGREGATES'],300,0.504903475,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
164,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'AL'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t1 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'AL') AS t2 INNER JOIN customer ON t2.ca_address_sk = customer.c_current_addr_sk AND t1.ctr_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t6.ctr_state, AVG(t6.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t3 ON catalog_returns0.cr_returned_date_sk = t3.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t6 GROUP BY t6.ctr_state) AS t7 ON t1.ctr_state = t7.ctr_state AND t1.ctr_total_return > t7.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return LIMIT 100;","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MULTI_JOIN_MERGE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']",300,0.943215688,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
165,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'CA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t1 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'CA') AS t2 INNER JOIN customer ON t2.ca_address_sk = customer.c_current_addr_sk AND t1.ctr_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t6.ctr_state, AVG(t6.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t3 ON catalog_returns0.cr_returned_date_sk = t3.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t6 GROUP BY t6.ctr_state) AS t7 ON t1.ctr_state = t7.ctr_state AND t1.ctr_total_return > t7.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return LIMIT 100;","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_AGGREGATE_TRANSPOSE']",300,0.93173035,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
166,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'IN'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk, customer_address.ca_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t0 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'IN') AS t1 INNER JOIN customer ON t1.ca_address_sk = customer.c_current_addr_sk AND t0.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t3.ca_state, AVG(t3.ctr_total_return) AS f1 FROM (SELECT catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t2 ON catalog_returns0.cr_returned_date_sk = t2.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t3 GROUP BY t3.ca_state) AS t4 ON t0.ca_state = t4.ca_state AND t0.ctr_total_return > t4.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return LIMIT 100","['AGGREGATE_PROJECT_MERGE', 'AGGREGATE_UNION_AGGREGATE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']",300,0.939188878,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
167,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'PA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT t9.c_customer_id, t9.c_salutation, t9.c_first_name, t9.c_last_name, t9.ca_street_number, t9.ca_street_name, t9.ca_street_type, t9.ca_suite_number, t9.ca_city, t9.ca_county, t9.ca_state, t9.ca_zip, t9.ca_country, t9.ca_gmt_offset, t9.ca_location_type, t9.ctr_total_return FROM (SELECT t1.ctr_customer_sk, t1.ctr_state, t1.ctr_total_return, t2.ca_gmt_offset, t2.ca_address_sk, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_location_type, t2.ca_address_id, customer.c_customer_sk, customer.c_current_hdemo_sk, customer.c_current_addr_sk, customer.c_first_shipto_date_sk, customer.c_first_sales_date_sk, customer.c_birth_day, customer.c_birth_month, customer.c_birth_year, customer.c_last_review_date_sk, customer.c_current_cdemo_sk, customer.c_customer_id, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_country, customer.c_login, customer.c_email_address, customer.c_salutation, customer.c_first_name, CAST(t7.ctr_state AS CHAR(1)) AS ctr_state0, CAST(t7.f1 AS DECIMAL(19, 0)) AS f1 FROM (SELECT catalog_returns.cr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t1 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'PA') AS t2 INNER JOIN customer ON t2.ca_address_sk = customer.c_current_addr_sk AND t1.ctr_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t6.ctr_state, AVG(t6.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t3 ON catalog_returns0.cr_returned_date_sk = t3.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t6 GROUP BY t6.ctr_state) AS t7 ON t1.ctr_state = t7.ctr_state AND t1.ctr_total_return > t7.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return LIMIT 100) AS t9","['FILTER_SCAN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SET_OP_TRANSPOSE', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']",300,0.939678351,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
168,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2000 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'GA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.ca_street_number, t6.ca_street_name, t6.ca_street_type, t6.ca_suite_number, t6.ca_city, t6.ca_county, t6.ca_state, t6.ca_zip, t6.ca_country, t6.ca_gmt_offset, t6.ca_location_type, t6.ctr_total_return FROM (SELECT t0.cr_returning_customer_sk AS ctr_customer_sk, t0.ca_state AS ctr_state, t0.ctr_total_return, t1.ca_gmt_offset, t1.ca_address_sk, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_location_type, t1.ca_address_id, customer.c_customer_sk, customer.c_current_hdemo_sk, customer.c_current_addr_sk, customer.c_first_shipto_date_sk, customer.c_first_sales_date_sk, customer.c_birth_day, customer.c_birth_month, customer.c_birth_year, customer.c_last_review_date_sk, customer.c_current_cdemo_sk, customer.c_customer_id, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_country, customer.c_login, customer.c_email_address, customer.c_salutation, customer.c_first_name, CAST(t4.ca_state AS CHAR(1)) AS ctr_state0, CAST(t4.f1 AS DECIMAL(19, 0)) AS f1 FROM (SELECT catalog_returns.cr_returning_customer_sk, customer_address.ca_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t0 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'GA') AS t1 INNER JOIN customer ON t1.ca_address_sk = customer.c_current_addr_sk AND t0.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t3.ca_state, AVG(t3.ctr_total_return) AS f1 FROM (SELECT catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t2 ON catalog_returns0.cr_returned_date_sk = t2.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t3 GROUP BY t3.ca_state) AS t4 ON t0.ca_state = t4.ca_state AND t0.ctr_total_return > t4.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return LIMIT 100) AS t6","['FILTER_SCAN', 'FILTER_CORRELATE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_AGGREGATE_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'JOIN_REDUCE_EXPRESSIONS', 'FILTER_REDUCE_EXPRESSIONS']",300,0.985155582,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
169,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2000 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'MN'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk, customer_address.ca_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t0 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'MN') AS t1 INNER JOIN customer ON t1.ca_address_sk = customer.c_current_addr_sk AND t0.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t3.ca_state, AVG(t3.ctr_total_return) AS f1 FROM (SELECT catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t2 ON catalog_returns0.cr_returned_date_sk = t2.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t3 GROUP BY t3.ca_state) AS t4 ON t0.ca_state = t4.ca_state AND t0.ctr_total_return > t4.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return LIMIT 100","['FILTER_SCAN', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']",300,0.946219126,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
170,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'CO'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.ca_street_number, t6.ca_street_name, t6.ca_street_type, t6.ca_suite_number, t6.ca_city, t6.ca_county, t6.ca_state, t6.ca_zip, t6.ca_country, t6.ca_gmt_offset, t6.ca_location_type, t6.ctr_total_return FROM (SELECT t0.cr_returning_customer_sk AS ctr_customer_sk, t0.ca_state AS ctr_state, t0.ctr_total_return, t1.ca_gmt_offset, t1.ca_address_sk, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_location_type, t1.ca_address_id, customer.c_customer_sk, customer.c_current_hdemo_sk, customer.c_current_addr_sk, customer.c_first_shipto_date_sk, customer.c_first_sales_date_sk, customer.c_birth_day, customer.c_birth_month, customer.c_birth_year, customer.c_last_review_date_sk, customer.c_current_cdemo_sk, customer.c_customer_id, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_country, customer.c_login, customer.c_email_address, customer.c_salutation, customer.c_first_name, CAST(t4.ca_state AS CHAR(1)) AS ctr_state0, CAST(t4.f1 AS DECIMAL(19, 0)) AS f1 FROM (SELECT catalog_returns.cr_returning_customer_sk, customer_address.ca_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t0 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'CO') AS t1 INNER JOIN customer ON t1.ca_address_sk = customer.c_current_addr_sk AND t0.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t3.ca_state, AVG(t3.ctr_total_return) AS f1 FROM (SELECT catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t2 ON catalog_returns0.cr_returned_date_sk = t2.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t3 GROUP BY t3.ca_state) AS t4 ON t0.ca_state = t4.ca_state AND t0.ctr_total_return > t4.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return LIMIT 100) AS t6;","['FILTER_SCAN', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_PROJECT_MERGE', 'SORT_PROJECT_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE']",300,0.944226185,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
171,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'GA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk, customer_address.ca_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t0 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'GA') AS t1 INNER JOIN customer ON t1.ca_address_sk = customer.c_current_addr_sk AND t0.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t3.ca_state, AVG(t3.ctr_total_return) AS f1 FROM (SELECT catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t2 ON catalog_returns0.cr_returned_date_sk = t2.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t3 GROUP BY t3.ca_state) AS t4 ON t0.ca_state = t4.ca_state AND t0.ctr_total_return > t4.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'FILTER_MULTI_JOIN_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']",300,0.942177931,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
172,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'KY'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t1 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'KY') AS t2 INNER JOIN customer ON t2.ca_address_sk = customer.c_current_addr_sk AND t1.ctr_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t6.ctr_state, AVG(t6.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t3 ON catalog_returns0.cr_returned_date_sk = t3.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t6 GROUP BY t6.ctr_state) AS t7 ON t1.ctr_state = t7.ctr_state AND t1.ctr_total_return > t7.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return LIMIT 100;","['FILTER_PROJECT_TRANSPOSE', 'FILTER_SCAN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH']",300,0.947539727,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
173,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'MI'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t1 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'MI') AS t2 INNER JOIN customer ON t2.ca_address_sk = customer.c_current_addr_sk AND t1.ctr_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t6.ctr_state, AVG(t6.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t3 ON catalog_returns0.cr_returned_date_sk = t3.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t6 GROUP BY t6.ctr_state) AS t7 ON t1.ctr_state = t7.ctr_state AND t1.ctr_total_return > t7.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return LIMIT 100","['FILTER_SET_OP_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']",300,0.923622052,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
174,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'MT'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk, customer_address.ca_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t0 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'MT') AS t1 INNER JOIN customer ON t1.ca_address_sk = customer.c_current_addr_sk AND t0.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t3.ca_state, AVG(t3.ctr_total_return) AS f1 FROM (SELECT catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t2 ON catalog_returns0.cr_returned_date_sk = t2.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t3 GROUP BY t3.ca_state) AS t4 ON t0.ca_state = t4.ca_state AND t0.ctr_total_return > t4.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']",300,0.944039901,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
175,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'WA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t1 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'WA') AS t2 INNER JOIN customer ON t2.ca_address_sk = customer.c_current_addr_sk AND t1.ctr_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t6.ctr_state, AVG(t6.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t3 ON catalog_returns0.cr_returned_date_sk = t3.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t6 GROUP BY t6.ctr_state) AS t7 ON t1.ctr_state = t7.ctr_state AND t1.ctr_total_return > t7.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return LIMIT 100","['FILTER_INTO_JOIN', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS']",300,0.94436415,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
176,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'IL'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk, customer_address.ca_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t0 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'IL') AS t1 INNER JOIN customer ON t1.ca_address_sk = customer.c_current_addr_sk AND t0.cr_returning_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t3.ca_state, AVG(t3.ctr_total_return) AS f1 FROM (SELECT catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t2 ON catalog_returns0.cr_returned_date_sk = t2.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t3 GROUP BY t3.ca_state) AS t4 ON t0.ca_state = t4.ca_state AND t0.ctr_total_return > t4.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t0.ctr_total_return LIMIT 100;","['AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'FILTER_SCAN', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_REMOVE']",300,0.941702366,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
177,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'MD'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t1 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'MD') AS t2 INNER JOIN customer ON t2.ca_address_sk = customer.c_current_addr_sk AND t1.ctr_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t6.ctr_state, AVG(t6.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t3 ON catalog_returns0.cr_returned_date_sk = t3.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t6 GROUP BY t6.ctr_state) AS t7 ON t1.ctr_state = t7.ctr_state AND t1.ctr_total_return > t7.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return LIMIT 100;","['AGGREGATE_ANY_PULL_UP_CONSTANTS', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'SORT_REMOVE', 'FILTER_MERGE']",300,0.955535412,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
178,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'OH'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t1 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'OH') AS t2 INNER JOIN customer ON t2.ca_address_sk = customer.c_current_addr_sk AND t1.ctr_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t6.ctr_state, AVG(t6.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t3 ON catalog_returns0.cr_returned_date_sk = t3.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t6 GROUP BY t6.ctr_state) AS t7 ON t1.ctr_state = t7.ctr_state AND t1.ctr_total_return > t7.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return LIMIT 100","['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE']",300,0.941330512,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
179,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'VA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t1 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'VA') AS t2 INNER JOIN customer ON t2.ca_address_sk = customer.c_current_addr_sk AND t1.ctr_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t6.ctr_state, AVG(t6.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t3 ON catalog_returns0.cr_returned_date_sk = t3.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t6 GROUP BY t6.ctr_state) AS t7 ON t1.ctr_state = t7.ctr_state AND t1.ctr_total_return > t7.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return LIMIT 100","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']",300,0.947834889,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
180,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'WA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;","SELECT customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return FROM (SELECT catalog_returns.cr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, SUM(catalog_returns.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t ON catalog_returns.cr_returned_date_sk = t.d_date_sk INNER JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk GROUP BY catalog_returns.cr_returning_customer_sk, customer_address.ca_state) AS t1 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state = 'WA') AS t2 INNER JOIN customer ON t2.ca_address_sk = customer.c_current_addr_sk AND t1.ctr_customer_sk = customer.c_customer_sk INNER JOIN (SELECT t6.ctr_state, AVG(t6.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(catalog_returns0.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns AS catalog_returns0 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t3 ON catalog_returns0.cr_returned_date_sk = t3.d_date_sk INNER JOIN customer_address AS customer_address1 ON catalog_returns0.cr_returning_addr_sk = customer_address1.ca_address_sk GROUP BY catalog_returns0.cr_returning_customer_sk, customer_address1.ca_state) AS t6 GROUP BY t6.ctr_state) AS t7 ON t1.ctr_state = t7.ctr_state AND t1.ctr_total_return > t7.f1 * 1.2 ORDER BY customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, t2.ca_street_number, t2.ca_street_name, t2.ca_street_type, t2.ca_suite_number, t2.ca_city, t2.ca_county, t2.ca_state, t2.ca_zip, t2.ca_country, t2.ca_gmt_offset, t2.ca_location_type, t1.ctr_total_return LIMIT 100",['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN'],300,0.936006069,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]"
181,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 211 and 270 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 3 AND 6 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AL', 'GA', 'NC') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'W') and cd_education_status IN ('Unknown', '4 yr Degree') and cd_gender = 'F' and c_birth_month = 2 and c_birth_year BETWEEN 1930 AND 1936 order by c_customer_id limit 100 ;","SELECT t1981.c_customer_id FROM (SELECT t1975.sr_customer_sk AS ctr_customer_sk, t1975.sr_store_sk AS ctr_store_sk, t1975.sr_reason_sk AS ctr_reason_sk, SUM(t1975.sr_fee) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 211 AND sr_return_amt / sr_return_quantity <= 270) AS t1975 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t1976 ON t1975.sr_returned_date_sk = t1976.d_date_sk WHERE t1975.sr_reason_sk >= 3 AND t1975.sr_reason_sk <= 6 GROUP BY t1975.sr_customer_sk, t1975.sr_store_sk, t1975.sr_reason_sk) AS t1979 INNER JOIN (SELECT * FROM store WHERE s_state IN ('AL', 'GA', 'NC')) AS t1980 ON t1979.ctr_store_sk = t1980.s_store_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 2 AND (c_birth_year >= 1930 AND c_birth_year <= 1936)) AS t1981 ON t1979.ctr_customer_sk = t1981.c_customer_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('M', 'W') AND cd_education_status IN ('4 yr Degree', 'Unknown') AND cd_gender = 'F') AS t1982 ON t1981.c_current_cdemo_sk = t1982.cd_demo_sk INNER JOIN (SELECT t1987.ctr_store_sk, AVG(t1987.ctr_total_return) AS f1 FROM (SELECT t1983.sr_store_sk AS ctr_store_sk, SUM(t1983.sr_fee) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 211 AND sr_return_amt / sr_return_quantity <= 270) AS t1983 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t1984 ON t1983.sr_returned_date_sk = t1984.d_date_sk GROUP BY t1983.sr_customer_sk, t1983.sr_store_sk, t1983.sr_reason_sk) AS t1987 GROUP BY t1987.ctr_store_sk) AS t1988 ON t1979.ctr_store_sk = t1988.ctr_store_sk AND t1979.ctr_total_return > t1988.f1 * 1.2 ORDER BY t1981.c_customer_id LIMIT 100","['PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN']",0.203440587,0.131189664,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
182,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 22 and 81 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 7 AND 10 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('ID', 'NC', 'SD') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('U', 'U') and cd_education_status IN ('Advanced Degree', 'Advanced Degree') and cd_gender = 'M' and c_birth_month = 4 and c_birth_year BETWEEN 1945 AND 1951 order by c_customer_id limit 100 ;","SELECT t10.c_customer_id FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT t.sr_customer_sk AS ctr_customer_sk, t.sr_store_sk AS ctr_store_sk, t.sr_reason_sk AS ctr_reason_sk, SUM(t.sr_fee) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 22 AND sr_return_amt / sr_return_quantity <= 81) AS t, (SELECT * FROM date_dim WHERE d_year = 2001) AS t0 WHERE t.sr_returned_date_sk = t0.d_date_sk GROUP BY t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk HAVING t.sr_reason_sk >= 7 AND t.sr_reason_sk <= 10) AS t4, (SELECT * FROM store WHERE s_state IN ('ID', 'NC', 'SD')) AS t5 WHERE t5.s_store_sk = t4.ctr_store_sk) AS t6, (SELECT * FROM customer WHERE c_birth_month = 4 AND (c_birth_year >= 1945 AND c_birth_year <= 1951)) AS t7 WHERE t6.ctr_customer_sk = t7.c_customer_sk) AS t8, (SELECT * FROM customer_demographics WHERE cd_marital_status = 'U' AND cd_education_status = 'Advanced Degree' AND cd_gender = 'M') AS t9 WHERE t8.c_current_cdemo_sk = t9.cd_demo_sk) AS t10, (SELECT t16.ctr_store_sk, AVG(t16.ctr_total_return) AS f1 FROM (SELECT t11.sr_store_sk AS ctr_store_sk, SUM(t11.sr_fee) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 22 AND sr_return_amt / sr_return_quantity <= 81) AS t11, (SELECT * FROM date_dim WHERE d_year = 2001) AS t12 WHERE t11.sr_returned_date_sk = t12.d_date_sk GROUP BY t11.sr_customer_sk, t11.sr_store_sk, t11.sr_reason_sk) AS t16 GROUP BY t16.ctr_store_sk) AS t17 WHERE t10.ctr_store_sk = t17.ctr_store_sk AND t10.ctr_total_return > t17.f1 * 1.2 ORDER BY t10.c_customer_id LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'JOIN_EXTRACT_FILTER', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']",208.9131316,0.633182844,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
183,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 241 and 300 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 50 AND 53 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AR', 'GA', 'NC') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'S') and cd_education_status IN ('4 yr Degree', '2 yr Degree') and cd_gender = 'F' and c_birth_month = 7 and c_birth_year BETWEEN 1939 AND 1945 order by c_customer_id limit 100 ;","SELECT t4.c_customer_id FROM (SELECT t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk, SUM(t.sr_fee) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 241 AND sr_return_amt / sr_return_quantity <= 300) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t0 ON t.sr_returned_date_sk = t0.d_date_sk GROUP BY t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk HAVING t.sr_reason_sk >= 50 AND t.sr_reason_sk <= 53) AS t2 INNER JOIN (SELECT * FROM store WHERE s_state IN ('AR', 'GA', 'NC')) AS t3 ON t2.sr_store_sk = t3.s_store_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 7 AND (c_birth_year >= 1939 AND c_birth_year <= 1945)) AS t4 ON t2.sr_customer_sk = t4.c_customer_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status IN ('2 yr Degree', '4 yr Degree') AND cd_gender = 'F') AS t5 ON t4.c_current_cdemo_sk = t5.cd_demo_sk INNER JOIN (SELECT t8.sr_store_sk, AVG(t8.ctr_total_return) AS f1 FROM (SELECT t6.sr_customer_sk, t6.sr_store_sk, t6.sr_reason_sk, SUM(t6.sr_fee) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 241 AND sr_return_amt / sr_return_quantity <= 300) AS t6 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t7 ON t6.sr_returned_date_sk = t7.d_date_sk GROUP BY t6.sr_customer_sk, t6.sr_store_sk, t6.sr_reason_sk) AS t8 GROUP BY t8.sr_store_sk) AS t9 ON t2.sr_store_sk = t9.sr_store_sk AND t2.ctr_total_return > t9.f1 * 1.2 ORDER BY t4.c_customer_id LIMIT 100","['AGGREGATE_PROJECT_MERGE', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE']",0.205320517,0.198288202,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
184,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 and sr_return_amt / sr_return_quantity between 185 and 244 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 23 AND 26 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('IN', 'ME', 'MI') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'M') and cd_education_status IN ('Secondary', 'Secondary') and cd_gender = 'M' and c_birth_month = 10 and c_birth_year BETWEEN 1971 AND 1977 order by c_customer_id limit 100 ;","SELECT t7.c_customer_id FROM (SELECT t0.sr_customer_sk, t0.sr_store_sk, t0.sr_reason_sk, SUM(t0.ctr_total_return * t2.f1) AS ctr_total_return FROM (SELECT sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_reason_sk, SUM(sr_refunded_cash) AS ctr_total_return FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 185 AND sr_return_amt / sr_return_quantity <= 244 GROUP BY sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_reason_sk) AS t0 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_year = 1998 GROUP BY d_date_sk) AS t2 ON t0.sr_returned_date_sk = t2.d_date_sk GROUP BY t0.sr_customer_sk, t0.sr_store_sk, t0.sr_reason_sk HAVING t0.sr_reason_sk >= 23 AND t0.sr_reason_sk <= 26) AS t5 INNER JOIN (SELECT * FROM store WHERE s_state IN ('IN', 'ME', 'MI')) AS t6 ON t5.sr_store_sk = t6.s_store_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 10 AND (c_birth_year >= 1971 AND c_birth_year <= 1977)) AS t7 ON t5.sr_customer_sk = t7.c_customer_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Secondary' AND cd_gender = 'M') AS t8 ON t7.c_current_cdemo_sk = t8.cd_demo_sk INNER JOIN (SELECT t14.sr_store_sk, AVG(t14.ctr_total_return) AS f1 FROM (SELECT t10.sr_customer_sk, t10.sr_store_sk, t10.sr_reason_sk, SUM(t10.ctr_total_return * t12.f1) AS ctr_total_return FROM (SELECT sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_reason_sk, SUM(sr_refunded_cash) AS ctr_total_return FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 185 AND sr_return_amt / sr_return_quantity <= 244 GROUP BY sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_reason_sk) AS t10 INNER JOIN (SELECT d_date_sk, COUNT(*) AS f1 FROM date_dim WHERE d_year = 1998 GROUP BY d_date_sk) AS t12 ON t10.sr_returned_date_sk = t12.d_date_sk GROUP BY t10.sr_customer_sk, t10.sr_store_sk, t10.sr_reason_sk) AS t14 GROUP BY t14.sr_store_sk) AS t15 ON t5.sr_store_sk = t15.sr_store_sk AND t5.ctr_total_return > t15.f1 * 1.2 ORDER BY t7.c_customer_id LIMIT 100","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_CORRELATE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE']",0.202314297,0.144602935,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
185,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 and sr_return_amt / sr_return_quantity between 78 and 137 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 23 AND 26 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AR', 'NY', 'TX') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'M') and cd_education_status IN ('4 yr Degree', 'Unknown') and cd_gender = 'F' and c_birth_month = 3 and c_birth_year BETWEEN 1945 AND 1951 order by c_customer_id limit 100 ;","SELECT t5.c_customer_id FROM (SELECT t.sr_customer_sk AS ctr_customer_sk, t.sr_store_sk AS ctr_store_sk, t.sr_reason_sk AS ctr_reason_sk, SUM(t.sr_refunded_cash) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 78 AND sr_return_amt / sr_return_quantity <= 137) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t0 ON t.sr_returned_date_sk = t0.d_date_sk GROUP BY t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk HAVING t.sr_reason_sk >= 23 AND t.sr_reason_sk <= 26) AS t3 INNER JOIN (SELECT * FROM store WHERE s_state IN ('AR', 'NY', 'TX')) AS t4 ON t3.ctr_store_sk = t4.s_store_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 3 AND (c_birth_year >= 1945 AND c_birth_year <= 1951)) AS t5 ON t3.ctr_customer_sk = t5.c_customer_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('M', 'S') AND cd_education_status IN ('4 yr Degree', 'Unknown') AND cd_gender = 'F') AS t6 ON t5.c_current_cdemo_sk = t6.cd_demo_sk INNER JOIN (SELECT t11.ctr_store_sk, AVG(t11.ctr_total_return) AS f1 FROM (SELECT t7.sr_store_sk AS ctr_store_sk, SUM(t7.sr_refunded_cash) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 78 AND sr_return_amt / sr_return_quantity <= 137) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t8 ON t7.sr_returned_date_sk = t8.d_date_sk GROUP BY t7.sr_customer_sk, t7.sr_store_sk, t7.sr_reason_sk) AS t11 GROUP BY t11.ctr_store_sk) AS t12 ON t3.ctr_store_sk = t12.ctr_store_sk AND t3.ctr_total_return > t12.f1 * 1.2 ORDER BY t5.c_customer_id LIMIT 100","['JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN']",4.52849404,0.352988958,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
186,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 241 and 300 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 16 AND 19 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('KS', 'NC', 'WV') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'S') and cd_education_status IN ('4 yr Degree', 'Secondary') and cd_gender = 'M' and c_birth_month = 3 and c_birth_year BETWEEN 1969 AND 1975 order by c_customer_id limit 100 ;","SELECT t8.c_customer_id FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk, SUM(t.sr_refunded_cash) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 241 AND sr_return_amt / sr_return_quantity <= 300 AND (sr_reason_sk >= 16 AND sr_reason_sk <= 19)) AS t, (SELECT * FROM date_dim WHERE d_year = 1999) AS t0 WHERE t.sr_returned_date_sk = t0.d_date_sk GROUP BY t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk) AS t2, (SELECT * FROM store WHERE s_state IN ('KS', 'NC', 'WV')) AS t3 WHERE t3.s_store_sk = t2.sr_store_sk) AS t4, (SELECT * FROM customer WHERE c_birth_month = 3 AND (c_birth_year >= 1969 AND c_birth_year <= 1975)) AS t5 WHERE t4.sr_customer_sk = t5.c_customer_sk) AS t6, (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('S', 'W') AND cd_education_status IN ('4 yr Degree', 'Secondary') AND cd_gender = 'M') AS t7 WHERE t6.c_current_cdemo_sk = t7.cd_demo_sk) AS t8, (SELECT t12.sr_store_sk, AVG(t12.ctr_total_return) AS f1 FROM (SELECT t9.sr_customer_sk, t9.sr_store_sk, t9.sr_reason_sk, SUM(t9.sr_refunded_cash) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 241 AND sr_return_amt / sr_return_quantity <= 300) AS t9, (SELECT * FROM date_dim WHERE d_year = 1999) AS t10 WHERE t9.sr_returned_date_sk = t10.d_date_sk GROUP BY t9.sr_customer_sk, t9.sr_store_sk, t9.sr_reason_sk) AS t12 GROUP BY t12.sr_store_sk) AS t13 WHERE t8.sr_store_sk = t13.sr_store_sk AND t8.ctr_total_return > t13.f1 * 1.2 ORDER BY t8.c_customer_id LIMIT 100;","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'FILTER_MERGE', 'FILTER_SCAN', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_LEFT_UNION_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH']",0.204963684,0.196500301,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
187,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 235 and 294 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 15 AND 18 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('GA', 'MO', 'VA') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'S') and cd_education_status IN ('Secondary', '2 yr Degree') and cd_gender = 'M' and c_birth_month = 9 and c_birth_year BETWEEN 1964 AND 1970 order by c_customer_id limit 100 ;","SELECT t4.c_customer_id FROM (SELECT t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk, SUM(t.sr_refunded_cash) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 235 AND sr_return_amt / sr_return_quantity <= 294) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t0 ON t.sr_returned_date_sk = t0.d_date_sk GROUP BY t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk HAVING t.sr_reason_sk >= 15 AND t.sr_reason_sk <= 18) AS t2 INNER JOIN (SELECT * FROM store WHERE s_state IN ('GA', 'MO', 'VA')) AS t3 ON t2.sr_store_sk = t3.s_store_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 9 AND (c_birth_year >= 1964 AND c_birth_year <= 1970)) AS t4 ON t2.sr_customer_sk = t4.c_customer_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status IN ('2 yr Degree', 'Secondary') AND cd_gender = 'M') AS t5 ON t4.c_current_cdemo_sk = t5.cd_demo_sk INNER JOIN (SELECT t8.sr_store_sk, AVG(t8.ctr_total_return) AS f1 FROM (SELECT t6.sr_customer_sk, t6.sr_store_sk, t6.sr_reason_sk, SUM(t6.sr_refunded_cash) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 235 AND sr_return_amt / sr_return_quantity <= 294) AS t6 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t7 ON t6.sr_returned_date_sk = t7.d_date_sk GROUP BY t6.sr_customer_sk, t6.sr_store_sk, t6.sr_reason_sk) AS t8 GROUP BY t8.sr_store_sk) AS t9 ON t2.sr_store_sk = t9.sr_store_sk AND t2.ctr_total_return > t9.f1 * 1.2 ORDER BY t4.c_customer_id LIMIT 100","['AGGREGATE_PROJECT_MERGE', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS']",0.208597104,0.199607293,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
188,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 241 and 300 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 64 AND 67 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('ID', 'LA', 'MT') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'M') and cd_education_status IN ('4 yr Degree', 'Secondary') and cd_gender = 'M' and c_birth_month = 10 and c_birth_year BETWEEN 1957 AND 1963 order by c_customer_id limit 100 ;","SELECT t4.c_customer_id FROM (SELECT t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk, SUM(t.sr_refunded_cash) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 241 AND sr_return_amt / sr_return_quantity <= 300) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t0 ON t.sr_returned_date_sk = t0.d_date_sk GROUP BY t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk HAVING t.sr_reason_sk >= 64 AND t.sr_reason_sk <= 67) AS t2 INNER JOIN (SELECT * FROM store WHERE s_state IN ('ID', 'LA', 'MT')) AS t3 ON t2.sr_store_sk = t3.s_store_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 10 AND (c_birth_year >= 1957 AND c_birth_year <= 1963)) AS t4 ON t2.sr_customer_sk = t4.c_customer_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('M', 'W') AND cd_education_status IN ('4 yr Degree', 'Secondary') AND cd_gender = 'M') AS t5 ON t4.c_current_cdemo_sk = t5.cd_demo_sk INNER JOIN (SELECT t8.sr_store_sk, AVG(t8.ctr_total_return) AS f1 FROM (SELECT t6.sr_customer_sk, t6.sr_store_sk, t6.sr_reason_sk, SUM(t6.sr_refunded_cash) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 241 AND sr_return_amt / sr_return_quantity <= 300) AS t6 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t7 ON t6.sr_returned_date_sk = t7.d_date_sk GROUP BY t6.sr_customer_sk, t6.sr_store_sk, t6.sr_reason_sk) AS t8 GROUP BY t8.sr_store_sk) AS t9 ON t2.sr_store_sk = t9.sr_store_sk AND t2.ctr_total_return > t9.f1 * 1.2 ORDER BY t4.c_customer_id LIMIT 100","['FILTER_INTO_JOIN', 'FILTER_SET_OP_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'PROJECT_TO_CALC']",0.203815301,0.200998227,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
189,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 202 and 261 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 2 AND 5 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AL', 'KS', 'NY') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'S') and cd_education_status IN ('Advanced Degree', 'Unknown') and cd_gender = 'F' and c_birth_month = 6 and c_birth_year BETWEEN 1971 AND 1977 order by c_customer_id limit 100 ;","SELECT t5.c_customer_id FROM (SELECT ctr_customer_sk, ctr_store_sk, ctr_reason_sk, SUM(sr_return_amt_inc_tax) AS ctr_total_return FROM (SELECT t.sr_customer_sk AS ctr_customer_sk, t.sr_store_sk AS ctr_store_sk, t.sr_reason_sk AS ctr_reason_sk, t.sr_return_amt_inc_tax FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 202 AND sr_return_amt / sr_return_quantity <= 261) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t0 ON t.sr_returned_date_sk = t0.d_date_sk) AS t1 WHERE t1.ctr_reason_sk >= 2 AND t1.ctr_reason_sk <= 5 GROUP BY ctr_customer_sk, ctr_store_sk, ctr_reason_sk) AS t3 INNER JOIN (SELECT * FROM store WHERE s_state IN ('AL', 'KS', 'NY')) AS t4 ON t3.ctr_store_sk = t4.s_store_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 6 AND (c_birth_year >= 1971 AND c_birth_year <= 1977)) AS t5 ON t3.ctr_customer_sk = t5.c_customer_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('M', 'S') AND cd_education_status IN ('Advanced Degree', 'Unknown') AND cd_gender = 'F') AS t6 ON t5.c_current_cdemo_sk = t6.cd_demo_sk INNER JOIN (SELECT t11.ctr_store_sk, AVG(t11.ctr_total_return) AS f1 FROM (SELECT t7.sr_store_sk AS ctr_store_sk, SUM(t7.sr_return_amt_inc_tax) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 202 AND sr_return_amt / sr_return_quantity <= 261) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t8 ON t7.sr_returned_date_sk = t8.d_date_sk GROUP BY t7.sr_customer_sk, t7.sr_store_sk, t7.sr_reason_sk) AS t11 GROUP BY t11.ctr_store_sk) AS t12 ON t3.ctr_store_sk = t12.ctr_store_sk AND t3.ctr_total_return > t12.f1 * 1.2 ORDER BY t5.c_customer_id LIMIT 100;","['AGGREGATE_REMOVE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_PROJECT_LEFT_TRANSPOSE', 'JOIN_PROJECT_RIGHT_TRANSPOSE']",0.202042739,0.12578392,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
190,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 59 and 118 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 14 AND 17 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('IN', 'SD', 'WV') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'W') and cd_education_status IN ('2 yr Degree', '2 yr Degree') and cd_gender = 'M' and c_birth_month = 3 and c_birth_year BETWEEN 1979 AND 1985 order by c_customer_id limit 100 ;","SELECT t4.c_customer_id FROM (SELECT t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk, SUM(t.sr_return_amt_inc_tax) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 59 AND sr_return_amt / sr_return_quantity <= 118) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t0 ON t.sr_returned_date_sk = t0.d_date_sk GROUP BY t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk HAVING t.sr_reason_sk >= 14 AND t.sr_reason_sk <= 17) AS t2 INNER JOIN (SELECT * FROM store WHERE s_state IN ('IN', 'SD', 'WV')) AS t3 ON t2.sr_store_sk = t3.s_store_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 3 AND (c_birth_year >= 1979 AND c_birth_year <= 1985)) AS t4 ON t2.sr_customer_sk = t4.c_customer_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'W' AND cd_education_status = '2 yr Degree' AND cd_gender = 'M') AS t5 ON t4.c_current_cdemo_sk = t5.cd_demo_sk INNER JOIN (SELECT t8.sr_store_sk, AVG(t8.ctr_total_return) AS f1 FROM (SELECT t6.sr_customer_sk, t6.sr_store_sk, t6.sr_reason_sk, SUM(t6.sr_return_amt_inc_tax) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 59 AND sr_return_amt / sr_return_quantity <= 118) AS t6 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t7 ON t6.sr_returned_date_sk = t7.d_date_sk GROUP BY t6.sr_customer_sk, t6.sr_store_sk, t6.sr_reason_sk) AS t8 GROUP BY t8.sr_store_sk) AS t9 ON t2.sr_store_sk = t9.sr_store_sk AND t2.ctr_total_return > t9.f1 * 1.2 ORDER BY t4.c_customer_id LIMIT 100","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']",44.85750969,0.446493705,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
191,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 21 and 80 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 71 AND 74 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AL', 'OK', 'TN') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'U') and cd_education_status IN ('Secondary', 'Primary') and cd_gender = 'M' and c_birth_month = 4 and c_birth_year BETWEEN 1947 AND 1953 order by c_customer_id limit 100 ;","SELECT t5.c_customer_id FROM (SELECT t.sr_customer_sk AS ctr_customer_sk, t.sr_store_sk AS ctr_store_sk, t.sr_reason_sk AS ctr_reason_sk, SUM(t.sr_return_amt_inc_tax) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 21 AND sr_return_amt / sr_return_quantity <= 80) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t0 ON t.sr_returned_date_sk = t0.d_date_sk GROUP BY t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk HAVING t.sr_reason_sk >= 71 AND t.sr_reason_sk <= 74) AS t3 INNER JOIN (SELECT * FROM store WHERE s_state IN ('AL', 'OK', 'TN')) AS t4 ON t3.ctr_store_sk = t4.s_store_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 4 AND (c_birth_year >= 1947 AND c_birth_year <= 1953)) AS t5 ON t3.ctr_customer_sk = t5.c_customer_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('U', 'W') AND cd_education_status IN ('Primary', 'Secondary') AND cd_gender = 'M') AS t6 ON t5.c_current_cdemo_sk = t6.cd_demo_sk INNER JOIN (SELECT t11.ctr_store_sk, AVG(t11.ctr_total_return) AS f1 FROM (SELECT t7.sr_store_sk AS ctr_store_sk, SUM(t7.sr_return_amt_inc_tax) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 21 AND sr_return_amt / sr_return_quantity <= 80) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t8 ON t7.sr_returned_date_sk = t8.d_date_sk GROUP BY t7.sr_customer_sk, t7.sr_store_sk, t7.sr_reason_sk) AS t11 GROUP BY t11.ctr_store_sk) AS t12 ON t3.ctr_store_sk = t12.ctr_store_sk AND t3.ctr_total_return > t12.f1 * 1.2 ORDER BY t5.c_customer_id LIMIT 100","['FILTER_SCAN', 'SORT_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS']",0.469784021,0.119863431,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
192,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 241 and 300 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 17 AND 20 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('KY', 'OH', 'VA') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'U') and cd_education_status IN ('Advanced Degree', 'Secondary') and cd_gender = 'M' and c_birth_month = 5 and c_birth_year BETWEEN 1939 AND 1945 order by c_customer_id limit 100 ;","SELECT t5.c_customer_id FROM (SELECT t.sr_customer_sk AS ctr_customer_sk, t.sr_store_sk AS ctr_store_sk, t.sr_reason_sk AS ctr_reason_sk, SUM(t.sr_return_tax) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 241 AND sr_return_amt / sr_return_quantity <= 300) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t0 ON t.sr_returned_date_sk = t0.d_date_sk GROUP BY t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk HAVING t.sr_reason_sk >= 17 AND t.sr_reason_sk <= 20) AS t3 INNER JOIN (SELECT * FROM store WHERE s_state IN ('KY', 'OH', 'VA')) AS t4 ON t3.ctr_store_sk = t4.s_store_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 5 AND (c_birth_year >= 1939 AND c_birth_year <= 1945)) AS t5 ON t3.ctr_customer_sk = t5.c_customer_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('M', 'U') AND cd_education_status IN ('Advanced Degree', 'Secondary') AND cd_gender = 'M') AS t6 ON t5.c_current_cdemo_sk = t6.cd_demo_sk INNER JOIN (SELECT t11.ctr_store_sk, AVG(t11.ctr_total_return) AS f1 FROM (SELECT t7.sr_store_sk AS ctr_store_sk, SUM(t7.sr_return_tax) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 241 AND sr_return_amt / sr_return_quantity <= 300) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t8 ON t7.sr_returned_date_sk = t8.d_date_sk GROUP BY t7.sr_customer_sk, t7.sr_store_sk, t7.sr_reason_sk) AS t11 GROUP BY t11.ctr_store_sk) AS t12 ON t3.ctr_store_sk = t12.ctr_store_sk AND t3.ctr_total_return > t12.f1 * 1.2 ORDER BY t5.c_customer_id LIMIT 100","['FILTER_SCAN', 'SORT_REMOVE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_MERGE', 'PROJECT_REDUCE_EXPRESSIONS']",0.196270068,0.182135344,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
193,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 and sr_return_amt / sr_return_quantity between 64 and 123 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 3 AND 6 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('KS', 'OK', 'WI') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('U', 'U') and cd_education_status IN ('Advanced Degree', 'Secondary') and cd_gender = 'M' and c_birth_month = 1 and c_birth_year BETWEEN 1967 AND 1973 order by c_customer_id limit 100 ;","SELECT t5.c_customer_id FROM (SELECT t.sr_customer_sk AS ctr_customer_sk, t.sr_store_sk AS ctr_store_sk, t.sr_reason_sk AS ctr_reason_sk, SUM(t.sr_return_tax) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 64 AND sr_return_amt / sr_return_quantity <= 123) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.sr_returned_date_sk = t0.d_date_sk GROUP BY t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk HAVING t.sr_reason_sk >= 3 AND t.sr_reason_sk <= 6) AS t3 INNER JOIN (SELECT * FROM store WHERE s_state IN ('KS', 'OK', 'WI')) AS t4 ON t3.ctr_store_sk = t4.s_store_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 1 AND (c_birth_year >= 1967 AND c_birth_year <= 1973)) AS t5 ON t3.ctr_customer_sk = t5.c_customer_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'U' AND cd_education_status IN ('Advanced Degree', 'Secondary') AND cd_gender = 'M') AS t6 ON t5.c_current_cdemo_sk = t6.cd_demo_sk INNER JOIN (SELECT t11.ctr_store_sk, AVG(t11.ctr_total_return) AS f1 FROM (SELECT t7.sr_store_sk AS ctr_store_sk, SUM(t7.sr_return_tax) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 64 AND sr_return_amt / sr_return_quantity <= 123) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.sr_returned_date_sk = t8.d_date_sk GROUP BY t7.sr_customer_sk, t7.sr_store_sk, t7.sr_reason_sk) AS t11 GROUP BY t11.ctr_store_sk) AS t12 ON t3.ctr_store_sk = t12.ctr_store_sk AND t3.ctr_total_return > t12.f1 * 1.2 ORDER BY t5.c_customer_id LIMIT 100","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_CORRELATE', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_MERGE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']",35.92047628,0.409809351,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
194,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_STORE_CREDIT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 24 and 83 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 23 AND 26 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('GA', 'MN', 'OK') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'S') and cd_education_status IN ('Advanced Degree', 'Advanced Degree') and cd_gender = 'F' and c_birth_month = 7 and c_birth_year BETWEEN 1940 AND 1946 order by c_customer_id limit 100 ;","SELECT t14.c_customer_id FROM (SELECT t3.ctr_customer_sk, t3.ctr_store_sk, t3.ctr_reason_sk, t3.ctr_total_return, t4.s_tax_precentage, t4.s_rec_start_date, t4.s_rec_end_date, t4.s_closed_date_sk, t4.s_number_employees, t4.s_floor_space, t4.s_market_id, t4.s_division_id, t4.s_company_id, t4.s_gmt_offset, t4.s_store_sk, t4.s_geography_class, t4.s_market_desc, t4.s_market_manager, t4.s_zip, t4.s_division_name, t4.s_country, t4.s_company_name, t4.s_street_number, t4.s_store_id, t4.s_street_name, t4.s_street_type, t4.s_suite_number, t4.s_store_name, t4.s_city, t4.s_county, t4.s_hours, t4.s_manager, t4.s_state, t5.c_customer_sk, t5.c_current_hdemo_sk, t5.c_current_addr_sk, t5.c_first_shipto_date_sk, t5.c_first_sales_date_sk, t5.c_birth_day, t5.c_birth_month, t5.c_birth_year, t5.c_last_review_date_sk, t5.c_current_cdemo_sk, t5.c_customer_id, t5.c_last_name, t5.c_preferred_cust_flag, t5.c_birth_country, t5.c_login, t5.c_email_address, t5.c_salutation, t5.c_first_name, t6.cd_dep_college_count, t6.cd_purchase_estimate, t6.cd_dep_count, t6.cd_dep_employed_count, t6.cd_demo_sk, t6.cd_gender, t6.cd_marital_status, t6.cd_education_status, t6.cd_credit_rating, CAST(t12.ctr_store_sk AS INTEGER) AS ctr_store_sk0, CAST(t12.f1 AS DECIMAL(19, 0)) AS f1 FROM (SELECT t.sr_customer_sk AS ctr_customer_sk, t.sr_store_sk AS ctr_store_sk, t.sr_reason_sk AS ctr_reason_sk, SUM(t.sr_store_credit) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 24 AND sr_return_amt / sr_return_quantity <= 83) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t0 ON t.sr_returned_date_sk = t0.d_date_sk GROUP BY t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk HAVING t.sr_reason_sk >= 23 AND t.sr_reason_sk <= 26) AS t3 INNER JOIN (SELECT * FROM store WHERE s_state IN ('GA', 'MN', 'OK')) AS t4 ON t3.ctr_store_sk = t4.s_store_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 7 AND (c_birth_year >= 1940 AND c_birth_year <= 1946)) AS t5 ON t3.ctr_customer_sk = t5.c_customer_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status = 'Advanced Degree' AND cd_gender = 'F') AS t6 ON t5.c_current_cdemo_sk = t6.cd_demo_sk INNER JOIN (SELECT t11.ctr_store_sk, AVG(t11.ctr_total_return) AS f1 FROM (SELECT t7.sr_store_sk AS ctr_store_sk, SUM(t7.sr_store_credit) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 24 AND sr_return_amt / sr_return_quantity <= 83) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t8 ON t7.sr_returned_date_sk = t8.d_date_sk GROUP BY t7.sr_customer_sk, t7.sr_store_sk, t7.sr_reason_sk) AS t11 GROUP BY t11.ctr_store_sk) AS t12 ON t3.ctr_store_sk = t12.ctr_store_sk AND t3.ctr_total_return > t12.f1 * 1.2 ORDER BY t5.c_customer_id LIMIT 100) AS t14","['FILTER_SCAN', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'SORT_PROJECT_TRANSPOSE']",199.6535749,0.579220057,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
195,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_STORE_CREDIT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 120 and 179 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 37 AND 40 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('GA', 'IL', 'NC') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'W') and cd_education_status IN ('Advanced Degree', '4 yr Degree') and cd_gender = 'M' and c_birth_month = 2 and c_birth_year BETWEEN 1942 AND 1948 order by c_customer_id limit 100 ;","SELECT t5.c_customer_id FROM (SELECT t.sr_customer_sk AS ctr_customer_sk, t.sr_store_sk AS ctr_store_sk, t.sr_reason_sk AS ctr_reason_sk, SUM(t.sr_store_credit) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 120 AND sr_return_amt / sr_return_quantity <= 179) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t0 ON t.sr_returned_date_sk = t0.d_date_sk GROUP BY t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk HAVING t.sr_reason_sk >= 37 AND t.sr_reason_sk <= 40) AS t3 INNER JOIN (SELECT * FROM store WHERE s_state IN ('GA', 'IL', 'NC')) AS t4 ON t3.ctr_store_sk = t4.s_store_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 2 AND (c_birth_year >= 1942 AND c_birth_year <= 1948)) AS t5 ON t3.ctr_customer_sk = t5.c_customer_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('M', 'W') AND cd_education_status IN ('4 yr Degree', 'Advanced Degree') AND cd_gender = 'M') AS t6 ON t5.c_current_cdemo_sk = t6.cd_demo_sk INNER JOIN (SELECT t11.ctr_store_sk, AVG(t11.ctr_total_return) AS f1 FROM (SELECT t7.sr_store_sk AS ctr_store_sk, SUM(t7.sr_store_credit) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 120 AND sr_return_amt / sr_return_quantity <= 179) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t8 ON t7.sr_returned_date_sk = t8.d_date_sk GROUP BY t7.sr_customer_sk, t7.sr_store_sk, t7.sr_reason_sk) AS t11 GROUP BY t11.ctr_store_sk) AS t12 ON t3.ctr_store_sk = t12.ctr_store_sk AND t3.ctr_total_return > t12.f1 * 1.2 ORDER BY t5.c_customer_id LIMIT 100;","['FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_SCAN', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'SORT_REMOVE']",1.02478838,0.309914827,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
196,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_STORE_CREDIT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 76 and 135 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 38 AND 41 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('MI', 'NE', 'OH') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'W') and cd_education_status IN ('2 yr Degree', 'Unknown') and cd_gender = 'F' and c_birth_month = 7 and c_birth_year BETWEEN 1982 AND 1988 order by c_customer_id limit 100 ;","SELECT t5.c_customer_id FROM (SELECT t.sr_customer_sk AS ctr_customer_sk, t.sr_store_sk AS ctr_store_sk, t.sr_reason_sk AS ctr_reason_sk, SUM(t.sr_store_credit) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 76 AND sr_return_amt / sr_return_quantity <= 135) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t0 ON t.sr_returned_date_sk = t0.d_date_sk GROUP BY t.sr_customer_sk, t.sr_store_sk, t.sr_reason_sk HAVING t.sr_reason_sk >= 38 AND t.sr_reason_sk <= 41) AS t3 INNER JOIN (SELECT * FROM store WHERE s_state IN ('MI', 'NE', 'OH')) AS t4 ON t3.ctr_store_sk = t4.s_store_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_month = 7 AND (c_birth_year >= 1982 AND c_birth_year <= 1988)) AS t5 ON t3.ctr_customer_sk = t5.c_customer_sk INNER JOIN (SELECT * FROM customer_demographics WHERE cd_marital_status IN ('M', 'W') AND cd_education_status IN ('2 yr Degree', 'Unknown') AND cd_gender = 'F') AS t6 ON t5.c_current_cdemo_sk = t6.cd_demo_sk INNER JOIN (SELECT t11.ctr_store_sk, AVG(t11.ctr_total_return) AS f1 FROM (SELECT t7.sr_store_sk AS ctr_store_sk, SUM(t7.sr_store_credit) AS ctr_total_return FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 76 AND sr_return_amt / sr_return_quantity <= 135) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t8 ON t7.sr_returned_date_sk = t8.d_date_sk GROUP BY t7.sr_customer_sk, t7.sr_store_sk, t7.sr_reason_sk) AS t11 GROUP BY t11.ctr_store_sk) AS t12 ON t3.ctr_store_sk = t12.ctr_store_sk AND t3.ctr_total_return > t12.f1 * 1.2 ORDER BY t5.c_customer_id LIMIT 100","['FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS']",19.94877466,0.368282795,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
197,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 20 and 29 and wr_return_amt / wr_return_quantity between 184 and 213 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('IL', 'MI', 'NE', 'OH')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (20, 34) and c_birth_year BETWEEN 1940 AND 1946 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t23.c_customer_id, t23.c_salutation, t23.c_first_name, t23.c_last_name, t23.c_preferred_cust_flag, t23.c_birth_day, t23.c_birth_month, t23.c_birth_year, t23.c_birth_country, t23.c_login, t23.c_email_address, t23.c_last_review_date_sk, t23.ctr_total_return FROM (SELECT t10.ctr_customer_sk, t10.ctr_state, t10.ctr_reason_sk, t10.ctr_total_return, t10.ca_gmt_offset, t10.ca_address_sk, t10.ca_street_number, t10.ca_street_name, t10.ca_street_type, t10.ca_suite_number, t10.ca_city, t10.ca_county, t10.ca_state, t10.ca_zip, t10.ca_country, t10.ca_location_type, t10.ca_address_id, t10.c_customer_sk, t10.c_current_hdemo_sk, t10.c_current_addr_sk, t10.c_first_shipto_date_sk, t10.c_first_sales_date_sk, t10.c_birth_day, t10.c_birth_month, t10.c_birth_year, t10.c_last_review_date_sk, t10.c_current_cdemo_sk, t10.c_customer_id, t10.c_last_name, t10.c_preferred_cust_flag, t10.c_birth_country, t10.c_login, t10.c_email_address, t10.c_salutation, t10.c_first_name, CAST(t20.ctr_state AS CHAR(1)) AS ctr_state0, CAST(t20.f1 AS DECIMAL(19, 0)) AS f1 FROM (SELECT * FROM (SELECT t2.wr_returning_customer_sk AS ctr_customer_sk, t2.ca_state AS ctr_state, t2.wr_reason_sk AS ctr_reason_sk, SUM(t2.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 184 AND wr_return_amt / wr_return_quantity <= 213) AS t, (SELECT * FROM date_dim WHERE d_year = 1998) AS t0 WHERE t.wr_returned_date_sk = t0.d_date_sk) AS t1, customer_address WHERE t1.wr_returning_addr_sk = customer_address.ca_address_sk) AS t2, (SELECT * FROM item WHERE i_manager_id >= 20 AND i_manager_id <= 29) AS t3 WHERE t2.wr_item_sk = t3.i_item_sk GROUP BY t2.wr_returning_customer_sk, t2.ca_state, t2.wr_reason_sk HAVING t2.wr_reason_sk IN (20, 34)) AS t7, (SELECT * FROM customer_address WHERE ca_state IN ('IL', 'MI', 'NE', 'OH')) AS t8, (SELECT * FROM customer WHERE c_birth_year >= 1940 AND c_birth_year <= 1946) AS t9 WHERE t8.ca_address_sk = t9.c_current_addr_sk AND t7.ctr_customer_sk = t9.c_customer_sk) AS t10, (SELECT t19.ctr_state, AVG(t19.ctr_total_return) AS f1 FROM (SELECT t14.ca_state AS ctr_state, SUM(t14.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 184 AND wr_return_amt / wr_return_quantity <= 213) AS t11, (SELECT * FROM date_dim WHERE d_year = 1998) AS t12 WHERE t11.wr_returned_date_sk = t12.d_date_sk) AS t13, customer_address AS customer_address1 WHERE t13.wr_returning_addr_sk = customer_address1.ca_address_sk) AS t14, (SELECT * FROM item WHERE i_manager_id >= 20 AND i_manager_id <= 29) AS t15 WHERE t14.wr_item_sk = t15.i_item_sk GROUP BY t14.wr_returning_customer_sk, t14.ca_state, t14.wr_reason_sk) AS t19 GROUP BY t19.ctr_state) AS t20 WHERE t10.ctr_state = t20.ctr_state AND t10.ctr_total_return > t20.f1 * 1.2 ORDER BY t10.c_customer_id, t10.c_salutation, t10.c_first_name, t10.c_last_name, t10.c_preferred_cust_flag, t10.c_birth_day, t10.c_birth_month, t10.c_birth_year, t10.c_birth_country, t10.c_login, t10.c_email_address, t10.c_last_review_date_sk, t10.ctr_total_return LIMIT 100) AS t23","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']",0.089872917,0.061599572,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
198,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 20 and 29 and wr_return_amt / wr_return_quantity between 241 and 270 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('FL', 'IL', 'KY', 'VA')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (12, 22) and c_birth_year BETWEEN 1965 AND 1971 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 241 AND wr_return_amt / wr_return_quantity <= 270) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 20 AND i_manager_id <= 29) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk HAVING t.wr_reason_sk IN (12, 22)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('FL', 'IL', 'KY', 'VA')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1965 AND c_birth_year <= 1971) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 241 AND wr_return_amt / wr_return_quantity <= 270) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 20 AND i_manager_id <= 29) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100;","['FILTER_INTO_JOIN', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH']",0.09082365,0.056500594,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
199,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 24 and 33 and wr_return_amt / wr_return_quantity between 97 and 126 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('MO', 'MT', 'NE', 'UT')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (29, 69) and c_birth_year BETWEEN 1966 AND 1972 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 97 AND wr_return_amt / wr_return_quantity <= 126) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 24 AND i_manager_id <= 33) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk HAVING t.wr_reason_sk IN (29, 69)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('MO', 'MT', 'NE', 'UT')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1966 AND c_birth_year <= 1972) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 97 AND wr_return_amt / wr_return_quantity <= 126) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 24 AND i_manager_id <= 33) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'FILTER_SCAN']",0.094943364,0.051020225,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
200,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 31 and 40 and wr_return_amt / wr_return_quantity between 156 and 185 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CO', 'IA', 'LA', 'OK')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (34, 35) and c_birth_year BETWEEN 1962 AND 1968 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 156 AND wr_return_amt / wr_return_quantity <= 185) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 31 AND i_manager_id <= 40) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk HAVING t.wr_reason_sk IN (34, 35)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('CO', 'IA', 'LA', 'OK')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1962 AND c_birth_year <= 1968) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 156 AND wr_return_amt / wr_return_quantity <= 185) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 31 AND i_manager_id <= 40) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE']",0.088687261,0.065059265,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
201,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 38 and 47 and wr_return_amt / wr_return_quantity between 20 and 49 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CO', 'NE', 'NY', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (11, 41) and c_birth_year BETWEEN 1963 AND 1969 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 20 AND wr_return_amt / wr_return_quantity <= 49) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 38 AND i_manager_id <= 47) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk HAVING t.wr_reason_sk IN (11, 41)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('CO', 'NE', 'NY', 'TX')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1963 AND c_birth_year <= 1969) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 20 AND wr_return_amt / wr_return_quantity <= 49) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 38 AND i_manager_id <= 47) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['FILTER_INTO_JOIN', 'FILTER_MERGE']",0.116658211,0.060835044,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
202,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 55 and 64 and wr_return_amt / wr_return_quantity between 271 and 300 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('LA', 'ND', 'TN', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (4, 7) and c_birth_year BETWEEN 1977 AND 1983 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT * FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 271 AND wr_return_amt / wr_return_quantity <= 300) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 55 AND i_manager_id <= 64) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state) AS t3 WHERE t3.wr_reason_sk IN (4, 7)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('LA', 'ND', 'TN', 'TX')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1977 AND c_birth_year <= 1983) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 271 AND wr_return_amt / wr_return_quantity <= 300) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 55 AND i_manager_id <= 64) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100;","['AGGREGATE_PROJECT_MERGE', 'FILTER_MULTI_JOIN_MERGE', 'JOIN_REDUCE_EXPRESSIONS']",0.087566455,0.059788624,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
203,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 90 and 99 and wr_return_amt / wr_return_quantity between 95 and 124 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('MO', 'MT', 'NE', 'UT')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (18, 43) and c_birth_year BETWEEN 1934 AND 1940 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT * FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 95 AND wr_return_amt / wr_return_quantity <= 124) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 90 AND i_manager_id <= 99) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state) AS t3 WHERE t3.wr_reason_sk IN (18, 43)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('MO', 'MT', 'NE', 'UT')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1934 AND c_birth_year <= 1940) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 95 AND wr_return_amt / wr_return_quantity <= 124) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 90 AND i_manager_id <= 99) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE']",0.091024399,0.050097942,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
204,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 136 and 165 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AL', 'IL', 'KS', 'MO')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (7, 64) and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t10.c_customer_id, t10.c_salutation, t10.c_first_name, t10.c_last_name, t10.c_preferred_cust_flag, t10.c_birth_day, t10.c_birth_month, t10.c_birth_year, t10.c_birth_country, t10.c_login, t10.c_email_address, t10.c_last_review_date_sk, t10.ctr_total_return FROM (SELECT * FROM (SELECT t2.wr_returning_customer_sk AS ctr_customer_sk, t2.ca_state AS ctr_state, t2.wr_reason_sk AS ctr_reason_sk, SUM(t2.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 136 AND wr_return_amt / wr_return_quantity <= 165) AS t, (SELECT * FROM date_dim WHERE d_year = 1998) AS t0 WHERE t.wr_returned_date_sk = t0.d_date_sk) AS t1, customer_address WHERE t1.wr_returning_addr_sk = customer_address.ca_address_sk) AS t2, (SELECT * FROM item WHERE i_manager_id >= 91 AND i_manager_id <= 100) AS t3 WHERE t2.wr_item_sk = t3.i_item_sk GROUP BY t2.wr_returning_customer_sk, t2.ca_state, t2.wr_reason_sk HAVING t2.wr_reason_sk IN (7, 64)) AS t7, (SELECT * FROM customer_address WHERE ca_state IN ('AL', 'IL', 'KS', 'MO')) AS t8, (SELECT * FROM customer WHERE c_birth_year >= 1987 AND c_birth_year <= 1993) AS t9 WHERE t8.ca_address_sk = t9.c_current_addr_sk AND t7.ctr_customer_sk = t9.c_customer_sk) AS t10, (SELECT t19.ctr_state, AVG(t19.ctr_total_return) AS f1 FROM (SELECT t14.ca_state AS ctr_state, SUM(t14.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 136 AND wr_return_amt / wr_return_quantity <= 165) AS t11, (SELECT * FROM date_dim WHERE d_year = 1998) AS t12 WHERE t11.wr_returned_date_sk = t12.d_date_sk) AS t13, customer_address AS customer_address1 WHERE t13.wr_returning_addr_sk = customer_address1.ca_address_sk) AS t14, (SELECT * FROM item WHERE i_manager_id >= 91 AND i_manager_id <= 100) AS t15 WHERE t14.wr_item_sk = t15.i_item_sk GROUP BY t14.wr_returning_customer_sk, t14.ca_state, t14.wr_reason_sk) AS t19 GROUP BY t19.ctr_state) AS t20 WHERE t10.ctr_state = t20.ctr_state AND t10.ctr_total_return > t20.f1 * 1.2 ORDER BY t10.c_customer_id, t10.c_salutation, t10.c_first_name, t10.c_last_name, t10.c_preferred_cust_flag, t10.c_birth_day, t10.c_birth_month, t10.c_birth_year, t10.c_birth_country, t10.c_login, t10.c_email_address, t10.c_last_review_date_sk, t10.ctr_total_return LIMIT 100;","['FILTER_SET_OP_TRANSPOSE', 'FILTER_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_EXTRACT_FILTER', 'JOIN_CONDITION_PUSH']",0.085430622,0.056460937,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
205,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 217 and 246 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CA', 'CO', 'FL', 'NY')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (46, 69) and c_birth_year BETWEEN 1943 AND 1949 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t10.c_customer_id, t10.c_salutation, t10.c_first_name, t10.c_last_name, t10.c_preferred_cust_flag, t10.c_birth_day, t10.c_birth_month, t10.c_birth_year, t10.c_birth_country, t10.c_login, t10.c_email_address, t10.c_last_review_date_sk, t10.ctr_total_return FROM (SELECT * FROM (SELECT ctr_customer_sk, ctr_state, ctr_reason_sk, SUM(wr_return_amt) AS ctr_total_return FROM (SELECT t2.wr_returning_customer_sk AS ctr_customer_sk, t2.ca_state AS ctr_state, t2.wr_reason_sk AS ctr_reason_sk, t2.wr_return_amt FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 217 AND wr_return_amt / wr_return_quantity <= 246) AS t, (SELECT * FROM date_dim WHERE d_year = 1998) AS t0 WHERE t.wr_returned_date_sk = t0.d_date_sk) AS t1, customer_address WHERE t1.wr_returning_addr_sk = customer_address.ca_address_sk) AS t2, (SELECT * FROM item WHERE i_manager_id >= 91 AND i_manager_id <= 100) AS t3 WHERE t2.wr_item_sk = t3.i_item_sk) AS t5 WHERE t5.ctr_reason_sk IN (46, 69) GROUP BY ctr_customer_sk, ctr_state, ctr_reason_sk) AS t7, (SELECT * FROM customer_address WHERE ca_state IN ('CA', 'CO', 'FL', 'NY')) AS t8, (SELECT * FROM customer WHERE c_birth_year >= 1943 AND c_birth_year <= 1949) AS t9 WHERE t8.ca_address_sk = t9.c_current_addr_sk AND t7.ctr_customer_sk = t9.c_customer_sk) AS t10, (SELECT t19.ctr_state, AVG(t19.ctr_total_return) AS f1 FROM (SELECT t14.ca_state AS ctr_state, SUM(t14.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 217 AND wr_return_amt / wr_return_quantity <= 246) AS t11, (SELECT * FROM date_dim WHERE d_year = 1998) AS t12 WHERE t11.wr_returned_date_sk = t12.d_date_sk) AS t13, customer_address AS customer_address1 WHERE t13.wr_returning_addr_sk = customer_address1.ca_address_sk) AS t14, (SELECT * FROM item WHERE i_manager_id >= 91 AND i_manager_id <= 100) AS t15 WHERE t14.wr_item_sk = t15.i_item_sk GROUP BY t14.wr_returning_customer_sk, t14.ca_state, t14.wr_reason_sk) AS t19 GROUP BY t19.ctr_state) AS t20 WHERE t10.ctr_state = t20.ctr_state AND t10.ctr_total_return > t20.f1 * 1.2 ORDER BY t10.c_customer_id, t10.c_salutation, t10.c_first_name, t10.c_last_name, t10.c_preferred_cust_flag, t10.c_birth_day, t10.c_birth_month, t10.c_birth_year, t10.c_birth_country, t10.c_login, t10.c_email_address, t10.c_last_review_date_sk, t10.ctr_total_return LIMIT 100;","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'JOIN_EXTRACT_FILTER', 'JOIN_LEFT_UNION_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'UNION_REMOVE']",0.090797027,0.053507408,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
206,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 14 and 23 and wr_return_amt / wr_return_quantity between 91 and 120 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('MO', 'OK', 'PA', 'WV')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (5, 55) and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT ctr_customer_sk, ctr_state, ctr_reason_sk, SUM(wr_return_amt) AS ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, t.wr_return_amt FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 91 AND wr_return_amt / wr_return_quantity <= 120) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 14 AND i_manager_id <= 23) AS t1 ON t.wr_item_sk = t1.i_item_sk) AS t2 WHERE t2.ctr_reason_sk IN (5, 55) GROUP BY ctr_customer_sk, ctr_state, ctr_reason_sk) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('MO', 'OK', 'PA', 'WV')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1987 AND c_birth_year <= 1993) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 91 AND wr_return_amt / wr_return_quantity <= 120) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 14 AND i_manager_id <= 23) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_REMOVE']",0.106383721,0.059911331,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
207,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 19 and 28 and wr_return_amt / wr_return_quantity between 17 and 46 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('KY', 'ME', 'ND', 'NY')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (21, 48) and c_birth_year BETWEEN 1956 AND 1962 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 17 AND wr_return_amt / wr_return_quantity <= 46) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 19 AND i_manager_id <= 28) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk HAVING t.wr_reason_sk IN (21, 48)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('KY', 'ME', 'ND', 'NY')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1956 AND c_birth_year <= 1962) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 17 AND wr_return_amt / wr_return_quantity <= 46) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 19 AND i_manager_id <= 28) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['AGGREGATE_ANY_PULL_UP_CONSTANTS', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'SORT_REMOVE']",0.178669612,0.167462667,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
208,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 39 and 48 and wr_return_amt / wr_return_quantity between 170 and 199 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('GA', 'IN', 'NE', 'SD')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (12, 54) and c_birth_year BETWEEN 1981 AND 1987 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 170 AND wr_return_amt / wr_return_quantity <= 199) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 39 AND i_manager_id <= 48) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk HAVING t.wr_reason_sk IN (12, 54)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('GA', 'IN', 'NE', 'SD')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1981 AND c_birth_year <= 1987) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 170 AND wr_return_amt / wr_return_quantity <= 199) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 39 AND i_manager_id <= 48) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'UNION_REMOVE', 'PROJECT_REDUCE_EXPRESSIONS']",0.088891586,0.048914115,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
209,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 48 and 57 and wr_return_amt / wr_return_quantity between 34 and 63 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('FL', 'GA', 'IN', 'WV')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (10, 48) and c_birth_year BETWEEN 1949 AND 1955 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT ctr_customer_sk, ctr_state, ctr_reason_sk, SUM(wr_return_amt) AS ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, t.wr_return_amt FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 34 AND wr_return_amt / wr_return_quantity <= 63) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 48 AND i_manager_id <= 57) AS t1 ON t.wr_item_sk = t1.i_item_sk) AS t2 WHERE t2.ctr_reason_sk IN (10, 48) GROUP BY ctr_customer_sk, ctr_state, ctr_reason_sk) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('FL', 'GA', 'IN', 'WV')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1949 AND c_birth_year <= 1955) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 34 AND wr_return_amt / wr_return_quantity <= 63) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 48 AND i_manager_id <= 57) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_SCAN']",0.128698667,0.067132314,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
210,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 8 and 17 and wr_return_amt / wr_return_quantity between 271 and 300 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AL', 'FL', 'MO', 'NC')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (30, 59) and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t13.c_customer_id, t13.c_salutation, t13.c_first_name, t13.c_last_name, t13.c_preferred_cust_flag, t13.c_birth_day, t13.c_birth_month, t13.c_birth_year, t13.c_birth_country, t13.c_login, t13.c_email_address, t13.c_last_review_date_sk, t13.ctr_total_return FROM (SELECT t4.wr_returning_customer_sk AS ctr_customer_sk, t4.ca_state AS ctr_state, t4.wr_reason_sk AS ctr_reason_sk, t4.ctr_total_return, t5.ca_gmt_offset, t5.ca_address_sk, t5.ca_street_number, t5.ca_street_name, t5.ca_street_type, t5.ca_suite_number, t5.ca_city, t5.ca_county, t5.ca_state, t5.ca_zip, t5.ca_country, t5.ca_location_type, t5.ca_address_id, t6.c_customer_sk, t6.c_current_hdemo_sk, t6.c_current_addr_sk, t6.c_first_shipto_date_sk, t6.c_first_sales_date_sk, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_last_review_date_sk, t6.c_current_cdemo_sk, t6.c_customer_id, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_salutation, t6.c_first_name, CAST(t11.ca_state AS CHAR(1)) AS ctr_state0, CAST(t11.f1 AS DECIMAL(19, 0)) AS f1 FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 271 AND wr_return_amt / wr_return_quantity <= 300) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 8 AND i_manager_id <= 17) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state HAVING t.wr_reason_sk IN (30, 59)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('AL', 'FL', 'MO', 'NC')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1987 AND c_birth_year <= 1993) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 271 AND wr_return_amt / wr_return_quantity <= 300) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 8 AND i_manager_id <= 17) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100) AS t13;","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'UNION_REMOVE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']",0.08400631,0.062641382,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
211,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 16 and 25 and wr_return_amt / wr_return_quantity between 41 and 70 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CO', 'MI', 'MN', 'OK')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (29, 66) and c_birth_year BETWEEN 1969 AND 1975 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT * FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 41 AND wr_return_amt / wr_return_quantity <= 70) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 16 AND i_manager_id <= 25) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state) AS t3 WHERE t3.wr_reason_sk IN (29, 66)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('CO', 'MI', 'MN', 'OK')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1969 AND c_birth_year <= 1975) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 41 AND wr_return_amt / wr_return_quantity <= 70) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 16 AND i_manager_id <= 25) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100;","['FILTER_SCAN', 'AGGREGATE_PROJECT_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MULTI_JOIN_MERGE', 'JOIN_CONDITION_PUSH', 'SORT_REMOVE']",0.143779119,0.061809619,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
212,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 2 and 11 and wr_return_amt / wr_return_quantity between 235 and 264 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AR', 'KS', 'MI', 'MO')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (30, 65) and c_birth_year BETWEEN 1985 AND 1991 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t13.c_customer_id, t13.c_salutation, t13.c_first_name, t13.c_last_name, t13.c_preferred_cust_flag, t13.c_birth_day, t13.c_birth_month, t13.c_birth_year, t13.c_birth_country, t13.c_login, t13.c_email_address, t13.c_last_review_date_sk, t13.ctr_total_return FROM (SELECT t4.wr_returning_customer_sk AS ctr_customer_sk, t4.ca_state AS ctr_state, t4.wr_reason_sk AS ctr_reason_sk, t4.ctr_total_return, t5.ca_gmt_offset, t5.ca_address_sk, t5.ca_street_number, t5.ca_street_name, t5.ca_street_type, t5.ca_suite_number, t5.ca_city, t5.ca_county, t5.ca_state, t5.ca_zip, t5.ca_country, t5.ca_location_type, t5.ca_address_id, t6.c_customer_sk, t6.c_current_hdemo_sk, t6.c_current_addr_sk, t6.c_first_shipto_date_sk, t6.c_first_sales_date_sk, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_last_review_date_sk, t6.c_current_cdemo_sk, t6.c_customer_id, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_salutation, t6.c_first_name, CAST(t11.ca_state AS CHAR(1)) AS ctr_state0, CAST(t11.f1 AS DECIMAL(19, 0)) AS f1 FROM (SELECT * FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 235 AND wr_return_amt / wr_return_quantity <= 264) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 2 AND i_manager_id <= 11) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state) AS t3 WHERE t3.wr_reason_sk IN (30, 65)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('AR', 'KS', 'MI', 'MO')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1985 AND c_birth_year <= 1991) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 235 AND wr_return_amt / wr_return_quantity <= 264) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 2 AND i_manager_id <= 11) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100) AS t13","['AGGREGATE_ANY_PULL_UP_CONSTANTS', 'JOIN_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'SORT_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_PROJECT_TRANSPOSE', 'FILTER_SCAN']",0.085406383,0.06167833,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
213,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 24 and 33 and wr_return_amt / wr_return_quantity between 17 and 46 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CO', 'FL', 'NY', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (24, 54) and c_birth_year BETWEEN 1951 AND 1957 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 17 AND wr_return_amt / wr_return_quantity <= 46) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 24 AND i_manager_id <= 33) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state HAVING t.wr_reason_sk IN (24, 54)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('CO', 'FL', 'NY', 'TX')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1951 AND c_birth_year <= 1957) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 17 AND wr_return_amt / wr_return_quantity <= 46) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 24 AND i_manager_id <= 33) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']",0.17169253,0.166745663,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
214,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 43 and 52 and wr_return_amt / wr_return_quantity between 92 and 121 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('GA', 'KS', 'MN', 'NM')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (47, 67) and c_birth_year BETWEEN 1942 AND 1948 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT ctr_customer_sk, ctr_state, ctr_reason_sk, SUM(wr_return_amt) AS ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, t.wr_return_amt FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 92 AND wr_return_amt / wr_return_quantity <= 121) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 43 AND i_manager_id <= 52) AS t1 ON t.wr_item_sk = t1.i_item_sk) AS t2 WHERE t2.ctr_reason_sk IN (47, 67) GROUP BY ctr_customer_sk, ctr_state, ctr_reason_sk) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('GA', 'KS', 'MN', 'NM')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1942 AND c_birth_year <= 1948) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 92 AND wr_return_amt / wr_return_quantity <= 121) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 43 AND i_manager_id <= 52) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100;","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_AGGREGATE_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']",0.102528016,0.057049195,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
215,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 271 and 300 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('MO', 'OH', 'OK', 'SD')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (15, 50) and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 271 AND wr_return_amt / wr_return_quantity <= 300) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 91 AND i_manager_id <= 100) AS t1 ON t.wr_item_sk = t1.i_item_sk WHERE t.wr_reason_sk IN (15, 50) GROUP BY t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('MO', 'OH', 'OK', 'SD')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1987 AND c_birth_year <= 1993) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 271 AND wr_return_amt / wr_return_quantity <= 300) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 91 AND i_manager_id <= 100) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE']",0.08731548,0.061556737,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
216,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2001 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 54 and 63 and wr_return_amt / wr_return_quantity between 128 and 157 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('IA', 'MN', 'MO', 'PA')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (32, 66) and c_birth_year BETWEEN 1940 AND 1946 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT * FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 128 AND wr_return_amt / wr_return_quantity <= 157) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 54 AND i_manager_id <= 63) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state) AS t3 WHERE t3.wr_reason_sk IN (32, 66)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('IA', 'MN', 'MO', 'PA')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1940 AND c_birth_year <= 1946) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 128 AND wr_return_amt / wr_return_quantity <= 157) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 54 AND i_manager_id <= 63) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'FILTER_SCAN', 'FILTER_CORRELATE', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_SET_OP_TRANSPOSE', 'SORT_REMOVE']",0.09695061,0.061044296,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
217,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2001 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 67 and 76 and wr_return_amt / wr_return_quantity between 271 and 300 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('NY', 'OK', 'TN', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (6, 39) and c_birth_year BETWEEN 1938 AND 1944 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 271 AND wr_return_amt / wr_return_quantity <= 300) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 67 AND i_manager_id <= 76) AS t1 ON t.wr_item_sk = t1.i_item_sk WHERE t.wr_reason_sk IN (6, 39) GROUP BY t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('NY', 'OK', 'TN', 'TX')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1938 AND c_birth_year <= 1944) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 271 AND wr_return_amt / wr_return_quantity <= 300) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 67 AND i_manager_id <= 76) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['FILTER_AGGREGATE_TRANSPOSE', 'PROJECT_TO_CALC', 'JOIN_REDUCE_EXPRESSIONS', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']",0.085871617,0.054593563,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
218,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2001 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 75 and 84 and wr_return_amt / wr_return_quantity between 271 and 300 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('GA', 'MN', 'TX', 'VT')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (31, 62) and c_birth_year BETWEEN 1936 AND 1942 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT * FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 271 AND wr_return_amt / wr_return_quantity <= 300) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 75 AND i_manager_id <= 84) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state) AS t3 WHERE t3.wr_reason_sk IN (31, 62)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('GA', 'MN', 'TX', 'VT')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1936 AND c_birth_year <= 1942) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 271 AND wr_return_amt / wr_return_quantity <= 300) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 75 AND i_manager_id <= 84) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['FILTER_PROJECT_TRANSPOSE', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES']",0.08200717,0.064496597,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
219,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2001 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 14 and 43 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AK', 'OR', 'WI', 'WY')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (4, 20) and c_birth_year BETWEEN 1936 AND 1942 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT * FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 14 AND wr_return_amt / wr_return_quantity <= 43) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 91 AND i_manager_id <= 100) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state) AS t3 WHERE t3.wr_reason_sk IN (4, 20)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('AK', 'OR', 'WI', 'WY')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1936 AND c_birth_year <= 1942) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 14 AND wr_return_amt / wr_return_quantity <= 43) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 91 AND i_manager_id <= 100) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_INTO_JOIN', 'JOIN_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']",0.137880961,0.068314711,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
220,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2001 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 165 and 194 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('ID', 'LA', 'NE', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (15, 74) and c_birth_year BETWEEN 1960 AND 1966 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT * FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 165 AND wr_return_amt / wr_return_quantity <= 194) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 91 AND i_manager_id <= 100) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state) AS t3 WHERE t3.wr_reason_sk IN (15, 74)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('ID', 'LA', 'NE', 'TX')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1960 AND c_birth_year <= 1966) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 165 AND wr_return_amt / wr_return_quantity <= 194) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 91 AND i_manager_id <= 100) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100;","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_SET_OP_TRANSPOSE', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES']",0.087124983,0.062792063,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
221,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 11 and 20 and wr_return_amt / wr_return_quantity between 77 and 106 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CT', 'MO', 'NM', 'SD')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (54, 66) and c_birth_year BETWEEN 1986 AND 1992 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 77 AND wr_return_amt / wr_return_quantity <= 106) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 11 AND i_manager_id <= 20) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state HAVING t.wr_reason_sk IN (54, 66)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('CT', 'MO', 'NM', 'SD')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1986 AND c_birth_year <= 1992) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 77 AND wr_return_amt / wr_return_quantity <= 106) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 11 AND i_manager_id <= 20) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100;","['FILTER_TABLE_FUNCTION_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_MERGE', 'AGGREGATE_REMOVE', 'SORT_JOIN_TRANSPOSE']",0.108394066,0.060549657,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
222,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 16 and 25 and wr_return_amt / wr_return_quantity between 250 and 279 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('IA', 'MO', 'MS', 'NM')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (16, 57) and c_birth_year BETWEEN 1931 AND 1937 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT * FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 250 AND wr_return_amt / wr_return_quantity <= 279) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 16 AND i_manager_id <= 25) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state) AS t3 WHERE t3.wr_reason_sk IN (16, 57)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('IA', 'MO', 'MS', 'NM')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1931 AND c_birth_year <= 1937) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 250 AND wr_return_amt / wr_return_quantity <= 279) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 16 AND i_manager_id <= 25) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100;","['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE']",0.082243681,0.058790127,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
223,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 27 and 36 and wr_return_amt / wr_return_quantity between 112 and 141 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('KY', 'NC', 'NE', 'WI')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (33, 54) and c_birth_year BETWEEN 1928 AND 1934 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 112 AND wr_return_amt / wr_return_quantity <= 141) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 27 AND i_manager_id <= 36) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk HAVING t.wr_reason_sk IN (33, 54)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('KY', 'NC', 'NE', 'WI')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1928 AND c_birth_year <= 1934) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 112 AND wr_return_amt / wr_return_quantity <= 141) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 27 AND i_manager_id <= 36) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['FILTER_PROJECT_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'SORT_REMOVE']",0.098734299,0.052508354,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
224,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 29 and 38 and wr_return_amt / wr_return_quantity between 61 and 90 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('GA', 'KY', 'MN', 'WV')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (35, 75) and c_birth_year BETWEEN 1945 AND 1951 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 61 AND wr_return_amt / wr_return_quantity <= 90) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 29 AND i_manager_id <= 38) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk HAVING t.wr_reason_sk IN (35, 75)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('GA', 'KY', 'MN', 'WV')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1945 AND c_birth_year <= 1951) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 61 AND wr_return_amt / wr_return_quantity <= 90) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 29 AND i_manager_id <= 38) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100;","['JOIN_REDUCE_EXPRESSIONS', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'FILTER_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_CONDITION_PUSH']",0.12421147,0.062823931,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
225,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 38 and 47 and wr_return_amt / wr_return_quantity between 271 and 300 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('GA', 'IA', 'OH', 'OR')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (60, 61) and c_birth_year BETWEEN 1972 AND 1978 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT * FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 271 AND wr_return_amt / wr_return_quantity <= 300) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 38 AND i_manager_id <= 47) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state) AS t3 WHERE t3.wr_reason_sk IN (60, 61)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('GA', 'IA', 'OH', 'OR')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1972 AND c_birth_year <= 1978) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 271 AND wr_return_amt / wr_return_quantity <= 300) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 38 AND i_manager_id <= 47) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE']",0.084861914,0.059737682,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
226,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 41 and 50 and wr_return_amt / wr_return_quantity between 211 and 240 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('KS', 'LA', 'MO', 'NE')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (64, 67) and c_birth_year BETWEEN 1967 AND 1973 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 211 AND wr_return_amt / wr_return_quantity <= 240) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 41 AND i_manager_id <= 50) AS t1 ON t.wr_item_sk = t1.i_item_sk WHERE t.wr_reason_sk IN (64, 67) GROUP BY t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('KS', 'LA', 'MO', 'NE')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1967 AND c_birth_year <= 1973) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 211 AND wr_return_amt / wr_return_quantity <= 240) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 41 AND i_manager_id <= 50) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'FILTER_PROJECT_TRANSPOSE']",0.088604927,0.061171373,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
227,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 50 and 59 and wr_return_amt / wr_return_quantity between 46 and 75 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AL', 'NE', 'TX', 'WI')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (61, 68) and c_birth_year BETWEEN 1963 AND 1969 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 46 AND wr_return_amt / wr_return_quantity <= 75) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 50 AND i_manager_id <= 59) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk HAVING t.wr_reason_sk IN (61, 68)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('AL', 'NE', 'TX', 'WI')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1963 AND c_birth_year <= 1969) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 46 AND wr_return_amt / wr_return_quantity <= 75) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 50 AND i_manager_id <= 59) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']",0.119033496,0.058745782,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
228,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 53 and 62 and wr_return_amt / wr_return_quantity between 242 and 271 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('GA', 'MO', 'SC', 'VA')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (2, 70) and c_birth_year BETWEEN 1972 AND 1978 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 242 AND wr_return_amt / wr_return_quantity <= 271) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 53 AND i_manager_id <= 62) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk HAVING t.wr_reason_sk IN (2, 70)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('GA', 'MO', 'SC', 'VA')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1972 AND c_birth_year <= 1978) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 242 AND wr_return_amt / wr_return_quantity <= 271) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 53 AND i_manager_id <= 62) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['SORT_REMOVE_CONSTANT_KEYS', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'JOIN_RIGHT_UNION_TRANSPOSE']",0.083552837,0.064259211,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
229,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 54 and 63 and wr_return_amt / wr_return_quantity between 165 and 194 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AL', 'GA', 'SC', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (1, 73) and c_birth_year BETWEEN 1959 AND 1965 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t13.c_customer_id, t13.c_salutation, t13.c_first_name, t13.c_last_name, t13.c_preferred_cust_flag, t13.c_birth_day, t13.c_birth_month, t13.c_birth_year, t13.c_birth_country, t13.c_login, t13.c_email_address, t13.c_last_review_date_sk, t13.ctr_total_return FROM (SELECT t4.wr_returning_customer_sk AS ctr_customer_sk, t4.ca_state AS ctr_state, t4.wr_reason_sk AS ctr_reason_sk, t4.ctr_total_return, t5.ca_gmt_offset, t5.ca_address_sk, t5.ca_street_number, t5.ca_street_name, t5.ca_street_type, t5.ca_suite_number, t5.ca_city, t5.ca_county, t5.ca_state, t5.ca_zip, t5.ca_country, t5.ca_location_type, t5.ca_address_id, t6.c_customer_sk, t6.c_current_hdemo_sk, t6.c_current_addr_sk, t6.c_first_shipto_date_sk, t6.c_first_sales_date_sk, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_last_review_date_sk, t6.c_current_cdemo_sk, t6.c_customer_id, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_salutation, t6.c_first_name, CAST(t11.ca_state AS CHAR(1)) AS ctr_state0, CAST(t11.f1 AS DECIMAL(19, 0)) AS f1 FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 165 AND wr_return_amt / wr_return_quantity <= 194) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 54 AND i_manager_id <= 63) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state HAVING t.wr_reason_sk IN (1, 73)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('AL', 'GA', 'SC', 'TX')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1959 AND c_birth_year <= 1965) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 165 AND wr_return_amt / wr_return_quantity <= 194) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 54 AND i_manager_id <= 63) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100) AS t13","['AGGREGATE_PROJECT_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'FILTER_SCAN', 'FILTER_CORRELATE', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'SORT_PROJECT_TRANSPOSE']",0.0932947,0.058475971,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
230,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 55 and 64 and wr_return_amt / wr_return_quantity between 35 and 64 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AR', 'OK', 'SC', 'WI')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (39, 70) and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT * FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 35 AND wr_return_amt / wr_return_quantity <= 64) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 55 AND i_manager_id <= 64) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state) AS t3 WHERE t3.wr_reason_sk IN (39, 70)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('AR', 'OK', 'SC', 'WI')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1987 AND c_birth_year <= 1993) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 35 AND wr_return_amt / wr_return_quantity <= 64) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 55 AND i_manager_id <= 64) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['AGGREGATE_PROJECT_MERGE', 'JOIN_CONDITION_PUSH', 'FILTER_CORRELATE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']",0.126581987,0.061193069,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
231,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 60 and 69 and wr_return_amt / wr_return_quantity between 81 and 110 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('GA', 'IN', 'NJ', 'VA')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (7, 38) and c_birth_year BETWEEN 1960 AND 1966 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT * FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 81 AND wr_return_amt / wr_return_quantity <= 110) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 60 AND i_manager_id <= 69) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state) AS t3 WHERE t3.wr_reason_sk IN (7, 38)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('GA', 'IN', 'NJ', 'VA')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1960 AND c_birth_year <= 1966) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 81 AND wr_return_amt / wr_return_quantity <= 110) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 60 AND i_manager_id <= 69) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100;","['AGGREGATE_PROJECT_MERGE', 'FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE']",0.106693665,0.066076358,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
232,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 62 and 71 and wr_return_amt / wr_return_quantity between 110 and 139 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CA', 'FL', 'MN', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (64, 65) and c_birth_year BETWEEN 1976 AND 1982 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT * FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 110 AND wr_return_amt / wr_return_quantity <= 139) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 62 AND i_manager_id <= 71) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state) AS t3 WHERE t3.wr_reason_sk IN (64, 65)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('CA', 'FL', 'MN', 'TX')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1976 AND c_birth_year <= 1982) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 110 AND wr_return_amt / wr_return_quantity <= 139) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 62 AND i_manager_id <= 71) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'FILTER_SET_OP_TRANSPOSE']",0.093389591,0.063878616,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
233,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 63 and 72 and wr_return_amt / wr_return_quantity between 157 and 186 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AZ', 'GA', 'MI', 'TN')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (10, 55) and c_birth_year BETWEEN 1940 AND 1946 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 157 AND wr_return_amt / wr_return_quantity <= 186) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 63 AND i_manager_id <= 72) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk HAVING t.wr_reason_sk IN (10, 55)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('AZ', 'GA', 'MI', 'TN')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1940 AND c_birth_year <= 1946) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 157 AND wr_return_amt / wr_return_quantity <= 186) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 63 AND i_manager_id <= 72) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'JOIN_CONDITION_PUSH', 'FILTER_SCAN', 'FILTER_SET_OP_TRANSPOSE', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']",0.090194225,0.061458747,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
234,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 64 and 73 and wr_return_amt / wr_return_quantity between 121 and 150 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('ND', 'TN', 'TX', 'WI')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (4, 65) and c_birth_year BETWEEN 1959 AND 1965 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t21.c_customer_id, t21.c_salutation, t21.c_first_name, t21.c_last_name, t21.c_preferred_cust_flag, t21.c_birth_day, t21.c_birth_month, t21.c_birth_year, t21.c_birth_country, t21.c_login, t21.c_email_address, t21.c_last_review_date_sk, t21.ctr_total_return FROM (SELECT t10.ctr_customer_sk, t10.ctr_state, t10.ctr_reason_sk, t10.ctr_total_return, t10.ca_gmt_offset, t10.ca_address_sk, t10.ca_street_number, t10.ca_street_name, t10.ca_street_type, t10.ca_suite_number, t10.ca_city, t10.ca_county, t10.ca_state, t10.ca_zip, t10.ca_country, t10.ca_location_type, t10.ca_address_id, t10.c_customer_sk, t10.c_current_hdemo_sk, t10.c_current_addr_sk, t10.c_first_shipto_date_sk, t10.c_first_sales_date_sk, t10.c_birth_day, t10.c_birth_month, t10.c_birth_year, t10.c_last_review_date_sk, t10.c_current_cdemo_sk, t10.c_customer_id, t10.c_last_name, t10.c_preferred_cust_flag, t10.c_birth_country, t10.c_login, t10.c_email_address, t10.c_salutation, t10.c_first_name, CAST(t18.ca_state AS CHAR(1)) AS ctr_state0, CAST(t18.f1 AS DECIMAL(19, 0)) AS f1 FROM (SELECT * FROM (SELECT ctr_customer_sk, ctr_state, ctr_reason_sk, SUM(wr_return_amt) AS ctr_total_return FROM (SELECT t2.wr_returning_customer_sk AS ctr_customer_sk, t2.ca_state AS ctr_state, t2.wr_reason_sk AS ctr_reason_sk, t2.wr_return_amt FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 121 AND wr_return_amt / wr_return_quantity <= 150) AS t, (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 WHERE t.wr_returned_date_sk = t0.d_date_sk) AS t1, customer_address WHERE t1.wr_returning_addr_sk = customer_address.ca_address_sk) AS t2, (SELECT * FROM item WHERE i_manager_id >= 64 AND i_manager_id <= 73) AS t3 WHERE t2.wr_item_sk = t3.i_item_sk) AS t5 WHERE t5.ctr_reason_sk IN (4, 65) GROUP BY ctr_customer_sk, ctr_state, ctr_reason_sk) AS t7, (SELECT * FROM customer_address WHERE ca_state IN ('ND', 'TN', 'TX', 'WI')) AS t8, (SELECT * FROM customer WHERE c_birth_year >= 1959 AND c_birth_year <= 1965) AS t9 WHERE t8.ca_address_sk = t9.c_current_addr_sk AND t7.ctr_customer_sk = t9.c_customer_sk) AS t10, (SELECT t17.ca_state, AVG(t17.ctr_total_return) AS f1 FROM (SELECT t14.wr_returning_customer_sk, t14.wr_reason_sk, t14.ca_state, SUM(t14.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 121 AND wr_return_amt / wr_return_quantity <= 150) AS t11, (SELECT * FROM date_dim WHERE d_year = 2002) AS t12 WHERE t11.wr_returned_date_sk = t12.d_date_sk) AS t13, customer_address AS customer_address1 WHERE t13.wr_returning_addr_sk = customer_address1.ca_address_sk) AS t14, (SELECT * FROM item WHERE i_manager_id >= 64 AND i_manager_id <= 73) AS t15 WHERE t14.wr_item_sk = t15.i_item_sk GROUP BY t14.wr_returning_customer_sk, t14.wr_reason_sk, t14.ca_state) AS t17 GROUP BY t17.ca_state) AS t18 WHERE t10.ctr_state = t18.ca_state AND t10.ctr_total_return > t18.f1 * 1.2 ORDER BY t10.c_customer_id, t10.c_salutation, t10.c_first_name, t10.c_last_name, t10.c_preferred_cust_flag, t10.c_birth_day, t10.c_birth_month, t10.c_birth_year, t10.c_birth_country, t10.c_login, t10.c_email_address, t10.c_last_review_date_sk, t10.ctr_total_return LIMIT 100) AS t21","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SET_OP_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'JOIN_EXTRACT_FILTER', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE']",0.09555467,0.054537376,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
235,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 73 and 82 and wr_return_amt / wr_return_quantity between 130 and 159 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AR', 'FL', 'MI', 'NC')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (16, 50) and c_birth_year BETWEEN 1976 AND 1982 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT ctr_customer_sk, ctr_state, ctr_reason_sk, SUM(wr_return_amt) AS ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, t.wr_return_amt FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 130 AND wr_return_amt / wr_return_quantity <= 159) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 73 AND i_manager_id <= 82) AS t1 ON t.wr_item_sk = t1.i_item_sk) AS t2 WHERE t2.ctr_reason_sk IN (16, 50) GROUP BY ctr_customer_sk, ctr_state, ctr_reason_sk) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('AR', 'FL', 'MI', 'NC')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1976 AND c_birth_year <= 1982) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t12.ctr_state, AVG(t12.ctr_total_return) AS f1 FROM (SELECT customer_address1.ca_state AS ctr_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 130 AND wr_return_amt / wr_return_quantity <= 159) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 73 AND i_manager_id <= 82) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, customer_address1.ca_state, t7.wr_reason_sk) AS t12 GROUP BY t12.ctr_state) AS t13 ON t4.ctr_state = t13.ctr_state AND t4.ctr_total_return > t13.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_SET_OP_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS']",0.091425419,0.057830016,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
236,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 90 and 99 and wr_return_amt / wr_return_quantity between 235 and 264 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('KS', 'LA', 'OK', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (28, 43) and c_birth_year BETWEEN 1952 AND 1958 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT t.wr_returning_customer_sk, customer_address.ca_state, t.wr_reason_sk, SUM(t.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 235 AND wr_return_amt / wr_return_quantity <= 264) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 90 AND i_manager_id <= 99) AS t1 ON t.wr_item_sk = t1.i_item_sk GROUP BY t.wr_returning_customer_sk, t.wr_reason_sk, customer_address.ca_state HAVING t.wr_reason_sk IN (28, 43)) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('KS', 'LA', 'OK', 'TX')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1952 AND c_birth_year <= 1958) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.wr_returning_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 235 AND wr_return_amt / wr_return_quantity <= 264) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 90 AND i_manager_id <= 99) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ca_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100;","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SCAN', 'SORT_REMOVE_CONSTANT_KEYS', 'FILTER_MULTI_JOIN_MERGE']",0.08389465,0.060710351,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
237,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 236 and 265 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CO', 'FL', 'MO', 'WI')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (5, 6) and c_birth_year BETWEEN 1951 AND 1957 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;","SELECT t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return FROM (SELECT ctr_customer_sk, ctr_state, ctr_reason_sk, SUM(wr_return_amt) AS ctr_total_return FROM (SELECT t.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, t.wr_reason_sk AS ctr_reason_sk, t.wr_return_amt FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 236 AND wr_return_amt / wr_return_quantity <= 265) AS t INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t0 ON t.wr_returned_date_sk = t0.d_date_sk INNER JOIN customer_address ON t.wr_returning_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 91 AND i_manager_id <= 100) AS t1 ON t.wr_item_sk = t1.i_item_sk) AS t2 WHERE t2.ctr_reason_sk IN (5, 6) GROUP BY ctr_customer_sk, ctr_state, ctr_reason_sk) AS t4 CROSS JOIN (SELECT * FROM customer_address WHERE ca_state IN ('CO', 'FL', 'MO', 'WI')) AS t5 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1951 AND c_birth_year <= 1957) AS t6 ON t5.ca_address_sk = t6.c_current_addr_sk AND t4.ctr_customer_sk = t6.c_customer_sk INNER JOIN (SELECT t10.ca_state, AVG(t10.ctr_total_return) AS f1 FROM (SELECT t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state, SUM(t7.wr_return_amt) AS ctr_total_return FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 236 AND wr_return_amt / wr_return_quantity <= 265) AS t7 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2002) AS t8 ON t7.wr_returned_date_sk = t8.d_date_sk INNER JOIN customer_address AS customer_address1 ON t7.wr_returning_addr_sk = customer_address1.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 91 AND i_manager_id <= 100) AS t9 ON t7.wr_item_sk = t9.i_item_sk GROUP BY t7.wr_returning_customer_sk, t7.wr_reason_sk, customer_address1.ca_state) AS t10 GROUP BY t10.ca_state) AS t11 ON t4.ctr_state = t11.ca_state AND t4.ctr_total_return > t11.f1 * 1.2 ORDER BY t6.c_customer_id, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t4.ctr_total_return LIMIT 100","['FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'FILTER_SCAN', 'JOIN_CONDITION_PUSH']",0.081834475,0.060833772,"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]], ['LogicalFilter', 'LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalFilter', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
238,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Books' and i_class = 'mystery' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 1 and d_year = 2001 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1975 AND 1988 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('GA','IL','LA'   ,'MN','MS','NE'   ,'NM','NY','SC'   ,'TX')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 1)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 1) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t3634.segment, COUNT(*) AS num_customers, t3634.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t3627.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t3622.c_customer_sk, t3622.c_current_addr_sk, t3622.ss_sold_date_sk, t3622.ss_sold_time_sk, t3622.ss_item_sk, t3622.ss_customer_sk, t3622.ss_cdemo_sk, t3622.ss_hdemo_sk, t3622.ss_addr_sk, t3622.ss_store_sk, t3622.ss_promo_sk, t3622.ss_ticket_number, t3622.ss_quantity, t3622.ss_wholesale_cost, t3622.ss_list_price, t3622.ss_sales_price, t3622.ss_ext_discount_amt, t3622.ss_ext_sales_price, t3622.ss_ext_wholesale_cost, t3622.ss_ext_list_price, t3622.ss_ext_tax, t3622.ss_coupon_amt, t3622.ss_net_paid, t3622.ss_net_paid_inc_tax, t3622.ss_net_profit, t3622.ca_gmt_offset, t3622.ca_address_sk, t3622.ca_street_number, t3622.ca_street_name, t3622.ca_street_type, t3622.ca_suite_number, t3622.ca_city, t3622.ca_county, t3622.ca_state, t3622.ca_zip, t3622.ca_country, t3622.ca_location_type, t3622.ca_address_id, t3622.s_tax_precentage, t3622.s_rec_start_date, t3622.s_rec_end_date, t3622.s_closed_date_sk, t3622.s_number_employees, t3622.s_floor_space, t3622.s_market_id, t3622.s_division_id, t3622.s_company_id, t3622.s_gmt_offset, t3622.s_store_sk, t3622.s_geography_class, t3622.s_market_desc, t3622.s_market_manager, t3622.s_zip, t3622.s_division_name, t3622.s_country, t3622.s_company_name, t3622.s_street_number, t3622.s_store_id, t3622.s_street_name, t3622.s_street_type, t3622.s_suite_number, t3622.s_store_name, t3622.s_city, t3622.s_county, t3622.s_hours, t3622.s_manager, t3622.s_state, t3622.d_quarter_seq, t3622.d_year, t3622.d_first_dom, t3622.d_last_dom, t3622.d_same_day_ly, t3622.d_same_day_lq, t3622.d_dow, t3622.d_moy, t3622.d_dom, t3622.d_qoy, t3622.d_date_sk, t3622.d_fy_year, t3622.d_fy_quarter_seq, t3622.d_fy_week_seq, t3622.d_date, t3622.d_month_seq, t3622.d_week_seq, t3622.d_current_year, t3622.d_date_id, t3622.d_day_name, t3622.d_quarter_name, t3622.d_holiday, t3622.d_weekend, t3622.d_following_holiday, t3622.d_current_day, t3622.d_current_week, t3622.d_current_month, t3622.d_current_quarter, CAST(t3625.EXPR0 AS INTEGER) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT c_customer_sk, c_current_addr_sk FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales WHERE cs_wholesale_cost >= 70 AND cs_wholesale_cost <= 100) AS t3600, (SELECT * FROM item WHERE i_category = 'Books' AND i_class = 'mystery') AS t3601 WHERE t3600.item_sk = t3601.i_item_sk) AS t3602, (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy = 1) AS t3603 WHERE t3602.sold_date_sk = t3603.d_date_sk) AS t3604, (SELECT * FROM customer WHERE c_birth_year >= 1975 AND c_birth_year <= 1988) AS t3605 WHERE t3605.c_customer_sk = t3604.customer_sk UNION ALL SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales WHERE ws_wholesale_cost >= 70 AND ws_wholesale_cost <= 100) AS t3608, (SELECT * FROM item WHERE i_category = 'Books' AND i_class = 'mystery') AS t3609 WHERE t3608.item_sk = t3609.i_item_sk) AS t3610, (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy = 1) AS t3611 WHERE t3610.sold_date_sk = t3611.d_date_sk) AS t3612, (SELECT * FROM customer WHERE c_birth_year >= 1975 AND c_birth_year <= 1988) AS t3613 WHERE t3613.c_customer_sk = t3612.customer_sk) AS t) AS t3616, (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 70 AND ss_wholesale_cost <= 100) AS t3617 WHERE t3616.c_customer_sk = t3617.ss_customer_sk) AS t3618, customer_address AS customer_address124 WHERE t3618.c_current_addr_sk = customer_address124.ca_address_sk) AS t3619, (SELECT * FROM store WHERE s_state IN ('GA', 'IL', 'LA', 'MN', 'MS', 'NE', 'NM', 'NY', 'SC', 'TX')) AS t3620 WHERE t3619.ca_county = t3620.s_county AND t3619.ca_state = t3620.s_state) AS t3621, date_dim AS date_dim538 WHERE t3621.ss_sold_date_sk = date_dim538.d_date_sk) AS t3622, (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2001 AND d_moy = 1 GROUP BY d_month_seq + 1) AS t3625 WHERE t3622.d_month_seq >= t3625.EXPR0) AS t3627, (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2001 AND d_moy = 1 GROUP BY d_month_seq + 3) AS t3630 WHERE t3627.d_month_seq <= t3630.EXPR0 GROUP BY t3627.c_customer_sk) AS t3634 GROUP BY t3634.segment ORDER BY t3634.segment, COUNT(*) LIMIT 100","['FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER']",71.62892365,0.348181566,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
239,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Books' and i_class = 'mystery' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 11 and d_year = 1999 and wholesale_cost BETWEEN 27 AND 57 and c_birth_year BETWEEN 1955 AND 1968 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 27 AND 57  and s_state in ('FL','GA','IL'   ,'IN','KS','MD'   ,'MT','NE','TX'   ,'VA')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1999 and d_moy = 11)   and (select distinct d_month_seq+3   from date_dim where d_year = 1999 and d_moy = 11) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t1278.segment, COUNT(*) AS num_customers, t1278.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t1273.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t1267.c_customer_sk, t1267.c_current_addr_sk, t1268.ss_sold_date_sk, t1268.ss_sold_time_sk, t1268.ss_item_sk, t1268.ss_customer_sk, t1268.ss_cdemo_sk, t1268.ss_hdemo_sk, t1268.ss_addr_sk, t1268.ss_store_sk, t1268.ss_promo_sk, t1268.ss_ticket_number, t1268.ss_quantity, t1268.ss_wholesale_cost, t1268.ss_list_price, t1268.ss_sales_price, t1268.ss_ext_discount_amt, t1268.ss_ext_sales_price, t1268.ss_ext_wholesale_cost, t1268.ss_ext_list_price, t1268.ss_ext_tax, t1268.ss_coupon_amt, t1268.ss_net_paid, t1268.ss_net_paid_inc_tax, t1268.ss_net_profit, customer_address46.ca_gmt_offset, customer_address46.ca_address_sk, customer_address46.ca_street_number, customer_address46.ca_street_name, customer_address46.ca_street_type, customer_address46.ca_suite_number, customer_address46.ca_city, customer_address46.ca_county, customer_address46.ca_state, customer_address46.ca_zip, customer_address46.ca_country, customer_address46.ca_location_type, customer_address46.ca_address_id, t1269.s_tax_precentage, t1269.s_rec_start_date, t1269.s_rec_end_date, t1269.s_closed_date_sk, t1269.s_number_employees, t1269.s_floor_space, t1269.s_market_id, t1269.s_division_id, t1269.s_company_id, t1269.s_gmt_offset, t1269.s_store_sk, t1269.s_geography_class, t1269.s_market_desc, t1269.s_market_manager, t1269.s_zip, t1269.s_division_name, t1269.s_country, t1269.s_company_name, t1269.s_street_number, t1269.s_store_id, t1269.s_street_name, t1269.s_street_type, t1269.s_suite_number, t1269.s_store_name, t1269.s_city, t1269.s_county, t1269.s_hours, t1269.s_manager, t1269.s_state, date_dim191.d_quarter_seq, date_dim191.d_year, date_dim191.d_first_dom, date_dim191.d_last_dom, date_dim191.d_same_day_ly, date_dim191.d_same_day_lq, date_dim191.d_dow, date_dim191.d_moy, date_dim191.d_dom, date_dim191.d_qoy, date_dim191.d_date_sk, date_dim191.d_fy_year, date_dim191.d_fy_quarter_seq, date_dim191.d_fy_week_seq, date_dim191.d_date, date_dim191.d_month_seq, date_dim191.d_week_seq, date_dim191.d_current_year, date_dim191.d_date_id, date_dim191.d_day_name, date_dim191.d_quarter_name, date_dim191.d_holiday, date_dim191.d_weekend, date_dim191.d_following_holiday, date_dim191.d_current_day, date_dim191.d_current_week, date_dim191.d_current_month, date_dim191.d_current_quarter, CAST(t1272.EXPR0 AS INTEGER) AS EXPR0 FROM (SELECT t1266.c_customer_sk, t1266.c_current_addr_sk FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales WHERE cs_wholesale_cost >= 27 AND cs_wholesale_cost <= 57 UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales WHERE ws_wholesale_cost >= 27 AND ws_wholesale_cost <= 57) AS t1263 INNER JOIN (SELECT * FROM item WHERE i_category = 'Books' AND i_class = 'mystery') AS t1264 ON t1263.item_sk = t1264.i_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy = 11) AS t1265 ON t1263.sold_date_sk = t1265.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1955 AND c_birth_year <= 1968) AS t1266 ON t1263.customer_sk = t1266.c_customer_sk) AS t1267 INNER JOIN (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 27 AND ss_wholesale_cost <= 57) AS t1268 ON t1267.c_customer_sk = t1268.ss_customer_sk INNER JOIN customer_address AS customer_address46 ON t1267.c_current_addr_sk = customer_address46.ca_address_sk INNER JOIN (SELECT * FROM store WHERE s_state IN ('FL', 'GA', 'IL', 'IN', 'KS', 'MD', 'MT', 'NE', 'TX', 'VA')) AS t1269 ON customer_address46.ca_county = t1269.s_county AND customer_address46.ca_state = t1269.s_state INNER JOIN date_dim AS date_dim191 ON t1268.ss_sold_date_sk = date_dim191.d_date_sk INNER JOIN (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 1999 AND d_moy = 11 GROUP BY d_month_seq + 1) AS t1272 ON date_dim191.d_month_seq >= t1272.EXPR0) AS t1273 INNER JOIN (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 1999 AND d_moy = 11 GROUP BY d_month_seq + 3) AS t1276 ON t1273.d_month_seq <= t1276.EXPR0 GROUP BY t1273.c_customer_sk) AS t1278 GROUP BY t1278.segment ORDER BY t1278.segment, COUNT(*) LIMIT 100","['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE']",300,2.381107569,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
240,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Books' and i_class = 'romance' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 7 and d_year = 1998 and wholesale_cost BETWEEN 37 AND 67 and c_birth_year BETWEEN 1944 AND 1957 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 37 AND 67  and s_state in ('GA','IL','MN'   ,'MO','MS','TX'   ,'VA','WA','WV'   ,'WY')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1998 and d_moy = 7)   and (select distinct d_month_seq+3   from date_dim where d_year = 1998 and d_moy = 7) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t17.segment, COUNT(*) AS num_customers, t17.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t12.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t6.c_customer_sk, t6.c_current_addr_sk, t7.ss_sold_date_sk, t7.ss_sold_time_sk, t7.ss_item_sk, t7.ss_customer_sk, t7.ss_cdemo_sk, t7.ss_hdemo_sk, t7.ss_addr_sk, t7.ss_store_sk, t7.ss_promo_sk, t7.ss_ticket_number, t7.ss_quantity, t7.ss_wholesale_cost, t7.ss_list_price, t7.ss_sales_price, t7.ss_ext_discount_amt, t7.ss_ext_sales_price, t7.ss_ext_wholesale_cost, t7.ss_ext_list_price, t7.ss_ext_tax, t7.ss_coupon_amt, t7.ss_net_paid, t7.ss_net_paid_inc_tax, t7.ss_net_profit, customer_address.ca_gmt_offset, customer_address.ca_address_sk, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_street_type, customer_address.ca_suite_number, customer_address.ca_city, customer_address.ca_county, customer_address.ca_state, customer_address.ca_zip, customer_address.ca_country, customer_address.ca_location_type, customer_address.ca_address_id, t8.s_tax_precentage, t8.s_rec_start_date, t8.s_rec_end_date, t8.s_closed_date_sk, t8.s_number_employees, t8.s_floor_space, t8.s_market_id, t8.s_division_id, t8.s_company_id, t8.s_gmt_offset, t8.s_store_sk, t8.s_geography_class, t8.s_market_desc, t8.s_market_manager, t8.s_zip, t8.s_division_name, t8.s_country, t8.s_company_name, t8.s_street_number, t8.s_store_id, t8.s_street_name, t8.s_street_type, t8.s_suite_number, t8.s_store_name, t8.s_city, t8.s_county, t8.s_hours, t8.s_manager, t8.s_state, date_dim0.d_quarter_seq, date_dim0.d_year, date_dim0.d_first_dom, date_dim0.d_last_dom, date_dim0.d_same_day_ly, date_dim0.d_same_day_lq, date_dim0.d_dow, date_dim0.d_moy, date_dim0.d_dom, date_dim0.d_qoy, date_dim0.d_date_sk, date_dim0.d_fy_year, date_dim0.d_fy_quarter_seq, date_dim0.d_fy_week_seq, date_dim0.d_date, date_dim0.d_month_seq, date_dim0.d_week_seq, date_dim0.d_current_year, date_dim0.d_date_id, date_dim0.d_day_name, date_dim0.d_quarter_name, date_dim0.d_holiday, date_dim0.d_weekend, date_dim0.d_following_holiday, date_dim0.d_current_day, date_dim0.d_current_week, date_dim0.d_current_month, date_dim0.d_current_quarter, CAST(t11.EXPR0 AS INTEGER) AS EXPR0 FROM (SELECT t5.c_customer_sk, t5.c_current_addr_sk FROM (SELECT * FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales) AS t1 WHERE wholesale_cost >= 37 AND wholesale_cost <= 67) AS t2 INNER JOIN (SELECT * FROM item WHERE i_category = 'Books' AND i_class = 'romance') AS t3 ON t2.item_sk = t3.i_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy = 7) AS t4 ON t2.sold_date_sk = t4.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1944 AND c_birth_year <= 1957) AS t5 ON t2.customer_sk = t5.c_customer_sk) AS t6 INNER JOIN (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 37 AND ss_wholesale_cost <= 67) AS t7 ON t6.c_customer_sk = t7.ss_customer_sk INNER JOIN customer_address ON t6.c_current_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM store WHERE s_state IN ('GA', 'IL', 'MN', 'MO', 'MS', 'TX', 'VA', 'WA', 'WV', 'WY')) AS t8 ON customer_address.ca_county = t8.s_county AND customer_address.ca_state = t8.s_state INNER JOIN date_dim AS date_dim0 ON t7.ss_sold_date_sk = date_dim0.d_date_sk INNER JOIN (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 1998 AND d_moy = 7 GROUP BY d_month_seq + 1) AS t11 ON date_dim0.d_month_seq >= t11.EXPR0) AS t12 INNER JOIN (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 1998 AND d_moy = 7 GROUP BY d_month_seq + 3) AS t15 ON t12.d_month_seq <= t15.EXPR0 GROUP BY t12.c_customer_sk) AS t17 GROUP BY t17.segment ORDER BY t17.segment, COUNT(*) LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'JOIN_CONDITION_PUSH', 'FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'FILTER_SCAN', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']",91.29340919,1.231194258,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
241,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Children' and i_class = 'infants' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 1 and d_year = 2000 and wholesale_cost BETWEEN 37 AND 67 and c_birth_year BETWEEN 1954 AND 1967 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 37 AND 67  and s_state in ('AR','CA','GA'   ,'MN','MO','NE'   ,'SC','TX','VA'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 1)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 1) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t2948.segment, COUNT(*) AS num_customers, t2948.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t2942.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t2936.c_customer_sk, t2936.c_current_addr_sk, t2937.ss_sold_date_sk, t2937.ss_sold_time_sk, t2937.ss_item_sk, t2937.ss_customer_sk, t2937.ss_cdemo_sk, t2937.ss_hdemo_sk, t2937.ss_addr_sk, t2937.ss_store_sk, t2937.ss_promo_sk, t2937.ss_ticket_number, t2937.ss_quantity, t2937.ss_wholesale_cost, t2937.ss_list_price, t2937.ss_sales_price, t2937.ss_ext_discount_amt, t2937.ss_ext_sales_price, t2937.ss_ext_wholesale_cost, t2937.ss_ext_list_price, t2937.ss_ext_tax, t2937.ss_coupon_amt, t2937.ss_net_paid, t2937.ss_net_paid_inc_tax, t2937.ss_net_profit, customer_address102.ca_gmt_offset, customer_address102.ca_address_sk, customer_address102.ca_street_number, customer_address102.ca_street_name, customer_address102.ca_street_type, customer_address102.ca_suite_number, customer_address102.ca_city, customer_address102.ca_county, customer_address102.ca_state, customer_address102.ca_zip, customer_address102.ca_country, customer_address102.ca_location_type, customer_address102.ca_address_id, t2938.s_tax_precentage, t2938.s_rec_start_date, t2938.s_rec_end_date, t2938.s_closed_date_sk, t2938.s_number_employees, t2938.s_floor_space, t2938.s_market_id, t2938.s_division_id, t2938.s_company_id, t2938.s_gmt_offset, t2938.s_store_sk, t2938.s_geography_class, t2938.s_market_desc, t2938.s_market_manager, t2938.s_zip, t2938.s_division_name, t2938.s_country, t2938.s_company_name, t2938.s_street_number, t2938.s_store_id, t2938.s_street_name, t2938.s_street_type, t2938.s_suite_number, t2938.s_store_name, t2938.s_city, t2938.s_county, t2938.s_hours, t2938.s_manager, t2938.s_state, date_dim427.d_quarter_seq, date_dim427.d_year, date_dim427.d_first_dom, date_dim427.d_last_dom, date_dim427.d_same_day_ly, date_dim427.d_same_day_lq, date_dim427.d_dow, date_dim427.d_moy, date_dim427.d_dom, date_dim427.d_qoy, date_dim427.d_date_sk, date_dim427.d_fy_year, date_dim427.d_fy_quarter_seq, date_dim427.d_fy_week_seq, date_dim427.d_date, date_dim427.d_month_seq, date_dim427.d_week_seq, date_dim427.d_current_year, date_dim427.d_date_id, date_dim427.d_day_name, date_dim427.d_quarter_name, date_dim427.d_holiday, date_dim427.d_weekend, date_dim427.d_following_holiday, date_dim427.d_current_day, date_dim427.d_current_week, date_dim427.d_current_month, date_dim427.d_current_quarter, CAST(t2941.EXPR0 AS INTEGER) AS EXPR0 FROM (SELECT t2935.c_customer_sk, t2935.c_current_addr_sk FROM (SELECT * FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales WHERE cs_wholesale_cost >= 37 AND cs_wholesale_cost <= 67) AS t2928 INNER JOIN (SELECT * FROM item WHERE i_category = 'Children' AND i_class = 'infants') AS t2929 ON t2928.item_sk = t2929.i_item_sk UNION ALL SELECT * FROM (SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales WHERE ws_wholesale_cost >= 37 AND ws_wholesale_cost <= 67) AS t2931 INNER JOIN (SELECT * FROM item WHERE i_category = 'Children' AND i_class = 'infants') AS t2932 ON t2931.item_sk = t2932.i_item_sk) AS t2933 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy = 1) AS t2934 ON t2933.sold_date_sk = t2934.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1954 AND c_birth_year <= 1967) AS t2935 ON t2933.customer_sk = t2935.c_customer_sk) AS t2936 INNER JOIN (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 37 AND ss_wholesale_cost <= 67) AS t2937 ON t2936.c_customer_sk = t2937.ss_customer_sk INNER JOIN customer_address AS customer_address102 ON t2936.c_current_addr_sk = customer_address102.ca_address_sk INNER JOIN (SELECT * FROM store WHERE s_state IN ('AR', 'CA', 'GA', 'MN', 'MO', 'NE', 'SC', 'TX', 'VA', 'WI')) AS t2938 ON customer_address102.ca_county = t2938.s_county AND customer_address102.ca_state = t2938.s_state INNER JOIN date_dim AS date_dim427 ON t2937.ss_sold_date_sk = date_dim427.d_date_sk INNER JOIN (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2000 AND d_moy = 1 GROUP BY d_month_seq + 1) AS t2941 ON date_dim427.d_month_seq >= t2941.EXPR0) AS t2942 INNER JOIN (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2000 AND d_moy = 1 GROUP BY d_month_seq + 3) AS t2945 ON t2942.d_month_seq <= t2945.EXPR0 GROUP BY t2942.c_customer_sk) AS t2948 GROUP BY t2948.segment ORDER BY t2948.segment, COUNT(*) LIMIT 100","['FILTER_INTO_JOIN', 'PROJECT_TO_CALC']",300,17.06835016,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
242,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Children' and i_class = 'infants' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 1 and d_year = 2001 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('GA','IA','ID'   ,'KY','MO','MT'   ,'NM','NY','OH'   ,'TX')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 1)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 1) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t3276.segment, COUNT(*) AS num_customers, t3276.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t3263.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t3261.c_customer_sk, t3261.c_current_addr_sk FROM (SELECT * FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales WHERE cs_wholesale_cost >= 70 AND cs_wholesale_cost <= 100) AS t3254 INNER JOIN (SELECT * FROM item WHERE i_category = 'Children' AND i_class = 'infants') AS t3255 ON t3254.item_sk = t3255.i_item_sk UNION ALL SELECT * FROM (SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales WHERE ws_wholesale_cost >= 70 AND ws_wholesale_cost <= 100) AS t3257 INNER JOIN (SELECT * FROM item WHERE i_category = 'Children' AND i_class = 'infants') AS t3258 ON t3257.item_sk = t3258.i_item_sk) AS t3259 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy = 1) AS t3260 ON t3259.sold_date_sk = t3260.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1980 AND c_birth_year <= 1993) AS t3261 ON t3259.customer_sk = t3261.c_customer_sk) AS t3262 INNER JOIN (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 70 AND ss_wholesale_cost <= 100) AS t3263 ON t3262.c_customer_sk = t3263.ss_customer_sk INNER JOIN customer_address AS customer_address116 ON t3262.c_current_addr_sk = customer_address116.ca_address_sk INNER JOIN (SELECT * FROM store WHERE s_state IN ('GA', 'IA', 'ID', 'KY', 'MO', 'MT', 'NM', 'NY', 'OH', 'TX')) AS t3264 ON customer_address116.ca_county = t3264.s_county AND customer_address116.ca_state = t3264.s_state INNER JOIN date_dim AS date_dim481 ON t3263.ss_sold_date_sk = date_dim481.d_date_sk INNER JOIN (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2001 AND d_moy = 1 GROUP BY d_month_seq + 1) AS t3267 ON date_dim481.d_month_seq >= t3267.EXPR0 CROSS JOIN (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2001 AND d_moy = 1 GROUP BY d_month_seq + 3) AS t3270 WHERE date_dim481.d_month_seq <= t3270.EXPR0 GROUP BY t3262.c_customer_sk) AS t3276 GROUP BY t3276.segment ORDER BY t3276.segment, COUNT(*) LIMIT 100","['PROJECT_TO_CALC', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']",300,25.19782456,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
243,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Children' and i_class = 'infants' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 8 and d_year = 2002 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1958 AND 1971 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('GA','MN','ND'   ,'NY','OR','PA'   ,'TN','TX','VA'   ,'VT')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2002 and d_moy = 8)   and (select distinct d_month_seq+3   from date_dim where d_year = 2002 and d_moy = 8) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t3270.segment, COUNT(*) AS num_customers, t3270.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t3262.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t3257.c_customer_sk, t3257.c_current_addr_sk, t3257.ss_sold_date_sk, t3257.ss_sold_time_sk, t3257.ss_item_sk, t3257.ss_customer_sk, t3257.ss_cdemo_sk, t3257.ss_hdemo_sk, t3257.ss_addr_sk, t3257.ss_store_sk, t3257.ss_promo_sk, t3257.ss_ticket_number, t3257.ss_quantity, t3257.ss_wholesale_cost, t3257.ss_list_price, t3257.ss_sales_price, t3257.ss_ext_discount_amt, t3257.ss_ext_sales_price, t3257.ss_ext_wholesale_cost, t3257.ss_ext_list_price, t3257.ss_ext_tax, t3257.ss_coupon_amt, t3257.ss_net_paid, t3257.ss_net_paid_inc_tax, t3257.ss_net_profit, t3257.ca_gmt_offset, t3257.ca_address_sk, t3257.ca_street_number, t3257.ca_street_name, t3257.ca_street_type, t3257.ca_suite_number, t3257.ca_city, t3257.ca_county, t3257.ca_state, t3257.ca_zip, t3257.ca_country, t3257.ca_location_type, t3257.ca_address_id, t3257.s_tax_precentage, t3257.s_rec_start_date, t3257.s_rec_end_date, t3257.s_closed_date_sk, t3257.s_number_employees, t3257.s_floor_space, t3257.s_market_id, t3257.s_division_id, t3257.s_company_id, t3257.s_gmt_offset, t3257.s_store_sk, t3257.s_geography_class, t3257.s_market_desc, t3257.s_market_manager, t3257.s_zip, t3257.s_division_name, t3257.s_country, t3257.s_company_name, t3257.s_street_number, t3257.s_store_id, t3257.s_street_name, t3257.s_street_type, t3257.s_suite_number, t3257.s_store_name, t3257.s_city, t3257.s_county, t3257.s_hours, t3257.s_manager, t3257.s_state, t3257.d_quarter_seq, t3257.d_year, t3257.d_first_dom, t3257.d_last_dom, t3257.d_same_day_ly, t3257.d_same_day_lq, t3257.d_dow, t3257.d_moy, t3257.d_dom, t3257.d_qoy, t3257.d_date_sk, t3257.d_fy_year, t3257.d_fy_quarter_seq, t3257.d_fy_week_seq, t3257.d_date, t3257.d_month_seq, t3257.d_week_seq, t3257.d_current_year, t3257.d_date_id, t3257.d_day_name, t3257.d_quarter_name, t3257.d_holiday, t3257.d_weekend, t3257.d_following_holiday, t3257.d_current_day, t3257.d_current_week, t3257.d_current_month, t3257.d_current_quarter, CAST(t3260.EXPR0 AS INTEGER) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT c_customer_sk, c_current_addr_sk FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales WHERE cs_wholesale_cost >= 70 AND cs_wholesale_cost <= 100) AS t3235, (SELECT * FROM item WHERE i_category = 'Children' AND i_class = 'infants') AS t3236 WHERE t3235.item_sk = t3236.i_item_sk) AS t3237, (SELECT * FROM date_dim WHERE d_year = 2002 AND d_moy = 8) AS t3238 WHERE t3237.sold_date_sk = t3238.d_date_sk) AS t3239, (SELECT * FROM customer WHERE c_birth_year >= 1958 AND c_birth_year <= 1971) AS t3240 WHERE t3240.c_customer_sk = t3239.customer_sk UNION ALL SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales WHERE ws_wholesale_cost >= 70 AND ws_wholesale_cost <= 100) AS t3243, (SELECT * FROM item WHERE i_category = 'Children' AND i_class = 'infants') AS t3244 WHERE t3243.item_sk = t3244.i_item_sk) AS t3245, (SELECT * FROM date_dim WHERE d_year = 2002 AND d_moy = 8) AS t3246 WHERE t3245.sold_date_sk = t3246.d_date_sk) AS t3247, (SELECT * FROM customer WHERE c_birth_year >= 1958 AND c_birth_year <= 1971) AS t3248 WHERE t3248.c_customer_sk = t3247.customer_sk) AS t) AS t3251, (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 70 AND ss_wholesale_cost <= 100) AS t3252 WHERE t3251.c_customer_sk = t3252.ss_customer_sk) AS t3253, customer_address AS customer_address108 WHERE t3253.c_current_addr_sk = customer_address108.ca_address_sk) AS t3254, (SELECT * FROM store WHERE s_state IN ('GA', 'MN', 'ND', 'NY', 'OR', 'PA', 'TN', 'TX', 'VA', 'VT')) AS t3255 WHERE t3254.ca_county = t3255.s_county AND t3254.ca_state = t3255.s_state) AS t3256, date_dim AS date_dim476 WHERE t3256.ss_sold_date_sk = date_dim476.d_date_sk) AS t3257, (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2002 AND d_moy = 8 GROUP BY d_month_seq + 1) AS t3260 WHERE t3257.d_month_seq >= t3260.EXPR0) AS t3262, (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2002 AND d_moy = 8 GROUP BY d_month_seq + 3) AS t3265 WHERE t3262.d_month_seq <= t3265.EXPR0 GROUP BY t3262.c_customer_sk) AS t3270 GROUP BY t3270.segment ORDER BY t3270.segment, COUNT(*) LIMIT 100","['PROJECT_TO_CALC', 'FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER']",300,15.35832787,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
244,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Children' and i_class = 'newborn' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 8 and d_year = 2001 and wholesale_cost BETWEEN 20 AND 50 and c_birth_year BETWEEN 1938 AND 1951 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 20 AND 50  and s_state in ('GA','IL','KY'   ,'LA','ME','OH'   ,'TN','TX','VA'   ,'WY')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 8)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 8) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t2819.segment, COUNT(*) AS num_customers, t2819.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t2813.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t2807.c_customer_sk, t2807.c_current_addr_sk, t2808.ss_sold_date_sk, t2808.ss_sold_time_sk, t2808.ss_item_sk, t2808.ss_customer_sk, t2808.ss_cdemo_sk, t2808.ss_hdemo_sk, t2808.ss_addr_sk, t2808.ss_store_sk, t2808.ss_promo_sk, t2808.ss_ticket_number, t2808.ss_quantity, t2808.ss_wholesale_cost, t2808.ss_list_price, t2808.ss_sales_price, t2808.ss_ext_discount_amt, t2808.ss_ext_sales_price, t2808.ss_ext_wholesale_cost, t2808.ss_ext_list_price, t2808.ss_ext_tax, t2808.ss_coupon_amt, t2808.ss_net_paid, t2808.ss_net_paid_inc_tax, t2808.ss_net_profit, customer_address98.ca_gmt_offset, customer_address98.ca_address_sk, customer_address98.ca_street_number, customer_address98.ca_street_name, customer_address98.ca_street_type, customer_address98.ca_suite_number, customer_address98.ca_city, customer_address98.ca_county, customer_address98.ca_state, customer_address98.ca_zip, customer_address98.ca_country, customer_address98.ca_location_type, customer_address98.ca_address_id, t2809.s_tax_precentage, t2809.s_rec_start_date, t2809.s_rec_end_date, t2809.s_closed_date_sk, t2809.s_number_employees, t2809.s_floor_space, t2809.s_market_id, t2809.s_division_id, t2809.s_company_id, t2809.s_gmt_offset, t2809.s_store_sk, t2809.s_geography_class, t2809.s_market_desc, t2809.s_market_manager, t2809.s_zip, t2809.s_division_name, t2809.s_country, t2809.s_company_name, t2809.s_street_number, t2809.s_store_id, t2809.s_street_name, t2809.s_street_type, t2809.s_suite_number, t2809.s_store_name, t2809.s_city, t2809.s_county, t2809.s_hours, t2809.s_manager, t2809.s_state, date_dim414.d_quarter_seq, date_dim414.d_year, date_dim414.d_first_dom, date_dim414.d_last_dom, date_dim414.d_same_day_ly, date_dim414.d_same_day_lq, date_dim414.d_dow, date_dim414.d_moy, date_dim414.d_dom, date_dim414.d_qoy, date_dim414.d_date_sk, date_dim414.d_fy_year, date_dim414.d_fy_quarter_seq, date_dim414.d_fy_week_seq, date_dim414.d_date, date_dim414.d_month_seq, date_dim414.d_week_seq, date_dim414.d_current_year, date_dim414.d_date_id, date_dim414.d_day_name, date_dim414.d_quarter_name, date_dim414.d_holiday, date_dim414.d_weekend, date_dim414.d_following_holiday, date_dim414.d_current_day, date_dim414.d_current_week, date_dim414.d_current_month, date_dim414.d_current_quarter, CAST(t2812.EXPR0 AS INTEGER) AS EXPR0 FROM (SELECT c_customer_sk, c_current_addr_sk FROM (SELECT * FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales WHERE cs_wholesale_cost >= 20 AND cs_wholesale_cost <= 50) AS t2797 INNER JOIN (SELECT * FROM item WHERE i_category = 'Children' AND i_class = 'newborn') AS t2798 ON t2797.item_sk = t2798.i_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy = 8) AS t2799 ON t2797.sold_date_sk = t2799.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1938 AND c_birth_year <= 1951) AS t2800 ON t2797.customer_sk = t2800.c_customer_sk UNION ALL SELECT * FROM (SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales WHERE ws_wholesale_cost >= 20 AND ws_wholesale_cost <= 50) AS t2802 INNER JOIN (SELECT * FROM item WHERE i_category = 'Children' AND i_class = 'newborn') AS t2803 ON t2802.item_sk = t2803.i_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy = 8) AS t2804 ON t2802.sold_date_sk = t2804.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1938 AND c_birth_year <= 1951) AS t2805 ON t2802.customer_sk = t2805.c_customer_sk) AS t) AS t2807 INNER JOIN (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 20 AND ss_wholesale_cost <= 50) AS t2808 ON t2807.c_customer_sk = t2808.ss_customer_sk INNER JOIN customer_address AS customer_address98 ON t2807.c_current_addr_sk = customer_address98.ca_address_sk INNER JOIN (SELECT * FROM store WHERE s_state IN ('GA', 'IL', 'KY', 'LA', 'ME', 'OH', 'TN', 'TX', 'VA', 'WY')) AS t2809 ON customer_address98.ca_county = t2809.s_county AND customer_address98.ca_state = t2809.s_state INNER JOIN date_dim AS date_dim414 ON t2808.ss_sold_date_sk = date_dim414.d_date_sk INNER JOIN (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2001 AND d_moy = 8 GROUP BY d_month_seq + 1) AS t2812 ON date_dim414.d_month_seq >= t2812.EXPR0) AS t2813 INNER JOIN (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2001 AND d_moy = 8 GROUP BY d_month_seq + 3) AS t2816 ON t2813.d_month_seq <= t2816.EXPR0 GROUP BY t2813.c_customer_sk) AS t2819 GROUP BY t2819.segment ORDER BY t2819.segment, COUNT(*) LIMIT 100","['FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN']",300,13.60736775,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
245,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Children' and i_class = 'toddlers' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 7 and d_year = 2001 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1938 AND 1951 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('AL','AR','CO'   ,'CT','MI','MN'   ,'OH','PA','TN'   ,'TX')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 7)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 7) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t13.segment, COUNT(*) AS num_customers, t13.segment * 50 AS segment_base FROM (SELECT CAST(SUM(store_sales.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT c_customer_sk, c_current_addr_sk FROM (SELECT * FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales) AS t, item, date_dim, customer UNION ALL SELECT * FROM (SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales) AS t0, item AS item0, date_dim AS date_dim0, customer AS customer0) AS t1 WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND (i_category = 'Children' AND i_class = 'toddlers') AND (c_customer_sk = customer_sk AND d_moy = 7 AND (d_year = 2001 AND (wholesale_cost >= 70 AND wholesale_cost <= 100 AND (c_birth_year >= 1938 AND c_birth_year <= 1951))))) AS t3 CROSS JOIN store_sales CROSS JOIN customer_address CROSS JOIN store CROSS JOIN date_dim AS date_dim1 LEFT JOIN (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2001 AND d_moy = 7 GROUP BY d_month_seq + 1) AS t6 ON TRUE LEFT JOIN (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2001 AND d_moy = 7 GROUP BY d_month_seq + 3) AS t9 ON TRUE WHERE t3.c_current_addr_sk = customer_address.ca_address_sk AND customer_address.ca_county = store.s_county AND (customer_address.ca_state = store.s_state AND store_sales.ss_sold_date_sk = date_dim1.d_date_sk) AND (t3.c_customer_sk = store_sales.ss_customer_sk AND (store_sales.ss_wholesale_cost >= 70 AND store_sales.ss_wholesale_cost <= 100) AND (store.s_state IN ('AL', 'AR', 'CO', 'CT', 'MI', 'MN', 'OH', 'PA', 'TN', 'TX') AND (date_dim1.d_month_seq >= t6.EXPR0 AND date_dim1.d_month_seq <= t9.EXPR0))) GROUP BY t3.c_customer_sk) AS t13 GROUP BY t13.segment ORDER BY t13.segment, COUNT(*) LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_AGGREGATE_TRANSPOSE', 'JOIN_EXTRACT_FILTER', 'UNION_MERGE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE']",300,24.31387369,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
246,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Electronics' and i_class = 'automotive' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 12 and d_year = 2000 and wholesale_cost BETWEEN 36 AND 66 and c_birth_year BETWEEN 1965 AND 1978 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 36 AND 66  and s_state in ('ID','LA','MI'   ,'MT','NC','NE'   ,'OH','SC','TX'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 12)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 12) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t26.segment, COUNT(*) AS num_customers, t26.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t20.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t15.c_customer_sk, t15.c_current_addr_sk, t15.ss_sold_date_sk, t15.ss_sold_time_sk, t15.ss_item_sk, t15.ss_customer_sk, t15.ss_cdemo_sk, t15.ss_hdemo_sk, t15.ss_addr_sk, t15.ss_store_sk, t15.ss_promo_sk, t15.ss_ticket_number, t15.ss_quantity, t15.ss_wholesale_cost, t15.ss_list_price, t15.ss_sales_price, t15.ss_ext_discount_amt, t15.ss_ext_sales_price, t15.ss_ext_wholesale_cost, t15.ss_ext_list_price, t15.ss_ext_tax, t15.ss_coupon_amt, t15.ss_net_paid, t15.ss_net_paid_inc_tax, t15.ss_net_profit, t15.ca_gmt_offset, t15.ca_address_sk, t15.ca_street_number, t15.ca_street_name, t15.ca_street_type, t15.ca_suite_number, t15.ca_city, t15.ca_county, t15.ca_state, t15.ca_zip, t15.ca_country, t15.ca_location_type, t15.ca_address_id, t15.s_tax_precentage, t15.s_rec_start_date, t15.s_rec_end_date, t15.s_closed_date_sk, t15.s_number_employees, t15.s_floor_space, t15.s_market_id, t15.s_division_id, t15.s_company_id, t15.s_gmt_offset, t15.s_store_sk, t15.s_geography_class, t15.s_market_desc, t15.s_market_manager, t15.s_zip, t15.s_division_name, t15.s_country, t15.s_company_name, t15.s_street_number, t15.s_store_id, t15.s_street_name, t15.s_street_type, t15.s_suite_number, t15.s_store_name, t15.s_city, t15.s_county, t15.s_hours, t15.s_manager, t15.s_state, t15.d_quarter_seq, t15.d_year, t15.d_first_dom, t15.d_last_dom, t15.d_same_day_ly, t15.d_same_day_lq, t15.d_dow, t15.d_moy, t15.d_dom, t15.d_qoy, t15.d_date_sk, t15.d_fy_year, t15.d_fy_quarter_seq, t15.d_fy_week_seq, t15.d_date, t15.d_month_seq, t15.d_week_seq, t15.d_current_year, t15.d_date_id, t15.d_day_name, t15.d_quarter_name, t15.d_holiday, t15.d_weekend, t15.d_following_holiday, t15.d_current_day, t15.d_current_week, t15.d_current_month, t15.d_current_quarter, CAST(t18.EXPR0 AS INTEGER) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT t7.c_customer_sk, t7.c_current_addr_sk FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales) AS t1 WHERE wholesale_cost >= 36 AND wholesale_cost <= 66) AS t2, (SELECT * FROM item WHERE i_category = 'Electronics' AND i_class = 'automotive') AS t3 WHERE t2.item_sk = t3.i_item_sk) AS t4, (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy = 12) AS t5 WHERE t4.sold_date_sk = t5.d_date_sk) AS t6, (SELECT * FROM customer WHERE c_birth_year >= 1965 AND c_birth_year <= 1978) AS t7 WHERE t7.c_customer_sk = t6.customer_sk) AS t9, (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 36 AND ss_wholesale_cost <= 66) AS t10 WHERE t9.c_customer_sk = t10.ss_customer_sk) AS t11, customer_address WHERE t11.c_current_addr_sk = customer_address.ca_address_sk) AS t12, (SELECT * FROM store WHERE s_state IN ('ID', 'LA', 'MI', 'MT', 'NC', 'NE', 'OH', 'SC', 'TX', 'WI')) AS t13 WHERE t12.ca_county = t13.s_county AND t12.ca_state = t13.s_state) AS t14, date_dim AS date_dim0 WHERE t14.ss_sold_date_sk = date_dim0.d_date_sk) AS t15, (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2000 AND d_moy = 12 GROUP BY d_month_seq + 1) AS t18 WHERE t15.d_month_seq >= t18.EXPR0) AS t20, (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2000 AND d_moy = 12 GROUP BY d_month_seq + 3) AS t23 WHERE t20.d_month_seq <= t23.EXPR0 GROUP BY t20.c_customer_sk) AS t26 GROUP BY t26.segment ORDER BY t26.segment, COUNT(*) LIMIT 100","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN']",300,3.384000142,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
247,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Home' and i_class = 'decor' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 6 and d_year = 1999 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1944 AND 1957 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('CO','IL','KS'   ,'KY','MD','MN'   ,'NC','NJ','OH'   ,'WV')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1999 and d_moy = 6)   and (select distinct d_month_seq+3   from date_dim where d_year = 1999 and d_moy = 6) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t3008.segment, COUNT(*) AS num_customers, t3008.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t3001.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT t2992.c_customer_sk, t2992.c_current_addr_sk, t2992.ss_sold_date_sk, t2992.ss_sold_time_sk, t2992.ss_item_sk, t2992.ss_customer_sk, t2992.ss_cdemo_sk, t2992.ss_hdemo_sk, t2992.ss_addr_sk, t2992.ss_store_sk, t2992.ss_promo_sk, t2992.ss_ticket_number, t2992.ss_quantity, t2992.ss_wholesale_cost, t2992.ss_list_price, t2992.ss_sales_price, t2992.ss_ext_discount_amt, t2992.ss_ext_sales_price, t2992.ss_ext_wholesale_cost, t2992.ss_ext_list_price, t2992.ss_ext_tax, t2992.ss_coupon_amt, t2992.ss_net_paid, t2992.ss_net_paid_inc_tax, t2992.ss_net_profit, customer_address104.ca_gmt_offset, customer_address104.ca_address_sk, customer_address104.ca_street_number, customer_address104.ca_street_name, customer_address104.ca_street_type, customer_address104.ca_suite_number, customer_address104.ca_city, customer_address104.ca_county, customer_address104.ca_state, customer_address104.ca_zip, customer_address104.ca_country, customer_address104.ca_location_type, customer_address104.ca_address_id FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT t2979.cs_sold_date_sk AS sold_date_sk, t2979.cs_bill_customer_sk AS customer_sk, t2979.cs_item_sk AS item_sk, t2979.cs_wholesale_cost AS wholesale_cost, t2979.i_item_sk, t2979.i_rec_start_date, t2979.i_rec_end_date, t2979.i_current_price, t2979.i_wholesale_cost, t2979.i_brand_id, t2979.i_class_id, t2979.i_category_id, t2979.i_manufact_id, t2979.i_manager_id, t2979.i_class, t2979.i_container, t2979.i_category, t2979.i_item_id, t2979.i_product_name, t2979.i_manufact, t2979.i_item_desc, t2979.i_size, t2979.i_formulation, t2979.i_color, t2979.i_brand, t2979.i_units, t2980.d_quarter_seq, t2980.d_year, t2980.d_first_dom, t2980.d_last_dom, t2980.d_same_day_ly, t2980.d_same_day_lq, t2980.d_dow, t2980.d_moy, t2980.d_dom, t2980.d_qoy, t2980.d_date_sk, t2980.d_fy_year, t2980.d_fy_quarter_seq, t2980.d_fy_week_seq, t2980.d_date, t2980.d_month_seq, t2980.d_week_seq, t2980.d_current_year, t2980.d_date_id, t2980.d_day_name, t2980.d_quarter_name, t2980.d_holiday, t2980.d_weekend, t2980.d_following_holiday, t2980.d_current_day, t2980.d_current_week, t2980.d_current_month, t2980.d_current_quarter FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 70 AND cs_wholesale_cost <= 100) AS t2977, (SELECT * FROM item WHERE i_category = 'Home' AND i_class = 'decor') AS t2978 WHERE t2977.cs_item_sk = t2978.i_item_sk) AS t2979, (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy = 6) AS t2980 UNION ALL SELECT t2984.ws_sold_date_sk AS sold_date_sk, t2984.ws_bill_customer_sk AS customer_sk, t2984.ws_item_sk AS item_sk, t2984.ws_wholesale_cost AS wholesale_cost, t2984.i_item_sk, t2984.i_rec_start_date, t2984.i_rec_end_date, t2984.i_current_price, t2984.i_wholesale_cost, t2984.i_brand_id, t2984.i_class_id, t2984.i_category_id, t2984.i_manufact_id, t2984.i_manager_id, t2984.i_class, t2984.i_container, t2984.i_category, t2984.i_item_id, t2984.i_product_name, t2984.i_manufact, t2984.i_item_desc, t2984.i_size, t2984.i_formulation, t2984.i_color, t2984.i_brand, t2984.i_units, t2985.d_quarter_seq, t2985.d_year, t2985.d_first_dom, t2985.d_last_dom, t2985.d_same_day_ly, t2985.d_same_day_lq, t2985.d_dow, t2985.d_moy, t2985.d_dom, t2985.d_qoy, t2985.d_date_sk, t2985.d_fy_year, t2985.d_fy_quarter_seq, t2985.d_fy_week_seq, t2985.d_date, t2985.d_month_seq, t2985.d_week_seq, t2985.d_current_year, t2985.d_date_id, t2985.d_day_name, t2985.d_quarter_name, t2985.d_holiday, t2985.d_weekend, t2985.d_following_holiday, t2985.d_current_day, t2985.d_current_week, t2985.d_current_month, t2985.d_current_quarter FROM (SELECT * FROM (SELECT * FROM web_sales WHERE ws_wholesale_cost >= 70 AND ws_wholesale_cost <= 100) AS t2982, (SELECT * FROM item WHERE i_category = 'Home' AND i_class = 'decor') AS t2983 WHERE t2982.ws_item_sk = t2983.i_item_sk) AS t2984, (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy = 6) AS t2985) AS t2987 WHERE sold_date_sk = d_date_sk) AS t2988, (SELECT * FROM customer WHERE c_birth_year >= 1944 AND c_birth_year <= 1957) AS t2989 WHERE t2989.c_customer_sk = t2988.customer_sk) AS t2990, (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 70 AND ss_wholesale_cost <= 100) AS t2991 WHERE t2990.c_customer_sk = t2991.ss_customer_sk) AS t2992, customer_address AS customer_address104) AS t2993 WHERE t2993.c_current_addr_sk = t2993.ca_address_sk) AS t2994, (SELECT * FROM store WHERE s_state IN ('CO', 'IL', 'KS', 'KY', 'MD', 'MN', 'NC', 'NJ', 'OH', 'WV')) AS t2995 WHERE t2994.ca_county = t2995.s_county AND t2994.ca_state = t2995.s_state) AS t2996, date_dim AS date_dim438 WHERE t2996.ss_sold_date_sk = date_dim438.d_date_sk) AS t2997, (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 1999 AND d_moy = 6 GROUP BY d_month_seq + 1) AS t3000 WHERE t2997.d_month_seq >= t3000.EXPR0) AS t3001, (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 1999 AND d_moy = 6 GROUP BY d_month_seq + 3) AS t3004 WHERE t3001.d_month_seq <= t3004.EXPR0 GROUP BY t3001.c_customer_sk) AS t3008 GROUP BY t3008.segment ORDER BY t3008.segment, COUNT(*) LIMIT 100","['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'JOIN_PROJECT_TRANSPOSE_RULE(_PROJECT-_OT', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER']",71.62566646,0.645684004,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
248,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Home' and i_class = 'flatware' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 9 and d_year = 1998 and wholesale_cost BETWEEN 68 AND 98 and c_birth_year BETWEEN 1942 AND 1955 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 68 AND 98  and s_state in ('CA','IA','IL'   ,'KS','NC','NY'   ,'OK','OR','TX'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1998 and d_moy = 9)   and (select distinct d_month_seq+3   from date_dim where d_year = 1998 and d_moy = 9) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Home' and i_class = 'flatware' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 9 and d_year = 1998 and wholesale_cost BETWEEN 68 AND 98 and c_birth_year BETWEEN 1942 AND 1955 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 68 AND 98  and s_state in ('CA','IA','IL'   ,'KS','NC','NY'   ,'OK','OR','TX'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1998 and d_moy = 9)   and (select distinct d_month_seq+3   from date_dim where d_year = 1998 and d_moy = 9) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ",[],215.7324673,5.085196257,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
249,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Home' and i_class = 'furniture' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 12 and d_year = 1999 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('GA','IA','IL'   ,'KS','LA','ME'   ,'MI','NC','ND'   ,'OK')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1999 and d_moy = 12)   and (select distinct d_month_seq+3   from date_dim where d_year = 1999 and d_moy = 12) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t1708.segment, COUNT(*) AS num_customers, t1708.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t1699.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT t1690.c_customer_sk, t1690.c_current_addr_sk, t1690.ss_sold_date_sk, t1690.ss_sold_time_sk, t1690.ss_item_sk, t1690.ss_customer_sk, t1690.ss_cdemo_sk, t1690.ss_hdemo_sk, t1690.ss_addr_sk, t1690.ss_store_sk, t1690.ss_promo_sk, t1690.ss_ticket_number, t1690.ss_quantity, t1690.ss_wholesale_cost, t1690.ss_list_price, t1690.ss_sales_price, t1690.ss_ext_discount_amt, t1690.ss_ext_sales_price, t1690.ss_ext_wholesale_cost, t1690.ss_ext_list_price, t1690.ss_ext_tax, t1690.ss_coupon_amt, t1690.ss_net_paid, t1690.ss_net_paid_inc_tax, t1690.ss_net_profit, customer_address63.ca_gmt_offset, customer_address63.ca_address_sk, customer_address63.ca_street_number, customer_address63.ca_street_name, customer_address63.ca_street_type, customer_address63.ca_suite_number, customer_address63.ca_city, customer_address63.ca_county, customer_address63.ca_state, customer_address63.ca_zip, customer_address63.ca_country, customer_address63.ca_location_type, customer_address63.ca_address_id FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT t1677.cs_sold_date_sk AS sold_date_sk, t1677.cs_bill_customer_sk AS customer_sk, t1677.cs_item_sk AS item_sk, t1677.cs_wholesale_cost AS wholesale_cost, t1677.i_item_sk, t1677.i_rec_start_date, t1677.i_rec_end_date, t1677.i_current_price, t1677.i_wholesale_cost, t1677.i_brand_id, t1677.i_class_id, t1677.i_category_id, t1677.i_manufact_id, t1677.i_manager_id, t1677.i_class, t1677.i_container, t1677.i_category, t1677.i_item_id, t1677.i_product_name, t1677.i_manufact, t1677.i_item_desc, t1677.i_size, t1677.i_formulation, t1677.i_color, t1677.i_brand, t1677.i_units, t1678.d_quarter_seq, t1678.d_year, t1678.d_first_dom, t1678.d_last_dom, t1678.d_same_day_ly, t1678.d_same_day_lq, t1678.d_dow, t1678.d_moy, t1678.d_dom, t1678.d_qoy, t1678.d_date_sk, t1678.d_fy_year, t1678.d_fy_quarter_seq, t1678.d_fy_week_seq, t1678.d_date, t1678.d_month_seq, t1678.d_week_seq, t1678.d_current_year, t1678.d_date_id, t1678.d_day_name, t1678.d_quarter_name, t1678.d_holiday, t1678.d_weekend, t1678.d_following_holiday, t1678.d_current_day, t1678.d_current_week, t1678.d_current_month, t1678.d_current_quarter FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 70 AND cs_wholesale_cost <= 100) AS t1675, (SELECT * FROM item WHERE i_category = 'Home' AND i_class = 'furniture') AS t1676 WHERE t1675.cs_item_sk = t1676.i_item_sk) AS t1677, (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy = 12) AS t1678 UNION ALL SELECT t1682.ws_sold_date_sk AS sold_date_sk, t1682.ws_bill_customer_sk AS customer_sk, t1682.ws_item_sk AS item_sk, t1682.ws_wholesale_cost AS wholesale_cost, t1682.i_item_sk, t1682.i_rec_start_date, t1682.i_rec_end_date, t1682.i_current_price, t1682.i_wholesale_cost, t1682.i_brand_id, t1682.i_class_id, t1682.i_category_id, t1682.i_manufact_id, t1682.i_manager_id, t1682.i_class, t1682.i_container, t1682.i_category, t1682.i_item_id, t1682.i_product_name, t1682.i_manufact, t1682.i_item_desc, t1682.i_size, t1682.i_formulation, t1682.i_color, t1682.i_brand, t1682.i_units, t1683.d_quarter_seq, t1683.d_year, t1683.d_first_dom, t1683.d_last_dom, t1683.d_same_day_ly, t1683.d_same_day_lq, t1683.d_dow, t1683.d_moy, t1683.d_dom, t1683.d_qoy, t1683.d_date_sk, t1683.d_fy_year, t1683.d_fy_quarter_seq, t1683.d_fy_week_seq, t1683.d_date, t1683.d_month_seq, t1683.d_week_seq, t1683.d_current_year, t1683.d_date_id, t1683.d_day_name, t1683.d_quarter_name, t1683.d_holiday, t1683.d_weekend, t1683.d_following_holiday, t1683.d_current_day, t1683.d_current_week, t1683.d_current_month, t1683.d_current_quarter FROM (SELECT * FROM (SELECT * FROM web_sales WHERE ws_wholesale_cost >= 70 AND ws_wholesale_cost <= 100) AS t1680, (SELECT * FROM item WHERE i_category = 'Home' AND i_class = 'furniture') AS t1681 WHERE t1680.ws_item_sk = t1681.i_item_sk) AS t1682, (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy = 12) AS t1683) AS t1685 WHERE sold_date_sk = d_date_sk) AS t1686, (SELECT * FROM customer WHERE c_birth_year >= 1980 AND c_birth_year <= 1993) AS t1687 WHERE t1687.c_customer_sk = t1686.customer_sk) AS t1688, (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 70 AND ss_wholesale_cost <= 100) AS t1689 WHERE t1688.c_customer_sk = t1689.ss_customer_sk) AS t1690, customer_address AS customer_address63) AS t1691 WHERE t1691.c_current_addr_sk = t1691.ca_address_sk) AS t1692, (SELECT * FROM store WHERE s_state IN ('GA', 'IA', 'IL', 'KS', 'LA', 'ME', 'MI', 'NC', 'ND', 'OK')) AS t1693 WHERE t1692.ca_county = t1693.s_county AND t1692.ca_state = t1693.s_state) AS t1694, date_dim AS date_dim259 WHERE t1694.ss_sold_date_sk = date_dim259.d_date_sk) AS t1695, (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 1999 AND d_moy = 12 GROUP BY d_month_seq + 1) AS t1698 WHERE t1695.d_month_seq >= t1698.EXPR0) AS t1699, (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 1999 AND d_moy = 12 GROUP BY d_month_seq + 3) AS t1702 WHERE t1699.d_month_seq <= t1702.EXPR0 GROUP BY t1699.c_customer_sk) AS t1708 GROUP BY t1708.segment ORDER BY t1708.segment, COUNT(*) LIMIT 100","['FILTER_INTO_JOIN', 'JOIN_PROJECT_TRANSPOSE_RULE(_PROJECT-_OT', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER']",279.4192433,5.743284305,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
250,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Home' and i_class = 'rugs' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 12 and d_year = 1999 and wholesale_cost BETWEEN 49 AND 79 and c_birth_year BETWEEN 1945 AND 1958 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 49 AND 79  and s_state in ('FL','IL','IN'   ,'NC','NE','NM'   ,'OK','TX','VA'   ,'WY')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1999 and d_moy = 12)   and (select distinct d_month_seq+3   from date_dim where d_year = 1999 and d_moy = 12) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT segment, COUNT(*) AS num_customers, segment * 50 AS segment_base FROM (SELECT CAST(SUM(t2953.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t2942.c_customer_sk, t2943.ss_ext_sales_price FROM (SELECT t2941.c_customer_sk, t2941.c_current_addr_sk FROM (SELECT * FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales WHERE cs_wholesale_cost >= 49 AND cs_wholesale_cost <= 79) AS t2933 INNER JOIN (SELECT * FROM item WHERE i_category = 'Home' AND i_class = 'rugs') AS t2934 ON t2933.item_sk = t2934.i_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy = 12) AS t2935 ON t2933.sold_date_sk = t2935.d_date_sk UNION ALL SELECT * FROM (SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales WHERE ws_wholesale_cost >= 49 AND ws_wholesale_cost <= 79) AS t2937 INNER JOIN (SELECT * FROM item WHERE i_category = 'Home' AND i_class = 'rugs') AS t2938 ON t2937.item_sk = t2938.i_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy = 12) AS t2939 ON t2937.sold_date_sk = t2939.d_date_sk) AS t2940 INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1945 AND c_birth_year <= 1958) AS t2941 ON t2940.customer_sk = t2941.c_customer_sk) AS t2942 INNER JOIN (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 49 AND ss_wholesale_cost <= 79) AS t2943 ON t2942.c_customer_sk = t2943.ss_customer_sk INNER JOIN customer_address AS customer_address101 ON t2942.c_current_addr_sk = customer_address101.ca_address_sk INNER JOIN (SELECT * FROM store WHERE s_state IN ('FL', 'IL', 'IN', 'NC', 'NE', 'NM', 'OK', 'TX', 'VA', 'WY')) AS t2944 ON customer_address101.ca_county = t2944.s_county AND customer_address101.ca_state = t2944.s_state INNER JOIN date_dim AS date_dim429 ON t2943.ss_sold_date_sk = date_dim429.d_date_sk INNER JOIN (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 1999 AND d_moy = 12 GROUP BY d_month_seq + 1) AS t2947 ON date_dim429.d_month_seq >= t2947.EXPR0 INNER JOIN (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 1999 AND d_moy = 12 GROUP BY d_month_seq + 3) AS t2950 ON date_dim429.d_month_seq <= t2950.EXPR0) AS t2953 GROUP BY t2953.c_customer_sk) AS t2955 GROUP BY segment ORDER BY segment, COUNT(*) LIMIT 100","['PROJECT_TO_CALC', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN']",300,7.207358996,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
251,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Jewelry' and i_class = 'costume' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 2 and d_year = 2001 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('GA','KS','KY'   ,'MN','NM','NY'   ,'OH','OK','TX'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 2)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 2) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t19.segment, COUNT(*) AS num_customers, t19.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t12.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t6.c_customer_sk, t6.c_current_addr_sk, t7.ss_sold_date_sk, t7.ss_sold_time_sk, t7.ss_item_sk, t7.ss_customer_sk, t7.ss_cdemo_sk, t7.ss_hdemo_sk, t7.ss_addr_sk, t7.ss_store_sk, t7.ss_promo_sk, t7.ss_ticket_number, t7.ss_quantity, t7.ss_wholesale_cost, t7.ss_list_price, t7.ss_sales_price, t7.ss_ext_discount_amt, t7.ss_ext_sales_price, t7.ss_ext_wholesale_cost, t7.ss_ext_list_price, t7.ss_ext_tax, t7.ss_coupon_amt, t7.ss_net_paid, t7.ss_net_paid_inc_tax, t7.ss_net_profit, customer_address.ca_gmt_offset, customer_address.ca_address_sk, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_street_type, customer_address.ca_suite_number, customer_address.ca_city, customer_address.ca_county, customer_address.ca_state, customer_address.ca_zip, customer_address.ca_country, customer_address.ca_location_type, customer_address.ca_address_id, t8.s_tax_precentage, t8.s_rec_start_date, t8.s_rec_end_date, t8.s_closed_date_sk, t8.s_number_employees, t8.s_floor_space, t8.s_market_id, t8.s_division_id, t8.s_company_id, t8.s_gmt_offset, t8.s_store_sk, t8.s_geography_class, t8.s_market_desc, t8.s_market_manager, t8.s_zip, t8.s_division_name, t8.s_country, t8.s_company_name, t8.s_street_number, t8.s_store_id, t8.s_street_name, t8.s_street_type, t8.s_suite_number, t8.s_store_name, t8.s_city, t8.s_county, t8.s_hours, t8.s_manager, t8.s_state, date_dim0.d_quarter_seq, date_dim0.d_year, date_dim0.d_first_dom, date_dim0.d_last_dom, date_dim0.d_same_day_ly, date_dim0.d_same_day_lq, date_dim0.d_dow, date_dim0.d_moy, date_dim0.d_dom, date_dim0.d_qoy, date_dim0.d_date_sk, date_dim0.d_fy_year, date_dim0.d_fy_quarter_seq, date_dim0.d_fy_week_seq, date_dim0.d_date, date_dim0.d_month_seq, date_dim0.d_week_seq, date_dim0.d_current_year, date_dim0.d_date_id, date_dim0.d_day_name, date_dim0.d_quarter_name, date_dim0.d_holiday, date_dim0.d_weekend, date_dim0.d_following_holiday, date_dim0.d_current_day, date_dim0.d_current_week, date_dim0.d_current_month, date_dim0.d_current_quarter, CAST(t11.EXPR0 AS INTEGER) AS EXPR0 FROM (SELECT t5.c_customer_sk, t5.c_current_addr_sk FROM (SELECT * FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales) AS t1 WHERE wholesale_cost >= 70 AND wholesale_cost <= 100) AS t2 INNER JOIN (SELECT * FROM item WHERE i_category = 'Jewelry' AND i_class = 'costume') AS t3 ON t2.item_sk = t3.i_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy = 2) AS t4 ON t2.sold_date_sk = t4.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1980 AND c_birth_year <= 1993) AS t5 ON t2.customer_sk = t5.c_customer_sk) AS t6 INNER JOIN (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 70 AND ss_wholesale_cost <= 100) AS t7 ON t6.c_customer_sk = t7.ss_customer_sk INNER JOIN customer_address ON t6.c_current_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM store WHERE s_state IN ('GA', 'KS', 'KY', 'MN', 'NM', 'NY', 'OH', 'OK', 'TX', 'WI')) AS t8 ON customer_address.ca_county = t8.s_county AND customer_address.ca_state = t8.s_state INNER JOIN date_dim AS date_dim0 ON t7.ss_sold_date_sk = date_dim0.d_date_sk INNER JOIN (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2001 AND d_moy = 2 GROUP BY d_month_seq + 1) AS t11 ON date_dim0.d_month_seq >= t11.EXPR0) AS t12 INNER JOIN (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2001 AND d_moy = 2 GROUP BY d_month_seq + 3) AS t15 ON t12.d_month_seq <= t15.EXPR0 GROUP BY t12.c_customer_sk) AS t19 GROUP BY t19.segment ORDER BY t19.segment, COUNT(*) LIMIT 100","['FILTER_INTO_JOIN', 'UNION_MERGE', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']",62.06518364,2.403183619,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
252,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Jewelry' and i_class = 'mens watch' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 6 and d_year = 2002 and wholesale_cost BETWEEN 21 AND 51 and c_birth_year BETWEEN 1956 AND 1969 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 21 AND 51  and s_state in ('AK','AR','GA'   ,'IA','MT','NY'   ,'PA','TN','TX'   ,'VA')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2002 and d_moy = 6)   and (select distinct d_month_seq+3   from date_dim where d_year = 2002 and d_moy = 6) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t2843.segment, COUNT(*) AS num_customers, t2843.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t2837.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t2832.c_customer_sk, t2832.c_current_addr_sk, t2832.ss_sold_date_sk, t2832.ss_sold_time_sk, t2832.ss_item_sk, t2832.ss_customer_sk, t2832.ss_cdemo_sk, t2832.ss_hdemo_sk, t2832.ss_addr_sk, t2832.ss_store_sk, t2832.ss_promo_sk, t2832.ss_ticket_number, t2832.ss_quantity, t2832.ss_wholesale_cost, t2832.ss_list_price, t2832.ss_sales_price, t2832.ss_ext_discount_amt, t2832.ss_ext_sales_price, t2832.ss_ext_wholesale_cost, t2832.ss_ext_list_price, t2832.ss_ext_tax, t2832.ss_coupon_amt, t2832.ss_net_paid, t2832.ss_net_paid_inc_tax, t2832.ss_net_profit, t2832.ca_gmt_offset, t2832.ca_address_sk, t2832.ca_street_number, t2832.ca_street_name, t2832.ca_street_type, t2832.ca_suite_number, t2832.ca_city, t2832.ca_county, t2832.ca_state, t2832.ca_zip, t2832.ca_country, t2832.ca_location_type, t2832.ca_address_id, t2832.s_tax_precentage, t2832.s_rec_start_date, t2832.s_rec_end_date, t2832.s_closed_date_sk, t2832.s_number_employees, t2832.s_floor_space, t2832.s_market_id, t2832.s_division_id, t2832.s_company_id, t2832.s_gmt_offset, t2832.s_store_sk, t2832.s_geography_class, t2832.s_market_desc, t2832.s_market_manager, t2832.s_zip, t2832.s_division_name, t2832.s_country, t2832.s_company_name, t2832.s_street_number, t2832.s_store_id, t2832.s_street_name, t2832.s_street_type, t2832.s_suite_number, t2832.s_store_name, t2832.s_city, t2832.s_county, t2832.s_hours, t2832.s_manager, t2832.s_state, t2832.d_quarter_seq, t2832.d_year, t2832.d_first_dom, t2832.d_last_dom, t2832.d_same_day_ly, t2832.d_same_day_lq, t2832.d_dow, t2832.d_moy, t2832.d_dom, t2832.d_qoy, t2832.d_date_sk, t2832.d_fy_year, t2832.d_fy_quarter_seq, t2832.d_fy_week_seq, t2832.d_date, t2832.d_month_seq, t2832.d_week_seq, t2832.d_current_year, t2832.d_date_id, t2832.d_day_name, t2832.d_quarter_name, t2832.d_holiday, t2832.d_weekend, t2832.d_following_holiday, t2832.d_current_day, t2832.d_current_week, t2832.d_current_month, t2832.d_current_quarter, CAST(t2835.EXPR0 AS INTEGER) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT t2824.c_customer_sk, t2824.c_current_addr_sk FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales WHERE cs_wholesale_cost >= 21 AND cs_wholesale_cost <= 51) AS t2815, (SELECT * FROM item WHERE i_category = 'Jewelry' AND i_class = 'mens watch') AS t2816 UNION ALL SELECT * FROM (SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales WHERE ws_wholesale_cost >= 21 AND ws_wholesale_cost <= 51) AS t2818, (SELECT * FROM item WHERE i_category = 'Jewelry' AND i_class = 'mens watch') AS t2819) AS t2820 WHERE item_sk = i_item_sk) AS t2821, (SELECT * FROM date_dim WHERE d_year = 2002 AND d_moy = 6) AS t2822 WHERE t2821.sold_date_sk = t2822.d_date_sk) AS t2823, (SELECT * FROM customer WHERE c_birth_year >= 1956 AND c_birth_year <= 1969) AS t2824 WHERE t2824.c_customer_sk = t2823.customer_sk) AS t2826, (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 21 AND ss_wholesale_cost <= 51) AS t2827 WHERE t2826.c_customer_sk = t2827.ss_customer_sk) AS t2828, customer_address AS customer_address99 WHERE t2828.c_current_addr_sk = customer_address99.ca_address_sk) AS t2829, (SELECT * FROM store WHERE s_state IN ('AK', 'AR', 'GA', 'IA', 'MT', 'NY', 'PA', 'TN', 'TX', 'VA')) AS t2830 WHERE t2829.ca_county = t2830.s_county AND t2829.ca_state = t2830.s_state) AS t2831, date_dim AS date_dim411 WHERE t2831.ss_sold_date_sk = date_dim411.d_date_sk) AS t2832, (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2002 AND d_moy = 6 GROUP BY d_month_seq + 1) AS t2835 WHERE t2832.d_month_seq >= t2835.EXPR0) AS t2837, (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2002 AND d_moy = 6 GROUP BY d_month_seq + 3) AS t2840 WHERE t2837.d_month_seq <= t2840.EXPR0 GROUP BY t2837.c_customer_sk) AS t2843 GROUP BY t2843.segment ORDER BY t2843.segment, COUNT(*) LIMIT 100","['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']",92.03243979,0.276667833,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
253,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Jewelry' and i_class = 'semi-precious' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 3 and d_year = 2000 and wholesale_cost BETWEEN 5 AND 35 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 5 AND 35  and s_state in ('DC','IA','KY'   ,'MN','OK','PA'   ,'SD','TN','WA'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 3)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t1495.segment, COUNT(*) AS num_customers, t1495.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t1490.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t1484.c_customer_sk, t1484.c_current_addr_sk, t1485.ss_sold_date_sk, t1485.ss_sold_time_sk, t1485.ss_item_sk, t1485.ss_customer_sk, t1485.ss_cdemo_sk, t1485.ss_hdemo_sk, t1485.ss_addr_sk, t1485.ss_store_sk, t1485.ss_promo_sk, t1485.ss_ticket_number, t1485.ss_quantity, t1485.ss_wholesale_cost, t1485.ss_list_price, t1485.ss_sales_price, t1485.ss_ext_discount_amt, t1485.ss_ext_sales_price, t1485.ss_ext_wholesale_cost, t1485.ss_ext_list_price, t1485.ss_ext_tax, t1485.ss_coupon_amt, t1485.ss_net_paid, t1485.ss_net_paid_inc_tax, t1485.ss_net_profit, customer_address53.ca_gmt_offset, customer_address53.ca_address_sk, customer_address53.ca_street_number, customer_address53.ca_street_name, customer_address53.ca_street_type, customer_address53.ca_suite_number, customer_address53.ca_city, customer_address53.ca_county, customer_address53.ca_state, customer_address53.ca_zip, customer_address53.ca_country, customer_address53.ca_location_type, customer_address53.ca_address_id, t1486.s_tax_precentage, t1486.s_rec_start_date, t1486.s_rec_end_date, t1486.s_closed_date_sk, t1486.s_number_employees, t1486.s_floor_space, t1486.s_market_id, t1486.s_division_id, t1486.s_company_id, t1486.s_gmt_offset, t1486.s_store_sk, t1486.s_geography_class, t1486.s_market_desc, t1486.s_market_manager, t1486.s_zip, t1486.s_division_name, t1486.s_country, t1486.s_company_name, t1486.s_street_number, t1486.s_store_id, t1486.s_street_name, t1486.s_street_type, t1486.s_suite_number, t1486.s_store_name, t1486.s_city, t1486.s_county, t1486.s_hours, t1486.s_manager, t1486.s_state, date_dim219.d_quarter_seq, date_dim219.d_year, date_dim219.d_first_dom, date_dim219.d_last_dom, date_dim219.d_same_day_ly, date_dim219.d_same_day_lq, date_dim219.d_dow, date_dim219.d_moy, date_dim219.d_dom, date_dim219.d_qoy, date_dim219.d_date_sk, date_dim219.d_fy_year, date_dim219.d_fy_quarter_seq, date_dim219.d_fy_week_seq, date_dim219.d_date, date_dim219.d_month_seq, date_dim219.d_week_seq, date_dim219.d_current_year, date_dim219.d_date_id, date_dim219.d_day_name, date_dim219.d_quarter_name, date_dim219.d_holiday, date_dim219.d_weekend, date_dim219.d_following_holiday, date_dim219.d_current_day, date_dim219.d_current_week, date_dim219.d_current_month, date_dim219.d_current_quarter, CAST(t1489.EXPR0 AS INTEGER) AS EXPR0 FROM (SELECT t1483.c_customer_sk, t1483.c_current_addr_sk FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales WHERE cs_wholesale_cost >= 5 AND cs_wholesale_cost <= 35 UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales WHERE ws_wholesale_cost >= 5 AND ws_wholesale_cost <= 35) AS t1480 INNER JOIN (SELECT * FROM item WHERE i_category = 'Jewelry' AND i_class = 'semi-precious') AS t1481 ON t1480.item_sk = t1481.i_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy = 3) AS t1482 ON t1480.sold_date_sk = t1482.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1980 AND c_birth_year <= 1993) AS t1483 ON t1480.customer_sk = t1483.c_customer_sk) AS t1484 INNER JOIN (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 5 AND ss_wholesale_cost <= 35) AS t1485 ON t1484.c_customer_sk = t1485.ss_customer_sk INNER JOIN customer_address AS customer_address53 ON t1484.c_current_addr_sk = customer_address53.ca_address_sk INNER JOIN (SELECT * FROM store WHERE s_state IN ('DC', 'IA', 'KY', 'MN', 'OK', 'PA', 'SD', 'TN', 'WA', 'WI')) AS t1486 ON customer_address53.ca_county = t1486.s_county AND customer_address53.ca_state = t1486.s_state INNER JOIN date_dim AS date_dim219 ON t1485.ss_sold_date_sk = date_dim219.d_date_sk INNER JOIN (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2000 AND d_moy = 3 GROUP BY d_month_seq + 1) AS t1489 ON date_dim219.d_month_seq >= t1489.EXPR0) AS t1490 INNER JOIN (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2000 AND d_moy = 3 GROUP BY d_month_seq + 3) AS t1493 ON t1490.d_month_seq <= t1493.EXPR0 GROUP BY t1490.c_customer_sk) AS t1495 GROUP BY t1495.segment ORDER BY t1495.segment, COUNT(*) LIMIT 100","['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'PROJECT_TO_CALC']",74.99168166,2.295695702,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
254,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Men' and i_class = 'pants' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 9 and d_year = 2001 and wholesale_cost BETWEEN 35 AND 65 and c_birth_year BETWEEN 1948 AND 1961 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 35 AND 65  and s_state in ('AL','GA','ID'   ,'IN','KS','MD'   ,'MS','NE','TX'   ,'UT')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 9)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 9) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t2454.segment, COUNT(*) AS num_customers, t2454.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t2442.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t2439.c_customer_sk, t2439.c_current_addr_sk, t2440.ss_sold_date_sk, t2440.ss_sold_time_sk, t2440.ss_item_sk, t2440.ss_customer_sk, t2440.ss_cdemo_sk, t2440.ss_hdemo_sk, t2440.ss_addr_sk, t2440.ss_store_sk, t2440.ss_promo_sk, t2440.ss_ticket_number, t2440.ss_quantity, t2440.ss_wholesale_cost, t2440.ss_list_price, t2440.ss_sales_price, t2440.ss_ext_discount_amt, t2440.ss_ext_sales_price, t2440.ss_ext_wholesale_cost, t2440.ss_ext_list_price, t2440.ss_ext_tax, t2440.ss_coupon_amt, t2440.ss_net_paid, t2440.ss_net_paid_inc_tax, t2440.ss_net_profit FROM (SELECT t2429.cs_sold_date_sk AS sold_date_sk, t2429.cs_bill_customer_sk AS customer_sk, t2429.cs_item_sk AS item_sk, t2429.cs_wholesale_cost AS wholesale_cost, t2430.i_item_sk, t2430.i_rec_start_date, t2430.i_rec_end_date, t2430.i_current_price, t2430.i_wholesale_cost, t2430.i_brand_id, t2430.i_class_id, t2430.i_category_id, t2430.i_manufact_id, t2430.i_manager_id, t2430.i_class, t2430.i_container, t2430.i_category, t2430.i_item_id, t2430.i_product_name, t2430.i_manufact, t2430.i_item_desc, t2430.i_size, t2430.i_formulation, t2430.i_color, t2430.i_brand, t2430.i_units FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 35 AND cs_wholesale_cost <= 65) AS t2429, (SELECT * FROM item WHERE i_category = 'Men' AND i_class = 'pants') AS t2430 WHERE t2429.cs_item_sk = t2430.i_item_sk UNION ALL SELECT t2433.ws_sold_date_sk AS sold_date_sk, t2433.ws_bill_customer_sk AS customer_sk, t2433.ws_item_sk AS item_sk, t2433.ws_wholesale_cost AS wholesale_cost, t2434.i_item_sk, t2434.i_rec_start_date, t2434.i_rec_end_date, t2434.i_current_price, t2434.i_wholesale_cost, t2434.i_brand_id, t2434.i_class_id, t2434.i_category_id, t2434.i_manufact_id, t2434.i_manager_id, t2434.i_class, t2434.i_container, t2434.i_category, t2434.i_item_id, t2434.i_product_name, t2434.i_manufact, t2434.i_item_desc, t2434.i_size, t2434.i_formulation, t2434.i_color, t2434.i_brand, t2434.i_units FROM (SELECT * FROM web_sales WHERE ws_wholesale_cost >= 35 AND ws_wholesale_cost <= 65) AS t2433, (SELECT * FROM item WHERE i_category = 'Men' AND i_class = 'pants') AS t2434 WHERE t2433.ws_item_sk = t2434.i_item_sk) AS t2437 INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy = 9) AS t2438 ON t2437.sold_date_sk = t2438.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1948 AND c_birth_year <= 1961) AS t2439 ON t2437.customer_sk = t2439.c_customer_sk CROSS JOIN (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 35 AND ss_wholesale_cost <= 65) AS t2440 WHERE t2439.c_customer_sk = t2440.ss_customer_sk) AS t2442 INNER JOIN customer_address AS customer_address87 ON t2442.c_current_addr_sk = customer_address87.ca_address_sk INNER JOIN (SELECT * FROM store WHERE s_state IN ('AL', 'GA', 'ID', 'IN', 'KS', 'MD', 'MS', 'NE', 'TX', 'UT')) AS t2443 ON customer_address87.ca_county = t2443.s_county AND customer_address87.ca_state = t2443.s_state INNER JOIN date_dim AS date_dim368 ON t2442.ss_sold_date_sk = date_dim368.d_date_sk INNER JOIN (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2001 AND d_moy = 9 GROUP BY d_month_seq + 1) AS t2446 ON date_dim368.d_month_seq >= t2446.EXPR0 CROSS JOIN (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2001 AND d_moy = 9 GROUP BY d_month_seq + 3) AS t2449 WHERE date_dim368.d_month_seq <= t2449.EXPR0 GROUP BY t2442.c_customer_sk) AS t2454 GROUP BY t2454.segment ORDER BY t2454.segment, COUNT(*) LIMIT 100","['FILTER_INTO_JOIN', 'JOIN_PROJECT_TRANSPOSE_RULE(_PROJECT-_OT', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']",300,13.24045928,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
255,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Men' and i_class = 'shirts' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 10 and d_year = 2001 and wholesale_cost BETWEEN 47 AND 77 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 47 AND 77  and s_state in ('AR','IL','IN'   ,'MI','MN','MS'   ,'ND','NJ','PA'   ,'WV')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 10)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 10) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t27.segment, COUNT(*) AS num_customers, t27.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t20.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t15.c_customer_sk, t15.c_current_addr_sk, t15.ss_sold_date_sk, t15.ss_sold_time_sk, t15.ss_item_sk, t15.ss_customer_sk, t15.ss_cdemo_sk, t15.ss_hdemo_sk, t15.ss_addr_sk, t15.ss_store_sk, t15.ss_promo_sk, t15.ss_ticket_number, t15.ss_quantity, t15.ss_wholesale_cost, t15.ss_list_price, t15.ss_sales_price, t15.ss_ext_discount_amt, t15.ss_ext_sales_price, t15.ss_ext_wholesale_cost, t15.ss_ext_list_price, t15.ss_ext_tax, t15.ss_coupon_amt, t15.ss_net_paid, t15.ss_net_paid_inc_tax, t15.ss_net_profit, t15.ca_gmt_offset, t15.ca_address_sk, t15.ca_street_number, t15.ca_street_name, t15.ca_street_type, t15.ca_suite_number, t15.ca_city, t15.ca_county, t15.ca_state, t15.ca_zip, t15.ca_country, t15.ca_location_type, t15.ca_address_id, t15.s_tax_precentage, t15.s_rec_start_date, t15.s_rec_end_date, t15.s_closed_date_sk, t15.s_number_employees, t15.s_floor_space, t15.s_market_id, t15.s_division_id, t15.s_company_id, t15.s_gmt_offset, t15.s_store_sk, t15.s_geography_class, t15.s_market_desc, t15.s_market_manager, t15.s_zip, t15.s_division_name, t15.s_country, t15.s_company_name, t15.s_street_number, t15.s_store_id, t15.s_street_name, t15.s_street_type, t15.s_suite_number, t15.s_store_name, t15.s_city, t15.s_county, t15.s_hours, t15.s_manager, t15.s_state, t15.d_quarter_seq, t15.d_year, t15.d_first_dom, t15.d_last_dom, t15.d_same_day_ly, t15.d_same_day_lq, t15.d_dow, t15.d_moy, t15.d_dom, t15.d_qoy, t15.d_date_sk, t15.d_fy_year, t15.d_fy_quarter_seq, t15.d_fy_week_seq, t15.d_date, t15.d_month_seq, t15.d_week_seq, t15.d_current_year, t15.d_date_id, t15.d_day_name, t15.d_quarter_name, t15.d_holiday, t15.d_weekend, t15.d_following_holiday, t15.d_current_day, t15.d_current_week, t15.d_current_month, t15.d_current_quarter, CAST(t18.EXPR0 AS INTEGER) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT t7.c_customer_sk, t7.c_current_addr_sk FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales) AS t1 WHERE wholesale_cost >= 47 AND wholesale_cost <= 77) AS t2, (SELECT * FROM item WHERE i_category = 'Men' AND i_class = 'shirts') AS t3 WHERE t2.item_sk = t3.i_item_sk) AS t4, (SELECT * FROM date_dim WHERE d_year = 2001 AND d_moy = 10) AS t5 WHERE t4.sold_date_sk = t5.d_date_sk) AS t6, (SELECT * FROM customer WHERE c_birth_year >= 1980 AND c_birth_year <= 1993) AS t7 WHERE t7.c_customer_sk = t6.customer_sk) AS t9, (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 47 AND ss_wholesale_cost <= 77) AS t10 WHERE t9.c_customer_sk = t10.ss_customer_sk) AS t11, customer_address WHERE t11.c_current_addr_sk = customer_address.ca_address_sk) AS t12, (SELECT * FROM store WHERE s_state IN ('AR', 'IL', 'IN', 'MI', 'MN', 'MS', 'ND', 'NJ', 'PA', 'WV')) AS t13 WHERE t12.ca_county = t13.s_county AND t12.ca_state = t13.s_state) AS t14, date_dim AS date_dim0 WHERE t14.ss_sold_date_sk = date_dim0.d_date_sk) AS t15, (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2001 AND d_moy = 10 GROUP BY d_month_seq + 1) AS t18 WHERE t15.d_month_seq >= t18.EXPR0) AS t20, (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2001 AND d_moy = 10 GROUP BY d_month_seq + 3) AS t23 WHERE t20.d_month_seq <= t23.EXPR0 GROUP BY t20.c_customer_sk) AS t27 GROUP BY t27.segment ORDER BY t27.segment, COUNT(*) LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_UNION_AGGREGATE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'JOIN_EXTRACT_FILTER', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'UNION_MERGE', 'UNION_REMOVE', 'SORT_JOIN_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']",300,15.25522908,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
256,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Men' and i_class = 'sports-apparel' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 8 and d_year = 2000 and wholesale_cost BETWEEN 59 AND 89 and c_birth_year BETWEEN 1936 AND 1949 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 59 AND 89  and s_state in ('IL','LA','MO'   ,'MS','NJ','OH'   ,'SD','TN','VA'   ,'WY')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 8)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 8) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t3688.segment, COUNT(*) AS num_customers, t3688.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t3682.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT t3673.c_customer_sk, t3673.c_current_addr_sk, t3673.ss_sold_date_sk, t3673.ss_sold_time_sk, t3673.ss_item_sk, t3673.ss_customer_sk, t3673.ss_cdemo_sk, t3673.ss_hdemo_sk, t3673.ss_addr_sk, t3673.ss_store_sk, t3673.ss_promo_sk, t3673.ss_ticket_number, t3673.ss_quantity, t3673.ss_wholesale_cost, t3673.ss_list_price, t3673.ss_sales_price, t3673.ss_ext_discount_amt, t3673.ss_ext_sales_price, t3673.ss_ext_wholesale_cost, t3673.ss_ext_list_price, t3673.ss_ext_tax, t3673.ss_coupon_amt, t3673.ss_net_paid, t3673.ss_net_paid_inc_tax, t3673.ss_net_profit, customer_address126.ca_gmt_offset, customer_address126.ca_address_sk, customer_address126.ca_street_number, customer_address126.ca_street_name, customer_address126.ca_street_type, customer_address126.ca_suite_number, customer_address126.ca_city, customer_address126.ca_county, customer_address126.ca_state, customer_address126.ca_zip, customer_address126.ca_country, customer_address126.ca_location_type, customer_address126.ca_address_id FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT t3660.cs_sold_date_sk AS sold_date_sk, t3660.cs_bill_customer_sk AS customer_sk, t3660.cs_item_sk AS item_sk, t3660.cs_wholesale_cost AS wholesale_cost, t3660.i_item_sk, t3660.i_rec_start_date, t3660.i_rec_end_date, t3660.i_current_price, t3660.i_wholesale_cost, t3660.i_brand_id, t3660.i_class_id, t3660.i_category_id, t3660.i_manufact_id, t3660.i_manager_id, t3660.i_class, t3660.i_container, t3660.i_category, t3660.i_item_id, t3660.i_product_name, t3660.i_manufact, t3660.i_item_desc, t3660.i_size, t3660.i_formulation, t3660.i_color, t3660.i_brand, t3660.i_units, t3661.d_quarter_seq, t3661.d_year, t3661.d_first_dom, t3661.d_last_dom, t3661.d_same_day_ly, t3661.d_same_day_lq, t3661.d_dow, t3661.d_moy, t3661.d_dom, t3661.d_qoy, t3661.d_date_sk, t3661.d_fy_year, t3661.d_fy_quarter_seq, t3661.d_fy_week_seq, t3661.d_date, t3661.d_month_seq, t3661.d_week_seq, t3661.d_current_year, t3661.d_date_id, t3661.d_day_name, t3661.d_quarter_name, t3661.d_holiday, t3661.d_weekend, t3661.d_following_holiday, t3661.d_current_day, t3661.d_current_week, t3661.d_current_month, t3661.d_current_quarter FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 59 AND cs_wholesale_cost <= 89) AS t3658, (SELECT * FROM item WHERE i_category = 'Men' AND i_class = 'sports-apparel') AS t3659 WHERE t3658.cs_item_sk = t3659.i_item_sk) AS t3660, (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy = 8) AS t3661 UNION ALL SELECT t3665.ws_sold_date_sk AS sold_date_sk, t3665.ws_bill_customer_sk AS customer_sk, t3665.ws_item_sk AS item_sk, t3665.ws_wholesale_cost AS wholesale_cost, t3665.i_item_sk, t3665.i_rec_start_date, t3665.i_rec_end_date, t3665.i_current_price, t3665.i_wholesale_cost, t3665.i_brand_id, t3665.i_class_id, t3665.i_category_id, t3665.i_manufact_id, t3665.i_manager_id, t3665.i_class, t3665.i_container, t3665.i_category, t3665.i_item_id, t3665.i_product_name, t3665.i_manufact, t3665.i_item_desc, t3665.i_size, t3665.i_formulation, t3665.i_color, t3665.i_brand, t3665.i_units, t3666.d_quarter_seq, t3666.d_year, t3666.d_first_dom, t3666.d_last_dom, t3666.d_same_day_ly, t3666.d_same_day_lq, t3666.d_dow, t3666.d_moy, t3666.d_dom, t3666.d_qoy, t3666.d_date_sk, t3666.d_fy_year, t3666.d_fy_quarter_seq, t3666.d_fy_week_seq, t3666.d_date, t3666.d_month_seq, t3666.d_week_seq, t3666.d_current_year, t3666.d_date_id, t3666.d_day_name, t3666.d_quarter_name, t3666.d_holiday, t3666.d_weekend, t3666.d_following_holiday, t3666.d_current_day, t3666.d_current_week, t3666.d_current_month, t3666.d_current_quarter FROM (SELECT * FROM (SELECT * FROM web_sales WHERE ws_wholesale_cost >= 59 AND ws_wholesale_cost <= 89) AS t3663, (SELECT * FROM item WHERE i_category = 'Men' AND i_class = 'sports-apparel') AS t3664 WHERE t3663.ws_item_sk = t3664.i_item_sk) AS t3665, (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy = 8) AS t3666) AS t3668 WHERE sold_date_sk = d_date_sk) AS t3669, (SELECT * FROM customer WHERE c_birth_year >= 1936 AND c_birth_year <= 1949) AS t3670 WHERE t3670.c_customer_sk = t3669.customer_sk) AS t3671, (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 59 AND ss_wholesale_cost <= 89) AS t3672 WHERE t3671.c_customer_sk = t3672.ss_customer_sk) AS t3673, customer_address AS customer_address126) AS t3674 WHERE t3674.c_current_addr_sk = t3674.ca_address_sk) AS t3675, (SELECT * FROM store WHERE s_state IN ('IL', 'LA', 'MO', 'MS', 'NJ', 'OH', 'SD', 'TN', 'VA', 'WY')) AS t3676 WHERE t3675.ca_county = t3676.s_county AND t3675.ca_state = t3676.s_state) AS t3677, date_dim AS date_dim535 WHERE t3677.ss_sold_date_sk = date_dim535.d_date_sk) AS t3678, (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2000 AND d_moy = 8 GROUP BY d_month_seq + 1) AS t3681 WHERE t3678.d_month_seq >= t3681.EXPR0) AS t3682, (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2000 AND d_moy = 8 GROUP BY d_month_seq + 3) AS t3685 WHERE t3682.d_month_seq <= t3685.EXPR0 GROUP BY t3682.c_customer_sk) AS t3688 GROUP BY t3688.segment ORDER BY t3688.segment, COUNT(*) LIMIT 100","['FILTER_INTO_JOIN', 'JOIN_PROJECT_TRANSPOSE_RULE(_PROJECT-_OT', 'FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'JOIN_EXTRACT_FILTER']",300,19.55668998,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
257,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Music' and i_class = 'pop' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 9 and d_year = 1999 and wholesale_cost BETWEEN 67 AND 97 and c_birth_year BETWEEN 1938 AND 1951 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 67 AND 97  and s_state in ('AL','AR','IA'   ,'IL','KS','MD'   ,'MI','MN','OR'   ,'WA')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1999 and d_moy = 9)   and (select distinct d_month_seq+3   from date_dim where d_year = 1999 and d_moy = 9) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT segment, COUNT(*) AS num_customers, segment * 50 AS segment_base FROM (SELECT CAST(SUM(ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t349.c_customer_sk, t349.c_current_addr_sk, t349.ss_sold_date_sk, t349.ss_sold_time_sk, t349.ss_item_sk, t349.ss_customer_sk, t349.ss_cdemo_sk, t349.ss_hdemo_sk, t349.ss_addr_sk, t349.ss_store_sk, t349.ss_promo_sk, t349.ss_ticket_number, t349.ss_quantity, t349.ss_wholesale_cost, t349.ss_list_price, t349.ss_sales_price, t349.ss_ext_discount_amt, t349.ss_ext_sales_price, t349.ss_ext_wholesale_cost, t349.ss_ext_list_price, t349.ss_ext_tax, t349.ss_coupon_amt, t349.ss_net_paid, t349.ss_net_paid_inc_tax, t349.ss_net_profit, t349.ca_gmt_offset, t349.ca_address_sk, t349.ca_street_number, t349.ca_street_name, t349.ca_street_type, t349.ca_suite_number, t349.ca_city, t349.ca_county, t349.ca_state, t349.ca_zip, t349.ca_country, t349.ca_location_type, t349.ca_address_id, t349.s_tax_precentage, t349.s_rec_start_date, t349.s_rec_end_date, t349.s_closed_date_sk, t349.s_number_employees, t349.s_floor_space, t349.s_market_id, t349.s_division_id, t349.s_company_id, t349.s_gmt_offset, t349.s_store_sk, t349.s_geography_class, t349.s_market_desc, t349.s_market_manager, t349.s_zip, t349.s_division_name, t349.s_country, t349.s_company_name, t349.s_street_number, t349.s_store_id, t349.s_street_name, t349.s_street_type, t349.s_suite_number, t349.s_store_name, t349.s_city, t349.s_county, t349.s_hours, t349.s_manager, t349.s_state, t349.d_quarter_seq, t349.d_year, t349.d_first_dom, t349.d_last_dom, t349.d_same_day_ly, t349.d_same_day_lq, t349.d_dow, t349.d_moy, t349.d_dom, t349.d_qoy, t349.d_date_sk, t349.d_fy_year, t349.d_fy_quarter_seq, t349.d_fy_week_seq, t349.d_date, t349.d_month_seq, t349.d_week_seq, t349.d_current_year, t349.d_date_id, t349.d_day_name, t349.d_quarter_name, t349.d_holiday, t349.d_weekend, t349.d_following_holiday, t349.d_current_day, t349.d_current_week, t349.d_current_month, t349.d_current_quarter, CAST(t349.EXPR0 AS INTEGER) AS EXPR0, t352.EXPR0 AS EXPR00 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT t338.c_customer_sk, t338.c_current_addr_sk, t339.ss_sold_date_sk, t339.ss_sold_time_sk, t339.ss_item_sk, t339.ss_customer_sk, t339.ss_cdemo_sk, t339.ss_hdemo_sk, t339.ss_addr_sk, t339.ss_store_sk, t339.ss_promo_sk, t339.ss_ticket_number, t339.ss_quantity, t339.ss_wholesale_cost, t339.ss_list_price, t339.ss_sales_price, t339.ss_ext_discount_amt, t339.ss_ext_sales_price, t339.ss_ext_wholesale_cost, t339.ss_ext_list_price, t339.ss_ext_tax, t339.ss_coupon_amt, t339.ss_net_paid, t339.ss_net_paid_inc_tax, t339.ss_net_profit FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT t327.cs_sold_date_sk AS sold_date_sk, t327.cs_bill_customer_sk AS customer_sk, t327.cs_item_sk AS item_sk, t327.cs_wholesale_cost AS wholesale_cost, t328.i_item_sk, t328.i_rec_start_date, t328.i_rec_end_date, t328.i_current_price, t328.i_wholesale_cost, t328.i_brand_id, t328.i_class_id, t328.i_category_id, t328.i_manufact_id, t328.i_manager_id, t328.i_class, t328.i_container, t328.i_category, t328.i_item_id, t328.i_product_name, t328.i_manufact, t328.i_item_desc, t328.i_size, t328.i_formulation, t328.i_color, t328.i_brand, t328.i_units FROM (SELECT * FROM catalog_sales WHERE cs_wholesale_cost >= 67 AND cs_wholesale_cost <= 97) AS t327, (SELECT * FROM item WHERE i_category = 'Music' AND i_class = 'pop') AS t328 UNION ALL SELECT t330.ws_sold_date_sk AS sold_date_sk, t330.ws_bill_customer_sk AS customer_sk, t330.ws_item_sk AS item_sk, t330.ws_wholesale_cost AS wholesale_cost, t331.i_item_sk, t331.i_rec_start_date, t331.i_rec_end_date, t331.i_current_price, t331.i_wholesale_cost, t331.i_brand_id, t331.i_class_id, t331.i_category_id, t331.i_manufact_id, t331.i_manager_id, t331.i_class, t331.i_container, t331.i_category, t331.i_item_id, t331.i_product_name, t331.i_manufact, t331.i_item_desc, t331.i_size, t331.i_formulation, t331.i_color, t331.i_brand, t331.i_units FROM (SELECT * FROM web_sales WHERE ws_wholesale_cost >= 67 AND ws_wholesale_cost <= 97) AS t330, (SELECT * FROM item WHERE i_category = 'Music' AND i_class = 'pop') AS t331) AS t333 WHERE item_sk = i_item_sk) AS t334, (SELECT * FROM date_dim WHERE d_year = 1999 AND d_moy = 9) AS t335 WHERE t334.sold_date_sk = t335.d_date_sk) AS t336, (SELECT * FROM customer WHERE c_birth_year >= 1938 AND c_birth_year <= 1951) AS t337 WHERE t337.c_customer_sk = t336.customer_sk) AS t338, (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 67 AND ss_wholesale_cost <= 97) AS t339) AS t340 WHERE t340.c_customer_sk = t340.ss_customer_sk) AS t341, customer_address AS customer_address15 WHERE t341.c_current_addr_sk = customer_address15.ca_address_sk) AS t342, (SELECT * FROM store WHERE s_state IN ('AL', 'AR', 'IA', 'IL', 'KS', 'MD', 'MI', 'MN', 'OR', 'WA')) AS t343 WHERE t342.ca_county = t343.s_county AND t342.ca_state = t343.s_state) AS t344, date_dim AS date_dim66 WHERE t344.ss_sold_date_sk = date_dim66.d_date_sk) AS t345, (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 1999 AND d_moy = 9 GROUP BY d_month_seq + 1) AS t348 WHERE t345.d_month_seq >= t348.EXPR0) AS t349, (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 1999 AND d_moy = 9 GROUP BY d_month_seq + 3) AS t352) AS t353 WHERE t353.d_month_seq <= t353.EXPR00 GROUP BY c_customer_sk) AS t358 GROUP BY segment ORDER BY segment, COUNT(*) LIMIT 100","['FILTER_INTO_JOIN', 'JOIN_PROJECT_TRANSPOSE_RULE(_PROJECT-_OT']",300,18.28972061,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
258,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Sports' and i_class = 'basketball' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 5 and d_year = 1998 and wholesale_cost BETWEEN 36 AND 66 and c_birth_year BETWEEN 1942 AND 1955 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 36 AND 66  and s_state in ('GA','IL','MD'   ,'NC','NH','TN'   ,'VA','WA','WI'   ,'WV')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1998 and d_moy = 5)   and (select distinct d_month_seq+3   from date_dim where d_year = 1998 and d_moy = 5) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t12.segment, COUNT(*) AS num_customers, t12.segment * 50 AS segment_base FROM (SELECT CAST(SUM(store_sales.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT customer.c_customer_sk, customer.c_current_addr_sk FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales) AS t1, item, date_dim, customer WHERE t1.sold_date_sk = date_dim.d_date_sk AND t1.item_sk = item.i_item_sk AND (item.i_category = 'Sports' AND (item.i_class = 'basketball' AND customer.c_customer_sk = t1.customer_sk)) AND (date_dim.d_moy = 5 AND (date_dim.d_year = 1998 AND t1.wholesale_cost >= 36) AND (t1.wholesale_cost <= 66 AND (customer.c_birth_year >= 1942 AND customer.c_birth_year <= 1955)))) AS t3 CROSS JOIN store_sales CROSS JOIN customer_address CROSS JOIN store CROSS JOIN date_dim AS date_dim0 LEFT JOIN (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 1998 AND d_moy = 5 GROUP BY d_month_seq + 1) AS t6 ON TRUE LEFT JOIN (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 1998 AND d_moy = 5 GROUP BY d_month_seq + 3) AS t9 ON TRUE WHERE t3.c_current_addr_sk = customer_address.ca_address_sk AND customer_address.ca_county = store.s_county AND (customer_address.ca_state = store.s_state AND (store_sales.ss_sold_date_sk = date_dim0.d_date_sk AND t3.c_customer_sk = store_sales.ss_customer_sk)) AND (store_sales.ss_wholesale_cost >= 36 AND store_sales.ss_wholesale_cost <= 66 AND ((store.s_state = 'GA' OR store.s_state = 'IL' OR (store.s_state = 'MD' OR (store.s_state = 'NC' OR store.s_state = 'NH')) OR (store.s_state = 'TN' OR store.s_state = 'VA' OR (store.s_state = 'WA' OR (store.s_state = 'WI' OR store.s_state = 'WV')))) AND (date_dim0.d_month_seq >= t6.EXPR0 AND date_dim0.d_month_seq <= t9.EXPR0))) GROUP BY t3.c_customer_sk) AS t12 GROUP BY t12.segment ORDER BY t12.segment, COUNT(*) LIMIT 100;","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE']",117.5652303,3.815450033,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
259,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Sports' and i_class = 'football' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 7 and d_year = 2001 and wholesale_cost BETWEEN 10 AND 40 and c_birth_year BETWEEN 1934 AND 1947 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 10 AND 40  and s_state in ('AR','CO','IL'   ,'IN','MI','NC'   ,'ND','OK','TX'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 7)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 7) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t12.segment, COUNT(*) AS num_customers, t12.segment * 50 AS segment_base FROM (SELECT CAST(SUM(store_sales.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT customer.c_customer_sk, customer.c_current_addr_sk FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales) AS t1, item, date_dim, customer WHERE t1.sold_date_sk = date_dim.d_date_sk AND t1.item_sk = item.i_item_sk AND (item.i_category = 'Sports' AND item.i_class = 'football') AND (customer.c_customer_sk = t1.customer_sk AND date_dim.d_moy = 7 AND (date_dim.d_year = 2001 AND (t1.wholesale_cost >= 10 AND t1.wholesale_cost <= 40 AND (customer.c_birth_year >= 1934 AND customer.c_birth_year <= 1947))))) AS t3 CROSS JOIN store_sales CROSS JOIN customer_address CROSS JOIN store CROSS JOIN date_dim AS date_dim0 LEFT JOIN (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2001 AND d_moy = 7 GROUP BY d_month_seq + 1) AS t6 ON TRUE LEFT JOIN (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2001 AND d_moy = 7 GROUP BY d_month_seq + 3) AS t9 ON TRUE WHERE t3.c_current_addr_sk = customer_address.ca_address_sk AND customer_address.ca_county = store.s_county AND (customer_address.ca_state = store.s_state AND store_sales.ss_sold_date_sk = date_dim0.d_date_sk) AND (t3.c_customer_sk = store_sales.ss_customer_sk AND (store_sales.ss_wholesale_cost >= 10 AND store_sales.ss_wholesale_cost <= 40) AND (store.s_state IN ('AR', 'CO', 'IL', 'IN', 'MI', 'NC', 'ND', 'OK', 'TX', 'WI') AND (date_dim0.d_month_seq >= t6.EXPR0 AND date_dim0.d_month_seq <= t9.EXPR0))) GROUP BY t3.c_customer_sk) AS t12 GROUP BY t12.segment ORDER BY t12.segment, COUNT(*) LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'SORT_UNION_TRANSPOSE', 'UNION_REMOVE', 'PROJECT_REDUCE_EXPRESSIONS', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE', 'FILTER_MERGE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']",89.38183729,6.849337022,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
260,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Sports' and i_class = 'football' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 7 and d_year = 2002 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1928 AND 1941 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('IL','KY','MI'   ,'MO','ND','SD'   ,'TX','UT','VA'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2002 and d_moy = 7)   and (select distinct d_month_seq+3   from date_dim where d_year = 2002 and d_moy = 7) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t12.segment, COUNT(*) AS num_customers, t12.segment * 50 AS segment_base FROM (SELECT CAST(SUM(store_sales.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT customer.c_customer_sk, customer.c_current_addr_sk FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales) AS t1, item, date_dim, customer WHERE t1.sold_date_sk = date_dim.d_date_sk AND t1.item_sk = item.i_item_sk AND (item.i_category = 'Sports' AND (item.i_class = 'football' AND customer.c_customer_sk = t1.customer_sk)) AND (date_dim.d_moy = 7 AND (date_dim.d_year = 2002 AND t1.wholesale_cost >= 70) AND (t1.wholesale_cost <= 100 AND (customer.c_birth_year >= 1928 AND customer.c_birth_year <= 1941)))) AS t3 CROSS JOIN store_sales CROSS JOIN customer_address CROSS JOIN store CROSS JOIN date_dim AS date_dim0 LEFT JOIN (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2002 AND d_moy = 7 GROUP BY d_month_seq + 1) AS t6 ON TRUE LEFT JOIN (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2002 AND d_moy = 7 GROUP BY d_month_seq + 3) AS t9 ON TRUE WHERE t3.c_current_addr_sk = customer_address.ca_address_sk AND customer_address.ca_county = store.s_county AND (customer_address.ca_state = store.s_state AND (store_sales.ss_sold_date_sk = date_dim0.d_date_sk AND t3.c_customer_sk = store_sales.ss_customer_sk)) AND (store_sales.ss_wholesale_cost >= 70 AND store_sales.ss_wholesale_cost <= 100 AND ((store.s_state = 'IL' OR store.s_state = 'KY' OR (store.s_state = 'MI' OR (store.s_state = 'MO' OR store.s_state = 'ND')) OR (store.s_state = 'SD' OR store.s_state = 'TX' OR (store.s_state = 'UT' OR (store.s_state = 'VA' OR store.s_state = 'WI')))) AND (date_dim0.d_month_seq >= t6.EXPR0 AND date_dim0.d_month_seq <= t9.EXPR0))) GROUP BY t3.c_customer_sk) AS t12 GROUP BY t12.segment ORDER BY t12.segment, COUNT(*) LIMIT 100","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'SORT_REMOVE']",97.37461027,6.736272097,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
261,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Women' and i_class = 'fragrances' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 2 and d_year = 2000 and wholesale_cost BETWEEN 18 AND 48 and c_birth_year BETWEEN 1937 AND 1950 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 18 AND 48  and s_state in ('CA','IL','KS'   ,'KY','MN','MS'   ,'MT','OH','SD'   ,'VA')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 2)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 2) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT t18.segment, COUNT(*) AS num_customers, t18.segment * 50 AS segment_base FROM (SELECT CAST(SUM(t13.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t7.c_customer_sk, t7.c_current_addr_sk, t8.ss_sold_date_sk, t8.ss_sold_time_sk, t8.ss_item_sk, t8.ss_customer_sk, t8.ss_cdemo_sk, t8.ss_hdemo_sk, t8.ss_addr_sk, t8.ss_store_sk, t8.ss_promo_sk, t8.ss_ticket_number, t8.ss_quantity, t8.ss_wholesale_cost, t8.ss_list_price, t8.ss_sales_price, t8.ss_ext_discount_amt, t8.ss_ext_sales_price, t8.ss_ext_wholesale_cost, t8.ss_ext_list_price, t8.ss_ext_tax, t8.ss_coupon_amt, t8.ss_net_paid, t8.ss_net_paid_inc_tax, t8.ss_net_profit, customer_address.ca_gmt_offset, customer_address.ca_address_sk, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_street_type, customer_address.ca_suite_number, customer_address.ca_city, customer_address.ca_county, customer_address.ca_state, customer_address.ca_zip, customer_address.ca_country, customer_address.ca_location_type, customer_address.ca_address_id, t9.s_tax_precentage, t9.s_rec_start_date, t9.s_rec_end_date, t9.s_closed_date_sk, t9.s_number_employees, t9.s_floor_space, t9.s_market_id, t9.s_division_id, t9.s_company_id, t9.s_gmt_offset, t9.s_store_sk, t9.s_geography_class, t9.s_market_desc, t9.s_market_manager, t9.s_zip, t9.s_division_name, t9.s_country, t9.s_company_name, t9.s_street_number, t9.s_store_id, t9.s_street_name, t9.s_street_type, t9.s_suite_number, t9.s_store_name, t9.s_city, t9.s_county, t9.s_hours, t9.s_manager, t9.s_state, date_dim0.d_quarter_seq, date_dim0.d_year, date_dim0.d_first_dom, date_dim0.d_last_dom, date_dim0.d_same_day_ly, date_dim0.d_same_day_lq, date_dim0.d_dow, date_dim0.d_moy, date_dim0.d_dom, date_dim0.d_qoy, date_dim0.d_date_sk, date_dim0.d_fy_year, date_dim0.d_fy_quarter_seq, date_dim0.d_fy_week_seq, date_dim0.d_date, date_dim0.d_month_seq, date_dim0.d_week_seq, date_dim0.d_current_year, date_dim0.d_date_id, date_dim0.d_day_name, date_dim0.d_quarter_name, date_dim0.d_holiday, date_dim0.d_weekend, date_dim0.d_following_holiday, date_dim0.d_current_day, date_dim0.d_current_week, date_dim0.d_current_month, date_dim0.d_current_quarter, CAST(t12.EXPR0 AS INTEGER) AS EXPR0 FROM (SELECT t6.c_customer_sk, t6.c_current_addr_sk FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales WHERE cs_wholesale_cost >= 18 AND cs_wholesale_cost <= 48 UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales WHERE ws_wholesale_cost >= 18 AND ws_wholesale_cost <= 48) AS t3 INNER JOIN (SELECT * FROM item WHERE i_category = 'Women' AND i_class = 'fragrances') AS t4 ON t3.item_sk = t4.i_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2000 AND d_moy = 2) AS t5 ON t3.sold_date_sk = t5.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1937 AND c_birth_year <= 1950) AS t6 ON t3.customer_sk = t6.c_customer_sk) AS t7 INNER JOIN (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 18 AND ss_wholesale_cost <= 48) AS t8 ON t7.c_customer_sk = t8.ss_customer_sk INNER JOIN customer_address ON t7.c_current_addr_sk = customer_address.ca_address_sk INNER JOIN (SELECT * FROM store WHERE s_state IN ('CA', 'IL', 'KS', 'KY', 'MN', 'MS', 'MT', 'OH', 'SD', 'VA')) AS t9 ON customer_address.ca_county = t9.s_county AND customer_address.ca_state = t9.s_state INNER JOIN date_dim AS date_dim0 ON t8.ss_sold_date_sk = date_dim0.d_date_sk INNER JOIN (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 2000 AND d_moy = 2 GROUP BY d_month_seq + 1) AS t12 ON date_dim0.d_month_seq >= t12.EXPR0) AS t13 INNER JOIN (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 2000 AND d_moy = 2 GROUP BY d_month_seq + 3) AS t16 ON t13.d_month_seq <= t16.EXPR0 GROUP BY t13.c_customer_sk) AS t18 GROUP BY t18.segment ORDER BY t18.segment, COUNT(*) LIMIT 100","['FILTER_INTO_JOIN', 'FILTER_SET_OP_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_MERGE', 'AGGREGATE_PROJECT_MERGE']",300,4.414060672,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
262,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Women' and i_class = 'fragrances' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 5 and d_year = 1998 and wholesale_cost BETWEEN 38 AND 68 and c_birth_year BETWEEN 1959 AND 1972 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 38 AND 68  and s_state in ('AL','AR','CO'   ,'GA','IA','ID'   ,'MN','NC','SD'   ,'WV')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1998 and d_moy = 5)   and (select distinct d_month_seq+3   from date_dim where d_year = 1998 and d_moy = 5) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;","SELECT segment, COUNT(*) AS num_customers, segment * 50 AS segment_base FROM (SELECT CAST(SUM(t2295.ss_ext_sales_price) / 50 AS INTEGER) AS segment FROM (SELECT t2288.c_customer_sk, t2288.ss_ext_sales_price FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT t2276.c_customer_sk, t2276.c_current_addr_sk FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales WHERE cs_wholesale_cost >= 38 AND cs_wholesale_cost <= 68) AS t2265, (SELECT * FROM item WHERE i_category = 'Women' AND i_class = 'fragrances') AS t2266 WHERE t2265.item_sk = t2266.i_item_sk) AS t2267, (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy = 5) AS t2268 UNION ALL SELECT * FROM (SELECT * FROM (SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales WHERE ws_wholesale_cost >= 38 AND ws_wholesale_cost <= 68) AS t2270, (SELECT * FROM item WHERE i_category = 'Women' AND i_class = 'fragrances') AS t2271 WHERE t2270.item_sk = t2271.i_item_sk) AS t2272, (SELECT * FROM date_dim WHERE d_year = 1998 AND d_moy = 5) AS t2273) AS t2274 WHERE sold_date_sk = d_date_sk) AS t2275, (SELECT * FROM customer WHERE c_birth_year >= 1959 AND c_birth_year <= 1972) AS t2276 WHERE t2276.c_customer_sk = t2275.customer_sk) AS t2278, (SELECT * FROM store_sales WHERE ss_wholesale_cost >= 38 AND ss_wholesale_cost <= 68) AS t2279 WHERE t2278.c_customer_sk = t2279.ss_customer_sk) AS t2280, customer_address AS customer_address83 WHERE t2280.c_current_addr_sk = customer_address83.ca_address_sk) AS t2281, (SELECT * FROM store WHERE s_state IN ('AL', 'AR', 'CO', 'GA', 'IA', 'ID', 'MN', 'NC', 'SD', 'WV')) AS t2282 WHERE t2281.ca_county = t2282.s_county AND t2281.ca_state = t2282.s_state) AS t2283, date_dim AS date_dim341 WHERE t2283.ss_sold_date_sk = date_dim341.d_date_sk) AS t2284, (SELECT d_month_seq + 1 AS EXPR0 FROM date_dim WHERE d_year = 1998 AND d_moy = 5 GROUP BY d_month_seq + 1) AS t2287 WHERE t2284.d_month_seq >= t2287.EXPR0) AS t2288, (SELECT d_month_seq + 3 AS EXPR0 FROM date_dim WHERE d_year = 1998 AND d_moy = 5 GROUP BY d_month_seq + 3) AS t2291 WHERE t2288.d_month_seq <= t2291.EXPR0) AS t2295 GROUP BY t2295.c_customer_sk) AS t2297 GROUP BY segment ORDER BY segment, COUNT(*) LIMIT 100","['PROJECT_TO_CALC', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER']",300,8.211226304,"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalUnion', ['LogicalProject', 'LogicalTableScan'], ['LogicalProject', 'LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]"
263,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1998-01-29','1998-05-22','1998-09-21','1998-11-09'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Men', 'Women') and i_manager_id BETWEEN 81 and 90 and sr_return_amt / sr_return_quantity between 149 and 178 and sr_reason_sk in (14, 48, 50, 64, 73) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-01-29','1998-05-22','1998-09-21','1998-11-09'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Men', 'Women') and i_manager_id BETWEEN 81 and 90 and cr_return_amount / cr_return_quantity between 149 and 178 and cr_reason_sk in (14, 48, 50, 64, 73) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-01-29','1998-05-22','1998-09-21','1998-11-09'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Men', 'Women') and i_manager_id BETWEEN 81 and 90 and wr_return_amt / wr_return_quantity between 149 and 178 and wr_reason_sk in (14, 48, 50, 64, 73) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;","SELECT t4.i_item_id AS item_id, t4.sr_item_qty, t4.sr_item_qty / (t4.sr_item_qty + t10.cr_item_qty + t16.wr_item_qty) / 3.0 * 100 AS sr_dev, t10.cr_item_qty, t10.cr_item_qty / (t4.sr_item_qty + t10.cr_item_qty + t16.wr_item_qty) / 3.0 * 100 AS cr_dev, t16.wr_item_qty, t16.wr_item_qty / (t4.sr_item_qty + t10.cr_item_qty + t16.wr_item_qty) / 3.0 * 100 AS wr_dev, (t4.sr_item_qty + t10.cr_item_qty + t16.wr_item_qty) / 3.0 AS average FROM (SELECT t0.i_item_id, SUM(t.sr_return_quantity) AS sr_item_qty FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 149 AND sr_return_amt / sr_return_quantity <= 178 AND sr_reason_sk IN (14, 48, 50, 64, 73)) AS t INNER JOIN (SELECT * FROM item WHERE i_category IN ('Men', 'Women') AND (i_manager_id >= 81 AND i_manager_id <= 90)) AS t0 ON t.sr_item_sk = t0.i_item_sk INNER JOIN date_dim ON t.sr_returned_date_sk = date_dim.d_date_sk INNER JOIN (SELECT date_dim0.d_date FROM date_dim AS date_dim0 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-01-29' OR d_date = '1998-05-22' OR d_date = '1998-09-21' OR d_date = '1998-11-09') AS t2 ON date_dim0.d_month_seq = t2.d_month_seq) AS t3 ON date_dim.d_date = t3.d_date GROUP BY t0.i_item_id) AS t4 INNER JOIN (SELECT t6.i_item_id, SUM(t5.cr_return_quantity) AS cr_item_qty FROM (SELECT * FROM catalog_returns WHERE cr_return_amount / cr_return_quantity >= 149 AND cr_return_amount / cr_return_quantity <= 178 AND cr_reason_sk IN (14, 48, 50, 64, 73)) AS t5 INNER JOIN (SELECT * FROM item WHERE i_category IN ('Men', 'Women') AND (i_manager_id >= 81 AND i_manager_id <= 90)) AS t6 ON t5.cr_item_sk = t6.i_item_sk INNER JOIN date_dim AS date_dim2 ON t5.cr_returned_date_sk = date_dim2.d_date_sk INNER JOIN (SELECT date_dim3.d_date FROM date_dim AS date_dim3 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-01-29' OR d_date = '1998-05-22' OR d_date = '1998-09-21' OR d_date = '1998-11-09') AS t8 ON date_dim3.d_month_seq = t8.d_month_seq) AS t9 ON date_dim2.d_date = t9.d_date GROUP BY t6.i_item_id) AS t10 ON t4.i_item_id = t10.i_item_id INNER JOIN (SELECT t12.i_item_id, SUM(t11.wr_return_quantity) AS wr_item_qty FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 149 AND wr_return_amt / wr_return_quantity <= 178 AND wr_reason_sk IN (14, 48, 50, 64, 73)) AS t11 INNER JOIN (SELECT * FROM item WHERE i_category IN ('Men', 'Women') AND (i_manager_id >= 81 AND i_manager_id <= 90)) AS t12 ON t11.wr_item_sk = t12.i_item_sk INNER JOIN date_dim AS date_dim5 ON t11.wr_returned_date_sk = date_dim5.d_date_sk INNER JOIN (SELECT date_dim6.d_date FROM date_dim AS date_dim6 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-01-29' OR d_date = '1998-05-22' OR d_date = '1998-09-21' OR d_date = '1998-11-09') AS t14 ON date_dim6.d_month_seq = t14.d_month_seq) AS t15 ON date_dim5.d_date = t15.d_date GROUP BY t12.i_item_id) AS t16 ON t4.i_item_id = t16.i_item_id ORDER BY t4.i_item_id, t4.sr_item_qty LIMIT 100","['FILTER_SCAN', 'FILTER_INTO_JOIN', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']",0.083114306,0.07767113,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]]"
264,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1998-03-15','1998-04-10','1998-08-01','1998-10-05'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Shoes', 'Sports') and i_manager_id BETWEEN 80 and 89 and sr_return_amt / sr_return_quantity between 226 and 255 and sr_reason_sk in (17, 20, 22, 65, 73) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-03-15','1998-04-10','1998-08-01','1998-10-05'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Shoes', 'Sports') and i_manager_id BETWEEN 80 and 89 and cr_return_amount / cr_return_quantity between 226 and 255 and cr_reason_sk in (17, 20, 22, 65, 73) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-03-15','1998-04-10','1998-08-01','1998-10-05'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Shoes', 'Sports') and i_manager_id BETWEEN 80 and 89 and wr_return_amt / wr_return_quantity between 226 and 255 and wr_reason_sk in (17, 20, 22, 65, 73) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;","SELECT t954.item_id, t954.sr_item_qty, t954.sr_item_qty / (t954.sr_item_qty + t962.cr_item_qty + t970.wr_item_qty) / 3.0 * 100 AS sr_dev, t962.cr_item_qty, t962.cr_item_qty / (t954.sr_item_qty + t962.cr_item_qty + t970.wr_item_qty) / 3.0 * 100 AS cr_dev, t970.wr_item_qty, t970.wr_item_qty / (t954.sr_item_qty + t962.cr_item_qty + t970.wr_item_qty) / 3.0 * 100 AS wr_dev, (t954.sr_item_qty + t962.cr_item_qty + t970.wr_item_qty) / 3.0 AS average FROM (SELECT i_item_id AS item_id, SUM(sr_return_quantity) AS sr_item_qty FROM (SELECT * FROM store_returns AS store_returns31, item AS item95, date_dim AS date_dim287, (SELECT date_dim288.d_date FROM date_dim AS date_dim288, (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-03-15' OR d_date = '1998-04-10' OR d_date = '1998-08-01' OR d_date = '1998-10-05') AS t948 WHERE date_dim288.d_month_seq = t948.d_month_seq) AS t950 WHERE date_dim287.d_date = t950.d_date) AS t951 WHERE t951.sr_item_sk = t951.i_item_sk AND TRUE AND (t951.sr_returned_date_sk = t951.d_date_sk AND (t951.i_category = 'Shoes' OR t951.i_category = 'Sports')) AND (t951.i_manager_id >= 80 AND t951.i_manager_id <= 89 AND (t951.sr_return_amt / t951.sr_return_quantity >= 226 AND (t951.sr_return_amt / t951.sr_return_quantity <= 255 AND (t951.sr_reason_sk = 17 OR t951.sr_reason_sk = 20 OR t951.sr_reason_sk = 22 OR t951.sr_reason_sk = 65 OR t951.sr_reason_sk = 73)))) GROUP BY i_item_id) AS t954, (SELECT i_item_id AS item_id, SUM(cr_return_quantity) AS cr_item_qty FROM (SELECT * FROM catalog_returns AS catalog_returns31, item AS item96, date_dim AS date_dim290, (SELECT date_dim291.d_date FROM date_dim AS date_dim291, (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-03-15' OR d_date = '1998-04-10' OR d_date = '1998-08-01' OR d_date = '1998-10-05') AS t956 WHERE date_dim291.d_month_seq = t956.d_month_seq) AS t958 WHERE date_dim290.d_date = t958.d_date) AS t959 WHERE t959.cr_item_sk = t959.i_item_sk AND TRUE AND (t959.cr_returned_date_sk = t959.d_date_sk AND (t959.i_category = 'Shoes' OR t959.i_category = 'Sports')) AND (t959.i_manager_id >= 80 AND t959.i_manager_id <= 89 AND (t959.cr_return_amount / t959.cr_return_quantity >= 226 AND (t959.cr_return_amount / t959.cr_return_quantity <= 255 AND (t959.cr_reason_sk = 17 OR t959.cr_reason_sk = 20 OR t959.cr_reason_sk = 22 OR t959.cr_reason_sk = 65 OR t959.cr_reason_sk = 73)))) GROUP BY i_item_id) AS t962, (SELECT i_item_id AS item_id, SUM(wr_return_quantity) AS wr_item_qty FROM (SELECT * FROM web_returns AS web_returns31, item AS item97, date_dim AS date_dim293, (SELECT date_dim294.d_date FROM date_dim AS date_dim294, (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-03-15' OR d_date = '1998-04-10' OR d_date = '1998-08-01' OR d_date = '1998-10-05') AS t964 WHERE date_dim294.d_month_seq = t964.d_month_seq) AS t966 WHERE date_dim293.d_date = t966.d_date) AS t967 WHERE t967.wr_item_sk = t967.i_item_sk AND TRUE AND (t967.wr_returned_date_sk = t967.d_date_sk AND (t967.i_category = 'Shoes' OR t967.i_category = 'Sports')) AND (t967.i_manager_id >= 80 AND t967.i_manager_id <= 89 AND (t967.wr_return_amt / t967.wr_return_quantity >= 226 AND (t967.wr_return_amt / t967.wr_return_quantity <= 255 AND (t967.wr_reason_sk = 17 OR t967.wr_reason_sk = 20 OR t967.wr_reason_sk = 22 OR t967.wr_reason_sk = 65 OR t967.wr_reason_sk = 73)))) GROUP BY i_item_id) AS t970 WHERE t954.item_id = t962.item_id AND t954.item_id = t970.item_id ORDER BY t954.item_id, t954.sr_item_qty LIMIT 100","['PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']",0.092598279,0.064948002,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]]"
265,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-03-22','1999-05-29','1999-08-16','1999-11-12'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Music') and i_manager_id BETWEEN 34 and 43 and sr_return_amt / sr_return_quantity between 132 and 161 and sr_reason_sk in (20, 58, 59, 63, 68) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-03-22','1999-05-29','1999-08-16','1999-11-12'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Music') and i_manager_id BETWEEN 34 and 43 and cr_return_amount / cr_return_quantity between 132 and 161 and cr_reason_sk in (20, 58, 59, 63, 68) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-03-22','1999-05-29','1999-08-16','1999-11-12'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Music') and i_manager_id BETWEEN 34 and 43 and wr_return_amt / wr_return_quantity between 132 and 161 and wr_reason_sk in (20, 58, 59, 63, 68) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;","SELECT t4.i_item_id AS item_id, t4.sr_item_qty, t4.sr_item_qty / (t4.sr_item_qty + t10.cr_item_qty + t16.wr_item_qty) / 3.0 * 100 AS sr_dev, t10.cr_item_qty, t10.cr_item_qty / (t4.sr_item_qty + t10.cr_item_qty + t16.wr_item_qty) / 3.0 * 100 AS cr_dev, t16.wr_item_qty, t16.wr_item_qty / (t4.sr_item_qty + t10.cr_item_qty + t16.wr_item_qty) / 3.0 * 100 AS wr_dev, (t4.sr_item_qty + t10.cr_item_qty + t16.wr_item_qty) / 3.0 AS average FROM (SELECT t0.i_item_id, SUM(t.sr_return_quantity) AS sr_item_qty FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 132 AND sr_return_amt / sr_return_quantity <= 161 AND sr_reason_sk IN (20, 58, 59, 63, 68)) AS t INNER JOIN (SELECT * FROM item WHERE i_category IN ('Children', 'Music') AND (i_manager_id >= 34 AND i_manager_id <= 43)) AS t0 ON t.sr_item_sk = t0.i_item_sk INNER JOIN date_dim ON t.sr_returned_date_sk = date_dim.d_date_sk INNER JOIN (SELECT date_dim0.d_date FROM date_dim AS date_dim0 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = '1999-03-22' OR d_date = '1999-05-29' OR d_date = '1999-08-16' OR d_date = '1999-11-12') AS t2 ON date_dim0.d_month_seq = t2.d_month_seq) AS t3 ON date_dim.d_date = t3.d_date GROUP BY t0.i_item_id) AS t4 INNER JOIN (SELECT t6.i_item_id, SUM(t5.cr_return_quantity) AS cr_item_qty FROM (SELECT * FROM catalog_returns WHERE cr_return_amount / cr_return_quantity >= 132 AND cr_return_amount / cr_return_quantity <= 161 AND cr_reason_sk IN (20, 58, 59, 63, 68)) AS t5 INNER JOIN (SELECT * FROM item WHERE i_category IN ('Children', 'Music') AND (i_manager_id >= 34 AND i_manager_id <= 43)) AS t6 ON t5.cr_item_sk = t6.i_item_sk INNER JOIN date_dim AS date_dim2 ON t5.cr_returned_date_sk = date_dim2.d_date_sk INNER JOIN (SELECT date_dim3.d_date FROM date_dim AS date_dim3 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = '1999-03-22' OR d_date = '1999-05-29' OR d_date = '1999-08-16' OR d_date = '1999-11-12') AS t8 ON date_dim3.d_month_seq = t8.d_month_seq) AS t9 ON date_dim2.d_date = t9.d_date GROUP BY t6.i_item_id) AS t10 ON t4.i_item_id = t10.i_item_id INNER JOIN (SELECT t12.i_item_id, SUM(t11.wr_return_quantity) AS wr_item_qty FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 132 AND wr_return_amt / wr_return_quantity <= 161 AND wr_reason_sk IN (20, 58, 59, 63, 68)) AS t11 INNER JOIN (SELECT * FROM item WHERE i_category IN ('Children', 'Music') AND (i_manager_id >= 34 AND i_manager_id <= 43)) AS t12 ON t11.wr_item_sk = t12.i_item_sk INNER JOIN date_dim AS date_dim5 ON t11.wr_returned_date_sk = date_dim5.d_date_sk INNER JOIN (SELECT date_dim6.d_date FROM date_dim AS date_dim6 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = '1999-03-22' OR d_date = '1999-05-29' OR d_date = '1999-08-16' OR d_date = '1999-11-12') AS t14 ON date_dim6.d_month_seq = t14.d_month_seq) AS t15 ON date_dim5.d_date = t15.d_date GROUP BY t12.i_item_id) AS t16 ON t4.i_item_id = t16.i_item_id ORDER BY t4.i_item_id, t4.sr_item_qty LIMIT 100;","['FILTER_SCAN', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']",0.110404968,0.105662266,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]]"
266,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-02-07','2001-04-26','2001-07-08','2001-11-15'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 91 and 100 and sr_return_amt / sr_return_quantity between 259 and 288 and sr_reason_sk in (31, 42, 54, 67, 71) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-02-07','2001-04-26','2001-07-08','2001-11-15'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 91 and 100 and cr_return_amount / cr_return_quantity between 259 and 288 and cr_reason_sk in (31, 42, 54, 67, 71) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-02-07','2001-04-26','2001-07-08','2001-11-15'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 259 and 288 and wr_reason_sk in (31, 42, 54, 67, 71) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;","SELECT t1912.item_id, t1912.sr_item_qty, t1912.sr_item_qty / (t1912.sr_item_qty + t1919.cr_item_qty + t1926.wr_item_qty) / 3.0 * 100 AS sr_dev, t1919.cr_item_qty, t1919.cr_item_qty / (t1912.sr_item_qty + t1919.cr_item_qty + t1926.wr_item_qty) / 3.0 * 100 AS cr_dev, t1926.wr_item_qty, t1926.wr_item_qty / (t1912.sr_item_qty + t1919.cr_item_qty + t1926.wr_item_qty) / 3.0 * 100 AS wr_dev, (t1912.sr_item_qty + t1919.cr_item_qty + t1926.wr_item_qty) / 3.0 AS average FROM (SELECT t1907.i_item_id AS item_id, SUM(t1906.sr_return_quantity) AS sr_item_qty FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 259 AND sr_return_amt / sr_return_quantity <= 288 AND sr_reason_sk IN (31, 42, 54, 67, 71)) AS t1906 INNER JOIN (SELECT * FROM item WHERE i_category IN ('Home', 'Shoes') AND (i_manager_id >= 91 AND i_manager_id <= 100)) AS t1907 ON t1906.sr_item_sk = t1907.i_item_sk INNER JOIN date_dim AS date_dim575 ON t1906.sr_returned_date_sk = date_dim575.d_date_sk INNER JOIN (SELECT date_dim576.d_date FROM date_dim AS date_dim576 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date IN (DATE '2001-02-07', DATE '2001-04-26', DATE '2001-07-08', DATE '2001-11-15')) AS t1909 ON date_dim576.d_month_seq = t1909.d_month_seq) AS t1910 ON date_dim575.d_date = t1910.d_date GROUP BY t1907.i_item_id) AS t1912 INNER JOIN (SELECT t1914.i_item_id AS item_id, SUM(t1913.cr_return_quantity) AS cr_item_qty FROM (SELECT * FROM catalog_returns WHERE cr_return_amount / cr_return_quantity >= 259 AND cr_return_amount / cr_return_quantity <= 288 AND cr_reason_sk IN (31, 42, 54, 67, 71)) AS t1913 INNER JOIN (SELECT * FROM item WHERE i_category IN ('Home', 'Shoes') AND (i_manager_id >= 91 AND i_manager_id <= 100)) AS t1914 ON t1913.cr_item_sk = t1914.i_item_sk INNER JOIN date_dim AS date_dim578 ON t1913.cr_returned_date_sk = date_dim578.d_date_sk INNER JOIN (SELECT date_dim579.d_date FROM date_dim AS date_dim579 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date IN (DATE '2001-02-07', DATE '2001-04-26', DATE '2001-07-08', DATE '2001-11-15')) AS t1916 ON date_dim579.d_month_seq = t1916.d_month_seq) AS t1917 ON date_dim578.d_date = t1917.d_date GROUP BY t1914.i_item_id) AS t1919 ON t1912.item_id = t1919.item_id INNER JOIN (SELECT t1921.i_item_id AS item_id, SUM(t1920.wr_return_quantity) AS wr_item_qty FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 259 AND wr_return_amt / wr_return_quantity <= 288 AND wr_reason_sk IN (31, 42, 54, 67, 71)) AS t1920 INNER JOIN (SELECT * FROM item WHERE i_category IN ('Home', 'Shoes') AND (i_manager_id >= 91 AND i_manager_id <= 100)) AS t1921 ON t1920.wr_item_sk = t1921.i_item_sk INNER JOIN date_dim AS date_dim581 ON t1920.wr_returned_date_sk = date_dim581.d_date_sk INNER JOIN (SELECT date_dim582.d_date FROM date_dim AS date_dim582 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date IN (DATE '2001-02-07', DATE '2001-04-26', DATE '2001-07-08', DATE '2001-11-15')) AS t1923 ON date_dim582.d_month_seq = t1923.d_month_seq) AS t1924 ON date_dim581.d_date = t1924.d_date GROUP BY t1921.i_item_id) AS t1926 ON t1912.item_id = t1926.item_id ORDER BY t1912.item_id, t1912.sr_item_qty LIMIT 100","['PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN']",0.070216338,0.054300388,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]]"
267,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-02-07','2001-05-05','2001-08-31','2001-10-13'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Shoes') and i_manager_id BETWEEN 35 and 44 and sr_return_amt / sr_return_quantity between 174 and 203 and sr_reason_sk in (8, 29, 30, 33, 65) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-02-07','2001-05-05','2001-08-31','2001-10-13'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Shoes') and i_manager_id BETWEEN 35 and 44 and cr_return_amount / cr_return_quantity between 174 and 203 and cr_reason_sk in (8, 29, 30, 33, 65) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-02-07','2001-05-05','2001-08-31','2001-10-13'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Shoes') and i_manager_id BETWEEN 35 and 44 and wr_return_amt / wr_return_quantity between 174 and 203 and wr_reason_sk in (8, 29, 30, 33, 65) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;","SELECT t6.item_id, t6.sr_item_qty, t6.sr_item_qty / (t6.sr_item_qty + t14.cr_item_qty + t22.wr_item_qty) / 3.0 * 100 AS sr_dev, t14.cr_item_qty, t14.cr_item_qty / (t6.sr_item_qty + t14.cr_item_qty + t22.wr_item_qty) / 3.0 * 100 AS cr_dev, t22.wr_item_qty, t22.wr_item_qty / (t6.sr_item_qty + t14.cr_item_qty + t22.wr_item_qty) / 3.0 * 100 AS wr_dev, (t6.sr_item_qty + t14.cr_item_qty + t22.wr_item_qty) / 3.0 AS average FROM (SELECT i_item_id AS item_id, SUM(sr_return_quantity) AS sr_item_qty FROM (SELECT * FROM store_returns, item, date_dim, (SELECT date_dim0.d_date FROM date_dim AS date_dim0, (SELECT d_month_seq FROM date_dim WHERE d_date IN (DATE '2001-02-07', DATE '2001-05-05', DATE '2001-08-31', DATE '2001-10-13')) AS t0 WHERE date_dim0.d_month_seq = t0.d_month_seq) AS t2 WHERE date_dim.d_date = t2.d_date) AS t3 WHERE t3.sr_item_sk = t3.i_item_sk AND (t3.sr_returned_date_sk = t3.d_date_sk AND t3.i_category IN ('Books', 'Shoes')) AND (t3.i_manager_id >= 35 AND t3.i_manager_id <= 44 AND t3.sr_return_amt / t3.sr_return_quantity >= 174 AND (t3.sr_return_amt / t3.sr_return_quantity <= 203 AND t3.sr_reason_sk IN (8, 29, 30, 33, 65))) GROUP BY i_item_id) AS t6, (SELECT i_item_id AS item_id, SUM(cr_return_quantity) AS cr_item_qty FROM (SELECT * FROM catalog_returns, item AS item0, date_dim AS date_dim2, (SELECT date_dim3.d_date FROM date_dim AS date_dim3, (SELECT d_month_seq FROM date_dim WHERE d_date IN (DATE '2001-02-07', DATE '2001-05-05', DATE '2001-08-31', DATE '2001-10-13')) AS t8 WHERE date_dim3.d_month_seq = t8.d_month_seq) AS t10 WHERE date_dim2.d_date = t10.d_date) AS t11 WHERE t11.cr_item_sk = t11.i_item_sk AND (t11.cr_returned_date_sk = t11.d_date_sk AND t11.i_category IN ('Books', 'Shoes')) AND (t11.i_manager_id >= 35 AND t11.i_manager_id <= 44 AND t11.cr_return_amount / t11.cr_return_quantity >= 174 AND (t11.cr_return_amount / t11.cr_return_quantity <= 203 AND t11.cr_reason_sk IN (8, 29, 30, 33, 65))) GROUP BY i_item_id) AS t14, (SELECT i_item_id AS item_id, SUM(wr_return_quantity) AS wr_item_qty FROM (SELECT * FROM web_returns, item AS item1, date_dim AS date_dim5, (SELECT date_dim6.d_date FROM date_dim AS date_dim6, (SELECT d_month_seq FROM date_dim WHERE d_date IN (DATE '2001-02-07', DATE '2001-05-05', DATE '2001-08-31', DATE '2001-10-13')) AS t16 WHERE date_dim6.d_month_seq = t16.d_month_seq) AS t18 WHERE date_dim5.d_date = t18.d_date) AS t19 WHERE t19.wr_item_sk = t19.i_item_sk AND (t19.wr_returned_date_sk = t19.d_date_sk AND t19.i_category IN ('Books', 'Shoes')) AND (t19.i_manager_id >= 35 AND t19.i_manager_id <= 44 AND t19.wr_return_amt / t19.wr_return_quantity >= 174 AND (t19.wr_return_amt / t19.wr_return_quantity <= 203 AND t19.wr_reason_sk IN (8, 29, 30, 33, 65))) GROUP BY i_item_id) AS t22 WHERE t6.item_id = t14.item_id AND t6.item_id = t22.item_id ORDER BY t6.item_id, t6.sr_item_qty LIMIT 100","['FILTER_PROJECT_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']",0.125035842,0.123323679,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]]"
268,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-03-23','2001-06-02','2001-07-23','2001-10-31'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Women') and i_manager_id BETWEEN 40 and 49 and sr_return_amt / sr_return_quantity between 153 and 182 and sr_reason_sk in (29, 31, 42, 54, 73) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-03-23','2001-06-02','2001-07-23','2001-10-31'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Women') and i_manager_id BETWEEN 40 and 49 and cr_return_amount / cr_return_quantity between 153 and 182 and cr_reason_sk in (29, 31, 42, 54, 73) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-03-23','2001-06-02','2001-07-23','2001-10-31'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Women') and i_manager_id BETWEEN 40 and 49 and wr_return_amt / wr_return_quantity between 153 and 182 and wr_reason_sk in (29, 31, 42, 54, 73) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;","SELECT t2756.item_id, t2756.sr_item_qty, t2756.sr_item_qty / (t2756.sr_item_qty + t2763.cr_item_qty + t2770.wr_item_qty) / 3.0 * 100 AS sr_dev, t2763.cr_item_qty, t2763.cr_item_qty / (t2756.sr_item_qty + t2763.cr_item_qty + t2770.wr_item_qty) / 3.0 * 100 AS cr_dev, t2770.wr_item_qty, t2770.wr_item_qty / (t2756.sr_item_qty + t2763.cr_item_qty + t2770.wr_item_qty) / 3.0 * 100 AS wr_dev, (t2756.sr_item_qty + t2763.cr_item_qty + t2770.wr_item_qty) / 3.0 AS average FROM (SELECT item290.i_item_id AS item_id, SUM(store_returns96.sr_return_quantity) AS sr_item_qty FROM store_returns AS store_returns96, item AS item290, date_dim AS date_dim872, (SELECT date_dim873.d_quarter_seq, date_dim873.d_year, date_dim873.d_first_dom, date_dim873.d_last_dom, date_dim873.d_same_day_ly, date_dim873.d_same_day_lq, date_dim873.d_dow, date_dim873.d_moy, date_dim873.d_dom, date_dim873.d_qoy, date_dim873.d_date_sk, date_dim873.d_fy_year, date_dim873.d_fy_quarter_seq, date_dim873.d_fy_week_seq, date_dim873.d_date, date_dim873.d_month_seq, date_dim873.d_week_seq, date_dim873.d_current_year, date_dim873.d_date_id, date_dim873.d_day_name, date_dim873.d_quarter_name, date_dim873.d_holiday, date_dim873.d_weekend, date_dim873.d_following_holiday, date_dim873.d_current_day, date_dim873.d_current_week, date_dim873.d_current_month, date_dim873.d_current_quarter, t2750.d_month_seq AS d_month_seq0 FROM date_dim AS date_dim873, (SELECT * FROM date_dim WHERE d_date IN (DATE '2001-03-23', DATE '2001-06-02', DATE '2001-07-23', DATE '2001-10-31')) AS t2750 WHERE date_dim873.d_month_seq = t2750.d_month_seq) AS t2752 WHERE date_dim872.d_date = t2752.d_date AND store_returns96.sr_item_sk = item290.i_item_sk AND (store_returns96.sr_returned_date_sk = date_dim872.d_date_sk AND item290.i_category IN ('Children', 'Women')) AND (item290.i_manager_id >= 40 AND item290.i_manager_id <= 49 AND store_returns96.sr_return_amt / store_returns96.sr_return_quantity >= 153 AND (store_returns96.sr_return_amt / store_returns96.sr_return_quantity <= 182 AND store_returns96.sr_reason_sk IN (29, 31, 42, 54, 73))) GROUP BY item290.i_item_id) AS t2756 INNER JOIN (SELECT item291.i_item_id AS item_id, SUM(catalog_returns96.cr_return_quantity) AS cr_item_qty FROM catalog_returns AS catalog_returns96, item AS item291, date_dim AS date_dim875, (SELECT date_dim876.d_quarter_seq, date_dim876.d_year, date_dim876.d_first_dom, date_dim876.d_last_dom, date_dim876.d_same_day_ly, date_dim876.d_same_day_lq, date_dim876.d_dow, date_dim876.d_moy, date_dim876.d_dom, date_dim876.d_qoy, date_dim876.d_date_sk, date_dim876.d_fy_year, date_dim876.d_fy_quarter_seq, date_dim876.d_fy_week_seq, date_dim876.d_date, date_dim876.d_month_seq, date_dim876.d_week_seq, date_dim876.d_current_year, date_dim876.d_date_id, date_dim876.d_day_name, date_dim876.d_quarter_name, date_dim876.d_holiday, date_dim876.d_weekend, date_dim876.d_following_holiday, date_dim876.d_current_day, date_dim876.d_current_week, date_dim876.d_current_month, date_dim876.d_current_quarter, t2757.d_month_seq AS d_month_seq0 FROM date_dim AS date_dim876, (SELECT * FROM date_dim WHERE d_date IN (DATE '2001-03-23', DATE '2001-06-02', DATE '2001-07-23', DATE '2001-10-31')) AS t2757 WHERE date_dim876.d_month_seq = t2757.d_month_seq) AS t2759 WHERE date_dim875.d_date = t2759.d_date AND catalog_returns96.cr_item_sk = item291.i_item_sk AND (catalog_returns96.cr_returned_date_sk = date_dim875.d_date_sk AND item291.i_category IN ('Children', 'Women')) AND (item291.i_manager_id >= 40 AND item291.i_manager_id <= 49 AND catalog_returns96.cr_return_amount / catalog_returns96.cr_return_quantity >= 153 AND (catalog_returns96.cr_return_amount / catalog_returns96.cr_return_quantity <= 182 AND catalog_returns96.cr_reason_sk IN (29, 31, 42, 54, 73))) GROUP BY item291.i_item_id) AS t2763 ON t2756.item_id = t2763.item_id INNER JOIN (SELECT item292.i_item_id AS item_id, SUM(web_returns96.wr_return_quantity) AS wr_item_qty FROM web_returns AS web_returns96, item AS item292, date_dim AS date_dim878, (SELECT date_dim879.d_quarter_seq, date_dim879.d_year, date_dim879.d_first_dom, date_dim879.d_last_dom, date_dim879.d_same_day_ly, date_dim879.d_same_day_lq, date_dim879.d_dow, date_dim879.d_moy, date_dim879.d_dom, date_dim879.d_qoy, date_dim879.d_date_sk, date_dim879.d_fy_year, date_dim879.d_fy_quarter_seq, date_dim879.d_fy_week_seq, date_dim879.d_date, date_dim879.d_month_seq, date_dim879.d_week_seq, date_dim879.d_current_year, date_dim879.d_date_id, date_dim879.d_day_name, date_dim879.d_quarter_name, date_dim879.d_holiday, date_dim879.d_weekend, date_dim879.d_following_holiday, date_dim879.d_current_day, date_dim879.d_current_week, date_dim879.d_current_month, date_dim879.d_current_quarter, t2764.d_month_seq AS d_month_seq0 FROM date_dim AS date_dim879, (SELECT * FROM date_dim WHERE d_date IN (DATE '2001-03-23', DATE '2001-06-02', DATE '2001-07-23', DATE '2001-10-31')) AS t2764 WHERE date_dim879.d_month_seq = t2764.d_month_seq) AS t2766 WHERE date_dim878.d_date = t2766.d_date AND web_returns96.wr_item_sk = item292.i_item_sk AND (web_returns96.wr_returned_date_sk = date_dim878.d_date_sk AND item292.i_category IN ('Children', 'Women')) AND (item292.i_manager_id >= 40 AND item292.i_manager_id <= 49 AND web_returns96.wr_return_amt / web_returns96.wr_return_quantity >= 153 AND (web_returns96.wr_return_amt / web_returns96.wr_return_quantity <= 182 AND web_returns96.wr_reason_sk IN (29, 31, 42, 54, 73))) GROUP BY item292.i_item_id) AS t2770 ON t2756.item_id = t2770.item_id ORDER BY t2756.item_id, t2756.sr_item_qty LIMIT 100","['JOIN_PROJECT_TRANSPOSE_RULE(_OTHER-_PROJ', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']",0.111448129,0.110020955,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]]"
269,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2002-02-24','2002-05-16','2002-09-02','2002-11-12'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Sports', 'Women') and i_manager_id BETWEEN 91 and 100 and sr_return_amt / sr_return_quantity between 64 and 93 and sr_reason_sk in (38, 48, 57, 60, 72) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-02-24','2002-05-16','2002-09-02','2002-11-12'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Sports', 'Women') and i_manager_id BETWEEN 91 and 100 and cr_return_amount / cr_return_quantity between 64 and 93 and cr_reason_sk in (38, 48, 57, 60, 72) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-02-24','2002-05-16','2002-09-02','2002-11-12'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Sports', 'Women') and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 64 and 93 and wr_reason_sk in (38, 48, 57, 60, 72) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;","SELECT t1333.item_id, t1333.sr_item_qty, t1333.sr_item_qty / (t1333.sr_item_qty + t1340.cr_item_qty + t1347.wr_item_qty) / 3.0 * 100 AS sr_dev, t1340.cr_item_qty, t1340.cr_item_qty / (t1333.sr_item_qty + t1340.cr_item_qty + t1347.wr_item_qty) / 3.0 * 100 AS cr_dev, t1347.wr_item_qty, t1347.wr_item_qty / (t1333.sr_item_qty + t1340.cr_item_qty + t1347.wr_item_qty) / 3.0 * 100 AS wr_dev, (t1333.sr_item_qty + t1340.cr_item_qty + t1347.wr_item_qty) / 3.0 AS average FROM (SELECT t1328.i_item_id AS item_id, SUM(t1327.sr_return_quantity) AS sr_item_qty FROM (SELECT * FROM store_returns WHERE sr_return_amt / sr_return_quantity >= 64 AND sr_return_amt / sr_return_quantity <= 93 AND sr_reason_sk IN (38, 48, 57, 60, 72)) AS t1327 INNER JOIN (SELECT * FROM item WHERE i_category IN ('Sports', 'Women') AND (i_manager_id >= 91 AND i_manager_id <= 100)) AS t1328 ON t1327.sr_item_sk = t1328.i_item_sk INNER JOIN date_dim AS date_dim404 ON t1327.sr_returned_date_sk = date_dim404.d_date_sk INNER JOIN (SELECT date_dim405.d_date FROM date_dim AS date_dim405 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date IN (DATE '2002-02-24', DATE '2002-05-16', DATE '2002-09-02', DATE '2002-11-12')) AS t1330 ON date_dim405.d_month_seq = t1330.d_month_seq) AS t1331 ON date_dim404.d_date = t1331.d_date GROUP BY t1328.i_item_id) AS t1333 INNER JOIN (SELECT t1335.i_item_id AS item_id, SUM(t1334.cr_return_quantity) AS cr_item_qty FROM (SELECT * FROM catalog_returns WHERE cr_return_amount / cr_return_quantity >= 64 AND cr_return_amount / cr_return_quantity <= 93 AND cr_reason_sk IN (38, 48, 57, 60, 72)) AS t1334 INNER JOIN (SELECT * FROM item WHERE i_category IN ('Sports', 'Women') AND (i_manager_id >= 91 AND i_manager_id <= 100)) AS t1335 ON t1334.cr_item_sk = t1335.i_item_sk INNER JOIN date_dim AS date_dim407 ON t1334.cr_returned_date_sk = date_dim407.d_date_sk INNER JOIN (SELECT date_dim408.d_date FROM date_dim AS date_dim408 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date IN (DATE '2002-02-24', DATE '2002-05-16', DATE '2002-09-02', DATE '2002-11-12')) AS t1337 ON date_dim408.d_month_seq = t1337.d_month_seq) AS t1338 ON date_dim407.d_date = t1338.d_date GROUP BY t1335.i_item_id) AS t1340 ON t1333.item_id = t1340.item_id INNER JOIN (SELECT t1342.i_item_id AS item_id, SUM(t1341.wr_return_quantity) AS wr_item_qty FROM (SELECT * FROM web_returns WHERE wr_return_amt / wr_return_quantity >= 64 AND wr_return_amt / wr_return_quantity <= 93 AND wr_reason_sk IN (38, 48, 57, 60, 72)) AS t1341 INNER JOIN (SELECT * FROM item WHERE i_category IN ('Sports', 'Women') AND (i_manager_id >= 91 AND i_manager_id <= 100)) AS t1342 ON t1341.wr_item_sk = t1342.i_item_sk INNER JOIN date_dim AS date_dim410 ON t1341.wr_returned_date_sk = date_dim410.d_date_sk INNER JOIN (SELECT date_dim411.d_date FROM date_dim AS date_dim411 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date IN (DATE '2002-02-24', DATE '2002-05-16', DATE '2002-09-02', DATE '2002-11-12')) AS t1344 ON date_dim411.d_month_seq = t1344.d_month_seq) AS t1345 ON date_dim410.d_date = t1345.d_date GROUP BY t1342.i_item_id) AS t1347 ON t1333.item_id = t1347.item_id ORDER BY t1333.item_id, t1333.sr_item_qty LIMIT 100","['PROJECT_TO_CALC', 'FILTER_INTO_JOIN']",1.098149697,0.106810013,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]]"
270,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('almond', 'coral') and i_manager_id BETWEEN 81 and 100 and ss_list_price between 95 and 109 and ca_state in ('OH','TN') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('almond', 'coral') and i_manager_id BETWEEN 81 and 100 and ws_list_price between 95 and 109 and ca_state in ('OH','TN') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;","SELECT t4.ca_county, t4.d_year, t28.web_sales / t22.web_sales AS web_q1_q2_increase, t10.store_sales / t4.store_sales AS store_q1_q2_increase, t34.web_sales / t28.web_sales AS web_q2_q3_increase, t16.store_sales / t10.store_sales AS store_q2_q3_increase FROM (SELECT t0.ca_county, date_dim.d_qoy, date_dim.d_year, SUM(t.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 95 AND ss_list_price <= 109) AS t INNER JOIN date_dim ON t.ss_sold_date_sk = date_dim.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('OH', 'TN')) AS t0 ON t.ss_addr_sk = t0.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('almond', 'coral') AND (i_manager_id >= 81 AND i_manager_id <= 100)) AS t1 ON t.ss_item_sk = t1.i_item_sk GROUP BY t0.ca_county, date_dim.d_qoy, date_dim.d_year HAVING date_dim.d_qoy = 1 AND date_dim.d_year = 1998) AS t4 INNER JOIN (SELECT t6.ca_county, date_dim0.d_qoy, date_dim0.d_year, SUM(t5.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 95 AND ss_list_price <= 109) AS t5 INNER JOIN date_dim AS date_dim0 ON t5.ss_sold_date_sk = date_dim0.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('OH', 'TN')) AS t6 ON t5.ss_addr_sk = t6.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('almond', 'coral') AND (i_manager_id >= 81 AND i_manager_id <= 100)) AS t7 ON t5.ss_item_sk = t7.i_item_sk GROUP BY t6.ca_county, date_dim0.d_qoy, date_dim0.d_year HAVING date_dim0.d_qoy = 2 AND date_dim0.d_year = 1998) AS t10 ON t4.ca_county = t10.ca_county INNER JOIN (SELECT t12.ca_county, date_dim1.d_qoy, date_dim1.d_year, SUM(t11.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 95 AND ss_list_price <= 109) AS t11 INNER JOIN date_dim AS date_dim1 ON t11.ss_sold_date_sk = date_dim1.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('OH', 'TN')) AS t12 ON t11.ss_addr_sk = t12.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('almond', 'coral') AND (i_manager_id >= 81 AND i_manager_id <= 100)) AS t13 ON t11.ss_item_sk = t13.i_item_sk GROUP BY t12.ca_county, date_dim1.d_qoy, date_dim1.d_year HAVING date_dim1.d_qoy = 3 AND date_dim1.d_year = 1998) AS t16 ON t10.ca_county = t16.ca_county INNER JOIN (SELECT t18.ca_county, date_dim2.d_qoy, date_dim2.d_year, SUM(t17.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 95 AND ws_list_price <= 109) AS t17 INNER JOIN date_dim AS date_dim2 ON t17.ws_sold_date_sk = date_dim2.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('OH', 'TN')) AS t18 ON t17.ws_bill_addr_sk = t18.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('almond', 'coral') AND (i_manager_id >= 81 AND i_manager_id <= 100)) AS t19 ON t17.ws_item_sk = t19.i_item_sk GROUP BY t18.ca_county, date_dim2.d_qoy, date_dim2.d_year HAVING date_dim2.d_qoy = 1 AND date_dim2.d_year = 1998) AS t22 ON t4.ca_county = t22.ca_county INNER JOIN (SELECT t24.ca_county, date_dim3.d_qoy, date_dim3.d_year, SUM(t23.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 95 AND ws_list_price <= 109) AS t23 INNER JOIN date_dim AS date_dim3 ON t23.ws_sold_date_sk = date_dim3.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('OH', 'TN')) AS t24 ON t23.ws_bill_addr_sk = t24.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('almond', 'coral') AND (i_manager_id >= 81 AND i_manager_id <= 100)) AS t25 ON t23.ws_item_sk = t25.i_item_sk GROUP BY t24.ca_county, date_dim3.d_qoy, date_dim3.d_year HAVING date_dim3.d_qoy = 2 AND date_dim3.d_year = 1998) AS t28 ON t22.ca_county = t28.ca_county AND CASE WHEN t22.web_sales > 0 THEN t28.web_sales / t22.web_sales ELSE NULL END > CASE WHEN t4.store_sales > 0 THEN t10.store_sales / t4.store_sales ELSE NULL END INNER JOIN (SELECT t30.ca_county, date_dim4.d_qoy, date_dim4.d_year, SUM(t29.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 95 AND ws_list_price <= 109) AS t29 INNER JOIN date_dim AS date_dim4 ON t29.ws_sold_date_sk = date_dim4.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('OH', 'TN')) AS t30 ON t29.ws_bill_addr_sk = t30.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('almond', 'coral') AND (i_manager_id >= 81 AND i_manager_id <= 100)) AS t31 ON t29.ws_item_sk = t31.i_item_sk GROUP BY t30.ca_county, date_dim4.d_qoy, date_dim4.d_year HAVING date_dim4.d_qoy = 3 AND date_dim4.d_year = 1998) AS t34 ON t22.ca_county = t34.ca_county AND CASE WHEN t28.web_sales > 0 THEN CAST(t34.web_sales / t28.web_sales AS DECIMAL(19, 0)) ELSE NULL END > CASE WHEN t10.store_sales > 0 THEN CAST(t16.store_sales / t10.store_sales AS DECIMAL(19, 0)) ELSE NULL END ORDER BY t16.store_sales / t10.store_sales","['FILTER_INTO_JOIN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_MERGE']",0.05597655,0.046730995,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
271,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('antique', 'floral') and i_manager_id BETWEEN 81 and 100 and ss_list_price between 254 and 268 and ca_state in ('CO','WI') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('antique', 'floral') and i_manager_id BETWEEN 81 and 100 and ws_list_price between 254 and 268 and ca_state in ('CO','WI') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;","SELECT t1.ca_county, t1.d_year, t13.web_sales / t10.web_sales AS web_q1_q2_increase, t4.store_sales / t1.store_sales AS store_q1_q2_increase, t16.web_sales / t13.web_sales AS web_q2_q3_increase, t7.store_sales / t4.store_sales AS store_q2_q3_increase FROM (SELECT customer_address.ca_county, date_dim.d_qoy, date_dim.d_year, SUM(store_sales.ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_addr_sk = customer_address.ca_address_sk AND (store_sales.ss_item_sk = item.i_item_sk AND (item.i_color = 'antique' OR item.i_color = 'floral')) AND (item.i_manager_id >= 81 AND item.i_manager_id <= 100 AND (store_sales.ss_list_price >= 254 AND (store_sales.ss_list_price <= 268 AND (customer_address.ca_state = 'CO' OR customer_address.ca_state = 'WI')))) GROUP BY date_dim.d_year, date_dim.d_qoy, customer_address.ca_county) AS t1, (SELECT customer_address0.ca_county, date_dim0.d_qoy, date_dim0.d_year, SUM(store_sales0.ss_ext_sales_price) AS store_sales FROM store_sales AS store_sales0, date_dim AS date_dim0, customer_address AS customer_address0, item AS item0 WHERE store_sales0.ss_sold_date_sk = date_dim0.d_date_sk AND store_sales0.ss_addr_sk = customer_address0.ca_address_sk AND (store_sales0.ss_item_sk = item0.i_item_sk AND (item0.i_color = 'antique' OR item0.i_color = 'floral')) AND (item0.i_manager_id >= 81 AND item0.i_manager_id <= 100 AND (store_sales0.ss_list_price >= 254 AND (store_sales0.ss_list_price <= 268 AND (customer_address0.ca_state = 'CO' OR customer_address0.ca_state = 'WI')))) GROUP BY date_dim0.d_year, date_dim0.d_qoy, customer_address0.ca_county) AS t4, (SELECT customer_address1.ca_county, date_dim1.d_qoy, date_dim1.d_year, SUM(store_sales1.ss_ext_sales_price) AS store_sales FROM store_sales AS store_sales1, date_dim AS date_dim1, customer_address AS customer_address1, item AS item1 WHERE store_sales1.ss_sold_date_sk = date_dim1.d_date_sk AND store_sales1.ss_addr_sk = customer_address1.ca_address_sk AND (store_sales1.ss_item_sk = item1.i_item_sk AND (item1.i_color = 'antique' OR item1.i_color = 'floral')) AND (item1.i_manager_id >= 81 AND item1.i_manager_id <= 100 AND (store_sales1.ss_list_price >= 254 AND (store_sales1.ss_list_price <= 268 AND (customer_address1.ca_state = 'CO' OR customer_address1.ca_state = 'WI')))) GROUP BY date_dim1.d_year, date_dim1.d_qoy, customer_address1.ca_county) AS t7, (SELECT customer_address2.ca_county, date_dim2.d_qoy, date_dim2.d_year, SUM(web_sales.ws_ext_sales_price) AS web_sales FROM web_sales, date_dim AS date_dim2, customer_address AS customer_address2, item AS item2 WHERE web_sales.ws_sold_date_sk = date_dim2.d_date_sk AND web_sales.ws_bill_addr_sk = customer_address2.ca_address_sk AND (web_sales.ws_item_sk = item2.i_item_sk AND (item2.i_color = 'antique' OR item2.i_color = 'floral')) AND (item2.i_manager_id >= 81 AND item2.i_manager_id <= 100 AND (web_sales.ws_list_price >= 254 AND (web_sales.ws_list_price <= 268 AND (customer_address2.ca_state = 'CO' OR customer_address2.ca_state = 'WI')))) GROUP BY date_dim2.d_year, date_dim2.d_qoy, customer_address2.ca_county) AS t10, (SELECT customer_address3.ca_county, date_dim3.d_qoy, date_dim3.d_year, SUM(web_sales0.ws_ext_sales_price) AS web_sales FROM web_sales AS web_sales0, date_dim AS date_dim3, customer_address AS customer_address3, item AS item3 WHERE web_sales0.ws_sold_date_sk = date_dim3.d_date_sk AND web_sales0.ws_bill_addr_sk = customer_address3.ca_address_sk AND (web_sales0.ws_item_sk = item3.i_item_sk AND (item3.i_color = 'antique' OR item3.i_color = 'floral')) AND (item3.i_manager_id >= 81 AND item3.i_manager_id <= 100 AND (web_sales0.ws_list_price >= 254 AND (web_sales0.ws_list_price <= 268 AND (customer_address3.ca_state = 'CO' OR customer_address3.ca_state = 'WI')))) GROUP BY date_dim3.d_year, date_dim3.d_qoy, customer_address3.ca_county) AS t13, (SELECT customer_address4.ca_county, date_dim4.d_qoy, date_dim4.d_year, SUM(web_sales1.ws_ext_sales_price) AS web_sales FROM web_sales AS web_sales1, date_dim AS date_dim4, customer_address AS customer_address4, item AS item4 WHERE web_sales1.ws_sold_date_sk = date_dim4.d_date_sk AND web_sales1.ws_bill_addr_sk = customer_address4.ca_address_sk AND (web_sales1.ws_item_sk = item4.i_item_sk AND (item4.i_color = 'antique' OR item4.i_color = 'floral')) AND (item4.i_manager_id >= 81 AND item4.i_manager_id <= 100 AND (web_sales1.ws_list_price >= 254 AND (web_sales1.ws_list_price <= 268 AND (customer_address4.ca_state = 'CO' OR customer_address4.ca_state = 'WI')))) GROUP BY date_dim4.d_year, date_dim4.d_qoy, customer_address4.ca_county) AS t16 WHERE t1.d_qoy = 1 AND t1.d_year = 2000 AND (t1.ca_county = t4.ca_county AND t4.d_qoy = 2) AND (t4.d_year = 2000 AND t4.ca_county = t7.ca_county AND (t7.d_qoy = 3 AND (t7.d_year = 2000 AND t1.ca_county = t10.ca_county))) AND (t10.d_qoy = 1 AND t10.d_year = 2000 AND (t10.ca_county = t13.ca_county AND (t13.d_qoy = 2 AND t13.d_year = 2000)) AND (t10.ca_county = t16.ca_county AND t16.d_qoy = 3 AND (t16.d_year = 2000 AND (CASE WHEN t10.web_sales > 0 THEN CAST(t13.web_sales / t10.web_sales AS DECIMAL(19, 0)) ELSE NULL END > CASE WHEN t1.store_sales > 0 THEN CAST(t4.store_sales / t1.store_sales AS DECIMAL(19, 0)) ELSE NULL END AND CASE WHEN t13.web_sales > 0 THEN CAST(t16.web_sales / t13.web_sales AS DECIMAL(19, 0)) ELSE NULL END > CASE WHEN t4.store_sales > 0 THEN CAST(t7.store_sales / t4.store_sales AS DECIMAL(19, 0)) ELSE NULL END)))) ORDER BY t7.store_sales / t4.store_sales","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_SCAN', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'SORT_UNION_TRANSPOSE', 'AGGREGATE_REMOVE']",0.039822419,0.03951486,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
272,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('azure', 'orange') and i_manager_id BETWEEN 12 and 31 and ss_list_price between 83 and 97 and ca_state in ('KY','SD') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('azure', 'orange') and i_manager_id BETWEEN 12 and 31 and ws_list_price between 83 and 97 and ca_state in ('KY','SD') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;","SELECT t4739.ca_county, t4739.d_year, t4763.web_sales / t4757.web_sales AS web_q1_q2_increase, t4745.store_sales / t4739.store_sales AS store_q1_q2_increase, t4769.web_sales / t4763.web_sales AS web_q2_q3_increase, t4751.store_sales / t4745.store_sales AS store_q2_q3_increase FROM (SELECT t4736.ca_county, t4735.d_qoy, t4735.d_year, SUM(t4734.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 83 AND ss_list_price <= 97) AS t4734 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 1 AND d_year = 2000) AS t4735 ON t4734.ss_sold_date_sk = t4735.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('KY', 'SD')) AS t4736 ON t4734.ss_addr_sk = t4736.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('azure', 'orange') AND (i_manager_id >= 12 AND i_manager_id <= 31)) AS t4737 ON t4734.ss_item_sk = t4737.i_item_sk GROUP BY t4736.ca_county, t4735.d_qoy, t4735.d_year) AS t4739 INNER JOIN (SELECT t4742.ca_county, t4741.d_qoy, t4741.d_year, SUM(t4740.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 83 AND ss_list_price <= 97) AS t4740 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 2 AND d_year = 2000) AS t4741 ON t4740.ss_sold_date_sk = t4741.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('KY', 'SD')) AS t4742 ON t4740.ss_addr_sk = t4742.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('azure', 'orange') AND (i_manager_id >= 12 AND i_manager_id <= 31)) AS t4743 ON t4740.ss_item_sk = t4743.i_item_sk GROUP BY t4742.ca_county, t4741.d_qoy, t4741.d_year) AS t4745 ON t4739.ca_county = t4745.ca_county INNER JOIN (SELECT t4748.ca_county, t4747.d_qoy, t4747.d_year, SUM(t4746.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 83 AND ss_list_price <= 97) AS t4746 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 3 AND d_year = 2000) AS t4747 ON t4746.ss_sold_date_sk = t4747.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('KY', 'SD')) AS t4748 ON t4746.ss_addr_sk = t4748.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('azure', 'orange') AND (i_manager_id >= 12 AND i_manager_id <= 31)) AS t4749 ON t4746.ss_item_sk = t4749.i_item_sk GROUP BY t4748.ca_county, t4747.d_qoy, t4747.d_year) AS t4751 ON t4745.ca_county = t4751.ca_county INNER JOIN (SELECT t4754.ca_county, t4753.d_qoy, t4753.d_year, SUM(t4752.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 83 AND ws_list_price <= 97) AS t4752 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 1 AND d_year = 2000) AS t4753 ON t4752.ws_sold_date_sk = t4753.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('KY', 'SD')) AS t4754 ON t4752.ws_bill_addr_sk = t4754.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('azure', 'orange') AND (i_manager_id >= 12 AND i_manager_id <= 31)) AS t4755 ON t4752.ws_item_sk = t4755.i_item_sk GROUP BY t4754.ca_county, t4753.d_qoy, t4753.d_year) AS t4757 ON t4739.ca_county = t4757.ca_county INNER JOIN (SELECT t4760.ca_county, t4759.d_qoy, t4759.d_year, SUM(t4758.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 83 AND ws_list_price <= 97) AS t4758 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 2 AND d_year = 2000) AS t4759 ON t4758.ws_sold_date_sk = t4759.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('KY', 'SD')) AS t4760 ON t4758.ws_bill_addr_sk = t4760.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('azure', 'orange') AND (i_manager_id >= 12 AND i_manager_id <= 31)) AS t4761 ON t4758.ws_item_sk = t4761.i_item_sk GROUP BY t4760.ca_county, t4759.d_qoy, t4759.d_year) AS t4763 ON t4757.ca_county = t4763.ca_county AND CASE WHEN t4757.web_sales > 0 THEN t4763.web_sales / t4757.web_sales ELSE NULL END > CASE WHEN t4739.store_sales > 0 THEN t4745.store_sales / t4739.store_sales ELSE NULL END INNER JOIN (SELECT t4766.ca_county, t4765.d_qoy, t4765.d_year, SUM(t4764.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 83 AND ws_list_price <= 97) AS t4764 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 3 AND d_year = 2000) AS t4765 ON t4764.ws_sold_date_sk = t4765.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('KY', 'SD')) AS t4766 ON t4764.ws_bill_addr_sk = t4766.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('azure', 'orange') AND (i_manager_id >= 12 AND i_manager_id <= 31)) AS t4767 ON t4764.ws_item_sk = t4767.i_item_sk GROUP BY t4766.ca_county, t4765.d_qoy, t4765.d_year) AS t4769 ON t4757.ca_county = t4769.ca_county AND CASE WHEN t4763.web_sales > 0 THEN t4769.web_sales / t4763.web_sales ELSE NULL END > CASE WHEN t4745.store_sales > 0 THEN t4751.store_sales / t4745.store_sales ELSE NULL END ORDER BY t4751.store_sales / t4745.store_sales","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']",2.496574004,0.38862133,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
273,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('bisque', 'cream') and i_manager_id BETWEEN 2 and 21 and ss_list_price between 199 and 213 and ca_state in ('IN','NE') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('bisque', 'cream') and i_manager_id BETWEEN 2 and 21 and ws_list_price between 199 and 213 and ca_state in ('IN','NE') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.ca_county ;","SELECT t588.ca_county, t588.d_year, t612.web_sales / t606.web_sales AS web_q1_q2_increase, t594.store_sales / t588.store_sales AS store_q1_q2_increase, t618.web_sales / t612.web_sales AS web_q2_q3_increase, t600.store_sales / t594.store_sales AS store_q2_q3_increase FROM (SELECT t585.ca_county, t584.d_qoy, t584.d_year, SUM(t583.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 199 AND ss_list_price <= 213) AS t583 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 1 AND d_year = 1998) AS t584 ON t583.ss_sold_date_sk = t584.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('IN', 'NE')) AS t585 ON t583.ss_addr_sk = t585.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('bisque', 'cream') AND (i_manager_id >= 2 AND i_manager_id <= 21)) AS t586 ON t583.ss_item_sk = t586.i_item_sk GROUP BY t585.ca_county, t584.d_qoy, t584.d_year) AS t588 INNER JOIN (SELECT t591.ca_county, t590.d_qoy, t590.d_year, SUM(t589.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 199 AND ss_list_price <= 213) AS t589 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 2 AND d_year = 1998) AS t590 ON t589.ss_sold_date_sk = t590.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('IN', 'NE')) AS t591 ON t589.ss_addr_sk = t591.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('bisque', 'cream') AND (i_manager_id >= 2 AND i_manager_id <= 21)) AS t592 ON t589.ss_item_sk = t592.i_item_sk GROUP BY t591.ca_county, t590.d_qoy, t590.d_year) AS t594 ON t588.ca_county = t594.ca_county INNER JOIN (SELECT t597.ca_county, t596.d_qoy, t596.d_year, SUM(t595.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 199 AND ss_list_price <= 213) AS t595 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 3 AND d_year = 1998) AS t596 ON t595.ss_sold_date_sk = t596.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('IN', 'NE')) AS t597 ON t595.ss_addr_sk = t597.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('bisque', 'cream') AND (i_manager_id >= 2 AND i_manager_id <= 21)) AS t598 ON t595.ss_item_sk = t598.i_item_sk GROUP BY t597.ca_county, t596.d_qoy, t596.d_year) AS t600 ON t594.ca_county = t600.ca_county INNER JOIN (SELECT t603.ca_county, t602.d_qoy, t602.d_year, SUM(t601.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 199 AND ws_list_price <= 213) AS t601 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 1 AND d_year = 1998) AS t602 ON t601.ws_sold_date_sk = t602.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('IN', 'NE')) AS t603 ON t601.ws_bill_addr_sk = t603.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('bisque', 'cream') AND (i_manager_id >= 2 AND i_manager_id <= 21)) AS t604 ON t601.ws_item_sk = t604.i_item_sk GROUP BY t603.ca_county, t602.d_qoy, t602.d_year) AS t606 ON t588.ca_county = t606.ca_county INNER JOIN (SELECT t609.ca_county, t608.d_qoy, t608.d_year, SUM(t607.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 199 AND ws_list_price <= 213) AS t607 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 2 AND d_year = 1998) AS t608 ON t607.ws_sold_date_sk = t608.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('IN', 'NE')) AS t609 ON t607.ws_bill_addr_sk = t609.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('bisque', 'cream') AND (i_manager_id >= 2 AND i_manager_id <= 21)) AS t610 ON t607.ws_item_sk = t610.i_item_sk GROUP BY t609.ca_county, t608.d_qoy, t608.d_year) AS t612 ON t606.ca_county = t612.ca_county AND CASE WHEN t606.web_sales > 0 THEN t612.web_sales / t606.web_sales ELSE NULL END > CASE WHEN t588.store_sales > 0 THEN t594.store_sales / t588.store_sales ELSE NULL END INNER JOIN (SELECT t615.ca_county, t614.d_qoy, t614.d_year, SUM(t613.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 199 AND ws_list_price <= 213) AS t613 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 3 AND d_year = 1998) AS t614 ON t613.ws_sold_date_sk = t614.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('IN', 'NE')) AS t615 ON t613.ws_bill_addr_sk = t615.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('bisque', 'cream') AND (i_manager_id >= 2 AND i_manager_id <= 21)) AS t616 ON t613.ws_item_sk = t616.i_item_sk GROUP BY t615.ca_county, t614.d_qoy, t614.d_year) AS t618 ON t606.ca_county = t618.ca_county AND CASE WHEN t612.web_sales > 0 THEN t618.web_sales / t612.web_sales ELSE NULL END > CASE WHEN t594.store_sales > 0 THEN t600.store_sales / t594.store_sales ELSE NULL END ORDER BY t588.ca_county",['FILTER_INTO_JOIN'],0.103693008,0.102133751,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
274,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('bisque', 'deep') and i_manager_id BETWEEN 18 and 37 and ss_list_price between 276 and 290 and ca_state in ('MS','NY') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('bisque', 'deep') and i_manager_id BETWEEN 18 and 37 and ws_list_price between 276 and 290 and ca_state in ('MS','NY') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2001 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2001 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2001 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2001 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2001 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2001 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year ;","SELECT t1.ca_county, t1.d_year, t13.web_sales / t10.web_sales AS web_q1_q2_increase, t4.store_sales / t1.store_sales AS store_q1_q2_increase, t16.web_sales / t13.web_sales AS web_q2_q3_increase, t7.store_sales / t4.store_sales AS store_q2_q3_increase FROM (SELECT customer_address.ca_county, date_dim.d_qoy, date_dim.d_year, SUM(store_sales.ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND (store_sales.ss_addr_sk = customer_address.ca_address_sk AND store_sales.ss_item_sk = item.i_item_sk) AND (item.i_color IN ('bisque', 'deep') AND (item.i_manager_id >= 18 AND item.i_manager_id <= 37) AND (store_sales.ss_list_price >= 276 AND store_sales.ss_list_price <= 290 AND customer_address.ca_state IN ('MS', 'NY'))) GROUP BY date_dim.d_year, date_dim.d_qoy, customer_address.ca_county) AS t1, (SELECT customer_address0.ca_county, date_dim0.d_qoy, date_dim0.d_year, SUM(store_sales0.ss_ext_sales_price) AS store_sales FROM store_sales AS store_sales0, date_dim AS date_dim0, customer_address AS customer_address0, item AS item0 WHERE store_sales0.ss_sold_date_sk = date_dim0.d_date_sk AND (store_sales0.ss_addr_sk = customer_address0.ca_address_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (item0.i_color IN ('bisque', 'deep') AND (item0.i_manager_id >= 18 AND item0.i_manager_id <= 37) AND (store_sales0.ss_list_price >= 276 AND store_sales0.ss_list_price <= 290 AND customer_address0.ca_state IN ('MS', 'NY'))) GROUP BY date_dim0.d_year, date_dim0.d_qoy, customer_address0.ca_county) AS t4, (SELECT customer_address1.ca_county, date_dim1.d_qoy, date_dim1.d_year, SUM(store_sales1.ss_ext_sales_price) AS store_sales FROM store_sales AS store_sales1, date_dim AS date_dim1, customer_address AS customer_address1, item AS item1 WHERE store_sales1.ss_sold_date_sk = date_dim1.d_date_sk AND (store_sales1.ss_addr_sk = customer_address1.ca_address_sk AND store_sales1.ss_item_sk = item1.i_item_sk) AND (item1.i_color IN ('bisque', 'deep') AND (item1.i_manager_id >= 18 AND item1.i_manager_id <= 37) AND (store_sales1.ss_list_price >= 276 AND store_sales1.ss_list_price <= 290 AND customer_address1.ca_state IN ('MS', 'NY'))) GROUP BY date_dim1.d_year, date_dim1.d_qoy, customer_address1.ca_county) AS t7, (SELECT customer_address2.ca_county, date_dim2.d_qoy, date_dim2.d_year, SUM(web_sales.ws_ext_sales_price) AS web_sales FROM web_sales, date_dim AS date_dim2, customer_address AS customer_address2, item AS item2 WHERE web_sales.ws_sold_date_sk = date_dim2.d_date_sk AND (web_sales.ws_bill_addr_sk = customer_address2.ca_address_sk AND web_sales.ws_item_sk = item2.i_item_sk) AND (item2.i_color IN ('bisque', 'deep') AND (item2.i_manager_id >= 18 AND item2.i_manager_id <= 37) AND (web_sales.ws_list_price >= 276 AND web_sales.ws_list_price <= 290 AND customer_address2.ca_state IN ('MS', 'NY'))) GROUP BY date_dim2.d_year, date_dim2.d_qoy, customer_address2.ca_county) AS t10, (SELECT customer_address3.ca_county, date_dim3.d_qoy, date_dim3.d_year, SUM(web_sales0.ws_ext_sales_price) AS web_sales FROM web_sales AS web_sales0, date_dim AS date_dim3, customer_address AS customer_address3, item AS item3 WHERE web_sales0.ws_sold_date_sk = date_dim3.d_date_sk AND (web_sales0.ws_bill_addr_sk = customer_address3.ca_address_sk AND web_sales0.ws_item_sk = item3.i_item_sk) AND (item3.i_color IN ('bisque', 'deep') AND (item3.i_manager_id >= 18 AND item3.i_manager_id <= 37) AND (web_sales0.ws_list_price >= 276 AND web_sales0.ws_list_price <= 290 AND customer_address3.ca_state IN ('MS', 'NY'))) GROUP BY date_dim3.d_year, date_dim3.d_qoy, customer_address3.ca_county) AS t13, (SELECT customer_address4.ca_county, date_dim4.d_qoy, date_dim4.d_year, SUM(web_sales1.ws_ext_sales_price) AS web_sales FROM web_sales AS web_sales1, date_dim AS date_dim4, customer_address AS customer_address4, item AS item4 WHERE web_sales1.ws_sold_date_sk = date_dim4.d_date_sk AND (web_sales1.ws_bill_addr_sk = customer_address4.ca_address_sk AND web_sales1.ws_item_sk = item4.i_item_sk) AND (item4.i_color IN ('bisque', 'deep') AND (item4.i_manager_id >= 18 AND item4.i_manager_id <= 37) AND (web_sales1.ws_list_price >= 276 AND web_sales1.ws_list_price <= 290 AND customer_address4.ca_state IN ('MS', 'NY'))) GROUP BY date_dim4.d_year, date_dim4.d_qoy, customer_address4.ca_county) AS t16 WHERE t1.d_qoy = 1 AND t1.d_year = 2001 AND (t1.ca_county = t4.ca_county AND t4.d_qoy = 2) AND (t4.d_year = 2001 AND t4.ca_county = t7.ca_county AND (t7.d_qoy = 3 AND (t7.d_year = 2001 AND t1.ca_county = t10.ca_county))) AND (t10.d_qoy = 1 AND t10.d_year = 2001 AND (t10.ca_county = t13.ca_county AND (t13.d_qoy = 2 AND t13.d_year = 2001)) AND (t10.ca_county = t16.ca_county AND t16.d_qoy = 3 AND (t16.d_year = 2001 AND (CASE WHEN t1.store_sales > 0 THEN CASE WHEN t10.web_sales > 0 THEN t13.web_sales / t10.web_sales > t4.store_sales / t1.store_sales ELSE FALSE END ELSE FALSE END AND CASE WHEN t4.store_sales > 0 THEN CASE WHEN t13.web_sales > 0 THEN t16.web_sales / t13.web_sales > t7.store_sales / t4.store_sales ELSE FALSE END ELSE FALSE END)))) ORDER BY t1.d_year","['AGGREGATE_PROJECT_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_REDUCE_EXPRESSIONS']",2.763051351,0.094494263,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
275,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('brown', 'navy') and i_manager_id BETWEEN 81 and 100 and ss_list_price between 187 and 201 and ca_state in ('GA','VA') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('brown', 'navy') and i_manager_id BETWEEN 81 and 100 and ws_list_price between 187 and 201 and ca_state in ('GA','VA') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q1_q2_increase ;","SELECT t1.ca_county, t1.d_year, t13.web_sales / t10.web_sales AS web_q1_q2_increase, t4.store_sales / t1.store_sales AS store_q1_q2_increase, t16.web_sales / t13.web_sales AS web_q2_q3_increase, t7.store_sales / t4.store_sales AS store_q2_q3_increase FROM (SELECT customer_address.ca_county, date_dim.d_qoy, date_dim.d_year, SUM(store_sales.ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND (store_sales.ss_addr_sk = customer_address.ca_address_sk AND store_sales.ss_item_sk = item.i_item_sk) AND (item.i_color IN ('brown', 'navy') AND (item.i_manager_id >= 81 AND item.i_manager_id <= 100) AND (store_sales.ss_list_price >= 187 AND store_sales.ss_list_price <= 201 AND customer_address.ca_state IN ('GA', 'VA'))) GROUP BY date_dim.d_year, date_dim.d_qoy, customer_address.ca_county) AS t1, (SELECT customer_address0.ca_county, date_dim0.d_qoy, date_dim0.d_year, SUM(store_sales0.ss_ext_sales_price) AS store_sales FROM store_sales AS store_sales0, date_dim AS date_dim0, customer_address AS customer_address0, item AS item0 WHERE store_sales0.ss_sold_date_sk = date_dim0.d_date_sk AND (store_sales0.ss_addr_sk = customer_address0.ca_address_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (item0.i_color IN ('brown', 'navy') AND (item0.i_manager_id >= 81 AND item0.i_manager_id <= 100) AND (store_sales0.ss_list_price >= 187 AND store_sales0.ss_list_price <= 201 AND customer_address0.ca_state IN ('GA', 'VA'))) GROUP BY date_dim0.d_year, date_dim0.d_qoy, customer_address0.ca_county) AS t4, (SELECT customer_address1.ca_county, date_dim1.d_qoy, date_dim1.d_year, SUM(store_sales1.ss_ext_sales_price) AS store_sales FROM store_sales AS store_sales1, date_dim AS date_dim1, customer_address AS customer_address1, item AS item1 WHERE store_sales1.ss_sold_date_sk = date_dim1.d_date_sk AND (store_sales1.ss_addr_sk = customer_address1.ca_address_sk AND store_sales1.ss_item_sk = item1.i_item_sk) AND (item1.i_color IN ('brown', 'navy') AND (item1.i_manager_id >= 81 AND item1.i_manager_id <= 100) AND (store_sales1.ss_list_price >= 187 AND store_sales1.ss_list_price <= 201 AND customer_address1.ca_state IN ('GA', 'VA'))) GROUP BY date_dim1.d_year, date_dim1.d_qoy, customer_address1.ca_county) AS t7, (SELECT customer_address2.ca_county, date_dim2.d_qoy, date_dim2.d_year, SUM(web_sales.ws_ext_sales_price) AS web_sales FROM web_sales, date_dim AS date_dim2, customer_address AS customer_address2, item AS item2 WHERE web_sales.ws_sold_date_sk = date_dim2.d_date_sk AND (web_sales.ws_bill_addr_sk = customer_address2.ca_address_sk AND web_sales.ws_item_sk = item2.i_item_sk) AND (item2.i_color IN ('brown', 'navy') AND (item2.i_manager_id >= 81 AND item2.i_manager_id <= 100) AND (web_sales.ws_list_price >= 187 AND web_sales.ws_list_price <= 201 AND customer_address2.ca_state IN ('GA', 'VA'))) GROUP BY date_dim2.d_year, date_dim2.d_qoy, customer_address2.ca_county) AS t10, (SELECT customer_address3.ca_county, date_dim3.d_qoy, date_dim3.d_year, SUM(web_sales0.ws_ext_sales_price) AS web_sales FROM web_sales AS web_sales0, date_dim AS date_dim3, customer_address AS customer_address3, item AS item3 WHERE web_sales0.ws_sold_date_sk = date_dim3.d_date_sk AND (web_sales0.ws_bill_addr_sk = customer_address3.ca_address_sk AND web_sales0.ws_item_sk = item3.i_item_sk) AND (item3.i_color IN ('brown', 'navy') AND (item3.i_manager_id >= 81 AND item3.i_manager_id <= 100) AND (web_sales0.ws_list_price >= 187 AND web_sales0.ws_list_price <= 201 AND customer_address3.ca_state IN ('GA', 'VA'))) GROUP BY date_dim3.d_year, date_dim3.d_qoy, customer_address3.ca_county) AS t13, (SELECT customer_address4.ca_county, date_dim4.d_qoy, date_dim4.d_year, SUM(web_sales1.ws_ext_sales_price) AS web_sales FROM web_sales AS web_sales1, date_dim AS date_dim4, customer_address AS customer_address4, item AS item4 WHERE web_sales1.ws_sold_date_sk = date_dim4.d_date_sk AND (web_sales1.ws_bill_addr_sk = customer_address4.ca_address_sk AND web_sales1.ws_item_sk = item4.i_item_sk) AND (item4.i_color IN ('brown', 'navy') AND (item4.i_manager_id >= 81 AND item4.i_manager_id <= 100) AND (web_sales1.ws_list_price >= 187 AND web_sales1.ws_list_price <= 201 AND customer_address4.ca_state IN ('GA', 'VA'))) GROUP BY date_dim4.d_year, date_dim4.d_qoy, customer_address4.ca_county) AS t16 WHERE t1.d_qoy = 1 AND t1.d_year = 1998 AND (t1.ca_county = t4.ca_county AND t4.d_qoy = 2) AND (t4.d_year = 1998 AND t4.ca_county = t7.ca_county AND (t7.d_qoy = 3 AND (t7.d_year = 1998 AND t1.ca_county = t10.ca_county))) AND (t10.d_qoy = 1 AND t10.d_year = 1998 AND (t10.ca_county = t13.ca_county AND (t13.d_qoy = 2 AND t13.d_year = 1998)) AND (t10.ca_county = t16.ca_county AND t16.d_qoy = 3 AND (t16.d_year = 1998 AND (CASE WHEN t1.store_sales > 0 THEN CASE WHEN t10.web_sales > 0 THEN t13.web_sales / t10.web_sales > t4.store_sales / t1.store_sales ELSE FALSE END ELSE FALSE END AND CASE WHEN t4.store_sales > 0 THEN CASE WHEN t13.web_sales > 0 THEN t16.web_sales / t13.web_sales > t7.store_sales / t4.store_sales ELSE FALSE END ELSE FALSE END)))) ORDER BY t4.store_sales / t1.store_sales;","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_REDUCE_EXPRESSIONS']",0.070011775,0.054555337,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
276,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('brown', 'steel') and i_manager_id BETWEEN 72 and 91 and ss_list_price between 221 and 235 and ca_state in ('MS','NE') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('brown', 'steel') and i_manager_id BETWEEN 72 and 91 and ws_list_price between 221 and 235 and ca_state in ('MS','NE') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2001 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2001 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2001 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2001 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2001 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2001 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;","SELECT t4.ca_county, t4.d_year, t28.web_sales / t22.web_sales AS web_q1_q2_increase, t10.store_sales / t4.store_sales AS store_q1_q2_increase, t34.web_sales / t28.web_sales AS web_q2_q3_increase, t16.store_sales / t10.store_sales AS store_q2_q3_increase FROM (SELECT t0.ca_county, date_dim.d_qoy, date_dim.d_year, SUM(t.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 221 AND ss_list_price <= 235) AS t INNER JOIN date_dim ON t.ss_sold_date_sk = date_dim.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('MS', 'NE')) AS t0 ON t.ss_addr_sk = t0.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('brown', 'steel') AND (i_manager_id >= 72 AND i_manager_id <= 91)) AS t1 ON t.ss_item_sk = t1.i_item_sk GROUP BY t0.ca_county, date_dim.d_qoy, date_dim.d_year HAVING date_dim.d_qoy = 1 AND date_dim.d_year = 2001) AS t4 INNER JOIN (SELECT t6.ca_county, date_dim0.d_qoy, date_dim0.d_year, SUM(t5.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 221 AND ss_list_price <= 235) AS t5 INNER JOIN date_dim AS date_dim0 ON t5.ss_sold_date_sk = date_dim0.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('MS', 'NE')) AS t6 ON t5.ss_addr_sk = t6.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('brown', 'steel') AND (i_manager_id >= 72 AND i_manager_id <= 91)) AS t7 ON t5.ss_item_sk = t7.i_item_sk GROUP BY t6.ca_county, date_dim0.d_qoy, date_dim0.d_year HAVING date_dim0.d_qoy = 2 AND date_dim0.d_year = 2001) AS t10 ON t4.ca_county = t10.ca_county INNER JOIN (SELECT t12.ca_county, date_dim1.d_qoy, date_dim1.d_year, SUM(t11.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 221 AND ss_list_price <= 235) AS t11 INNER JOIN date_dim AS date_dim1 ON t11.ss_sold_date_sk = date_dim1.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('MS', 'NE')) AS t12 ON t11.ss_addr_sk = t12.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('brown', 'steel') AND (i_manager_id >= 72 AND i_manager_id <= 91)) AS t13 ON t11.ss_item_sk = t13.i_item_sk GROUP BY t12.ca_county, date_dim1.d_qoy, date_dim1.d_year HAVING date_dim1.d_qoy = 3 AND date_dim1.d_year = 2001) AS t16 ON t10.ca_county = t16.ca_county INNER JOIN (SELECT t18.ca_county, date_dim2.d_qoy, date_dim2.d_year, SUM(t17.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 221 AND ws_list_price <= 235) AS t17 INNER JOIN date_dim AS date_dim2 ON t17.ws_sold_date_sk = date_dim2.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('MS', 'NE')) AS t18 ON t17.ws_bill_addr_sk = t18.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('brown', 'steel') AND (i_manager_id >= 72 AND i_manager_id <= 91)) AS t19 ON t17.ws_item_sk = t19.i_item_sk GROUP BY t18.ca_county, date_dim2.d_qoy, date_dim2.d_year HAVING date_dim2.d_qoy = 1 AND date_dim2.d_year = 2001) AS t22 ON t4.ca_county = t22.ca_county INNER JOIN (SELECT t24.ca_county, date_dim3.d_qoy, date_dim3.d_year, SUM(t23.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 221 AND ws_list_price <= 235) AS t23 INNER JOIN date_dim AS date_dim3 ON t23.ws_sold_date_sk = date_dim3.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('MS', 'NE')) AS t24 ON t23.ws_bill_addr_sk = t24.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('brown', 'steel') AND (i_manager_id >= 72 AND i_manager_id <= 91)) AS t25 ON t23.ws_item_sk = t25.i_item_sk GROUP BY t24.ca_county, date_dim3.d_qoy, date_dim3.d_year HAVING date_dim3.d_qoy = 2 AND date_dim3.d_year = 2001) AS t28 ON t22.ca_county = t28.ca_county AND CASE WHEN t4.store_sales > 0 THEN CASE WHEN t22.web_sales > 0 THEN t28.web_sales / t22.web_sales > t10.store_sales / t4.store_sales ELSE FALSE END ELSE FALSE END INNER JOIN (SELECT t30.ca_county, date_dim4.d_qoy, date_dim4.d_year, SUM(t29.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 221 AND ws_list_price <= 235) AS t29 INNER JOIN date_dim AS date_dim4 ON t29.ws_sold_date_sk = date_dim4.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('MS', 'NE')) AS t30 ON t29.ws_bill_addr_sk = t30.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('brown', 'steel') AND (i_manager_id >= 72 AND i_manager_id <= 91)) AS t31 ON t29.ws_item_sk = t31.i_item_sk GROUP BY t30.ca_county, date_dim4.d_qoy, date_dim4.d_year HAVING date_dim4.d_qoy = 3 AND date_dim4.d_year = 2001) AS t34 ON t22.ca_county = t34.ca_county AND CASE WHEN t10.store_sales > 0 THEN CASE WHEN t28.web_sales > 0 THEN t34.web_sales / t28.web_sales > t16.store_sales / t10.store_sales ELSE FALSE END ELSE FALSE END ORDER BY t16.store_sales / t10.store_sales","['FILTER_INTO_JOIN', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS']",0.093197823,0.092089891,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
277,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('chartreuse', 'moccasin') and i_manager_id BETWEEN 23 and 42 and ss_list_price between 229 and 243 and ca_state in ('NC','OH') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('chartreuse', 'moccasin') and i_manager_id BETWEEN 23 and 42 and ws_list_price between 229 and 243 and ca_state in ('NC','OH') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2001 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2001 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2001 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2001 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2001 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2001 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q1_q2_increase ;","SELECT t4.ca_county, t4.d_year, t28.web_sales / t22.web_sales AS web_q1_q2_increase, t10.store_sales / t4.store_sales AS store_q1_q2_increase, t34.web_sales / t28.web_sales AS web_q2_q3_increase, t16.store_sales / t10.store_sales AS store_q2_q3_increase FROM (SELECT t0.ca_county, date_dim.d_qoy, date_dim.d_year, SUM(t.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 229 AND ss_list_price <= 243) AS t INNER JOIN date_dim ON t.ss_sold_date_sk = date_dim.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('NC', 'OH')) AS t0 ON t.ss_addr_sk = t0.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('chartreuse', 'moccasin') AND (i_manager_id >= 23 AND i_manager_id <= 42)) AS t1 ON t.ss_item_sk = t1.i_item_sk GROUP BY t0.ca_county, date_dim.d_qoy, date_dim.d_year HAVING date_dim.d_qoy = 1 AND date_dim.d_year = 2001) AS t4 INNER JOIN (SELECT t6.ca_county, date_dim0.d_qoy, date_dim0.d_year, SUM(t5.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 229 AND ss_list_price <= 243) AS t5 INNER JOIN date_dim AS date_dim0 ON t5.ss_sold_date_sk = date_dim0.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('NC', 'OH')) AS t6 ON t5.ss_addr_sk = t6.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('chartreuse', 'moccasin') AND (i_manager_id >= 23 AND i_manager_id <= 42)) AS t7 ON t5.ss_item_sk = t7.i_item_sk GROUP BY t6.ca_county, date_dim0.d_qoy, date_dim0.d_year HAVING date_dim0.d_qoy = 2 AND date_dim0.d_year = 2001) AS t10 ON t4.ca_county = t10.ca_county INNER JOIN (SELECT t12.ca_county, date_dim1.d_qoy, date_dim1.d_year, SUM(t11.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 229 AND ss_list_price <= 243) AS t11 INNER JOIN date_dim AS date_dim1 ON t11.ss_sold_date_sk = date_dim1.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('NC', 'OH')) AS t12 ON t11.ss_addr_sk = t12.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('chartreuse', 'moccasin') AND (i_manager_id >= 23 AND i_manager_id <= 42)) AS t13 ON t11.ss_item_sk = t13.i_item_sk GROUP BY t12.ca_county, date_dim1.d_qoy, date_dim1.d_year HAVING date_dim1.d_qoy = 3 AND date_dim1.d_year = 2001) AS t16 ON t10.ca_county = t16.ca_county INNER JOIN (SELECT t18.ca_county, date_dim2.d_qoy, date_dim2.d_year, SUM(t17.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 229 AND ws_list_price <= 243) AS t17 INNER JOIN date_dim AS date_dim2 ON t17.ws_sold_date_sk = date_dim2.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('NC', 'OH')) AS t18 ON t17.ws_bill_addr_sk = t18.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('chartreuse', 'moccasin') AND (i_manager_id >= 23 AND i_manager_id <= 42)) AS t19 ON t17.ws_item_sk = t19.i_item_sk GROUP BY t18.ca_county, date_dim2.d_qoy, date_dim2.d_year HAVING date_dim2.d_qoy = 1 AND date_dim2.d_year = 2001) AS t22 ON t4.ca_county = t22.ca_county INNER JOIN (SELECT t24.ca_county, date_dim3.d_qoy, date_dim3.d_year, SUM(t23.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 229 AND ws_list_price <= 243) AS t23 INNER JOIN date_dim AS date_dim3 ON t23.ws_sold_date_sk = date_dim3.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('NC', 'OH')) AS t24 ON t23.ws_bill_addr_sk = t24.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('chartreuse', 'moccasin') AND (i_manager_id >= 23 AND i_manager_id <= 42)) AS t25 ON t23.ws_item_sk = t25.i_item_sk GROUP BY t24.ca_county, date_dim3.d_qoy, date_dim3.d_year HAVING date_dim3.d_qoy = 2 AND date_dim3.d_year = 2001) AS t28 ON t22.ca_county = t28.ca_county AND CASE WHEN t22.web_sales > 0 THEN t28.web_sales / t22.web_sales ELSE NULL END > CASE WHEN t4.store_sales > 0 THEN t10.store_sales / t4.store_sales ELSE NULL END INNER JOIN (SELECT t30.ca_county, date_dim4.d_qoy, date_dim4.d_year, SUM(t29.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 229 AND ws_list_price <= 243) AS t29 INNER JOIN date_dim AS date_dim4 ON t29.ws_sold_date_sk = date_dim4.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('NC', 'OH')) AS t30 ON t29.ws_bill_addr_sk = t30.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('chartreuse', 'moccasin') AND (i_manager_id >= 23 AND i_manager_id <= 42)) AS t31 ON t29.ws_item_sk = t31.i_item_sk GROUP BY t30.ca_county, date_dim4.d_qoy, date_dim4.d_year HAVING date_dim4.d_qoy = 3 AND date_dim4.d_year = 2001) AS t34 ON t22.ca_county = t34.ca_county AND CASE WHEN t28.web_sales > 0 THEN CAST(t34.web_sales / t28.web_sales AS DECIMAL(19, 0)) ELSE NULL END > CASE WHEN t10.store_sales > 0 THEN CAST(t16.store_sales / t10.store_sales AS DECIMAL(19, 0)) ELSE NULL END ORDER BY t28.web_sales / t22.web_sales","['FILTER_INTO_JOIN', 'FILTER_SET_OP_TRANSPOSE']",0.798597415,0.663448334,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
278,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('cream', 'slate') and i_manager_id BETWEEN 36 and 55 and ss_list_price between 139 and 153 and ca_state in ('IN','MI') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('cream', 'slate') and i_manager_id BETWEEN 36 and 55 and ws_list_price between 139 and 153 and ca_state in ('IN','MI') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.ca_county ;","SELECT t1.ca_county, t1.d_year, t13.web_sales / t10.web_sales AS web_q1_q2_increase, t4.store_sales / t1.store_sales AS store_q1_q2_increase, t16.web_sales / t13.web_sales AS web_q2_q3_increase, t7.store_sales / t4.store_sales AS store_q2_q3_increase FROM (SELECT customer_address.ca_county, date_dim.d_qoy, date_dim.d_year, SUM(store_sales.ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND (store_sales.ss_addr_sk = customer_address.ca_address_sk AND store_sales.ss_item_sk = item.i_item_sk) AND (item.i_color IN ('cream', 'slate') AND (item.i_manager_id >= 36 AND item.i_manager_id <= 55) AND (store_sales.ss_list_price >= 139 AND store_sales.ss_list_price <= 153 AND customer_address.ca_state IN ('IN', 'MI'))) GROUP BY date_dim.d_year, date_dim.d_qoy, customer_address.ca_county) AS t1, (SELECT customer_address0.ca_county, date_dim0.d_qoy, date_dim0.d_year, SUM(store_sales0.ss_ext_sales_price) AS store_sales FROM store_sales AS store_sales0, date_dim AS date_dim0, customer_address AS customer_address0, item AS item0 WHERE store_sales0.ss_sold_date_sk = date_dim0.d_date_sk AND (store_sales0.ss_addr_sk = customer_address0.ca_address_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (item0.i_color IN ('cream', 'slate') AND (item0.i_manager_id >= 36 AND item0.i_manager_id <= 55) AND (store_sales0.ss_list_price >= 139 AND store_sales0.ss_list_price <= 153 AND customer_address0.ca_state IN ('IN', 'MI'))) GROUP BY date_dim0.d_year, date_dim0.d_qoy, customer_address0.ca_county) AS t4, (SELECT customer_address1.ca_county, date_dim1.d_qoy, date_dim1.d_year, SUM(store_sales1.ss_ext_sales_price) AS store_sales FROM store_sales AS store_sales1, date_dim AS date_dim1, customer_address AS customer_address1, item AS item1 WHERE store_sales1.ss_sold_date_sk = date_dim1.d_date_sk AND (store_sales1.ss_addr_sk = customer_address1.ca_address_sk AND store_sales1.ss_item_sk = item1.i_item_sk) AND (item1.i_color IN ('cream', 'slate') AND (item1.i_manager_id >= 36 AND item1.i_manager_id <= 55) AND (store_sales1.ss_list_price >= 139 AND store_sales1.ss_list_price <= 153 AND customer_address1.ca_state IN ('IN', 'MI'))) GROUP BY date_dim1.d_year, date_dim1.d_qoy, customer_address1.ca_county) AS t7, (SELECT customer_address2.ca_county, date_dim2.d_qoy, date_dim2.d_year, SUM(web_sales.ws_ext_sales_price) AS web_sales FROM web_sales, date_dim AS date_dim2, customer_address AS customer_address2, item AS item2 WHERE web_sales.ws_sold_date_sk = date_dim2.d_date_sk AND (web_sales.ws_bill_addr_sk = customer_address2.ca_address_sk AND web_sales.ws_item_sk = item2.i_item_sk) AND (item2.i_color IN ('cream', 'slate') AND (item2.i_manager_id >= 36 AND item2.i_manager_id <= 55) AND (web_sales.ws_list_price >= 139 AND web_sales.ws_list_price <= 153 AND customer_address2.ca_state IN ('IN', 'MI'))) GROUP BY date_dim2.d_year, date_dim2.d_qoy, customer_address2.ca_county) AS t10, (SELECT customer_address3.ca_county, date_dim3.d_qoy, date_dim3.d_year, SUM(web_sales0.ws_ext_sales_price) AS web_sales FROM web_sales AS web_sales0, date_dim AS date_dim3, customer_address AS customer_address3, item AS item3 WHERE web_sales0.ws_sold_date_sk = date_dim3.d_date_sk AND (web_sales0.ws_bill_addr_sk = customer_address3.ca_address_sk AND web_sales0.ws_item_sk = item3.i_item_sk) AND (item3.i_color IN ('cream', 'slate') AND (item3.i_manager_id >= 36 AND item3.i_manager_id <= 55) AND (web_sales0.ws_list_price >= 139 AND web_sales0.ws_list_price <= 153 AND customer_address3.ca_state IN ('IN', 'MI'))) GROUP BY date_dim3.d_year, date_dim3.d_qoy, customer_address3.ca_county) AS t13, (SELECT customer_address4.ca_county, date_dim4.d_qoy, date_dim4.d_year, SUM(web_sales1.ws_ext_sales_price) AS web_sales FROM web_sales AS web_sales1, date_dim AS date_dim4, customer_address AS customer_address4, item AS item4 WHERE web_sales1.ws_sold_date_sk = date_dim4.d_date_sk AND (web_sales1.ws_bill_addr_sk = customer_address4.ca_address_sk AND web_sales1.ws_item_sk = item4.i_item_sk) AND (item4.i_color IN ('cream', 'slate') AND (item4.i_manager_id >= 36 AND item4.i_manager_id <= 55) AND (web_sales1.ws_list_price >= 139 AND web_sales1.ws_list_price <= 153 AND customer_address4.ca_state IN ('IN', 'MI'))) GROUP BY date_dim4.d_year, date_dim4.d_qoy, customer_address4.ca_county) AS t16 WHERE t1.d_qoy = 1 AND t1.d_year = 1999 AND (t1.ca_county = t4.ca_county AND t4.d_qoy = 2) AND (t4.d_year = 1999 AND t4.ca_county = t7.ca_county AND (t7.d_qoy = 3 AND (t7.d_year = 1999 AND t1.ca_county = t10.ca_county))) AND (t10.d_qoy = 1 AND t10.d_year = 1999 AND (t10.ca_county = t13.ca_county AND (t13.d_qoy = 2 AND t13.d_year = 1999)) AND (t10.ca_county = t16.ca_county AND t16.d_qoy = 3 AND (t16.d_year = 1999 AND (CASE WHEN t1.store_sales > 0 THEN CASE WHEN t10.web_sales > 0 THEN t13.web_sales / t10.web_sales > t4.store_sales / t1.store_sales ELSE FALSE END ELSE FALSE END AND CASE WHEN t4.store_sales > 0 THEN CASE WHEN t13.web_sales > 0 THEN t16.web_sales / t13.web_sales > t7.store_sales / t4.store_sales ELSE FALSE END ELSE FALSE END)))) ORDER BY t1.ca_county;","['FILTER_SCAN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'FILTER_MULTI_JOIN_MERGE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'FILTER_AGGREGATE_TRANSPOSE']",1.977299213,1.919639349,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
279,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('dark', 'steel') and i_manager_id BETWEEN 56 and 75 and ss_list_price between 195 and 209 and ca_state in ('AR','TX') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('dark', 'steel') and i_manager_id BETWEEN 56 and 75 and ws_list_price between 195 and 209 and ca_state in ('AR','TX') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.ca_county ;","SELECT t5186.ca_county, t5186.d_year, t5210.web_sales / t5204.web_sales AS web_q1_q2_increase, t5192.store_sales / t5186.store_sales AS store_q1_q2_increase, t5216.web_sales / t5210.web_sales AS web_q2_q3_increase, t5198.store_sales / t5192.store_sales AS store_q2_q3_increase FROM (SELECT t5182.ca_county, date_dim479.d_qoy, date_dim479.d_year, SUM(t5181.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 195 AND ss_list_price <= 209) AS t5181 INNER JOIN date_dim AS date_dim479 ON t5181.ss_sold_date_sk = date_dim479.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('AR', 'TX')) AS t5182 ON t5181.ss_addr_sk = t5182.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('dark', 'steel') AND (i_manager_id >= 56 AND i_manager_id <= 75)) AS t5183 ON t5181.ss_item_sk = t5183.i_item_sk WHERE date_dim479.d_qoy = 1 AND date_dim479.d_year = 2000 GROUP BY t5182.ca_county, date_dim479.d_qoy, date_dim479.d_year) AS t5186 INNER JOIN (SELECT t5188.ca_county, date_dim480.d_qoy, date_dim480.d_year, SUM(t5187.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 195 AND ss_list_price <= 209) AS t5187 INNER JOIN date_dim AS date_dim480 ON t5187.ss_sold_date_sk = date_dim480.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('AR', 'TX')) AS t5188 ON t5187.ss_addr_sk = t5188.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('dark', 'steel') AND (i_manager_id >= 56 AND i_manager_id <= 75)) AS t5189 ON t5187.ss_item_sk = t5189.i_item_sk WHERE date_dim480.d_qoy = 2 AND date_dim480.d_year = 2000 GROUP BY t5188.ca_county, date_dim480.d_qoy, date_dim480.d_year) AS t5192 ON t5186.ca_county = t5192.ca_county INNER JOIN (SELECT t5194.ca_county, date_dim481.d_qoy, date_dim481.d_year, SUM(t5193.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 195 AND ss_list_price <= 209) AS t5193 INNER JOIN date_dim AS date_dim481 ON t5193.ss_sold_date_sk = date_dim481.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('AR', 'TX')) AS t5194 ON t5193.ss_addr_sk = t5194.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('dark', 'steel') AND (i_manager_id >= 56 AND i_manager_id <= 75)) AS t5195 ON t5193.ss_item_sk = t5195.i_item_sk WHERE date_dim481.d_qoy = 3 AND date_dim481.d_year = 2000 GROUP BY t5194.ca_county, date_dim481.d_qoy, date_dim481.d_year) AS t5198 ON t5192.ca_county = t5198.ca_county INNER JOIN (SELECT t5200.ca_county, date_dim482.d_qoy, date_dim482.d_year, SUM(t5199.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 195 AND ws_list_price <= 209) AS t5199 INNER JOIN date_dim AS date_dim482 ON t5199.ws_sold_date_sk = date_dim482.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('AR', 'TX')) AS t5200 ON t5199.ws_bill_addr_sk = t5200.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('dark', 'steel') AND (i_manager_id >= 56 AND i_manager_id <= 75)) AS t5201 ON t5199.ws_item_sk = t5201.i_item_sk WHERE date_dim482.d_qoy = 1 AND date_dim482.d_year = 2000 GROUP BY t5200.ca_county, date_dim482.d_qoy, date_dim482.d_year) AS t5204 ON t5186.ca_county = t5204.ca_county INNER JOIN (SELECT t5206.ca_county, date_dim483.d_qoy, date_dim483.d_year, SUM(t5205.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 195 AND ws_list_price <= 209) AS t5205 INNER JOIN date_dim AS date_dim483 ON t5205.ws_sold_date_sk = date_dim483.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('AR', 'TX')) AS t5206 ON t5205.ws_bill_addr_sk = t5206.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('dark', 'steel') AND (i_manager_id >= 56 AND i_manager_id <= 75)) AS t5207 ON t5205.ws_item_sk = t5207.i_item_sk WHERE date_dim483.d_qoy = 2 AND date_dim483.d_year = 2000 GROUP BY t5206.ca_county, date_dim483.d_qoy, date_dim483.d_year) AS t5210 ON t5204.ca_county = t5210.ca_county AND CASE WHEN t5204.web_sales > 0 THEN t5210.web_sales / t5204.web_sales ELSE NULL END > CASE WHEN t5186.store_sales > 0 THEN t5192.store_sales / t5186.store_sales ELSE NULL END INNER JOIN (SELECT t5212.ca_county, date_dim484.d_qoy, date_dim484.d_year, SUM(t5211.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 195 AND ws_list_price <= 209) AS t5211 INNER JOIN date_dim AS date_dim484 ON t5211.ws_sold_date_sk = date_dim484.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('AR', 'TX')) AS t5212 ON t5211.ws_bill_addr_sk = t5212.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('dark', 'steel') AND (i_manager_id >= 56 AND i_manager_id <= 75)) AS t5213 ON t5211.ws_item_sk = t5213.i_item_sk WHERE date_dim484.d_qoy = 3 AND date_dim484.d_year = 2000 GROUP BY t5212.ca_county, date_dim484.d_qoy, date_dim484.d_year) AS t5216 ON t5204.ca_county = t5216.ca_county AND CASE WHEN t5210.web_sales > 0 THEN t5216.web_sales / t5210.web_sales ELSE NULL END > CASE WHEN t5192.store_sales > 0 THEN t5198.store_sales / t5192.store_sales ELSE NULL END ORDER BY t5186.ca_county","['PROJECT_TO_CALC', 'FILTER_INTO_JOIN']",0.156023343,0.145089149,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
280,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('forest', 'orange') and i_manager_id BETWEEN 81 and 100 and ss_list_price between 15 and 29 and ca_state in ('GA','MN') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('forest', 'orange') and i_manager_id BETWEEN 81 and 100 and ws_list_price between 15 and 29 and ca_state in ('GA','MN') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q1_q2_increase ;","SELECT t1.ca_county, t1.d_year, t13.web_sales / t10.web_sales AS web_q1_q2_increase, t4.store_sales / t1.store_sales AS store_q1_q2_increase, t16.web_sales / t13.web_sales AS web_q2_q3_increase, t7.store_sales / t4.store_sales AS store_q2_q3_increase FROM (SELECT customer_address.ca_county, date_dim.d_qoy, date_dim.d_year, SUM(store_sales.ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND (store_sales.ss_addr_sk = customer_address.ca_address_sk AND store_sales.ss_item_sk = item.i_item_sk) AND (item.i_color IN ('forest', 'orange') AND (item.i_manager_id >= 81 AND item.i_manager_id <= 100) AND (store_sales.ss_list_price >= 15 AND store_sales.ss_list_price <= 29 AND customer_address.ca_state IN ('GA', 'MN'))) GROUP BY date_dim.d_year, date_dim.d_qoy, customer_address.ca_county) AS t1, (SELECT customer_address0.ca_county, date_dim0.d_qoy, date_dim0.d_year, SUM(store_sales0.ss_ext_sales_price) AS store_sales FROM store_sales AS store_sales0, date_dim AS date_dim0, customer_address AS customer_address0, item AS item0 WHERE store_sales0.ss_sold_date_sk = date_dim0.d_date_sk AND (store_sales0.ss_addr_sk = customer_address0.ca_address_sk AND store_sales0.ss_item_sk = item0.i_item_sk) AND (item0.i_color IN ('forest', 'orange') AND (item0.i_manager_id >= 81 AND item0.i_manager_id <= 100) AND (store_sales0.ss_list_price >= 15 AND store_sales0.ss_list_price <= 29 AND customer_address0.ca_state IN ('GA', 'MN'))) GROUP BY date_dim0.d_year, date_dim0.d_qoy, customer_address0.ca_county) AS t4, (SELECT customer_address1.ca_county, date_dim1.d_qoy, date_dim1.d_year, SUM(store_sales1.ss_ext_sales_price) AS store_sales FROM store_sales AS store_sales1, date_dim AS date_dim1, customer_address AS customer_address1, item AS item1 WHERE store_sales1.ss_sold_date_sk = date_dim1.d_date_sk AND (store_sales1.ss_addr_sk = customer_address1.ca_address_sk AND store_sales1.ss_item_sk = item1.i_item_sk) AND (item1.i_color IN ('forest', 'orange') AND (item1.i_manager_id >= 81 AND item1.i_manager_id <= 100) AND (store_sales1.ss_list_price >= 15 AND store_sales1.ss_list_price <= 29 AND customer_address1.ca_state IN ('GA', 'MN'))) GROUP BY date_dim1.d_year, date_dim1.d_qoy, customer_address1.ca_county) AS t7, (SELECT customer_address2.ca_county, date_dim2.d_qoy, date_dim2.d_year, SUM(web_sales.ws_ext_sales_price) AS web_sales FROM web_sales, date_dim AS date_dim2, customer_address AS customer_address2, item AS item2 WHERE web_sales.ws_sold_date_sk = date_dim2.d_date_sk AND (web_sales.ws_bill_addr_sk = customer_address2.ca_address_sk AND web_sales.ws_item_sk = item2.i_item_sk) AND (item2.i_color IN ('forest', 'orange') AND (item2.i_manager_id >= 81 AND item2.i_manager_id <= 100) AND (web_sales.ws_list_price >= 15 AND web_sales.ws_list_price <= 29 AND customer_address2.ca_state IN ('GA', 'MN'))) GROUP BY date_dim2.d_year, date_dim2.d_qoy, customer_address2.ca_county) AS t10, (SELECT customer_address3.ca_county, date_dim3.d_qoy, date_dim3.d_year, SUM(web_sales0.ws_ext_sales_price) AS web_sales FROM web_sales AS web_sales0, date_dim AS date_dim3, customer_address AS customer_address3, item AS item3 WHERE web_sales0.ws_sold_date_sk = date_dim3.d_date_sk AND (web_sales0.ws_bill_addr_sk = customer_address3.ca_address_sk AND web_sales0.ws_item_sk = item3.i_item_sk) AND (item3.i_color IN ('forest', 'orange') AND (item3.i_manager_id >= 81 AND item3.i_manager_id <= 100) AND (web_sales0.ws_list_price >= 15 AND web_sales0.ws_list_price <= 29 AND customer_address3.ca_state IN ('GA', 'MN'))) GROUP BY date_dim3.d_year, date_dim3.d_qoy, customer_address3.ca_county) AS t13, (SELECT customer_address4.ca_county, date_dim4.d_qoy, date_dim4.d_year, SUM(web_sales1.ws_ext_sales_price) AS web_sales FROM web_sales AS web_sales1, date_dim AS date_dim4, customer_address AS customer_address4, item AS item4 WHERE web_sales1.ws_sold_date_sk = date_dim4.d_date_sk AND (web_sales1.ws_bill_addr_sk = customer_address4.ca_address_sk AND web_sales1.ws_item_sk = item4.i_item_sk) AND (item4.i_color IN ('forest', 'orange') AND (item4.i_manager_id >= 81 AND item4.i_manager_id <= 100) AND (web_sales1.ws_list_price >= 15 AND web_sales1.ws_list_price <= 29 AND customer_address4.ca_state IN ('GA', 'MN'))) GROUP BY date_dim4.d_year, date_dim4.d_qoy, customer_address4.ca_county) AS t16 WHERE t1.d_qoy = 1 AND t1.d_year = 1999 AND (t1.ca_county = t4.ca_county AND t4.d_qoy = 2) AND (t4.d_year = 1999 AND t4.ca_county = t7.ca_county AND (t7.d_qoy = 3 AND (t7.d_year = 1999 AND t1.ca_county = t10.ca_county))) AND (t10.d_qoy = 1 AND t10.d_year = 1999 AND (t10.ca_county = t13.ca_county AND (t13.d_qoy = 2 AND t13.d_year = 1999)) AND (t10.ca_county = t16.ca_county AND t16.d_qoy = 3 AND (t16.d_year = 1999 AND (CASE WHEN t1.store_sales > 0 THEN CASE WHEN t10.web_sales > 0 THEN t13.web_sales / t10.web_sales > t4.store_sales / t1.store_sales ELSE FALSE END ELSE FALSE END AND CASE WHEN t4.store_sales > 0 THEN CASE WHEN t13.web_sales > 0 THEN t16.web_sales / t13.web_sales > t7.store_sales / t4.store_sales ELSE FALSE END ELSE FALSE END)))) ORDER BY t4.store_sales / t1.store_sales;","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE']",0.059433699,0.057216009,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
281,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('maroon', 'wheat') and i_manager_id BETWEEN 81 and 100 and ss_list_price between 106 and 120 and ca_state in ('GA','UT') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('maroon', 'wheat') and i_manager_id BETWEEN 81 and 100 and ws_list_price between 106 and 120 and ca_state in ('GA','UT') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q1_q2_increase ;","SELECT t1.ca_county, t1.d_year, t13.web_sales / t10.web_sales AS web_q1_q2_increase, t4.store_sales / t1.store_sales AS store_q1_q2_increase, t16.web_sales / t13.web_sales AS web_q2_q3_increase, t7.store_sales / t4.store_sales AS store_q2_q3_increase FROM (SELECT customer_address.ca_county, date_dim.d_qoy, date_dim.d_year, SUM(store_sales.ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_addr_sk = customer_address.ca_address_sk AND (store_sales.ss_item_sk = item.i_item_sk AND (item.i_color = 'maroon' OR item.i_color = 'wheat')) AND (item.i_manager_id >= 81 AND item.i_manager_id <= 100 AND (store_sales.ss_list_price >= 106 AND (store_sales.ss_list_price <= 120 AND (customer_address.ca_state = 'GA' OR customer_address.ca_state = 'UT')))) GROUP BY date_dim.d_year, date_dim.d_qoy, customer_address.ca_county) AS t1, (SELECT customer_address0.ca_county, date_dim0.d_qoy, date_dim0.d_year, SUM(store_sales0.ss_ext_sales_price) AS store_sales FROM store_sales AS store_sales0, date_dim AS date_dim0, customer_address AS customer_address0, item AS item0 WHERE store_sales0.ss_sold_date_sk = date_dim0.d_date_sk AND store_sales0.ss_addr_sk = customer_address0.ca_address_sk AND (store_sales0.ss_item_sk = item0.i_item_sk AND (item0.i_color = 'maroon' OR item0.i_color = 'wheat')) AND (item0.i_manager_id >= 81 AND item0.i_manager_id <= 100 AND (store_sales0.ss_list_price >= 106 AND (store_sales0.ss_list_price <= 120 AND (customer_address0.ca_state = 'GA' OR customer_address0.ca_state = 'UT')))) GROUP BY date_dim0.d_year, date_dim0.d_qoy, customer_address0.ca_county) AS t4, (SELECT customer_address1.ca_county, date_dim1.d_qoy, date_dim1.d_year, SUM(store_sales1.ss_ext_sales_price) AS store_sales FROM store_sales AS store_sales1, date_dim AS date_dim1, customer_address AS customer_address1, item AS item1 WHERE store_sales1.ss_sold_date_sk = date_dim1.d_date_sk AND store_sales1.ss_addr_sk = customer_address1.ca_address_sk AND (store_sales1.ss_item_sk = item1.i_item_sk AND (item1.i_color = 'maroon' OR item1.i_color = 'wheat')) AND (item1.i_manager_id >= 81 AND item1.i_manager_id <= 100 AND (store_sales1.ss_list_price >= 106 AND (store_sales1.ss_list_price <= 120 AND (customer_address1.ca_state = 'GA' OR customer_address1.ca_state = 'UT')))) GROUP BY date_dim1.d_year, date_dim1.d_qoy, customer_address1.ca_county) AS t7, (SELECT customer_address2.ca_county, date_dim2.d_qoy, date_dim2.d_year, SUM(web_sales.ws_ext_sales_price) AS web_sales FROM web_sales, date_dim AS date_dim2, customer_address AS customer_address2, item AS item2 WHERE web_sales.ws_sold_date_sk = date_dim2.d_date_sk AND web_sales.ws_bill_addr_sk = customer_address2.ca_address_sk AND (web_sales.ws_item_sk = item2.i_item_sk AND (item2.i_color = 'maroon' OR item2.i_color = 'wheat')) AND (item2.i_manager_id >= 81 AND item2.i_manager_id <= 100 AND (web_sales.ws_list_price >= 106 AND (web_sales.ws_list_price <= 120 AND (customer_address2.ca_state = 'GA' OR customer_address2.ca_state = 'UT')))) GROUP BY date_dim2.d_year, date_dim2.d_qoy, customer_address2.ca_county) AS t10, (SELECT customer_address3.ca_county, date_dim3.d_qoy, date_dim3.d_year, SUM(web_sales0.ws_ext_sales_price) AS web_sales FROM web_sales AS web_sales0, date_dim AS date_dim3, customer_address AS customer_address3, item AS item3 WHERE web_sales0.ws_sold_date_sk = date_dim3.d_date_sk AND web_sales0.ws_bill_addr_sk = customer_address3.ca_address_sk AND (web_sales0.ws_item_sk = item3.i_item_sk AND (item3.i_color = 'maroon' OR item3.i_color = 'wheat')) AND (item3.i_manager_id >= 81 AND item3.i_manager_id <= 100 AND (web_sales0.ws_list_price >= 106 AND (web_sales0.ws_list_price <= 120 AND (customer_address3.ca_state = 'GA' OR customer_address3.ca_state = 'UT')))) GROUP BY date_dim3.d_year, date_dim3.d_qoy, customer_address3.ca_county) AS t13, (SELECT customer_address4.ca_county, date_dim4.d_qoy, date_dim4.d_year, SUM(web_sales1.ws_ext_sales_price) AS web_sales FROM web_sales AS web_sales1, date_dim AS date_dim4, customer_address AS customer_address4, item AS item4 WHERE web_sales1.ws_sold_date_sk = date_dim4.d_date_sk AND web_sales1.ws_bill_addr_sk = customer_address4.ca_address_sk AND (web_sales1.ws_item_sk = item4.i_item_sk AND (item4.i_color = 'maroon' OR item4.i_color = 'wheat')) AND (item4.i_manager_id >= 81 AND item4.i_manager_id <= 100 AND (web_sales1.ws_list_price >= 106 AND (web_sales1.ws_list_price <= 120 AND (customer_address4.ca_state = 'GA' OR customer_address4.ca_state = 'UT')))) GROUP BY date_dim4.d_year, date_dim4.d_qoy, customer_address4.ca_county) AS t16 WHERE t1.d_qoy = 1 AND t1.d_year = 1998 AND (t1.ca_county = t4.ca_county AND t4.d_qoy = 2) AND (t4.d_year = 1998 AND t4.ca_county = t7.ca_county AND (t7.d_qoy = 3 AND (t7.d_year = 1998 AND t1.ca_county = t10.ca_county))) AND (t10.d_qoy = 1 AND t10.d_year = 1998 AND (t10.ca_county = t13.ca_county AND (t13.d_qoy = 2 AND t13.d_year = 1998)) AND (t10.ca_county = t16.ca_county AND t16.d_qoy = 3 AND (t16.d_year = 1998 AND (CASE WHEN t10.web_sales > 0 THEN CAST(t13.web_sales / t10.web_sales AS DECIMAL(19, 0)) ELSE NULL END > CASE WHEN t1.store_sales > 0 THEN CAST(t4.store_sales / t1.store_sales AS DECIMAL(19, 0)) ELSE NULL END AND CASE WHEN t13.web_sales > 0 THEN CAST(t16.web_sales / t13.web_sales AS DECIMAL(19, 0)) ELSE NULL END > CASE WHEN t4.store_sales > 0 THEN CAST(t7.store_sales / t4.store_sales AS DECIMAL(19, 0)) ELSE NULL END)))) ORDER BY t13.web_sales / t10.web_sales","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'SORT_JOIN_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']",2.589369059,0.224712769,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
282,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('mint', 'sandy') and i_manager_id BETWEEN 5 and 24 and ss_list_price between 278 and 292 and ca_state in ('AR','GA') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('mint', 'sandy') and i_manager_id BETWEEN 5 and 24 and ws_list_price between 278 and 292 and ca_state in ('AR','GA') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year ;","SELECT t1.ca_county, t1.d_year, t13.web_sales / t10.web_sales AS web_q1_q2_increase, t4.store_sales / t1.store_sales AS store_q1_q2_increase, t16.web_sales / t13.web_sales AS web_q2_q3_increase, t7.store_sales / t4.store_sales AS store_q2_q3_increase FROM (SELECT customer_address.ca_county, date_dim.d_qoy, date_dim.d_year, SUM(store_sales.ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_addr_sk = customer_address.ca_address_sk AND (store_sales.ss_item_sk = item.i_item_sk AND (item.i_color = 'mint' OR item.i_color = 'sandy')) AND (item.i_manager_id >= 5 AND item.i_manager_id <= 24 AND (store_sales.ss_list_price >= 278 AND (store_sales.ss_list_price <= 292 AND (customer_address.ca_state = 'AR' OR customer_address.ca_state = 'GA')))) GROUP BY date_dim.d_year, date_dim.d_qoy, customer_address.ca_county) AS t1, (SELECT customer_address0.ca_county, date_dim0.d_qoy, date_dim0.d_year, SUM(store_sales0.ss_ext_sales_price) AS store_sales FROM store_sales AS store_sales0, date_dim AS date_dim0, customer_address AS customer_address0, item AS item0 WHERE store_sales0.ss_sold_date_sk = date_dim0.d_date_sk AND store_sales0.ss_addr_sk = customer_address0.ca_address_sk AND (store_sales0.ss_item_sk = item0.i_item_sk AND (item0.i_color = 'mint' OR item0.i_color = 'sandy')) AND (item0.i_manager_id >= 5 AND item0.i_manager_id <= 24 AND (store_sales0.ss_list_price >= 278 AND (store_sales0.ss_list_price <= 292 AND (customer_address0.ca_state = 'AR' OR customer_address0.ca_state = 'GA')))) GROUP BY date_dim0.d_year, date_dim0.d_qoy, customer_address0.ca_county) AS t4, (SELECT customer_address1.ca_county, date_dim1.d_qoy, date_dim1.d_year, SUM(store_sales1.ss_ext_sales_price) AS store_sales FROM store_sales AS store_sales1, date_dim AS date_dim1, customer_address AS customer_address1, item AS item1 WHERE store_sales1.ss_sold_date_sk = date_dim1.d_date_sk AND store_sales1.ss_addr_sk = customer_address1.ca_address_sk AND (store_sales1.ss_item_sk = item1.i_item_sk AND (item1.i_color = 'mint' OR item1.i_color = 'sandy')) AND (item1.i_manager_id >= 5 AND item1.i_manager_id <= 24 AND (store_sales1.ss_list_price >= 278 AND (store_sales1.ss_list_price <= 292 AND (customer_address1.ca_state = 'AR' OR customer_address1.ca_state = 'GA')))) GROUP BY date_dim1.d_year, date_dim1.d_qoy, customer_address1.ca_county) AS t7, (SELECT customer_address2.ca_county, date_dim2.d_qoy, date_dim2.d_year, SUM(web_sales.ws_ext_sales_price) AS web_sales FROM web_sales, date_dim AS date_dim2, customer_address AS customer_address2, item AS item2 WHERE web_sales.ws_sold_date_sk = date_dim2.d_date_sk AND web_sales.ws_bill_addr_sk = customer_address2.ca_address_sk AND (web_sales.ws_item_sk = item2.i_item_sk AND (item2.i_color = 'mint' OR item2.i_color = 'sandy')) AND (item2.i_manager_id >= 5 AND item2.i_manager_id <= 24 AND (web_sales.ws_list_price >= 278 AND (web_sales.ws_list_price <= 292 AND (customer_address2.ca_state = 'AR' OR customer_address2.ca_state = 'GA')))) GROUP BY date_dim2.d_year, date_dim2.d_qoy, customer_address2.ca_county) AS t10, (SELECT customer_address3.ca_county, date_dim3.d_qoy, date_dim3.d_year, SUM(web_sales0.ws_ext_sales_price) AS web_sales FROM web_sales AS web_sales0, date_dim AS date_dim3, customer_address AS customer_address3, item AS item3 WHERE web_sales0.ws_sold_date_sk = date_dim3.d_date_sk AND web_sales0.ws_bill_addr_sk = customer_address3.ca_address_sk AND (web_sales0.ws_item_sk = item3.i_item_sk AND (item3.i_color = 'mint' OR item3.i_color = 'sandy')) AND (item3.i_manager_id >= 5 AND item3.i_manager_id <= 24 AND (web_sales0.ws_list_price >= 278 AND (web_sales0.ws_list_price <= 292 AND (customer_address3.ca_state = 'AR' OR customer_address3.ca_state = 'GA')))) GROUP BY date_dim3.d_year, date_dim3.d_qoy, customer_address3.ca_county) AS t13, (SELECT customer_address4.ca_county, date_dim4.d_qoy, date_dim4.d_year, SUM(web_sales1.ws_ext_sales_price) AS web_sales FROM web_sales AS web_sales1, date_dim AS date_dim4, customer_address AS customer_address4, item AS item4 WHERE web_sales1.ws_sold_date_sk = date_dim4.d_date_sk AND web_sales1.ws_bill_addr_sk = customer_address4.ca_address_sk AND (web_sales1.ws_item_sk = item4.i_item_sk AND (item4.i_color = 'mint' OR item4.i_color = 'sandy')) AND (item4.i_manager_id >= 5 AND item4.i_manager_id <= 24 AND (web_sales1.ws_list_price >= 278 AND (web_sales1.ws_list_price <= 292 AND (customer_address4.ca_state = 'AR' OR customer_address4.ca_state = 'GA')))) GROUP BY date_dim4.d_year, date_dim4.d_qoy, customer_address4.ca_county) AS t16 WHERE t1.d_qoy = 1 AND t1.d_year = 2000 AND (t1.ca_county = t4.ca_county AND t4.d_qoy = 2) AND (t4.d_year = 2000 AND t4.ca_county = t7.ca_county AND (t7.d_qoy = 3 AND (t7.d_year = 2000 AND t1.ca_county = t10.ca_county))) AND (t10.d_qoy = 1 AND t10.d_year = 2000 AND (t10.ca_county = t13.ca_county AND (t13.d_qoy = 2 AND t13.d_year = 2000)) AND (t10.ca_county = t16.ca_county AND t16.d_qoy = 3 AND (t16.d_year = 2000 AND (CASE WHEN t10.web_sales > 0 THEN CAST(t13.web_sales / t10.web_sales AS DECIMAL(19, 0)) ELSE NULL END > CASE WHEN t1.store_sales > 0 THEN CAST(t4.store_sales / t1.store_sales AS DECIMAL(19, 0)) ELSE NULL END AND CASE WHEN t13.web_sales > 0 THEN CAST(t16.web_sales / t13.web_sales AS DECIMAL(19, 0)) ELSE NULL END > CASE WHEN t4.store_sales > 0 THEN CAST(t7.store_sales / t4.store_sales AS DECIMAL(19, 0)) ELSE NULL END)))) ORDER BY t1.d_year;","['FILTER_SCAN', 'AGGREGATE_PROJECT_MERGE']",1.17997702,0.405446291,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
283,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('orchid', 'pale') and i_manager_id BETWEEN 49 and 68 and ss_list_price between 210 and 224 and ca_state in ('AR','IL') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('orchid', 'pale') and i_manager_id BETWEEN 49 and 68 and ws_list_price between 210 and 224 and ca_state in ('AR','IL') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q2_q3_increase ;","SELECT ca_county, d_year, web_sales0 / web_sales AS web_q1_q2_increase, store_sales0 / store_sales AS store_q1_q2_increase, web_sales1 / web_sales0 AS web_q2_q3_increase, store_sales1 / store_sales0 AS store_q2_q3_increase FROM (SELECT t0.ca_county, t0.d_qoy, t0.d_year, t0.store_sales, t2.ca_county AS ca_county0, t2.d_qoy AS d_qoy0, t2.d_year AS d_year0, t2.store_sales AS store_sales0, t4.ca_county AS ca_county1, t4.d_qoy AS d_qoy1, t4.d_year AS d_year1, t4.store_sales AS store_sales1, t6.ca_county AS ca_county2, t6.d_qoy AS d_qoy2, t6.d_year AS d_year2, t6.web_sales, t8.ca_county AS ca_county3, t8.d_qoy AS d_qoy3, t8.d_year AS d_year3, t8.web_sales AS web_sales0, t10.ca_county AS ca_county4, t10.d_qoy AS d_qoy4, t10.d_year AS d_year4, t10.web_sales AS web_sales1 FROM (SELECT date_dim.d_year, date_dim.d_qoy, customer_address.ca_county, SUM(store_sales.ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address, item WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_addr_sk = customer_address.ca_address_sk AND (store_sales.ss_item_sk = item.i_item_sk AND (item.i_color = 'orchid' OR item.i_color = 'pale')) AND (item.i_manager_id >= 49 AND item.i_manager_id <= 68 AND (store_sales.ss_list_price >= 210 AND (store_sales.ss_list_price <= 224 AND (customer_address.ca_state = 'AR' OR customer_address.ca_state = 'IL')))) GROUP BY date_dim.d_year, date_dim.d_qoy, customer_address.ca_county) AS t0, (SELECT date_dim0.d_year, date_dim0.d_qoy, customer_address0.ca_county, SUM(store_sales0.ss_ext_sales_price) AS store_sales FROM store_sales AS store_sales0, date_dim AS date_dim0, customer_address AS customer_address0, item AS item0 WHERE store_sales0.ss_sold_date_sk = date_dim0.d_date_sk AND store_sales0.ss_addr_sk = customer_address0.ca_address_sk AND (store_sales0.ss_item_sk = item0.i_item_sk AND (item0.i_color = 'orchid' OR item0.i_color = 'pale')) AND (item0.i_manager_id >= 49 AND item0.i_manager_id <= 68 AND (store_sales0.ss_list_price >= 210 AND (store_sales0.ss_list_price <= 224 AND (customer_address0.ca_state = 'AR' OR customer_address0.ca_state = 'IL')))) GROUP BY date_dim0.d_year, date_dim0.d_qoy, customer_address0.ca_county) AS t2, (SELECT date_dim1.d_year, date_dim1.d_qoy, customer_address1.ca_county, SUM(store_sales1.ss_ext_sales_price) AS store_sales FROM store_sales AS store_sales1, date_dim AS date_dim1, customer_address AS customer_address1, item AS item1 WHERE store_sales1.ss_sold_date_sk = date_dim1.d_date_sk AND store_sales1.ss_addr_sk = customer_address1.ca_address_sk AND (store_sales1.ss_item_sk = item1.i_item_sk AND (item1.i_color = 'orchid' OR item1.i_color = 'pale')) AND (item1.i_manager_id >= 49 AND item1.i_manager_id <= 68 AND (store_sales1.ss_list_price >= 210 AND (store_sales1.ss_list_price <= 224 AND (customer_address1.ca_state = 'AR' OR customer_address1.ca_state = 'IL')))) GROUP BY date_dim1.d_year, date_dim1.d_qoy, customer_address1.ca_county) AS t4, (SELECT date_dim2.d_year, date_dim2.d_qoy, customer_address2.ca_county, SUM(web_sales.ws_ext_sales_price) AS web_sales FROM web_sales, date_dim AS date_dim2, customer_address AS customer_address2, item AS item2 WHERE web_sales.ws_sold_date_sk = date_dim2.d_date_sk AND web_sales.ws_bill_addr_sk = customer_address2.ca_address_sk AND (web_sales.ws_item_sk = item2.i_item_sk AND (item2.i_color = 'orchid' OR item2.i_color = 'pale')) AND (item2.i_manager_id >= 49 AND item2.i_manager_id <= 68 AND (web_sales.ws_list_price >= 210 AND (web_sales.ws_list_price <= 224 AND (customer_address2.ca_state = 'AR' OR customer_address2.ca_state = 'IL')))) GROUP BY date_dim2.d_year, date_dim2.d_qoy, customer_address2.ca_county) AS t6, (SELECT date_dim3.d_year, date_dim3.d_qoy, customer_address3.ca_county, SUM(web_sales0.ws_ext_sales_price) AS web_sales FROM web_sales AS web_sales0, date_dim AS date_dim3, customer_address AS customer_address3, item AS item3 WHERE web_sales0.ws_sold_date_sk = date_dim3.d_date_sk AND web_sales0.ws_bill_addr_sk = customer_address3.ca_address_sk AND (web_sales0.ws_item_sk = item3.i_item_sk AND (item3.i_color = 'orchid' OR item3.i_color = 'pale')) AND (item3.i_manager_id >= 49 AND item3.i_manager_id <= 68 AND (web_sales0.ws_list_price >= 210 AND (web_sales0.ws_list_price <= 224 AND (customer_address3.ca_state = 'AR' OR customer_address3.ca_state = 'IL')))) GROUP BY date_dim3.d_year, date_dim3.d_qoy, customer_address3.ca_county) AS t8, (SELECT date_dim4.d_year, date_dim4.d_qoy, customer_address4.ca_county, SUM(web_sales1.ws_ext_sales_price) AS web_sales FROM web_sales AS web_sales1, date_dim AS date_dim4, customer_address AS customer_address4, item AS item4 WHERE web_sales1.ws_sold_date_sk = date_dim4.d_date_sk AND web_sales1.ws_bill_addr_sk = customer_address4.ca_address_sk AND (web_sales1.ws_item_sk = item4.i_item_sk AND (item4.i_color = 'orchid' OR item4.i_color = 'pale')) AND (item4.i_manager_id >= 49 AND item4.i_manager_id <= 68 AND (web_sales1.ws_list_price >= 210 AND (web_sales1.ws_list_price <= 224 AND (customer_address4.ca_state = 'AR' OR customer_address4.ca_state = 'IL')))) GROUP BY date_dim4.d_year, date_dim4.d_qoy, customer_address4.ca_county) AS t10) AS t11 WHERE t11.d_qoy = 1 AND t11.d_year = 1999 AND (t11.ca_county = t11.ca_county0 AND t11.d_qoy0 = 2) AND (t11.d_year0 = 1999 AND t11.ca_county0 = t11.ca_county1 AND (t11.d_qoy1 = 3 AND (t11.d_year1 = 1999 AND t11.ca_county = t11.ca_county2))) AND (t11.d_qoy2 = 1 AND t11.d_year2 = 1999 AND (t11.ca_county2 = t11.ca_county3 AND (t11.d_qoy3 = 2 AND t11.d_year3 = 1999)) AND (t11.ca_county2 = t11.ca_county4 AND t11.d_qoy4 = 3 AND (t11.d_year4 = 1999 AND (CASE WHEN t11.web_sales > 0 THEN CAST(t11.web_sales0 / t11.web_sales AS DECIMAL(19, 0)) ELSE NULL END > CASE WHEN t11.store_sales > 0 THEN CAST(t11.store_sales0 / t11.store_sales AS DECIMAL(19, 0)) ELSE NULL END AND CASE WHEN t11.web_sales0 > 0 THEN CAST(t11.web_sales1 / t11.web_sales0 AS DECIMAL(19, 0)) ELSE NULL END > CASE WHEN t11.store_sales0 > 0 THEN CAST(t11.store_sales1 / t11.store_sales0 AS DECIMAL(19, 0)) ELSE NULL END)))) ORDER BY web_sales1 / web_sales0;","['FILTER_SCAN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_JOIN_TRANSPOSE']",8.239730676,8.176733573,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
284,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('peru', 'sandy') and i_manager_id BETWEEN 10 and 29 and ss_list_price between 166 and 180 and ca_state in ('MO','VT') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('peru', 'sandy') and i_manager_id BETWEEN 10 and 29 and ws_list_price between 166 and 180 and ca_state in ('MO','VT') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year ;","SELECT t4266.ca_county, t4266.d_year, t4290.web_sales / t4284.web_sales AS web_q1_q2_increase, t4272.store_sales / t4266.store_sales AS store_q1_q2_increase, t4296.web_sales / t4290.web_sales AS web_q2_q3_increase, t4278.store_sales / t4272.store_sales AS store_q2_q3_increase FROM (SELECT t4263.ca_county, t4262.d_qoy, t4262.d_year, SUM(t4261.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 166 AND ss_list_price <= 180) AS t4261 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 1 AND d_year = 1998) AS t4262 ON t4261.ss_sold_date_sk = t4262.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('MO', 'VT')) AS t4263 ON t4261.ss_addr_sk = t4263.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('peru', 'sandy') AND (i_manager_id >= 10 AND i_manager_id <= 29)) AS t4264 ON t4261.ss_item_sk = t4264.i_item_sk GROUP BY t4263.ca_county, t4262.d_qoy, t4262.d_year) AS t4266 INNER JOIN (SELECT t4269.ca_county, t4268.d_qoy, t4268.d_year, SUM(t4267.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 166 AND ss_list_price <= 180) AS t4267 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 2 AND d_year = 1998) AS t4268 ON t4267.ss_sold_date_sk = t4268.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('MO', 'VT')) AS t4269 ON t4267.ss_addr_sk = t4269.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('peru', 'sandy') AND (i_manager_id >= 10 AND i_manager_id <= 29)) AS t4270 ON t4267.ss_item_sk = t4270.i_item_sk GROUP BY t4269.ca_county, t4268.d_qoy, t4268.d_year) AS t4272 ON t4266.ca_county = t4272.ca_county INNER JOIN (SELECT t4275.ca_county, t4274.d_qoy, t4274.d_year, SUM(t4273.ss_ext_sales_price) AS store_sales FROM (SELECT * FROM store_sales WHERE ss_list_price >= 166 AND ss_list_price <= 180) AS t4273 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 3 AND d_year = 1998) AS t4274 ON t4273.ss_sold_date_sk = t4274.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('MO', 'VT')) AS t4275 ON t4273.ss_addr_sk = t4275.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('peru', 'sandy') AND (i_manager_id >= 10 AND i_manager_id <= 29)) AS t4276 ON t4273.ss_item_sk = t4276.i_item_sk GROUP BY t4275.ca_county, t4274.d_qoy, t4274.d_year) AS t4278 ON t4272.ca_county = t4278.ca_county INNER JOIN (SELECT t4281.ca_county, t4280.d_qoy, t4280.d_year, SUM(t4279.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 166 AND ws_list_price <= 180) AS t4279 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 1 AND d_year = 1998) AS t4280 ON t4279.ws_sold_date_sk = t4280.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('MO', 'VT')) AS t4281 ON t4279.ws_bill_addr_sk = t4281.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('peru', 'sandy') AND (i_manager_id >= 10 AND i_manager_id <= 29)) AS t4282 ON t4279.ws_item_sk = t4282.i_item_sk GROUP BY t4281.ca_county, t4280.d_qoy, t4280.d_year) AS t4284 ON t4266.ca_county = t4284.ca_county INNER JOIN (SELECT t4287.ca_county, t4286.d_qoy, t4286.d_year, SUM(t4285.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 166 AND ws_list_price <= 180) AS t4285 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 2 AND d_year = 1998) AS t4286 ON t4285.ws_sold_date_sk = t4286.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('MO', 'VT')) AS t4287 ON t4285.ws_bill_addr_sk = t4287.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('peru', 'sandy') AND (i_manager_id >= 10 AND i_manager_id <= 29)) AS t4288 ON t4285.ws_item_sk = t4288.i_item_sk GROUP BY t4287.ca_county, t4286.d_qoy, t4286.d_year) AS t4290 ON t4284.ca_county = t4290.ca_county AND CASE WHEN t4284.web_sales > 0 THEN t4290.web_sales / t4284.web_sales ELSE NULL END > CASE WHEN t4266.store_sales > 0 THEN t4272.store_sales / t4266.store_sales ELSE NULL END INNER JOIN (SELECT t4293.ca_county, t4292.d_qoy, t4292.d_year, SUM(t4291.ws_ext_sales_price) AS web_sales FROM (SELECT * FROM web_sales WHERE ws_list_price >= 166 AND ws_list_price <= 180) AS t4291 INNER JOIN (SELECT * FROM date_dim WHERE d_qoy = 3 AND d_year = 1998) AS t4292 ON t4291.ws_sold_date_sk = t4292.d_date_sk INNER JOIN (SELECT * FROM customer_address WHERE ca_state IN ('MO', 'VT')) AS t4293 ON t4291.ws_bill_addr_sk = t4293.ca_address_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('peru', 'sandy') AND (i_manager_id >= 10 AND i_manager_id <= 29)) AS t4294 ON t4291.ws_item_sk = t4294.i_item_sk GROUP BY t4293.ca_county, t4292.d_qoy, t4292.d_year) AS t4296 ON t4284.ca_county = t4296.ca_county AND CASE WHEN t4290.web_sales > 0 THEN t4296.web_sales / t4290.web_sales ELSE NULL END > CASE WHEN t4272.store_sales > 0 THEN t4278.store_sales / t4272.store_sales ELSE NULL END ORDER BY t4266.d_year","['FILTER_INTO_JOIN', 'PROJECT_TO_CALC']",5.549081643,5.035064618,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]"
285,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-01-10')) and ss_sold_date_sk = d_date_sk and ss_list_price between 21 and 50 and i_manager_id BETWEEN 22 and 51 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1982 AND 1988 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-01-10')) and cs_sold_date_sk = d_date_sk and cs_list_price between 21 and 50 and i_manager_id BETWEEN 22 and 51 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1982 AND 1988 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-01-10')) and ws_sold_date_sk = d_date_sk and ws_list_price between 21 and 50 and i_manager_id BETWEEN 22 and 51 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1982 AND 1988 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;","SELECT t4395.item_id, t4395.birth_year, t4395.ss_item_rev, t4395.ss_item_rev / ((t4395.ss_item_rev + t4404.cs_item_rev + t4413.ws_item_rev) / 3) * 100 AS ss_dev, t4404.cs_item_rev, t4404.cs_item_rev / ((t4395.ss_item_rev + t4404.cs_item_rev + t4413.ws_item_rev) / 3) * 100 AS cs_dev, t4413.ws_item_rev, t4413.ws_item_rev / ((t4395.ss_item_rev + t4404.cs_item_rev + t4413.ws_item_rev) / 3) * 100 AS ws_dev, (t4395.ss_item_rev + t4404.cs_item_rev + t4413.ws_item_rev) / 3 AS average FROM (SELECT t4388.i_item_id AS item_id, t4389.c_birth_year AS birth_year, SUM(t4387.ss_ext_sales_price) AS ss_item_rev FROM (SELECT * FROM store_sales WHERE ss_list_price >= 21 AND ss_list_price <= 50) AS t4387 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 22 AND i_manager_id <= 51) AS t4388 ON t4387.ss_item_sk = t4388.i_item_sk INNER JOIN date_dim AS date_dim1043 ON t4387.ss_sold_date_sk = date_dim1043.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1982 AND c_birth_year <= 1988) AS t4389 ON t4387.ss_customer_sk = t4389.c_customer_sk INNER JOIN (SELECT date_dim1044.d_date FROM date_dim AS date_dim1044 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = DATE '1998-01-10') AS t4391 ON date_dim1044.d_month_seq = t4391.d_month_seq) AS t4393 ON date_dim1043.d_date = t4393.d_date GROUP BY t4388.i_item_id, t4389.c_birth_year) AS t4395 INNER JOIN (SELECT t4397.i_item_id AS item_id, t4398.c_birth_year AS birth_year, SUM(t4396.cs_ext_sales_price) AS cs_item_rev FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 21 AND cs_list_price <= 50) AS t4396 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 22 AND i_manager_id <= 51) AS t4397 ON t4396.cs_item_sk = t4397.i_item_sk INNER JOIN date_dim AS date_dim1046 ON t4396.cs_sold_date_sk = date_dim1046.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1982 AND c_birth_year <= 1988) AS t4398 ON t4396.cs_bill_customer_sk = t4398.c_customer_sk INNER JOIN (SELECT date_dim1047.d_date FROM date_dim AS date_dim1047 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = DATE '1998-01-10') AS t4400 ON date_dim1047.d_month_seq = t4400.d_month_seq) AS t4402 ON date_dim1046.d_date = t4402.d_date GROUP BY t4397.i_item_id, t4398.c_birth_year) AS t4404 ON t4395.item_id = t4404.item_id AND (t4395.birth_year = t4404.birth_year AND t4395.ss_item_rev >= 0.9 * t4404.cs_item_rev) AND (t4395.ss_item_rev <= 1.1 * t4404.cs_item_rev AND (t4404.cs_item_rev >= 0.9 * t4395.ss_item_rev AND t4404.cs_item_rev <= 1.1 * t4395.ss_item_rev)) INNER JOIN (SELECT t4406.i_item_id AS item_id, t4407.c_birth_year AS birth_year, SUM(t4405.ws_ext_sales_price) AS ws_item_rev FROM (SELECT * FROM web_sales WHERE ws_list_price >= 21 AND ws_list_price <= 50) AS t4405 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 22 AND i_manager_id <= 51) AS t4406 ON t4405.ws_item_sk = t4406.i_item_sk INNER JOIN date_dim AS date_dim1049 ON t4405.ws_sold_date_sk = date_dim1049.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1982 AND c_birth_year <= 1988) AS t4407 ON t4405.ws_bill_customer_sk = t4407.c_customer_sk INNER JOIN (SELECT date_dim1050.d_date FROM date_dim AS date_dim1050 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = DATE '1998-01-10') AS t4409 ON date_dim1050.d_month_seq = t4409.d_month_seq) AS t4411 ON date_dim1049.d_date = t4411.d_date GROUP BY t4406.i_item_id, t4407.c_birth_year) AS t4413 ON t4395.item_id = t4413.item_id AND t4395.birth_year = t4413.birth_year AND (t4395.ss_item_rev >= 0.9 * t4413.ws_item_rev AND (t4395.ss_item_rev <= 1.1 * t4413.ws_item_rev AND t4404.cs_item_rev >= 0.9 * t4413.ws_item_rev)) AND (t4404.cs_item_rev <= 1.1 * t4413.ws_item_rev AND t4413.ws_item_rev >= 0.9 * t4395.ss_item_rev AND (t4413.ws_item_rev <= 1.1 * t4395.ss_item_rev AND (t4413.ws_item_rev >= 0.9 * t4404.cs_item_rev AND t4413.ws_item_rev <= 1.1 * t4404.cs_item_rev))) ORDER BY t4395.item_id, t4395.birth_year, t4395.ss_item_rev LIMIT 100","['PROJECT_TO_CALC', 'FILTER_INTO_JOIN']",16.04100982,12.29461948,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]]]"
286,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-02-13')) and ss_sold_date_sk = d_date_sk and ss_list_price between 217 and 246 and i_manager_id BETWEEN 46 and 75 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1963 AND 1969 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-02-13')) and cs_sold_date_sk = d_date_sk and cs_list_price between 217 and 246 and i_manager_id BETWEEN 46 and 75 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1963 AND 1969 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-02-13')) and ws_sold_date_sk = d_date_sk and ws_list_price between 217 and 246 and i_manager_id BETWEEN 46 and 75 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1963 AND 1969 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;","SELECT t3804.item_id, t3804.birth_year, t3804.ss_item_rev, t3804.ss_item_rev / ((t3804.ss_item_rev + t3812.cs_item_rev + t3820.ws_item_rev) / 3) * 100 AS ss_dev, t3812.cs_item_rev, t3812.cs_item_rev / ((t3804.ss_item_rev + t3812.cs_item_rev + t3820.ws_item_rev) / 3) * 100 AS cs_dev, t3820.ws_item_rev, t3820.ws_item_rev / ((t3804.ss_item_rev + t3812.cs_item_rev + t3820.ws_item_rev) / 3) * 100 AS ws_dev, (t3804.ss_item_rev + t3812.cs_item_rev + t3820.ws_item_rev) / 3 AS average FROM (SELECT t3798.i_item_id AS item_id, t3799.c_birth_year AS birth_year, SUM(t3797.ss_ext_sales_price) AS ss_item_rev FROM (SELECT * FROM store_sales WHERE ss_list_price >= 217 AND ss_list_price <= 246) AS t3797 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 46 AND i_manager_id <= 75) AS t3798 ON t3797.ss_item_sk = t3798.i_item_sk INNER JOIN date_dim AS date_dim899 ON t3797.ss_sold_date_sk = date_dim899.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1963 AND c_birth_year <= 1969) AS t3799 ON t3797.ss_customer_sk = t3799.c_customer_sk INNER JOIN (SELECT date_dim900.d_date FROM date_dim AS date_dim900 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = DATE '1998-02-13') AS t3801 ON date_dim900.d_month_seq = t3801.d_month_seq) AS t3802 ON date_dim899.d_date = t3802.d_date GROUP BY t3798.i_item_id, t3799.c_birth_year) AS t3804 INNER JOIN (SELECT t3806.i_item_id AS item_id, t3807.c_birth_year AS birth_year, SUM(t3805.cs_ext_sales_price) AS cs_item_rev FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 217 AND cs_list_price <= 246) AS t3805 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 46 AND i_manager_id <= 75) AS t3806 ON t3805.cs_item_sk = t3806.i_item_sk INNER JOIN date_dim AS date_dim902 ON t3805.cs_sold_date_sk = date_dim902.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1963 AND c_birth_year <= 1969) AS t3807 ON t3805.cs_bill_customer_sk = t3807.c_customer_sk INNER JOIN (SELECT date_dim903.d_date FROM date_dim AS date_dim903 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = DATE '1998-02-13') AS t3809 ON date_dim903.d_month_seq = t3809.d_month_seq) AS t3810 ON date_dim902.d_date = t3810.d_date GROUP BY t3806.i_item_id, t3807.c_birth_year) AS t3812 ON t3804.item_id = t3812.item_id AND (t3804.birth_year = t3812.birth_year AND t3804.ss_item_rev >= 0.9 * t3812.cs_item_rev) AND (t3804.ss_item_rev <= 1.1 * t3812.cs_item_rev AND (t3812.cs_item_rev >= 0.9 * t3804.ss_item_rev AND t3812.cs_item_rev <= 1.1 * t3804.ss_item_rev)) INNER JOIN (SELECT t3814.i_item_id AS item_id, t3815.c_birth_year AS birth_year, SUM(t3813.ws_ext_sales_price) AS ws_item_rev FROM (SELECT * FROM web_sales WHERE ws_list_price >= 217 AND ws_list_price <= 246) AS t3813 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 46 AND i_manager_id <= 75) AS t3814 ON t3813.ws_item_sk = t3814.i_item_sk INNER JOIN date_dim AS date_dim905 ON t3813.ws_sold_date_sk = date_dim905.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1963 AND c_birth_year <= 1969) AS t3815 ON t3813.ws_bill_customer_sk = t3815.c_customer_sk INNER JOIN (SELECT date_dim906.d_date FROM date_dim AS date_dim906 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = DATE '1998-02-13') AS t3817 ON date_dim906.d_month_seq = t3817.d_month_seq) AS t3818 ON date_dim905.d_date = t3818.d_date GROUP BY t3814.i_item_id, t3815.c_birth_year) AS t3820 ON t3804.item_id = t3820.item_id AND t3804.birth_year = t3820.birth_year AND (t3804.ss_item_rev >= 0.9 * t3820.ws_item_rev AND (t3804.ss_item_rev <= 1.1 * t3820.ws_item_rev AND t3812.cs_item_rev >= 0.9 * t3820.ws_item_rev)) AND (t3812.cs_item_rev <= 1.1 * t3820.ws_item_rev AND t3820.ws_item_rev >= 0.9 * t3804.ss_item_rev AND (t3820.ws_item_rev <= 1.1 * t3804.ss_item_rev AND (t3820.ws_item_rev >= 0.9 * t3812.cs_item_rev AND t3820.ws_item_rev <= 1.1 * t3812.cs_item_rev))) ORDER BY t3804.item_id, t3804.birth_year, t3804.ss_item_rev LIMIT 100","['FILTER_INTO_JOIN', 'JOIN_PROJECT_TRANSPOSE_RULE(_OTHER-_PROJ', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']",10.48900628,5.324170748,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]]]"
287,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-05-14')) and ss_sold_date_sk = d_date_sk and ss_list_price between 108 and 137 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1984 AND 1990 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-05-14')) and cs_sold_date_sk = d_date_sk and cs_list_price between 108 and 137 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1984 AND 1990 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-05-14')) and ws_sold_date_sk = d_date_sk and ws_list_price between 108 and 137 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1984 AND 1990 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;","SELECT t3507.item_id, t3507.birth_year, t3507.ss_item_rev, t3507.ss_item_rev / ((t3507.ss_item_rev + t3515.cs_item_rev + t3523.ws_item_rev) / 3) * 100 AS ss_dev, t3515.cs_item_rev, t3515.cs_item_rev / ((t3507.ss_item_rev + t3515.cs_item_rev + t3523.ws_item_rev) / 3) * 100 AS cs_dev, t3523.ws_item_rev, t3523.ws_item_rev / ((t3507.ss_item_rev + t3515.cs_item_rev + t3523.ws_item_rev) / 3) * 100 AS ws_dev, (t3507.ss_item_rev + t3515.cs_item_rev + t3523.ws_item_rev) / 3 AS average FROM (SELECT t3501.i_item_id AS item_id, t3502.c_birth_year AS birth_year, SUM(t3500.ss_ext_sales_price) AS ss_item_rev FROM (SELECT * FROM store_sales WHERE ss_list_price >= 108 AND ss_list_price <= 137) AS t3500 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 71 AND i_manager_id <= 100) AS t3501 ON t3500.ss_item_sk = t3501.i_item_sk INNER JOIN date_dim AS date_dim818 ON t3500.ss_sold_date_sk = date_dim818.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1984 AND c_birth_year <= 1990) AS t3502 ON t3500.ss_customer_sk = t3502.c_customer_sk INNER JOIN (SELECT date_dim819.d_date FROM date_dim AS date_dim819 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = DATE '1998-05-14') AS t3504 ON date_dim819.d_month_seq = t3504.d_month_seq) AS t3505 ON date_dim818.d_date = t3505.d_date GROUP BY t3501.i_item_id, t3502.c_birth_year) AS t3507 INNER JOIN (SELECT t3509.i_item_id AS item_id, t3510.c_birth_year AS birth_year, SUM(t3508.cs_ext_sales_price) AS cs_item_rev FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 108 AND cs_list_price <= 137) AS t3508 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 71 AND i_manager_id <= 100) AS t3509 ON t3508.cs_item_sk = t3509.i_item_sk INNER JOIN date_dim AS date_dim821 ON t3508.cs_sold_date_sk = date_dim821.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1984 AND c_birth_year <= 1990) AS t3510 ON t3508.cs_bill_customer_sk = t3510.c_customer_sk INNER JOIN (SELECT date_dim822.d_date FROM date_dim AS date_dim822 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = DATE '1998-05-14') AS t3512 ON date_dim822.d_month_seq = t3512.d_month_seq) AS t3513 ON date_dim821.d_date = t3513.d_date GROUP BY t3509.i_item_id, t3510.c_birth_year) AS t3515 ON t3507.item_id = t3515.item_id AND (t3507.birth_year = t3515.birth_year AND t3507.ss_item_rev >= 0.9 * t3515.cs_item_rev) AND (t3507.ss_item_rev <= 1.1 * t3515.cs_item_rev AND (t3515.cs_item_rev >= 0.9 * t3507.ss_item_rev AND t3515.cs_item_rev <= 1.1 * t3507.ss_item_rev)) INNER JOIN (SELECT t3517.i_item_id AS item_id, t3518.c_birth_year AS birth_year, SUM(t3516.ws_ext_sales_price) AS ws_item_rev FROM (SELECT * FROM web_sales WHERE ws_list_price >= 108 AND ws_list_price <= 137) AS t3516 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 71 AND i_manager_id <= 100) AS t3517 ON t3516.ws_item_sk = t3517.i_item_sk INNER JOIN date_dim AS date_dim824 ON t3516.ws_sold_date_sk = date_dim824.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1984 AND c_birth_year <= 1990) AS t3518 ON t3516.ws_bill_customer_sk = t3518.c_customer_sk INNER JOIN (SELECT date_dim825.d_date FROM date_dim AS date_dim825 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = DATE '1998-05-14') AS t3520 ON date_dim825.d_month_seq = t3520.d_month_seq) AS t3521 ON date_dim824.d_date = t3521.d_date GROUP BY t3517.i_item_id, t3518.c_birth_year) AS t3523 ON t3507.item_id = t3523.item_id AND t3507.birth_year = t3523.birth_year AND (t3507.ss_item_rev >= 0.9 * t3523.ws_item_rev AND (t3507.ss_item_rev <= 1.1 * t3523.ws_item_rev AND t3515.cs_item_rev >= 0.9 * t3523.ws_item_rev)) AND (t3515.cs_item_rev <= 1.1 * t3523.ws_item_rev AND t3523.ws_item_rev >= 0.9 * t3507.ss_item_rev AND (t3523.ws_item_rev <= 1.1 * t3507.ss_item_rev AND (t3523.ws_item_rev >= 0.9 * t3515.cs_item_rev AND t3523.ws_item_rev <= 1.1 * t3515.cs_item_rev))) ORDER BY t3507.item_id, t3507.birth_year, t3507.ss_item_rev LIMIT 100","['FILTER_INTO_JOIN', 'PROJECT_TO_CALC']",21.93114956,11.3270177,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]]]"
288,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-01-11')) and ss_sold_date_sk = d_date_sk and ss_list_price between 69 and 98 and i_manager_id BETWEEN 51 and 80 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1984 AND 1990 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-01-11')) and cs_sold_date_sk = d_date_sk and cs_list_price between 69 and 98 and i_manager_id BETWEEN 51 and 80 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1984 AND 1990 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-01-11')) and ws_sold_date_sk = d_date_sk and ws_list_price between 69 and 98 and i_manager_id BETWEEN 51 and 80 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1984 AND 1990 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;","SELECT t27.item_id, t27.birth_year, t27.ss_item_rev, t27.ss_item_rev / ((t27.ss_item_rev + t27.cs_item_rev + t41.ws_item_rev) / 3) * 100 AS ss_dev, t27.cs_item_rev, t27.cs_item_rev / ((t27.ss_item_rev + t27.cs_item_rev + t41.ws_item_rev) / 3) * 100 AS cs_dev, t41.ws_item_rev, t41.ws_item_rev / ((t27.ss_item_rev + t27.cs_item_rev + t41.ws_item_rev) / 3) * 100 AS ws_dev, (t27.ss_item_rev + t27.cs_item_rev + t41.ws_item_rev) / 3 AS average FROM (SELECT * FROM (SELECT t4.i_item_id AS item_id, t4.c_birth_year AS birth_year, SUM(t4.ss_ext_sales_price) AS ss_item_rev FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM store_sales WHERE ss_list_price >= 69 AND ss_list_price <= 98) AS t, (SELECT * FROM item WHERE i_manager_id >= 51 AND i_manager_id <= 80) AS t0 WHERE t.ss_item_sk = t0.i_item_sk) AS t1, date_dim WHERE t1.ss_sold_date_sk = date_dim.d_date_sk) AS t2, (SELECT * FROM customer WHERE c_birth_year >= 1984 AND c_birth_year <= 1990) AS t3 WHERE t2.ss_customer_sk = t3.c_customer_sk) AS t4, (SELECT date_dim0.d_date FROM date_dim AS date_dim0, (SELECT d_month_seq FROM date_dim WHERE d_date = '2001-01-11') AS t6 WHERE date_dim0.d_month_seq = t6.d_month_seq) AS t9 WHERE t4.d_date = t9.d_date GROUP BY t4.i_item_id, t4.c_birth_year) AS t12, (SELECT t18.i_item_id AS item_id, t18.c_birth_year AS birth_year, SUM(t18.cs_ext_sales_price) AS cs_item_rev FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 69 AND cs_list_price <= 98) AS t13, (SELECT * FROM item WHERE i_manager_id >= 51 AND i_manager_id <= 80) AS t14 WHERE t13.cs_item_sk = t14.i_item_sk) AS t15, date_dim AS date_dim2 WHERE t15.cs_sold_date_sk = date_dim2.d_date_sk) AS t16, (SELECT * FROM customer WHERE c_birth_year >= 1984 AND c_birth_year <= 1990) AS t17 WHERE t16.cs_bill_customer_sk = t17.c_customer_sk) AS t18, (SELECT date_dim3.d_date FROM date_dim AS date_dim3, (SELECT d_month_seq FROM date_dim WHERE d_date = '2001-01-11') AS t20 WHERE date_dim3.d_month_seq = t20.d_month_seq) AS t23 WHERE t18.d_date = t23.d_date GROUP BY t18.i_item_id, t18.c_birth_year) AS t26 WHERE t12.item_id = t26.item_id AND (t12.birth_year = t26.birth_year AND t12.ss_item_rev >= 0.9 * t26.cs_item_rev) AND (t12.ss_item_rev <= 1.1 * t26.cs_item_rev AND (t26.cs_item_rev >= 0.9 * t12.ss_item_rev AND t26.cs_item_rev <= 1.1 * t12.ss_item_rev))) AS t27, (SELECT t33.i_item_id AS item_id, t33.c_birth_year AS birth_year, SUM(t33.ws_ext_sales_price) AS ws_item_rev FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM web_sales WHERE ws_list_price >= 69 AND ws_list_price <= 98) AS t28, (SELECT * FROM item WHERE i_manager_id >= 51 AND i_manager_id <= 80) AS t29 WHERE t28.ws_item_sk = t29.i_item_sk) AS t30, date_dim AS date_dim5 WHERE t30.ws_sold_date_sk = date_dim5.d_date_sk) AS t31, (SELECT * FROM customer WHERE c_birth_year >= 1984 AND c_birth_year <= 1990) AS t32 WHERE t31.ws_bill_customer_sk = t32.c_customer_sk) AS t33, (SELECT date_dim6.d_date FROM date_dim AS date_dim6, (SELECT d_month_seq FROM date_dim WHERE d_date = '2001-01-11') AS t35 WHERE date_dim6.d_month_seq = t35.d_month_seq) AS t38 WHERE t33.d_date = t38.d_date GROUP BY t33.i_item_id, t33.c_birth_year) AS t41 WHERE t27.item_id = t41.item_id AND t27.birth_year = t41.birth_year AND (t27.ss_item_rev >= 0.9 * t41.ws_item_rev AND (t27.ss_item_rev <= 1.1 * t41.ws_item_rev AND t27.cs_item_rev >= 0.9 * t41.ws_item_rev)) AND (t27.cs_item_rev <= 1.1 * t41.ws_item_rev AND t41.ws_item_rev >= 0.9 * t27.ss_item_rev AND (t41.ws_item_rev <= 1.1 * t27.ss_item_rev AND (t41.ws_item_rev >= 0.9 * t27.cs_item_rev AND t41.ws_item_rev <= 1.1 * t27.cs_item_rev))) ORDER BY t27.item_id, t27.birth_year, t27.ss_item_rev LIMIT 100","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'SORT_REMOVE_CONSTANT_KEYS']",19.53162964,18.14252067,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]]]"
289,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-06-09')) and ss_sold_date_sk = d_date_sk and ss_list_price between 75 and 104 and i_manager_id BETWEEN 8 and 37 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1937 AND 1943 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-06-09')) and cs_sold_date_sk = d_date_sk and cs_list_price between 75 and 104 and i_manager_id BETWEEN 8 and 37 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1937 AND 1943 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-06-09')) and ws_sold_date_sk = d_date_sk and ws_list_price between 75 and 104 and i_manager_id BETWEEN 8 and 37 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1937 AND 1943 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;","SELECT t7.item_id, t7.birth_year, t7.ss_item_rev, t7.ss_item_rev / ((t7.ss_item_rev + t16.cs_item_rev + t25.ws_item_rev) / 3) * 100 AS ss_dev, t16.cs_item_rev, t16.cs_item_rev / ((t7.ss_item_rev + t16.cs_item_rev + t25.ws_item_rev) / 3) * 100 AS cs_dev, t25.ws_item_rev, t25.ws_item_rev / ((t7.ss_item_rev + t16.cs_item_rev + t25.ws_item_rev) / 3) * 100 AS ws_dev, (t7.ss_item_rev + t16.cs_item_rev + t25.ws_item_rev) / 3 AS average FROM (SELECT t0.i_item_id AS item_id, t1.c_birth_year AS birth_year, SUM(t.ss_ext_sales_price) AS ss_item_rev FROM (SELECT * FROM store_sales WHERE ss_list_price >= 75 AND ss_list_price <= 104) AS t INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 8 AND i_manager_id <= 37) AS t0 ON t.ss_item_sk = t0.i_item_sk INNER JOIN date_dim ON t.ss_sold_date_sk = date_dim.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1937 AND c_birth_year <= 1943) AS t1 ON t.ss_customer_sk = t1.c_customer_sk INNER JOIN (SELECT date_dim0.d_date FROM date_dim AS date_dim0 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = '2002-06-09') AS t3 ON date_dim0.d_month_seq = t3.d_month_seq) AS t5 ON date_dim.d_date = t5.d_date GROUP BY t0.i_item_id, t1.c_birth_year) AS t7 INNER JOIN (SELECT t9.i_item_id AS item_id, t10.c_birth_year AS birth_year, SUM(t8.cs_ext_sales_price) AS cs_item_rev FROM (SELECT * FROM catalog_sales WHERE cs_list_price >= 75 AND cs_list_price <= 104) AS t8 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 8 AND i_manager_id <= 37) AS t9 ON t8.cs_item_sk = t9.i_item_sk INNER JOIN date_dim AS date_dim2 ON t8.cs_sold_date_sk = date_dim2.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1937 AND c_birth_year <= 1943) AS t10 ON t8.cs_bill_customer_sk = t10.c_customer_sk INNER JOIN (SELECT date_dim3.d_date FROM date_dim AS date_dim3 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = '2002-06-09') AS t12 ON date_dim3.d_month_seq = t12.d_month_seq) AS t14 ON date_dim2.d_date = t14.d_date GROUP BY t9.i_item_id, t10.c_birth_year) AS t16 ON t7.item_id = t16.item_id AND (t7.birth_year = t16.birth_year AND t7.ss_item_rev >= 0.9 * t16.cs_item_rev) AND (t7.ss_item_rev <= 1.1 * t16.cs_item_rev AND (t16.cs_item_rev >= 0.9 * t7.ss_item_rev AND t16.cs_item_rev <= 1.1 * t7.ss_item_rev)) INNER JOIN (SELECT t18.i_item_id AS item_id, t19.c_birth_year AS birth_year, SUM(t17.ws_ext_sales_price) AS ws_item_rev FROM (SELECT * FROM web_sales WHERE ws_list_price >= 75 AND ws_list_price <= 104) AS t17 INNER JOIN (SELECT * FROM item WHERE i_manager_id >= 8 AND i_manager_id <= 37) AS t18 ON t17.ws_item_sk = t18.i_item_sk INNER JOIN date_dim AS date_dim5 ON t17.ws_sold_date_sk = date_dim5.d_date_sk INNER JOIN (SELECT * FROM customer WHERE c_birth_year >= 1937 AND c_birth_year <= 1943) AS t19 ON t17.ws_bill_customer_sk = t19.c_customer_sk INNER JOIN (SELECT date_dim6.d_date FROM date_dim AS date_dim6 INNER JOIN (SELECT d_month_seq FROM date_dim WHERE d_date = '2002-06-09') AS t21 ON date_dim6.d_month_seq = t21.d_month_seq) AS t23 ON date_dim5.d_date = t23.d_date GROUP BY t18.i_item_id, t19.c_birth_year) AS t25 ON t7.item_id = t25.item_id AND t7.birth_year = t25.birth_year AND (t7.ss_item_rev >= 0.9 * t25.ws_item_rev AND (t7.ss_item_rev <= 1.1 * t25.ws_item_rev AND t16.cs_item_rev >= 0.9 * t25.ws_item_rev)) AND (t16.cs_item_rev <= 1.1 * t25.ws_item_rev AND t25.ws_item_rev >= 0.9 * t7.ss_item_rev AND (t25.ws_item_rev <= 1.1 * t7.ss_item_rev AND (t25.ws_item_rev >= 0.9 * t16.cs_item_rev AND t25.ws_item_rev <= 1.1 * t16.cs_item_rev))) ORDER BY t7.item_id, t7.birth_year, t7.ss_item_rev LIMIT 100;","['SORT_REMOVE_CONSTANT_KEYS', 'FILTER_INTO_JOIN']",20.52475333,19.02809874,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]], ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]]]]]]]"
290,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 1 * 0.01 AND 21 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1184 and 1184 + 11  and s_state in ('CO','ID','KS'   ,'ME','OK','TX','VT','WI')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1184+ 12 and 1184 + 23  and s_state in ('CO','ID','KS'   ,'ME','OK','TX','VT','WI')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;","SELECT t1755.s_store_name1, t1755.s_store_id1, t1755.d_week_seq1, t1755.sun_sales1 / t1764.sun_sales2, t1755.mon_sales1 / t1764.mon_sales2, t1755.tue_sales1 / t1764.tue_sales2, t1755.wed_sales1 / t1764.wed_sales2, t1755.thu_sales1 / t1764.thu_sales2, t1755.fri_sales1 / t1764.fri_sales2, t1755.sat_sales1 / t1764.sat_sales2 FROM (SELECT t1752.s_store_name AS s_store_name1, t1752.d_week_seq AS d_week_seq1, t1752.s_store_id AS s_store_id1, t1752.sun_sales AS sun_sales1, t1752.mon_sales AS mon_sales1, t1752.tue_sales AS tue_sales1, t1752.wed_sales AS wed_sales1, t1752.thu_sales AS thu_sales1, t1752.fri_sales AS fri_sales1, t1752.sat_sales AS sat_sales1 FROM (SELECT * FROM (SELECT date_dim411.d_week_seq, t1747.ss_store_sk, SUM(CASE WHEN CAST(date_dim411.d_day_name AS CHAR(6)) = 'Sunday' THEN t1747.ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN CAST(date_dim411.d_day_name AS CHAR(6)) = 'Monday' THEN t1747.ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN CAST(date_dim411.d_day_name AS CHAR(7)) = 'Tuesday' THEN t1747.ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN CAST(date_dim411.d_day_name AS CHAR(9)) = 'Wednesday' THEN t1747.ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN CAST(date_dim411.d_day_name AS CHAR(8)) = 'Thursday' THEN t1747.ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN CAST(date_dim411.d_day_name AS CHAR(6)) = 'Friday' THEN t1747.ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN CAST(date_dim411.d_day_name AS CHAR(8)) = 'Saturday' THEN t1747.ss_sales_price ELSE NULL END) AS sat_sales FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 0.01 AND ss_sales_price / ss_list_price <= 21 * 0.01) AS t1747, date_dim AS date_dim411 WHERE date_dim411.d_date_sk = t1747.ss_sold_date_sk GROUP BY date_dim411.d_week_seq, t1747.ss_store_sk) AS t1750, (SELECT * FROM store WHERE s_state IN ('CO', 'ID', 'KS', 'ME', 'OK', 'TX', 'VT', 'WI')) AS t1751 WHERE t1750.ss_store_sk = t1751.s_store_sk) AS t1752, (SELECT * FROM date_dim WHERE d_month_seq >= 1184 AND d_month_seq <= 1184 + 11) AS t1753 WHERE t1753.d_week_seq = t1752.d_week_seq) AS t1755, (SELECT t1761.s_store_name AS s_store_name2, t1761.d_week_seq AS d_week_seq2, t1761.s_store_id AS s_store_id2, t1761.sun_sales AS sun_sales2, t1761.mon_sales AS mon_sales2, t1761.tue_sales AS tue_sales2, t1761.wed_sales AS wed_sales2, t1761.thu_sales AS thu_sales2, t1761.fri_sales AS fri_sales2, t1761.sat_sales AS sat_sales2 FROM (SELECT * FROM (SELECT date_dim413.d_week_seq, t1756.ss_store_sk, SUM(CASE WHEN CAST(date_dim413.d_day_name AS CHAR(6)) = 'Sunday' THEN t1756.ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN CAST(date_dim413.d_day_name AS CHAR(6)) = 'Monday' THEN t1756.ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN CAST(date_dim413.d_day_name AS CHAR(7)) = 'Tuesday' THEN t1756.ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN CAST(date_dim413.d_day_name AS CHAR(9)) = 'Wednesday' THEN t1756.ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN CAST(date_dim413.d_day_name AS CHAR(8)) = 'Thursday' THEN t1756.ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN CAST(date_dim413.d_day_name AS CHAR(6)) = 'Friday' THEN t1756.ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN CAST(date_dim413.d_day_name AS CHAR(8)) = 'Saturday' THEN t1756.ss_sales_price ELSE NULL END) AS sat_sales FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 0.01 AND ss_sales_price / ss_list_price <= 21 * 0.01) AS t1756, date_dim AS date_dim413 WHERE date_dim413.d_date_sk = t1756.ss_sold_date_sk GROUP BY date_dim413.d_week_seq, t1756.ss_store_sk) AS t1759, (SELECT * FROM store WHERE s_state IN ('CO', 'ID', 'KS', 'ME', 'OK', 'TX', 'VT', 'WI')) AS t1760 WHERE t1759.ss_store_sk = t1760.s_store_sk) AS t1761, (SELECT * FROM date_dim WHERE d_month_seq >= 1184 + 12 AND d_month_seq <= 1184 + 23) AS t1762 WHERE t1762.d_week_seq = t1761.d_week_seq) AS t1764 WHERE t1755.s_store_id1 = t1764.s_store_id2 AND t1755.d_week_seq1 = t1764.d_week_seq2 - 52 ORDER BY t1755.s_store_name1, t1755.s_store_id1, t1755.d_week_seq1 LIMIT 100","['PROJECT_TO_CALC', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER']",5.952360789,5.886567672,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]"
291,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 16 * 0.01 AND 36 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1205 and 1205 + 11  and s_state in ('AL','FL','IL'   ,'MO','MT','ND','OK','RI')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1205+ 12 and 1205 + 23  and s_state in ('AL','FL','IL'   ,'MO','MT','ND','OK','RI')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;","SELECT t95.s_store_name1, t95.s_store_id1, t95.d_week_seq1, t95.sun_sales1 / t101.sun_sales2, t95.mon_sales1 / t101.mon_sales2, t95.tue_sales1 / t101.tue_sales2, t95.wed_sales1 / t101.wed_sales2, t95.thu_sales1 / t101.thu_sales2, t95.fri_sales1 / t101.fri_sales2, t95.sat_sales1 / t101.sat_sales2 FROM (SELECT t93.s_store_name AS s_store_name1, t92.d_week_seq AS d_week_seq1, t93.s_store_id AS s_store_id1, t92.sun_sales AS sun_sales1, t92.mon_sales AS mon_sales1, t92.tue_sales AS tue_sales1, t92.wed_sales AS wed_sales1, t92.thu_sales AS thu_sales1, t92.fri_sales AS fri_sales1, t92.sat_sales AS sat_sales1 FROM (SELECT date_dim27.d_week_seq, t90.ss_store_sk, SUM(CASE WHEN CAST(date_dim27.d_day_name AS CHAR(6)) = 'Sunday' THEN t90.ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN CAST(date_dim27.d_day_name AS CHAR(6)) = 'Monday' THEN t90.ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN CAST(date_dim27.d_day_name AS CHAR(7)) = 'Tuesday' THEN t90.ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN CAST(date_dim27.d_day_name AS CHAR(9)) = 'Wednesday' THEN t90.ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN CAST(date_dim27.d_day_name AS CHAR(8)) = 'Thursday' THEN t90.ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN CAST(date_dim27.d_day_name AS CHAR(6)) = 'Friday' THEN t90.ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN CAST(date_dim27.d_day_name AS CHAR(8)) = 'Saturday' THEN t90.ss_sales_price ELSE NULL END) AS sat_sales FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 16 * 0.01 AND ss_sales_price / ss_list_price <= 36 * 0.01) AS t90 INNER JOIN date_dim AS date_dim27 ON t90.ss_sold_date_sk = date_dim27.d_date_sk GROUP BY date_dim27.d_week_seq, t90.ss_store_sk) AS t92 INNER JOIN (SELECT * FROM store WHERE s_state IN ('AL', 'FL', 'IL', 'MO', 'MT', 'ND', 'OK', 'RI')) AS t93 ON t92.ss_store_sk = t93.s_store_sk INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1205 AND d_month_seq <= 1205 + 11) AS t94 ON t92.d_week_seq = t94.d_week_seq) AS t95 INNER JOIN (SELECT t99.s_store_name AS s_store_name2, t98.d_week_seq AS d_week_seq2, t99.s_store_id AS s_store_id2, t98.sun_sales AS sun_sales2, t98.mon_sales AS mon_sales2, t98.tue_sales AS tue_sales2, t98.wed_sales AS wed_sales2, t98.thu_sales AS thu_sales2, t98.fri_sales AS fri_sales2, t98.sat_sales AS sat_sales2 FROM (SELECT date_dim29.d_week_seq, t96.ss_store_sk, SUM(CASE WHEN CAST(date_dim29.d_day_name AS CHAR(6)) = 'Sunday' THEN t96.ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN CAST(date_dim29.d_day_name AS CHAR(6)) = 'Monday' THEN t96.ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN CAST(date_dim29.d_day_name AS CHAR(7)) = 'Tuesday' THEN t96.ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN CAST(date_dim29.d_day_name AS CHAR(9)) = 'Wednesday' THEN t96.ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN CAST(date_dim29.d_day_name AS CHAR(8)) = 'Thursday' THEN t96.ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN CAST(date_dim29.d_day_name AS CHAR(6)) = 'Friday' THEN t96.ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN CAST(date_dim29.d_day_name AS CHAR(8)) = 'Saturday' THEN t96.ss_sales_price ELSE NULL END) AS sat_sales FROM (SELECT * FROM store_sales WHERE ss_sales_price / ss_list_price >= 16 * 0.01 AND ss_sales_price / ss_list_price <= 36 * 0.01) AS t96 INNER JOIN date_dim AS date_dim29 ON t96.ss_sold_date_sk = date_dim29.d_date_sk GROUP BY date_dim29.d_week_seq, t96.ss_store_sk) AS t98 INNER JOIN (SELECT * FROM store WHERE s_state IN ('AL', 'FL', 'IL', 'MO', 'MT', 'ND', 'OK', 'RI')) AS t99 ON t98.ss_store_sk = t99.s_store_sk INNER JOIN (SELECT * FROM date_dim WHERE d_month_seq >= 1205 + 12 AND d_month_seq <= 1205 + 23) AS t100 ON t98.d_week_seq = t100.d_week_seq) AS t101 ON t95.s_store_id1 = t101.s_store_id2 AND t95.d_week_seq1 = t101.d_week_seq2 - 52 ORDER BY t95.s_store_name1, t95.s_store_id1, t95.d_week_seq1 LIMIT 100","['FILTER_INTO_JOIN', 'PROJECT_TO_CALC']",14.75111039,13.02333919,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]"
292,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 39 * 0.01 AND 59 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1212 and 1212 + 11  and s_state in ('IL','IN','KY'   ,'MO','MT','OK','TX','WI')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1212+ 12 and 1212 + 23  and s_state in ('IL','IN','KY'   ,'MO','MT','OK','TX','WI')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;","SELECT t3.s_store_name1, t3.s_store_id1, t3.d_week_seq1, t3.sun_sales1 / t8.sun_sales2, t3.mon_sales1 / t8.mon_sales2, t3.tue_sales1 / t8.tue_sales2, t3.wed_sales1 / t8.wed_sales2, t3.thu_sales1 / t8.thu_sales2, t3.fri_sales1 / t8.fri_sales2, t3.sat_sales1 / t8.sat_sales2 FROM (SELECT store.s_store_name AS s_store_name1, t1.d_week_seq AS d_week_seq1, store.s_store_id AS s_store_id1, t1.sun_sales AS sun_sales1, t1.mon_sales AS mon_sales1, t1.tue_sales AS tue_sales1, t1.wed_sales AS wed_sales1, t1.thu_sales AS thu_sales1, t1.fri_sales AS fri_sales1, t1.sat_sales AS sat_sales1 FROM (SELECT date_dim.d_week_seq, store_sales.ss_store_sk, SUM(CASE WHEN date_dim.d_day_name = 'Sunday' THEN store_sales.ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN date_dim.d_day_name = 'Monday' THEN store_sales.ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN date_dim.d_day_name = 'Tuesday' THEN store_sales.ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN date_dim.d_day_name = 'Wednesday' THEN store_sales.ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN date_dim.d_day_name = 'Thursday' THEN store_sales.ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN date_dim.d_day_name = 'Friday' THEN store_sales.ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN date_dim.d_day_name = 'Saturday' THEN store_sales.ss_sales_price ELSE NULL END) AS sat_sales FROM store_sales, date_dim WHERE date_dim.d_date_sk = store_sales.ss_sold_date_sk AND store_sales.ss_sales_price / store_sales.ss_list_price >= 39 * 0.01 AND store_sales.ss_sales_price / store_sales.ss_list_price <= 59 * 0.01 GROUP BY date_dim.d_week_seq, store_sales.ss_store_sk) AS t1, store, date_dim AS date_dim0 WHERE date_dim0.d_week_seq = t1.d_week_seq AND t1.ss_store_sk = store.s_store_sk AND date_dim0.d_month_seq >= 1212 AND date_dim0.d_month_seq <= 1212 + 11 AND store.s_state IN ('IL', 'IN', 'KY', 'MO', 'MT', 'OK', 'TX', 'WI')) AS t3, (SELECT store0.s_store_name AS s_store_name2, t6.d_week_seq AS d_week_seq2, store0.s_store_id AS s_store_id2, t6.sun_sales AS sun_sales2, t6.mon_sales AS mon_sales2, t6.tue_sales AS tue_sales2, t6.wed_sales AS wed_sales2, t6.thu_sales AS thu_sales2, t6.fri_sales AS fri_sales2, t6.sat_sales AS sat_sales2 FROM (SELECT date_dim1.d_week_seq, store_sales0.ss_store_sk, SUM(CASE WHEN date_dim1.d_day_name = 'Sunday' THEN store_sales0.ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN date_dim1.d_day_name = 'Monday' THEN store_sales0.ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN date_dim1.d_day_name = 'Tuesday' THEN store_sales0.ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN date_dim1.d_day_name = 'Wednesday' THEN store_sales0.ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN date_dim1.d_day_name = 'Thursday' THEN store_sales0.ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN date_dim1.d_day_name = 'Friday' THEN store_sales0.ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN date_dim1.d_day_name = 'Saturday' THEN store_sales0.ss_sales_price ELSE NULL END) AS sat_sales FROM store_sales AS store_sales0, date_dim AS date_dim1 WHERE date_dim1.d_date_sk = store_sales0.ss_sold_date_sk AND store_sales0.ss_sales_price / store_sales0.ss_list_price >= 39 * 0.01 AND store_sales0.ss_sales_price / store_sales0.ss_list_price <= 59 * 0.01 GROUP BY date_dim1.d_week_seq, store_sales0.ss_store_sk) AS t6, store AS store0, date_dim AS date_dim2 WHERE date_dim2.d_week_seq = t6.d_week_seq AND t6.ss_store_sk = store0.s_store_sk AND date_dim2.d_month_seq >= 1212 + 12 AND date_dim2.d_month_seq <= 1212 + 23 AND store0.s_state IN ('IL', 'IN', 'KY', 'MO', 'MT', 'OK', 'TX', 'WI')) AS t8 WHERE t3.s_store_id1 = t8.s_store_id2 AND t3.d_week_seq1 = t8.d_week_seq2 - 52 ORDER BY t3.s_store_name1, t3.s_store_id1, t3.d_week_seq1 LIMIT 100","['FILTER_PROJECT_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'JOIN_CONDITION_PUSH', 'SORT_REMOVE', 'SORT_JOIN_TRANSPOSE', 'FILTER_MERGE']",9.10187157,8.196233352,"['LogicalSort', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']]]], ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan']]]], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]"