,db_id,original_sql
0,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Children') and item2.i_manager_id between 6 and 25 and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 87 and 101 and s2.ss_list_price between 87 and 101  ;"
1,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 35 and 54 and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 132 and 146 and s2.ss_list_price between 132 and 146  ;"
2,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Caledonia County','Cleveland County','Montezuma County','Pearl River County','Pinal County') and c.c_birth_month in (4, 5) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('D', 'S', 'M') and cd_education_status in ('4 yr Degree', 'Unknown', '2 yr Degree') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+3 and  ss_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Shoes')  and ss_sales_price / ss_list_price BETWEEN 53 * 0.01 AND 63 * 0.01  and i_manager_id BETWEEN 28 and 37  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 ANd 9+3 and  ws_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Shoes')  and i_manager_id BETWEEN 28 and 37  and ws_sales_price / ws_list_price BETWEEN 53 * 0.01 AND 63 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+3 and  cs_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Shoes')  and i_manager_id BETWEEN 28 and 37  and cs_sales_price / cs_list_price BETWEEN 53 * 0.01 AND 63 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
3,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Men', 'Women') and item2.i_manager_id between 52 and 71 and cd_marital_status = 'U' and cd_education_status = 'Primary' and s1.ss_list_price between 73 and 87 and s2.ss_list_price between 73 and 87 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
4,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Union Hill' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 7 * 10000 and ib_upper_bound <= 7 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
5,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,max(ss_net_profit) as store_sales_profit ,max(sr_net_loss) as store_returns_loss ,max(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 2001 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
6,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'NY'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
7,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Meigs County','Pasco County','Richmond city','Washington County','White County') and c.c_birth_month in (2, 3) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'W', 'U') and cd_education_status in ('2 yr Degree', 'Unknown', 'Secondary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 5 and 5+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Jewelry')  and ss_sales_price / ss_list_price BETWEEN 16 * 0.01 AND 26 * 0.01  and i_manager_id BETWEEN 52 and 61  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 5 ANd 5+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Jewelry')  and i_manager_id BETWEEN 52 and 61  and ws_sales_price / ws_list_price BETWEEN 16 * 0.01 AND 26 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 5 and 5+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Jewelry')  and i_manager_id BETWEEN 52 and 61  and cs_sales_price / cs_list_price BETWEEN 16 * 0.01 AND 26 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
8,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1187 and 1187 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 271 and 300 and sm_type = 'LIBRARY' and cc_class = 'small' and w_gmt_offset = -5  ;"
9,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Jewelry') and item2.i_manager_id between 50 and 69 and cd_marital_status = 'S' and cd_education_status = 'Unknown' and s1.ss_list_price between 195 and 209 and s2.ss_list_price between 195 and 209 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
10,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 2 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7  ;"
11,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Music' and i_class = 'pop' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 7 and d_year = 2001 and wholesale_cost BETWEEN 69 AND 99 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 69 AND 99  and s_state in ('AK','IN','MO'   ,'MS','NE','NV'   ,'NY','SD','TX'   ,'UT')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 7)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 7) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
12,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2002-02-19','2002-06-13','2002-08-19','2002-10-10'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 31 and 40 and sr_return_amt / sr_return_quantity between 107 and 136 and sr_reason_sk in (14, 27, 52, 59, 66) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-02-19','2002-06-13','2002-08-19','2002-10-10'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 31 and 40 and cr_return_amount / cr_return_quantity between 107 and 136 and cr_reason_sk in (14, 27, 52, 59, 66) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-02-19','2002-06-13','2002-08-19','2002-10-10'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 31 and 40 and wr_return_amt / wr_return_quantity between 107 and 136 and wr_reason_sk in (14, 27, 52, 59, 66) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
13,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'UT'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
14,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Chattahoochee County','Ellis County','Hall County','Santa Cruz County','Van Wert County') and c.c_birth_month in (3, 6) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'W', 'W') and cd_education_status in ('2 yr Degree', '2 yr Degree', '2 yr Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 8 and 8+3 and  ss_item_sk = i_item_sk and  i_category in ('Home', 'Music', 'Women')  and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  and i_manager_id BETWEEN 12 and 21  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 8 ANd 8+3 and  ws_item_sk = i_item_sk and  i_category in ('Home', 'Music', 'Women')  and i_manager_id BETWEEN 12 and 21  and ws_sales_price / ws_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 8 and 8+3 and  cs_item_sk = i_item_sk and  i_category in ('Home', 'Music', 'Women')  and i_manager_id BETWEEN 12 and 21  and cs_sales_price / cs_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
15,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'U' and  cd_education_status = '4 yr Degree' and  d_year = 2000 and  s_state = 'NM' and i_category = 'Jewelry'  ;"
16,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Newtown' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 12783 and ib_upper_bound <= 12783 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
17,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 1 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 1 and 1 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 1 and 1 + 2 and d3.d_year  = 1998 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
18,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'MA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
19,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Deerfield' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 35037 and ib_upper_bound <= 35037 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
20,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 7 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
21,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-04-17')) and ss_sold_date_sk = d_date_sk and ss_list_price between 184 and 213 and i_manager_id BETWEEN 68 and 97 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1968 AND 1974 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-04-17')) and cs_sold_date_sk = d_date_sk and cs_list_price between 184 and 213 and i_manager_id BETWEEN 68 and 97 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1968 AND 1974 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-04-17')) and ws_sold_date_sk = d_date_sk and ws_list_price between 184 and 213 and i_manager_id BETWEEN 68 and 97 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1968 AND 1974 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
22,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Primary' and c_current_addr_sk = ca_address_sk and d_year = 2001 and c_birth_month = 9 and ca_state in ('MT', 'OR', 'SC') and cs_wholesale_cost BETWEEN 80 AND 85 AND i_category = 'Children' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
23,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 80 * 0.01 AND 100 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1205 and 1205 + 11  and s_state in ('GA','IL','LA'   ,'NE','NM','SC','WA','WY')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1205+ 12 and 1205 + 23  and s_state in ('GA','IL','LA'   ,'NE','NM','SC','WA','WY')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
24,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2000 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'MS'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
25,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = 'Secondary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'PA', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'VA', 'WY') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'HI', 'ID') and ss_net_profit between 50 and 250 ))  ;"
26,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Home') and item2.i_manager_id between 35 and 54 and cd_marital_status = 'W' and cd_education_status = 'Primary' and s1.ss_list_price between 279 and 293 and s2.ss_list_price between 279 and 293 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
27,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -7  ;"
28,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'College' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'IL', 'MO') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('LA', 'MA', 'MN') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'GA', 'UT') and ss_net_profit between 50 and 250 ))  ;"
29,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Maple Grove' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 5 * 10000 and ib_upper_bound <= 5 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
30,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Electronics') and item2.i_manager_id between 38 and 57 and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 61 and 75 and s2.ss_list_price between 61 and 75  ;"
31,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2002-03-05','2002-05-29','2002-09-14','2002-11-02'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 60 and 69 and sr_return_amt / sr_return_quantity between 123 and 152 and sr_reason_sk in (11, 14, 52, 65, 74) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-03-05','2002-05-29','2002-09-14','2002-11-02'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 60 and 69 and cr_return_amount / cr_return_quantity between 123 and 152 and cr_reason_sk in (11, 14, 52, 65, 74) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-03-05','2002-05-29','2002-09-14','2002-11-02'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 60 and 69 and wr_return_amt / wr_return_quantity between 123 and 152 and wr_reason_sk in (11, 14, 52, 65, 74) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
32,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Electronics' and i_class = 'scanners' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 12 and d_year = 2001 and wholesale_cost BETWEEN 68 AND 98 and c_birth_year BETWEEN 1934 AND 1947 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 68 AND 98  and s_state in ('AR','GA','NC'   ,'NE','NY','OK'   ,'TX','UT','VA'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 12)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 12) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
33,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Mountain View' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 2 * 10000 and ib_upper_bound <= 2 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
34,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 16 AND 36 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 56 and 56 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('IN','NM','OK') and ss_wholesale_cost BETWEEN 16 AND 36 and cd1.cd_marital_status in ('M', 'S', 'M') and cd1.cd_education_status in ('Advanced Degree', '2 yr Degree', '4 yr Degree') and cd2.cd_marital_status in ('M', 'S', 'M') and cd2.cd_education_status in ('Advanced Degree', '2 yr Degree', '4 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
35,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Secondary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'College' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'NC', 'SD') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CT', 'MO', 'MT') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MA', 'OK', 'TX') and ss_net_profit between 50 and 250 ))  ;"
36,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 67 AND 87 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 34 and 34 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('OR','TN','TX') and ss_wholesale_cost BETWEEN 67 AND 87 and cd1.cd_marital_status in ('S', 'S', 'U') and cd1.cd_education_status in ('2 yr Degree', 'Advanced Degree', 'Advanced Degree') and cd2.cd_marital_status in ('S', 'S', 'U') and cd2.cd_education_status in ('2 yr Degree', 'Advanced Degree', 'Advanced Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2000 and cs2.syear = 2000 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
37,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'OK', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'KS', 'MO') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'MI', 'NE') and ss_net_profit between 50 and 250 ))  ;"
38,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Sunnyside' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 3 * 10000 and ib_upper_bound <= 3 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
39,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
40,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-01-20','2001-05-24','2001-07-22','2001-11-15'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Men') and i_manager_id BETWEEN 87 and 96 and sr_return_amt / sr_return_quantity between 242 and 271 and sr_reason_sk in (16, 31, 37, 47, 71) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-01-20','2001-05-24','2001-07-22','2001-11-15'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Men') and i_manager_id BETWEEN 87 and 96 and cr_return_amount / cr_return_quantity between 242 and 271 and cr_reason_sk in (16, 31, 37, 47, 71) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-01-20','2001-05-24','2001-07-22','2001-11-15'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Men') and i_manager_id BETWEEN 87 and 96 and wr_return_amt / wr_return_quantity between 242 and 271 and wr_reason_sk in (16, 31, 37, 47, 71) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
41,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Shoes') and item2.i_manager_id between 100 and 119 and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 146 and 160 and s2.ss_list_price between 146 and 160 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
42,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Primary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'ME', 'VA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'TX', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NE', 'OH', 'PA') and ss_net_profit between 50 and 250 ))  ;"
43,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'ME'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
44,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 9 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 9 and 9 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 9 and 9 + 2 and d3.d_year  = 2001 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
45,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'S' and cd_education_status = 'Unknown' and d_year = 2001 and s_state = 'MI' and i_category = 'Books' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
46,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-02-04')) and ss_sold_date_sk = d_date_sk and ss_list_price between 141 and 170 and i_manager_id BETWEEN 20 and 49 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1972 AND 1978 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-02-04')) and cs_sold_date_sk = d_date_sk and cs_list_price between 141 and 170 and i_manager_id BETWEEN 20 and 49 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1972 AND 1978 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-02-04')) and ws_sold_date_sk = d_date_sk and ws_list_price between 141 and 170 and i_manager_id BETWEEN 20 and 49 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1972 AND 1978 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
47,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Greenwood' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 4 * 10000 and ib_upper_bound <= 4 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
48,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Cheshire County','Delaware County','Klamath County','Lemhi County','Weld County') and c.c_birth_month in (6, 9) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'S', 'S') and cd_education_status in ('4 yr Degree', 'Secondary', '4 yr Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Music')  and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  and i_manager_id BETWEEN 14 and 23  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 ANd 9+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Music')  and i_manager_id BETWEEN 14 and 23  and ws_sales_price / ws_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Music')  and i_manager_id BETWEEN 14 and 23  and cs_sales_price / cs_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
49,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Children', 'Electronics', 'Jewelry') and i_manager_id BETWEEN 86 and 95 and ss_wholesale_cost BETWEEN 38 AND 58 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Children', 'Electronics', 'Jewelry') and i_manager_id BETWEEN 86 and 95 and cs_wholesale_cost BETWEEN 38 AND 58 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 38 AND 58 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Electronics', 'Jewelry') and i_manager_id BETWEEN 86 and 95 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 38 AND 58  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 38 AND 58  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 38 AND 58 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 11) and i_category IN ('Children', 'Electronics', 'Jewelry') and i_manager_id BETWEEN 86 and 95 and ss_wholesale_cost BETWEEN 38 AND 58 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 11) and i_category IN ('Children', 'Electronics', 'Jewelry') and ss_wholesale_cost BETWEEN 38 AND 58 and i_manager_id BETWEEN 86 and 95 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
50,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Advanced Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 1998 and  c_birth_month = 8 and  ca_state in ('KS', 'OK', 'WI')  and cs_wholesale_cost BETWEEN 19 AND 24  AND i_category = 'Jewelry'  ;"
51,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 2 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
52,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Primary' and c_current_addr_sk = ca_address_sk and d_year = 1998 and c_birth_month = 11 and ca_state in ('MN', 'MS', 'MT') and cs_wholesale_cost BETWEEN 68 AND 73 AND i_category = 'Children' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
53,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KY', 'ND', 'NM') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('MD', 'NC', 'TN') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('ID', 'NC', 'SD') and ws_net_profit between 50 and 250 ) )  ;"
54,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 38 AND 58 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 33 and 33 + 10 and p_channel_email = 'Y' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('IL','MD','OR') and ss_wholesale_cost BETWEEN 38 AND 58 and cd1.cd_marital_status in ('M', 'M', 'U') and cd1.cd_education_status in ('Primary', 'Advanced Degree', 'Primary') and cd2.cd_marital_status in ('M', 'M', 'U') and cd2.cd_education_status in ('Primary', 'Advanced Degree', 'Primary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1999 and cs2.syear = 1999 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
55,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Children', 'Shoes') and i_manager_id BETWEEN 91 and 100 and ss_wholesale_cost BETWEEN 68 AND 88 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Children', 'Shoes') and i_manager_id BETWEEN 91 and 100 and cs_wholesale_cost BETWEEN 68 AND 88 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 68 AND 88 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Children', 'Shoes') and i_manager_id BETWEEN 91 and 100 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 68 AND 88  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 68 AND 88  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 68 AND 88 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 28) and i_category IN ('Books', 'Children', 'Shoes') and i_manager_id BETWEEN 91 and 100 and ss_wholesale_cost BETWEEN 68 AND 88 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 28) and i_category IN ('Books', 'Children', 'Shoes') and ss_wholesale_cost BETWEEN 68 AND 88 and i_manager_id BETWEEN 91 and 100 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
56,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Children' and i_class = 'infants' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 8 and d_year = 2001 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1979 AND 1992 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('FL','IL','KS'   ,'LA','NE','NV'   ,'OK','SD','TX'   ,'WV')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 8)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 8) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
57,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Electronics' and i_class = 'monitors' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 1 and d_year = 1999 and wholesale_cost BETWEEN 68 AND 98 and c_birth_year BETWEEN 1935 AND 1948 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 68 AND 98  and s_state in ('CA','CO','KY'   ,'MO','NE','NJ'   ,'NY','OH','SC'   ,'TX')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1999 and d_moy = 1)   and (select distinct d_month_seq+3   from date_dim where d_year = 1999 and d_moy = 1) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
58,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('beige', 'sandy') and i_manager_id BETWEEN 26 and 45 and ss_list_price between 32 and 46 and ca_state in ('NH','WV') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('beige', 'sandy') and i_manager_id BETWEEN 26 and 45 and ws_list_price between 32 and 46 and ca_state in ('NH','WV') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.ca_county ;"
59,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Books' and i_class = 'science' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 11 and d_year = 2002 and wholesale_cost BETWEEN 25 AND 55 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 25 AND 55  and s_state in ('AL','CA','ID'   ,'IL','KS','MD'   ,'NC','PA','TX'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2002 and d_moy = 11)   and (select distinct d_month_seq+3   from date_dim where d_year = 2002 and d_moy = 11) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
60,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Electronics' and i_class = 'camcorders' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 1 and d_year = 1999 and wholesale_cost BETWEEN 5 AND 35 and c_birth_year BETWEEN 1974 AND 1987 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 5 AND 35  and s_state in ('CO','KS','NH'   ,'NM','OH','SC'   ,'SD','TN','TX'   ,'WV')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1999 and d_moy = 1)   and (select distinct d_month_seq+3   from date_dim where d_year = 1999 and d_moy = 1) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
61,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Jewelry') and item2.i_manager_id between 75 and 94 and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 66 and 80 and s2.ss_list_price between 66 and 80  ;"
62,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 85 and 94 and wr_return_amt / wr_return_quantity between 103 and 132 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('IN', 'MN', 'NC', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (39, 42) and c_birth_year BETWEEN 1969 AND 1975 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
63,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'GA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
64,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Oakdale' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 2 * 10000 and ib_upper_bound <= 2 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
65,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Unknown' and  c_current_addr_sk = ca_address_sk and  d_year = 1998 and  c_birth_month = 5 and  ca_state in ('KY', 'NE', 'WY')  and cs_wholesale_cost BETWEEN 69 AND 74  AND i_category = 'Sports'  ;"
66,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
67,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Oakdale' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 8886 and ib_upper_bound <= 8886 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
68,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'KS'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
69,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-01-27','1999-04-24','1999-07-13','1999-10-04'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 71 and 80 and sr_return_amt / sr_return_quantity between 243 and 272 and sr_reason_sk in (7, 22, 38, 56, 64) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-01-27','1999-04-24','1999-07-13','1999-10-04'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 71 and 80 and cr_return_amount / cr_return_quantity between 243 and 272 and cr_reason_sk in (7, 22, 38, 56, 64) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-01-27','1999-04-24','1999-07-13','1999-10-04'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 71 and 80 and wr_return_amt / wr_return_quantity between 243 and 272 and wr_reason_sk in (7, 22, 38, 56, 64) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
70,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Electronics' and i_class = 'monitors' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 7 and d_year = 2000 and wholesale_cost BETWEEN 52 AND 82 and c_birth_year BETWEEN 1928 AND 1941 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 52 AND 82  and s_state in ('AR','CA','IN'   ,'KS','MN','MS'   ,'NJ','SC','TN'   ,'VA')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 7)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 7) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
71,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Lakewood' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 0 * 10000 and ib_upper_bound <= 0 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
72,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 2002  ;"
73,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Oakdale' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 5 * 10000 and ib_upper_bound <= 5 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
74,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 56 * 0.01 AND 76 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1185 and 1185 + 11  and s_state in ('AL','FL','GA'   ,'HI','ID','NY','VA','WY')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1185+ 12 and 1185 + 23  and s_state in ('AL','FL','GA'   ,'HI','ID','NY','VA','WY')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
75,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 32 AND 52 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 61 and 61 + 10 and p_channel_email = 'Y' and p_channel_tv = 'Y' and p_channel_radio = 'N' and ad2.ca_state in ('MS','SD','TX') and ss_wholesale_cost BETWEEN 32 AND 52 and cd1.cd_marital_status in ('S', 'W', 'W') and cd1.cd_education_status in ('4 yr Degree', 'Advanced Degree', '2 yr Degree') and cd2.cd_marital_status in ('S', 'W', 'W') and cd2.cd_education_status in ('4 yr Degree', 'Advanced Degree', '2 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
76,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-03-24')) and ss_sold_date_sk = d_date_sk and ss_list_price between 90 and 119 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1934 AND 1940 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-03-24')) and cs_sold_date_sk = d_date_sk and cs_list_price between 90 and 119 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1934 AND 1940 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-03-24')) and ws_sold_date_sk = d_date_sk and ws_list_price between 90 and 119 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1934 AND 1940 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
77,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Secondary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MI', 'NM', 'NY') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'GA', 'IL') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'MS', 'NJ') and ss_net_profit between 50 and 250 ))  ;"
78,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 9 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 9 and 9 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 9 and 9 + 2 and d3.d_year  = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
79,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 and i_category IN ('Shoes', 'Sports', 'Women') and i_manager_id BETWEEN 2 and 11 and ss_wholesale_cost BETWEEN 74 AND 94 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 and i_category IN ('Shoes', 'Sports', 'Women') and i_manager_id BETWEEN 2 and 11 and cs_wholesale_cost BETWEEN 74 AND 94 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 74 AND 94 and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Shoes', 'Sports', 'Women') and i_manager_id BETWEEN 2 and 11 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and ss_wholesale_cost BETWEEN 74 AND 94  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and cs_wholesale_cost BETWEEN 74 AND 94  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 74 AND 94 and d_year between 1999 and 1999 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999 + 1   and d_moy = 12   and d_dom = 12) and i_category IN ('Shoes', 'Sports', 'Women') and i_manager_id BETWEEN 2 and 11 and ss_wholesale_cost BETWEEN 74 AND 94 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999   and d_moy = 12   and d_dom = 12) and i_category IN ('Shoes', 'Sports', 'Women') and ss_wholesale_cost BETWEEN 74 AND 94 and i_manager_id BETWEEN 2 and 11 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
80,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7  ;"
81,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1211 and 1211 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 260 and 289 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5  ;"
82,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 2000  ;"
83,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = 'Unknown' and c_current_addr_sk = ca_address_sk and d_year = 1999 and c_birth_month = 3 and ca_state in ('CA', 'KS', 'SC') and cs_wholesale_cost BETWEEN 53 AND 58 AND i_category = 'Jewelry' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
84,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1207 and 1207+11 and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1207 and 1207+11 and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 94 and 98  and s_state in ('CA','KS','SD') order by s_store_name, i_item_desc limit 100 ;"
85,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = 'Unknown' and c_current_addr_sk = ca_address_sk and d_year = 2001 and c_birth_month = 10 and ca_state in ('DC', 'OK', 'PA') and cs_wholesale_cost BETWEEN 95 AND 100 AND i_category = 'Home' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
86,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Jewelry' and i_class = 'jewelry boxes' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 3 and d_year = 2001 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1930 AND 1943 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('CA','FL','KY'   ,'LA','MO','NY'   ,'OK','SC','SD'   ,'VA')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 3)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
87,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '2 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2001 and  c_birth_month = 9 and  ca_state in ('AR', 'GA', 'SD')  and cs_wholesale_cost BETWEEN 63 AND 68  AND i_category = 'Women'  ;"
88,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Mount Pleasant' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 6 * 10000 and ib_upper_bound <= 6 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
89,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NE', 'TX', 'VA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'MS', 'WV') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CA', 'KS', 'TX') and ss_net_profit between 50 and 250 ))  ;"
90,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = 'Advanced Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2002 and  c_birth_month = 11 and  ca_state in ('CO', 'GA', 'TN')  and cs_wholesale_cost BETWEEN 43 AND 48  AND i_category = 'Sports'  ;"
91,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Macedonia' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 5 * 10000 and ib_upper_bound <= 5 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
92,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1189 and 1189 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 19 and 48 and sm_type = 'OVERNIGHT' and cc_class = 'large' and w_gmt_offset = -5  ;"
93,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 and sr_return_amt / sr_return_quantity between 40 and 99 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 12 AND 15 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('CO', 'SC', 'WV') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'S') and cd_education_status IN ('2 yr Degree', '4 yr Degree') and cd_gender = 'F' and c_birth_month = 2 and c_birth_year BETWEEN 1976 AND 1982 order by c_customer_id limit 100 ;"
94,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 4 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
95,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 1998  ;"
96,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 2002  ;"
97,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('FL', 'IL', 'MT') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AK', 'FL', 'NY') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('FL', 'NE', 'VA') and ws_net_profit between 50 and 250 ) )  ;"
98,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Secondary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MA', 'OR', 'WA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'TX', 'WY') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('OH', 'SC', 'TX') and ss_net_profit between 50 and 250 ))  ;"
99,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Home') and item2.i_manager_id between 56 and 75 and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 126 and 140 and s2.ss_list_price between 126 and 140 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
100,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-01-10')) and ss_sold_date_sk = d_date_sk and ss_list_price between 90 and 119 and i_manager_id BETWEEN 26 and 55 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1937 AND 1943 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-01-10')) and cs_sold_date_sk = d_date_sk and cs_list_price between 90 and 119 and i_manager_id BETWEEN 26 and 55 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1937 AND 1943 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-01-10')) and ws_sold_date_sk = d_date_sk and ws_list_price between 90 and 119 and i_manager_id BETWEEN 26 and 55 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1937 AND 1943 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
101,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('FL', 'MI', 'NC') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AR', 'IN', 'TN') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('MS', 'MT', 'TX') and ws_net_profit between 50 and 250 ) )  ;"
102,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 9 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 9 and 9 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 9 and 9 + 2 and d3.d_year  = 2002  ;"
103,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1185 and 1185 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 271 and 300 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5  ;"
104,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 76 and 85 and wr_return_amt / wr_return_quantity between 135 and 164 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AR', 'KY', 'NE', 'UT')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (27, 30) and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
105,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'S' and  cd_education_status = '4 yr Degree' and  d_year = 2000 and  s_state = 'KY' and i_category = 'Jewelry'  ;"
106,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'LA', 'OK') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'ME', 'NC') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IA', 'IL', 'MI') and ss_net_profit between 50 and 250 ))  ;"
107,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 1999  ;"
108,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 1998  ;"
109,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CO', 'NC', 'WV') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'GA', 'NC') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'GA', 'IA') and ss_net_profit between 50 and 250 ))  ;"
110,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 10 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -6  ;"
111,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'M' and  cd_education_status = 'Primary' and  d_year = 1998 and  s_state = 'CA' and i_category = 'Children'  ;"
112,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 18 and 27 and wr_return_amt / wr_return_quantity between 35 and 64 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CO', 'ID', 'OK', 'PA')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (28, 59) and c_birth_year BETWEEN 1977 AND 1983 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
113,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 1 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7  ;"
114,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'NC'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
115,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 91 and 100 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 91 and 100 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 80 AND 100 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 91 and 100 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 80 AND 100  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 80 AND 100  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 80 AND 100 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 3) and i_category IN ('Books', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 91 and 100 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 3) and i_category IN ('Books', 'Jewelry', 'Shoes') and ss_wholesale_cost BETWEEN 80 AND 100 and i_manager_id BETWEEN 91 and 100 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
116,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1192 and 1192+11 and ss_sales_price / ss_list_price BETWEEN 43 * 0.01 AND 53 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1192 and 1192+11 and ss_sales_price / ss_list_price BETWEEN 43 * 0.01 AND 53 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 64 and 68  and s_state in ('KS','KY','OH') order by s_store_name, i_item_desc limit 100 ;"
117,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 11 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -6  ;"
118,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Children' and i_class = 'infants' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 6 and d_year = 1999 and wholesale_cost BETWEEN 1 AND 31 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 1 AND 31  and s_state in ('HI','IL','MI'   ,'MN','NC','NE'   ,'OH','PA','TX'   ,'UT')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1999 and d_moy = 6)   and (select distinct d_month_seq+3   from date_dim where d_year = 1999 and d_moy = 6) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
119,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Women') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 228 and 242 and s2.ss_list_price between 228 and 242 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
120,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Advanced Degree' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 2 and ca_state in ('MT', 'PA', 'UT') and cs_wholesale_cost BETWEEN 1 AND 6 AND i_category = 'Sports' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
121,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 1999 and  c_birth_month = 8 and  ca_state in ('KS', 'MD', 'NC')  and cs_wholesale_cost BETWEEN 70 AND 75  AND i_category = 'Books'  ;"
122,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Riverside' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 0 * 10000 and ib_upper_bound <= 0 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
123,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('MS','TN','VA') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'W', 'S') and cd_education_status in ('Advanced Degree', 'Secondary') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 8 and 8+2  and ss_list_price between 158 and 247 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 8 and 8+2  and ws_list_price between 158 and 247  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 8 and 8+2  and cs_list_price between 158 and 247)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
124,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 80 AND 100 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 63 and 63 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('NE','PA','TN') and ss_wholesale_cost BETWEEN 80 AND 100 and cd1.cd_marital_status in ('W', 'S', 'M') and cd1.cd_education_status in ('Advanced Degree', 'College', 'Secondary') and cd2.cd_marital_status in ('W', 'S', 'M') and cd2.cd_education_status in ('Advanced Degree', 'College', 'Secondary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
125,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 77 AND 97 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 3 and 3 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('KY','NY','TX') and ss_wholesale_cost BETWEEN 77 AND 97 and cd1.cd_marital_status in ('S', 'W', 'W') and cd1.cd_education_status in ('Secondary', '4 yr Degree', '2 yr Degree') and cd2.cd_marital_status in ('S', 'W', 'W') and cd2.cd_education_status in ('Secondary', '4 yr Degree', '2 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2000 and cs2.syear = 2000 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
126,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Sports' and i_class = 'optics' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 10 and d_year = 2000 and wholesale_cost BETWEEN 33 AND 63 and c_birth_year BETWEEN 1966 AND 1979 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 33 AND 63  and s_state in ('IL','IN','KY'   ,'MO','MS','MT'   ,'OK','TX','WA'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 10)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 10) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
127,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 1 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
128,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2000-03-20','2000-06-08','2000-09-07','2000-10-28'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 76 and 85 and sr_return_amt / sr_return_quantity between 125 and 154 and sr_reason_sk in (9, 13, 27, 33, 52) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-03-20','2000-06-08','2000-09-07','2000-10-28'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 76 and 85 and cr_return_amount / cr_return_quantity between 125 and 154 and cr_reason_sk in (9, 13, 27, 33, 52) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-03-20','2000-06-08','2000-09-07','2000-10-28'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 76 and 85 and wr_return_amt / wr_return_quantity between 125 and 154 and wr_reason_sk in (9, 13, 27, 33, 52) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
129,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Shoes') and item2.i_manager_id between 40 and 59 and cd_marital_status = 'W' and cd_education_status = 'Unknown' and s1.ss_list_price between 162 and 176 and s2.ss_list_price between 162 and 176  ;"
130,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('FL', 'NE', 'OR') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('OK', 'TX', 'VA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'NC', 'WY') and ws_net_profit between 50 and 250 ) )  ;"
131,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'College' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IL', 'MI', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('KY', 'SD', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('ND', 'TN', 'UT') and ws_net_profit between 50 and 250 ) )  ;"
132,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'U' and  cd_education_status = 'Primary' and  d_year = 1998 and  s_state = 'AK' and i_category = 'Women'  ;"
133,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'TN'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
134,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 80 AND 100 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 50 and 50 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('MN','OK','WV') and ss_wholesale_cost BETWEEN 80 AND 100 and cd1.cd_marital_status in ('M', 'M', 'M') and cd1.cd_education_status in ('2 yr Degree', 'Unknown', 'Advanced Degree') and cd2.cd_marital_status in ('M', 'M', 'M') and cd2.cd_education_status in ('2 yr Degree', 'Unknown', 'Advanced Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
135,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 80 AND 100 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 3 and 3 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('FL','NV','SD') and ss_wholesale_cost BETWEEN 80 AND 100 and cd1.cd_marital_status in ('U', 'M', 'S') and cd1.cd_education_status in ('4 yr Degree', 'Secondary', 'Advanced Degree') and cd2.cd_marital_status in ('U', 'M', 'S') and cd2.cd_education_status in ('4 yr Degree', 'Secondary', 'Advanced Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
136,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('PA', 'TN', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CO', 'CT', 'MN') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'CO', 'MI') and ss_net_profit between 50 and 250 ))  ;"
137,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 46 and 65 and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 14 and 28 and s2.ss_list_price between 14 and 28  ;"
138,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Home') and item2.i_manager_id between 27 and 46 and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 95 and 109 and s2.ss_list_price between 95 and 109 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
139,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Cumberland County','Fayette County','Jefferson County','Mason County','Montgomery County') and c.c_birth_month in (7, 11) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'U', 'U') and cd_education_status in ('Secondary', '4 yr Degree', 'Primary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 and 8+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Men')  and ss_sales_price / ss_list_price BETWEEN 45 * 0.01 AND 55 * 0.01  and i_manager_id BETWEEN 86 and 95  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 ANd 8+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Men')  and i_manager_id BETWEEN 86 and 95  and ws_sales_price / ws_list_price BETWEEN 45 * 0.01 AND 55 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 and 8+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Men')  and i_manager_id BETWEEN 86 and 95  and cs_sales_price / cs_list_price BETWEEN 45 * 0.01 AND 55 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
140,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'D' and  cd_education_status = 'Unknown' and  d_year = 2000 and  s_state = 'AZ' and i_category = 'Books'  ;"
141,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Advanced Degree' and c_current_addr_sk = ca_address_sk and d_year = 2001 and c_birth_month = 10 and ca_state in ('NE', 'SD', 'WV') and cs_wholesale_cost BETWEEN 35 AND 40 AND i_category = 'Jewelry' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
142,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 8 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 8 and 8 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 8 and 8 + 2 and d3.d_year  = 1999  ;"
143,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Secondary' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 2 and ca_state in ('KY', 'TX', 'WI') and cs_wholesale_cost BETWEEN 84 AND 89 AND i_category = 'Children' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
144,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2001 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 81 and 90 and wr_return_amt / wr_return_quantity between 37 and 66 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('FL', 'ID', 'IN', 'PA')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (2, 19) and c_birth_year BETWEEN 1951 AND 1957 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
145,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Books' and i_class = 'home repair' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 9 and d_year = 2002 and wholesale_cost BETWEEN 66 AND 96 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 66 AND 96  and s_state in ('AL','CO','KS'   ,'KY','MA','MO'   ,'NE','TX','WI'   ,'WY')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2002 and d_moy = 9)   and (select distinct d_month_seq+3   from date_dim where d_year = 2002 and d_moy = 9) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
146,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Secondary' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 9 and  ca_state in ('IL', 'MT', 'TX')  and cs_wholesale_cost BETWEEN 92 AND 97  AND i_category = 'Jewelry'  ;"
147,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Primary' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 2 and ca_state in ('MI', 'NJ', 'PA') and cs_wholesale_cost BETWEEN 38 AND 43 AND i_category = 'Children' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
148,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'VA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
149,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2001 and  c_birth_month = 9 and  ca_state in ('IL', 'MS', 'VA')  and cs_wholesale_cost BETWEEN 78 AND 83  AND i_category = 'Jewelry'  ;"
150,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Primary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NE', 'SC', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MT', 'NC', 'WI') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'MI', 'OH') and ss_net_profit between 50 and 250 ))  ;"
151,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
152,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Children') and item2.i_manager_id between 26 and 45 and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 107 and 121 and s2.ss_list_price between 107 and 121  ;"
153,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Grayson County','Marion County','Southampton County','Taylor County','Whitley County') and c.c_birth_month in (5, 8) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'M', 'S') and cd_education_status in ('4 yr Degree', '2 yr Degree', '4 yr Degree') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 2 and 2+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Music')  and ss_sales_price / ss_list_price BETWEEN 39 * 0.01 AND 49 * 0.01  and i_manager_id BETWEEN 28 and 37  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 2 ANd 2+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Music')  and i_manager_id BETWEEN 28 and 37  and ws_sales_price / ws_list_price BETWEEN 39 * 0.01 AND 49 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 2 and 2+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Music')  and i_manager_id BETWEEN 28 and 37  and cs_sales_price / cs_list_price BETWEEN 39 * 0.01 AND 49 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
154,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1195 and 1195+11 and ss_sales_price / ss_list_price BETWEEN 23 * 0.01 AND 33 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1195 and 1195+11 and ss_sales_price / ss_list_price BETWEEN 23 * 0.01 AND 33 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 82 and 86  and s_state in ('IN','KY','OR') order by s_store_name, i_item_desc limit 100 ;"
155,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-06-16')) and ss_sold_date_sk = d_date_sk and ss_list_price between 246 and 275 and i_manager_id BETWEEN 23 and 52 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1936 AND 1942 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-06-16')) and cs_sold_date_sk = d_date_sk and cs_list_price between 246 and 275 and i_manager_id BETWEEN 23 and 52 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1936 AND 1942 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-06-16')) and ws_sold_date_sk = d_date_sk and ws_list_price between 246 and 275 and i_manager_id BETWEEN 23 and 52 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1936 AND 1942 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
156,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 2000  ;"
157,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'S' and  cd_education_status = '2 yr Degree' and  d_year = 1999 and  s_state = 'KS' and i_category = 'Shoes'  ;"
158,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Highland Park' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 41471 and ib_upper_bound <= 41471 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
159,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Calaveras County','Cheboygan County','Massac County','McPherson County','Wilcox County') and c.c_birth_month in (7, 11) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'W', 'U') and cd_education_status in ('Secondary', 'Primary', 'Secondary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 2 and 2+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Jewelry')  and ss_sales_price / ss_list_price BETWEEN 78 * 0.01 AND 88 * 0.01  and i_manager_id BETWEEN 13 and 22  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 2 ANd 2+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Jewelry')  and i_manager_id BETWEEN 13 and 22  and ws_sales_price / ws_list_price BETWEEN 78 * 0.01 AND 88 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 2 and 2+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Jewelry')  and i_manager_id BETWEEN 13 and 22  and cs_sales_price / cs_list_price BETWEEN 78 * 0.01 AND 88 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
160,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Riverdale' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 5 * 10000 and ib_upper_bound <= 5 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
161,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'KY', 'MO') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'TN', 'UT') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('NE', 'OH', 'TX') and ws_net_profit between 50 and 250 ) )  ;"
162,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 and i_category IN ('Children', 'Sports', 'Women') and i_manager_id BETWEEN 29 and 38 and ss_wholesale_cost BETWEEN 51 AND 71 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 and i_category IN ('Children', 'Sports', 'Women') and i_manager_id BETWEEN 29 and 38 and cs_wholesale_cost BETWEEN 51 AND 71 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 51 AND 71 and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Sports', 'Women') and i_manager_id BETWEEN 29 and 38 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and ss_wholesale_cost BETWEEN 51 AND 71  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and cs_wholesale_cost BETWEEN 51 AND 71  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 51 AND 71 and d_year between 1999 and 1999 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999 + 1   and d_moy = 12   and d_dom = 12) and i_category IN ('Children', 'Sports', 'Women') and i_manager_id BETWEEN 29 and 38 and ss_wholesale_cost BETWEEN 51 AND 71 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999   and d_moy = 12   and d_dom = 12) and i_category IN ('Children', 'Sports', 'Women') and ss_wholesale_cost BETWEEN 51 AND 71 and i_manager_id BETWEEN 29 and 38 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
163,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'M' and  cd_education_status = 'Secondary' and  d_year = 1998 and  s_state = 'AR' and i_category = 'Women'  ;"
164,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = 'Advanced Degree' and c_current_addr_sk = ca_address_sk and d_year = 2002 and c_birth_month = 11 and ca_state in ('CO', 'GA', 'TN') and cs_wholesale_cost BETWEEN 43 AND 48 AND i_category = 'Sports' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
165,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2000 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'TX'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
166,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Northampton County','Pendleton County','Perry County','Randolph County','Woods County') and c.c_birth_month in (7, 11) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'M', 'M') and cd_education_status in ('4 yr Degree', 'Unknown', 'Unknown') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 4 and 4+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Electronics', 'Sports')  and ss_sales_price / ss_list_price BETWEEN 77 * 0.01 AND 87 * 0.01  and i_manager_id BETWEEN 91 and 100  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 4 ANd 4+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Electronics', 'Sports')  and i_manager_id BETWEEN 91 and 100  and ws_sales_price / ws_list_price BETWEEN 77 * 0.01 AND 87 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 4 and 4+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Electronics', 'Sports')  and i_manager_id BETWEEN 91 and 100  and cs_sales_price / cs_list_price BETWEEN 77 * 0.01 AND 87 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
167,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'S' and cd_education_status = 'Secondary' and s1.ss_list_price between 225 and 239 and s2.ss_list_price between 225 and 239 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
168,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 80 AND 100 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 68 and 68 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('MO','SD','VA') and ss_wholesale_cost BETWEEN 80 AND 100 and cd1.cd_marital_status in ('S', 'S', 'S') and cd1.cd_education_status in ('Advanced Degree', 'Advanced Degree', 'Advanced Degree') and cd2.cd_marital_status in ('S', 'S', 'S') and cd2.cd_education_status in ('Advanced Degree', 'Advanced Degree', 'Advanced Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1999 and cs2.syear = 1999 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
169,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = 'Unknown' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '2 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CA', 'NY', 'RI') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'KY', 'OK') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'SD', 'VA') and ss_net_profit between 50 and 250 ))  ;"
170,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IN', 'NC', 'NE') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('KY', 'MS', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('MO', 'NJ', 'NY') and ws_net_profit between 50 and 250 ) )  ;"
171,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('chartreuse', 'cornsilk') and i_manager_id BETWEEN 20 and 39 and ss_list_price between 125 and 139 and ca_state in ('IL','MS') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('chartreuse', 'cornsilk') and i_manager_id BETWEEN 20 and 39 and ws_list_price between 125 and 139 and ca_state in ('IL','MS') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;"
172,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Women' and i_class = 'maternity' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 4 and d_year = 2001 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1935 AND 1948 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('AL','CA','KY'   ,'MO','NC','NJ'   ,'NY','OK','WI'   ,'WV')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 4)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 4) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
173,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1202 and 1202 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 180 and 209 and sm_type = 'REGULAR' and cc_class = 'large' and w_gmt_offset = -5  ;"
174,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Cumberland County','Lee County','Logan County','Stokes County','Wabash County') and c.c_birth_month in (5, 6) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'S', 'W') and cd_education_status in ('4 yr Degree', 'Advanced Degree', 'Unknown') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 and 3+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Shoes')  and ss_sales_price / ss_list_price BETWEEN 71 * 0.01 AND 81 * 0.01  and i_manager_id BETWEEN 78 and 87  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 ANd 3+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Shoes')  and i_manager_id BETWEEN 78 and 87  and ws_sales_price / ws_list_price BETWEEN 71 * 0.01 AND 81 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 and 3+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Shoes')  and i_manager_id BETWEEN 78 and 87  and cs_sales_price / cs_list_price BETWEEN 71 * 0.01 AND 81 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
175,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'KS', 'NY') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NM', 'TX', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'NY', 'TX') and ss_net_profit between 50 and 250 ))  ;"
176,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Springfield' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 7 * 10000 and ib_upper_bound <= 7 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
177,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -6  ;"
178,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -7  ;"
179,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Women') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 119 and 133 and s2.ss_list_price between 119 and 133  ;"
180,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'U' and  cd_education_status = 'Advanced Degree' and  d_year = 1999 and  s_state = 'MN' and i_category = 'Jewelry'  ;"
181,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,stddev_samp(ss_net_profit) as store_sales_profit ,stddev_samp(sr_net_loss) as store_returns_loss ,stddev_samp(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 2001 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
182,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'GA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
183,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Shoes') and item2.i_manager_id between 68 and 87 and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 125 and 139 and s2.ss_list_price between 125 and 139  ;"
184,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Chatham County','Craig County','Greene County','Oxford County','Twiggs County') and c.c_birth_month in (7, 12) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'W', 'S') and cd_education_status in ('Secondary', 'Secondary', 'Secondary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 9 and 9+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Women')  and ss_sales_price / ss_list_price BETWEEN 75 * 0.01 AND 85 * 0.01  and i_manager_id BETWEEN 34 and 43  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 9 ANd 9+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Women')  and i_manager_id BETWEEN 34 and 43  and ws_sales_price / ws_list_price BETWEEN 75 * 0.01 AND 85 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 9 and 9+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Women')  and i_manager_id BETWEEN 34 and 43  and cs_sales_price / cs_list_price BETWEEN 75 * 0.01 AND 85 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
185,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CA', 'KS', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'ID', 'IL') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MD', 'NC', 'WI') and ss_net_profit between 50 and 250 ))  ;"
186,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'S' and  cd_education_status = '4 yr Degree' and  d_year = 2000 and  s_state = 'WV' and i_category = 'Sports'  ;"
187,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Jewelry' and i_class = 'jewelry boxes' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 8 and d_year = 2002 and wholesale_cost BETWEEN 29 AND 59 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 29 AND 59  and s_state in ('GA','KY','MN'   ,'MO','MT','NC'   ,'SC','VA','VT'   ,'WA')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2002 and d_moy = 8)   and (select distinct d_month_seq+3   from date_dim where d_year = 2002 and d_moy = 8) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
188,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Red Hill' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 3 * 10000 and ib_upper_bound <= 3 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
189,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 10 and 29 and cd_marital_status = 'U' and cd_education_status = 'Secondary' and s1.ss_list_price between 78 and 92 and s2.ss_list_price between 78 and 92  ;"
190,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 11 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -6  ;"
191,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Jewelry') and item2.i_manager_id between 51 and 70 and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 86 and 100 and s2.ss_list_price between 86 and 100  ;"
192,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Secondary' and c_current_addr_sk = ca_address_sk and d_year = 1998 and c_birth_month = 1 and ca_state in ('LA', 'MA', 'MN') and cs_wholesale_cost BETWEEN 48 AND 53 AND i_category = 'Jewelry' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
193,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 38 and 47 and ss_wholesale_cost BETWEEN 56 AND 76 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 38 and 47 and cs_wholesale_cost BETWEEN 56 AND 76 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 56 AND 76 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 38 and 47 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 56 AND 76  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 56 AND 76  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 56 AND 76 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 1) and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 38 and 47 and ss_wholesale_cost BETWEEN 56 AND 76 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 1) and i_category IN ('Home', 'Jewelry', 'Women') and ss_wholesale_cost BETWEEN 56 AND 76 and i_manager_id BETWEEN 38 and 47 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
194,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Children', 'Women') and i_manager_id BETWEEN 26 and 35 and ss_wholesale_cost BETWEEN 56 AND 76 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Children', 'Women') and i_manager_id BETWEEN 26 and 35 and cs_wholesale_cost BETWEEN 56 AND 76 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 56 AND 76 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Children', 'Women') and i_manager_id BETWEEN 26 and 35 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 56 AND 76  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 56 AND 76  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 56 AND 76 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 18) and i_category IN ('Books', 'Children', 'Women') and i_manager_id BETWEEN 26 and 35 and ss_wholesale_cost BETWEEN 56 AND 76 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 18) and i_category IN ('Books', 'Children', 'Women') and ss_wholesale_cost BETWEEN 56 AND 76 and i_manager_id BETWEEN 26 and 35 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
195,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7  ;"
196,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Sports') and item2.i_manager_id between 36 and 55 and cd_marital_status = 'M' and cd_education_status = 'Primary' and s1.ss_list_price between 147 and 161 and s2.ss_list_price between 147 and 161 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
197,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = 'Secondary' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 11 and  ca_state in ('OH', 'SC', 'TN')  and cs_wholesale_cost BETWEEN 8 AND 13  AND i_category = 'Shoes'  ;"
198,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Unionville' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 1 * 10000 and ib_upper_bound <= 1 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
199,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Secondary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'MO', 'MS') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'WA', 'WI') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'MO', 'MT') and ss_net_profit between 50 and 250 ))  ;"
200,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Bibb County','Lincoln County','Power County','Pulaski County','Telfair County') and c.c_birth_month in (5, 11) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'W', 'U') and cd_education_status in ('Primary', 'Secondary', 'Primary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 2 and 2+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Women')  and ss_sales_price / ss_list_price BETWEEN 84 * 0.01 AND 94 * 0.01  and i_manager_id BETWEEN 17 and 26  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 2 ANd 2+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Women')  and i_manager_id BETWEEN 17 and 26  and ws_sales_price / ws_list_price BETWEEN 84 * 0.01 AND 94 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 2 and 2+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Women')  and i_manager_id BETWEEN 17 and 26  and cs_sales_price / cs_list_price BETWEEN 84 * 0.01 AND 94 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
201,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '2 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2002 and  c_birth_month = 12 and  ca_state in ('ID', 'ME', 'OK')  and cs_wholesale_cost BETWEEN 39 AND 44  AND i_category = 'Home'  ;"
202,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Children') and item2.i_manager_id between 6 and 25 and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 87 and 101 and s2.ss_list_price between 87 and 101 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
203,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2002 and  c_birth_month = 7 and  ca_state in ('IL', 'TN', 'WA')  and cs_wholesale_cost BETWEEN 66 AND 71  AND i_category = 'Children'  ;"
204,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'U' and cd_education_status = 'Primary' and d_year = 1998 and s_state = 'UT' and i_category = 'Jewelry' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
205,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('cornsilk', 'lace') and i_manager_id BETWEEN 62 and 81 and ss_list_price between 82 and 96 and ca_state in ('KY','MN') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('cornsilk', 'lace') and i_manager_id BETWEEN 62 and 81 and ws_list_price between 82 and 96 and ca_state in ('KY','MN') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q1_q2_increase ;"
206,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1202 and 1202 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 271 and 300 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5  ;"
207,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MA', 'NC', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IN', 'MT', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AL', 'NY', 'TX') and ws_net_profit between 50 and 250 ) )  ;"
208,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 16 and 25 and wr_return_amt / wr_return_quantity between 178 and 207 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AR', 'MO', 'SD', 'VT')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (62, 65) and c_birth_year BETWEEN 1976 AND 1982 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
209,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AL', 'IL', 'NY') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('LA', 'MN', 'MO') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'MA', 'UT') and ws_net_profit between 50 and 250 ) )  ;"
210,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
211,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 5 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
212,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 34 AND 54 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 24 and 24 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('NC','NJ','WV') and ss_wholesale_cost BETWEEN 34 AND 54 and cd1.cd_marital_status in ('M', 'W', 'W') and cd1.cd_education_status in ('Secondary', 'Advanced Degree', '2 yr Degree') and cd2.cd_marital_status in ('M', 'W', 'W') and cd2.cd_education_status in ('Secondary', 'Advanced Degree', '2 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2000 and cs2.syear = 2000 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
213,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'MN'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
214,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Green Acres' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 6 * 10000 and ib_upper_bound <= 6 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
215,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'W' and  cd_education_status = 'Unknown' and  d_year = 2001 and  s_state = 'OH' and i_category = 'Women'  ;"
216,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 7 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -7  ;"
217,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,avg(ss_net_profit) as store_sales_profit ,avg(sr_net_loss) as store_returns_loss ,avg(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
218,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
219,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 80 AND 100 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 57 and 57 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('AL','CO','KY') and ss_wholesale_cost BETWEEN 80 AND 100 and cd1.cd_marital_status in ('S', 'W', 'M') and cd1.cd_education_status in ('Advanced Degree', 'Secondary', 'Secondary') and cd2.cd_marital_status in ('S', 'W', 'M') and cd2.cd_education_status in ('Advanced Degree', 'Secondary', 'Secondary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1999 and cs2.syear = 1999 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
220,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Wilson' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 28091 and ib_upper_bound <= 28091 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
221,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Home', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 61 and 70 and ss_wholesale_cost BETWEEN 23 AND 43 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Home', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 61 and 70 and cs_wholesale_cost BETWEEN 23 AND 43 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 23 AND 43 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Home', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 61 and 70 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 23 AND 43  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 23 AND 43  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 23 AND 43 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 14) and i_category IN ('Home', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 61 and 70 and ss_wholesale_cost BETWEEN 23 AND 43 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 14) and i_category IN ('Home', 'Jewelry', 'Shoes') and ss_wholesale_cost BETWEEN 23 AND 43 and i_manager_id BETWEEN 61 and 70 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
222,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'MI'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
223,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'NE'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
224,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 and i_category IN ('Books', 'Music', 'Shoes') and i_manager_id BETWEEN 46 and 55 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 and i_category IN ('Books', 'Music', 'Shoes') and i_manager_id BETWEEN 46 and 55 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 80 AND 100 and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Music', 'Shoes') and i_manager_id BETWEEN 46 and 55 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and ss_wholesale_cost BETWEEN 80 AND 100  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and cs_wholesale_cost BETWEEN 80 AND 100  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 80 AND 100 and d_year between 1999 and 1999 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999 + 1   and d_moy = 12   and d_dom = 5) and i_category IN ('Books', 'Music', 'Shoes') and i_manager_id BETWEEN 46 and 55 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999   and d_moy = 12   and d_dom = 5) and i_category IN ('Books', 'Music', 'Shoes') and ss_wholesale_cost BETWEEN 80 AND 100 and i_manager_id BETWEEN 46 and 55 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
225,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 and i_category IN ('Books', 'Children', 'Home') and i_manager_id BETWEEN 7 and 16 and ss_wholesale_cost BETWEEN 43 AND 63 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 and i_category IN ('Books', 'Children', 'Home') and i_manager_id BETWEEN 7 and 16 and cs_wholesale_cost BETWEEN 43 AND 63 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 43 AND 63 and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Children', 'Home') and i_manager_id BETWEEN 7 and 16 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and ss_wholesale_cost BETWEEN 43 AND 63  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and cs_wholesale_cost BETWEEN 43 AND 63  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 43 AND 63 and d_year between 1999 and 1999 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999 + 1   and d_moy = 12   and d_dom = 24) and i_category IN ('Books', 'Children', 'Home') and i_manager_id BETWEEN 7 and 16 and ss_wholesale_cost BETWEEN 43 AND 63 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999   and d_moy = 12   and d_dom = 24) and i_category IN ('Books', 'Children', 'Home') and ss_wholesale_cost BETWEEN 43 AND 63 and i_manager_id BETWEEN 7 and 16 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
226,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'U' and  cd_education_status = '4 yr Degree' and  d_year = 1998 and  s_state = 'MD' and i_category = 'Children'  ;"
227,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-01-17')) and ss_sold_date_sk = d_date_sk and ss_list_price between 55 and 84 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-01-17')) and cs_sold_date_sk = d_date_sk and cs_list_price between 55 and 84 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-01-17')) and ws_sold_date_sk = d_date_sk and ws_list_price between 55 and 84 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
228,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,max(ss_net_profit) as store_sales_profit ,max(sr_net_loss) as store_returns_loss ,max(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 1998 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
229,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-01-18')) and ss_sold_date_sk = d_date_sk and ss_list_price between 243 and 272 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1978 AND 1984 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-01-18')) and cs_sold_date_sk = d_date_sk and cs_list_price between 243 and 272 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1978 AND 1984 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-01-18')) and ws_sold_date_sk = d_date_sk and ws_list_price between 243 and 272 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1978 AND 1984 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
230,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 2 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
231,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'S' and  cd_education_status = '4 yr Degree' and  d_year = 2002 and  s_state = 'IA' and i_category = 'Books'  ;"
232,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 1999 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
233,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Becker County','Coffee County','Dent County','King William County','Van Zandt County') and c.c_birth_month in (5, 10) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'W', 'S') and cd_education_status in ('Secondary', '2 yr Degree', '2 yr Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 5 and 5+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Jewelry')  and ss_sales_price / ss_list_price BETWEEN 30 * 0.01 AND 40 * 0.01  and i_manager_id BETWEEN 24 and 33  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 5 ANd 5+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Jewelry')  and i_manager_id BETWEEN 24 and 33  and ws_sales_price / ws_list_price BETWEEN 30 * 0.01 AND 40 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 5 and 5+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Jewelry')  and i_manager_id BETWEEN 24 and 33  and cs_sales_price / cs_list_price BETWEEN 30 * 0.01 AND 40 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
234,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Men' and i_class = 'pants' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 3 and d_year = 1998 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1936 AND 1949 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('AR','IA','KS'   ,'MN','OK','TN'   ,'TX','VA','VT'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1998 and d_moy = 3)   and (select distinct d_month_seq+3   from date_dim where d_year = 1998 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
235,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 11 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
236,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Bath County','Haralson County','Monroe County','Suffolk city','Vermillion County') and c.c_birth_month in (1, 5) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'M', 'S') and cd_education_status in ('2 yr Degree', '2 yr Degree', '4 yr Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 1 and 1+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Electronics', 'Jewelry')  and ss_sales_price / ss_list_price BETWEEN 68 * 0.01 AND 78 * 0.01  and i_manager_id BETWEEN 86 and 95  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 1 ANd 1+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Electronics', 'Jewelry')  and i_manager_id BETWEEN 86 and 95  and ws_sales_price / ws_list_price BETWEEN 68 * 0.01 AND 78 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 1 and 1+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Electronics', 'Jewelry')  and i_manager_id BETWEEN 86 and 95  and cs_sales_price / cs_list_price BETWEEN 68 * 0.01 AND 78 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
237,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 2000  ;"
238,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'WI'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
239,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1207 and 1207 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 125 and 154 and sm_type = 'REGULAR' and cc_class = 'large' and w_gmt_offset = -5  ;"
240,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'College' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'IL', 'MO') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('LA', 'MA', 'MN') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'GA', 'UT') and ss_net_profit between 50 and 250 ))  ;"
241,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 and i_category IN ('Books', 'Shoes', 'Sports') and i_manager_id BETWEEN 81 and 90 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 and i_category IN ('Books', 'Shoes', 'Sports') and i_manager_id BETWEEN 81 and 90 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 80 AND 100 and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Shoes', 'Sports') and i_manager_id BETWEEN 81 and 90 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and ss_wholesale_cost BETWEEN 80 AND 100  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and cs_wholesale_cost BETWEEN 80 AND 100  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 80 AND 100 and d_year between 1999 and 1999 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999 + 1   and d_moy = 12   and d_dom = 23) and i_category IN ('Books', 'Shoes', 'Sports') and i_manager_id BETWEEN 81 and 90 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999   and d_moy = 12   and d_dom = 23) and i_category IN ('Books', 'Shoes', 'Sports') and ss_wholesale_cost BETWEEN 80 AND 100 and i_manager_id BETWEEN 81 and 90 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
242,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2002 and  c_birth_month = 3 and  ca_state in ('SD', 'TN', 'TX')  and cs_wholesale_cost BETWEEN 88 AND 93  AND i_category = 'Home'  ;"
243,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 11 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
244,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'U' and  cd_education_status = 'Primary' and  d_year = 1998 and  s_state = 'UT' and i_category = 'Jewelry'  ;"
245,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'M' and  cd_education_status = 'Unknown' and  d_year = 1998 and  s_state = 'TX' and i_category = 'Shoes'  ;"
246,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -7  ;"
247,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IA', 'NY', 'TN') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AK', 'AR', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'PA', 'VA') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
248,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-02-25','1999-04-24','1999-09-04','1999-11-06'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Music') and i_manager_id BETWEEN 43 and 52 and sr_return_amt / sr_return_quantity between 63 and 92 and sr_reason_sk in (14, 23, 26, 61, 75) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-02-25','1999-04-24','1999-09-04','1999-11-06'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Music') and i_manager_id BETWEEN 43 and 52 and cr_return_amount / cr_return_quantity between 63 and 92 and cr_reason_sk in (14, 23, 26, 61, 75) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-02-25','1999-04-24','1999-09-04','1999-11-06'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Music') and i_manager_id BETWEEN 43 and 52 and wr_return_amt / wr_return_quantity between 63 and 92 and wr_reason_sk in (14, 23, 26, 61, 75) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
249,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1208 and 1208+11 and ss_sales_price / ss_list_price BETWEEN 56 * 0.01 AND 66 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1208 and 1208+11 and ss_sales_price / ss_list_price BETWEEN 56 * 0.01 AND 66 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 78 and 82  and s_state in ('MO','NC','TN') order by s_store_name, i_item_desc limit 100 ;"
250,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Shoes', 'Sports') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = 'Secondary' and s1.ss_list_price between 4 and 18 and s2.ss_list_price between 4 and 18  ;"
251,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Home') and item2.i_manager_id between 8 and 27 and cd_marital_status = 'W' and cd_education_status = 'Unknown' and s1.ss_list_price between 184 and 198 and s2.ss_list_price between 184 and 198  ;"
252,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 1998 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
253,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = 'Primary' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 3 and  ca_state in ('MS', 'NC', 'VT')  and cs_wholesale_cost BETWEEN 21 AND 26  AND i_category = 'Jewelry'  ;"
254,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Home') and item2.i_manager_id between 35 and 54 and cd_marital_status = 'W' and cd_education_status = 'Primary' and s1.ss_list_price between 279 and 293 and s2.ss_list_price between 279 and 293  ;"
255,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 5 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -6  ;"
256,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2000 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'KS'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
257,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 8 * 0.01 AND 28 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1206 and 1206 + 11  and s_state in ('LA','MO','MS'   ,'NJ','OH','TN','VA','WY')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1206+ 12 and 1206 + 23  and s_state in ('LA','MO','MS'   ,'NJ','OH','TN','VA','WY')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
258,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Music') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 67 and 81 and s2.ss_list_price between 67 and 81 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
259,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,max(ss_net_profit) as store_sales_profit ,max(sr_net_loss) as store_returns_loss ,max(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 2 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 2 and 2 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 2 and 2 + 2 and d3.d_year  = 1998 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
260,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Riverside' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 10129 and ib_upper_bound <= 10129 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
261,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 1999  ;"
262,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 10 and 29 and cd_marital_status = 'U' and cd_education_status = 'Secondary' and s1.ss_list_price between 78 and 92 and s2.ss_list_price between 78 and 92 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
263,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IL', 'MO', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('LA', 'MI', 'WY') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IN', 'SD', 'VT') and ws_net_profit between 50 and 250 ) )  ;"
264,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'MO'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
265,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Advanced Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 3 and  ca_state in ('MI', 'NM', 'NY')  and cs_wholesale_cost BETWEEN 91 AND 96  AND i_category = 'Electronics'  ;"
266,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Children', 'Home', 'Women') and i_manager_id BETWEEN 29 and 38 and ss_wholesale_cost BETWEEN 5 AND 25 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Children', 'Home', 'Women') and i_manager_id BETWEEN 29 and 38 and cs_wholesale_cost BETWEEN 5 AND 25 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 5 AND 25 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Home', 'Women') and i_manager_id BETWEEN 29 and 38 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 5 AND 25  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 5 AND 25  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 5 AND 25 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 25) and i_category IN ('Children', 'Home', 'Women') and i_manager_id BETWEEN 29 and 38 and ss_wholesale_cost BETWEEN 5 AND 25 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 25) and i_category IN ('Children', 'Home', 'Women') and ss_wholesale_cost BETWEEN 5 AND 25 and i_manager_id BETWEEN 29 and 38 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
267,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 2001  ;"
268,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1206 and 1206 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 271 and 300 and sm_type = 'OVERNIGHT' and cc_class = 'large' and w_gmt_offset = -5  ;"
269,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Newtown' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 66778 and ib_upper_bound <= 66778 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
270,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 35 and 54 and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 132 and 146 and s2.ss_list_price between 132 and 146 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
271,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2000-01-29','2000-06-18','2000-07-24','2000-11-16'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 7 and 16 and sr_return_amt / sr_return_quantity between 239 and 268 and sr_reason_sk in (36, 43, 44, 45, 51) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-01-29','2000-06-18','2000-07-24','2000-11-16'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 7 and 16 and cr_return_amount / cr_return_quantity between 239 and 268 and cr_reason_sk in (36, 43, 44, 45, 51) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-01-29','2000-06-18','2000-07-24','2000-11-16'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 7 and 16 and wr_return_amt / wr_return_quantity between 239 and 268 and wr_reason_sk in (36, 43, 44, 45, 51) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
272,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'U' and  cd_education_status = 'Primary' and  d_year = 2002 and  s_state = 'VA' and i_category = 'Women'  ;"
273,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'S' and  cd_education_status = '2 yr Degree' and  d_year = 2001 and  s_state = 'AR' and i_category = 'Children'  ;"
274,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
275,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Cherokee County','Grenada County','Kalamazoo County','Mineral County','Stafford County') and c.c_birth_month in (2, 11) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'W', 'W') and cd_education_status in ('Advanced Degree', 'Secondary', 'Primary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 2 and 2+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Jewelry')  and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  and i_manager_id BETWEEN 31 and 40  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 2 ANd 2+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Jewelry')  and i_manager_id BETWEEN 31 and 40  and ws_sales_price / ws_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 2 and 2+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Jewelry')  and i_manager_id BETWEEN 31 and 40  and cs_sales_price / cs_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
276,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Music' and i_class = 'rock' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 10 and d_year = 2000 and wholesale_cost BETWEEN 55 AND 85 and c_birth_year BETWEEN 1938 AND 1951 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 55 AND 85  and s_state in ('CO','IN','KY'   ,'MI','MO','NV'   ,'OH','OR','WI'   ,'WV')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 10)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 10) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
277,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'S' and  cd_education_status = '4 yr Degree' and  d_year = 1999 and  s_state = 'MO' and i_category = 'Children'  ;"
278,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 1998 and  c_birth_month = 4 and  ca_state in ('LA', 'MS', 'NE')  and cs_wholesale_cost BETWEEN 74 AND 79  AND i_category = 'Home'  ;"
279,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 55 and 74 and cd_marital_status = 'U' and cd_education_status = 'Primary' and s1.ss_list_price between 238 and 252 and s2.ss_list_price between 238 and 252  ;"
280,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 33 * 0.01 AND 53 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1198 and 1198 + 11  and s_state in ('IL','IN','MI'   ,'OH','PA','SD','TX','WV')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1198+ 12 and 1198 + 23  and s_state in ('IL','IN','MI'   ,'OH','PA','SD','TX','WV')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
281,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 2 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -7  ;"
282,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 1998  ;"
283,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Children' and i_class = 'infants' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 9 and d_year = 2002 and wholesale_cost BETWEEN 13 AND 43 and c_birth_year BETWEEN 1949 AND 1962 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 13 AND 43  and s_state in ('AR','FL','GA'   ,'KS','KY','NC'   ,'NM','NY','SD'   ,'TX')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2002 and d_moy = 9)   and (select distinct d_month_seq+3   from date_dim where d_year = 2002 and d_moy = 9) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
284,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = 'Primary' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 3 and ca_state in ('MS', 'NC', 'VT') and cs_wholesale_cost BETWEEN 21 AND 26 AND i_category = 'Jewelry' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
285,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1217 and 1217 + 11 and c_birth_month in (3, 4, 6, 8) and ss_list_price between 200 and 259 and ss_wholesale_cost BETWEEN 70 AND 90 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1217 and 1217 + 11 and c_birth_month in (3, 4, 6, 8) and cs_list_price between 200 and 259 and cs_wholesale_cost BETWEEN 70 AND 90 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1217 and 1217 + 11 and c_birth_month in (3, 4, 6, 8) and ws_list_price between 200 and 259 and ws_wholesale_cost BETWEEN 70 AND 90 ) hot_cust limit 100 ;"
286,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'M' and  cd_education_status = '4 yr Degree' and  d_year = 1999 and  s_state = 'SD' and i_category = 'Home'  ;"
287,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1208 and 1208 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 229 and 258 and sm_type = 'LIBRARY' and cc_class = 'small' and w_gmt_offset = -5  ;"
288,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Women') and item2.i_manager_id between 53 and 72 and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 73 and 87 and s2.ss_list_price between 73 and 87  ;"
289,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Shoes') and item2.i_manager_id between 77 and 96 and cd_marital_status = 'D' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 10 and 24 and s2.ss_list_price between 10 and 24  ;"
290,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Secondary' and  c_current_addr_sk = ca_address_sk and  d_year = 1999 and  c_birth_month = 6 and  ca_state in ('IL', 'ME', 'MN')  and cs_wholesale_cost BETWEEN 19 AND 24  AND i_category = 'Children'  ;"
291,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'IL'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
292,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 11 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
293,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Primary' and c_current_addr_sk = ca_address_sk and d_year = 2001 and c_birth_month = 9 and ca_state in ('AR', 'IL', 'KS') and cs_wholesale_cost BETWEEN 24 AND 29 AND i_category = 'Children' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
294,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1191 and 1191+11 and ss_sales_price / ss_list_price BETWEEN 63 * 0.01 AND 73 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1191 and 1191+11 and ss_sales_price / ss_list_price BETWEEN 63 * 0.01 AND 73 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 77 and 81  and s_state in ('LA','MI','MO') order by s_store_name, i_item_desc limit 100 ;"
295,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1210 and 1210 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 261 and 290 and sm_type = 'OVERNIGHT' and cc_class = 'medium' and w_gmt_offset = -5  ;"
296,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Books' and i_class = 'arts' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 2 and d_year = 2000 and wholesale_cost BETWEEN 3 AND 33 and c_birth_year BETWEEN 1928 AND 1941 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 3 AND 33  and s_state in ('AK','FL','IL'   ,'MT','ND','NE'   ,'NY','RI','VA'   ,'WV')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 2)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 2) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
297,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('green', 'magenta') and i_manager_id BETWEEN 5 and 24 and ss_list_price between 163 and 177 and ca_state in ('GA','NC') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('green', 'magenta') and i_manager_id BETWEEN 5 and 24 and ws_list_price between 163 and 177 and ca_state in ('GA','NC') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2001 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2001 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2001 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2001 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2001 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2001 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q2_q3_increase ;"
298,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Shoes') and item2.i_manager_id between 77 and 96 and cd_marital_status = 'D' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 10 and 24 and s2.ss_list_price between 10 and 24 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
299,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'LA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
300,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'MN', 'NC') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('KY', 'MN', 'WV') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'IN', 'VA') and ws_net_profit between 50 and 250 ) )  ;"
301,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Antioch' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 6 * 10000 and ib_upper_bound <= 6 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
302,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Unknown' and c_current_addr_sk = ca_address_sk and d_year = 1998 and c_birth_month = 5 and ca_state in ('KY', 'NE', 'WY') and cs_wholesale_cost BETWEEN 69 AND 74 AND i_category = 'Sports' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
303,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Shoes' and i_class = 'mens' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 2 and d_year = 1998 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1925 AND 1938 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('GA','ID','KY'   ,'MD','NC','ND'   ,'NM','PA','SD'   ,'TN')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1998 and d_moy = 2)   and (select distinct d_month_seq+3   from date_dim where d_year = 1998 and d_moy = 2) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
304,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 and i_category IN ('Jewelry', 'Men', 'Women') and i_manager_id BETWEEN 7 and 16 and ss_wholesale_cost BETWEEN 10 AND 30 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 and i_category IN ('Jewelry', 'Men', 'Women') and i_manager_id BETWEEN 7 and 16 and cs_wholesale_cost BETWEEN 10 AND 30 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 10 AND 30 and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Jewelry', 'Men', 'Women') and i_manager_id BETWEEN 7 and 16 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and ss_wholesale_cost BETWEEN 10 AND 30  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and cs_wholesale_cost BETWEEN 10 AND 30  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 10 AND 30 and d_year between 1999 and 1999 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999 + 1   and d_moy = 12   and d_dom = 2) and i_category IN ('Jewelry', 'Men', 'Women') and i_manager_id BETWEEN 7 and 16 and ss_wholesale_cost BETWEEN 10 AND 30 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999   and d_moy = 12   and d_dom = 2) and i_category IN ('Jewelry', 'Men', 'Women') and ss_wholesale_cost BETWEEN 10 AND 30 and i_manager_id BETWEEN 7 and 16 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
305,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 1999  ;"
306,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'S' and  cd_education_status = 'Advanced Degree' and  d_year = 2002 and  s_state = 'WA' and i_category = 'Children'  ;"
307,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'KS'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
308,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1192 and 1192+11 and ss_sales_price / ss_list_price BETWEEN 62 * 0.01 AND 72 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1192 and 1192+11 and ss_sales_price / ss_list_price BETWEEN 62 * 0.01 AND 72 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 35 and 39  and s_state in ('AR','KS','VA') order by s_store_name, i_item_desc limit 100 ;"
309,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Douglas County','Graves County','Lake County','Leavenworth County','Wirt County') and c.c_birth_month in (1, 2) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'M', 'U') and cd_education_status in ('Advanced Degree', '4 yr Degree', 'Secondary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 2 and 2+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Women')  and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  and i_manager_id BETWEEN 91 and 100  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 2 ANd 2+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Women')  and i_manager_id BETWEEN 91 and 100  and ws_sales_price / ws_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 2 and 2+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Women')  and i_manager_id BETWEEN 91 and 100  and cs_sales_price / cs_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
310,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('dim', 'midnight') and i_manager_id BETWEEN 68 and 87 and ss_list_price between 199 and 213 and ca_state in ('MO','TX') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('dim', 'midnight') and i_manager_id BETWEEN 68 and 87 and ws_list_price between 199 and 213 and ca_state in ('MO','TX') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;"
311,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Home') and item2.i_manager_id between 56 and 75 and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 126 and 140 and s2.ss_list_price between 126 and 140  ;"
312,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Secondary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'MN', 'TN') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MN', 'NJ', 'SD') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CO', 'ID', 'TX') and ss_net_profit between 50 and 250 ))  ;"
313,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 80 * 0.01 AND 100 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1188 and 1188 + 11  and s_state in ('AK','IA','MN'   ,'MO','NV','OK','TN','VT')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1188+ 12 and 1188 + 23  and s_state in ('AK','IA','MN'   ,'MO','NV','OK','TN','VT')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
314,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'S' and  cd_education_status = '4 yr Degree' and  d_year = 2001 and  s_state = 'NC' and i_category = 'Home'  ;"
315,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Shoes') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 182 and 196 and s2.ss_list_price between 182 and 196 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
316,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Women' and i_class = 'maternity' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 7 and d_year = 1998 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1964 AND 1977 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('AR','GA','IL'   ,'IN','MO','MT'   ,'NY','TN','VA'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1998 and d_moy = 7)   and (select distinct d_month_seq+3   from date_dim where d_year = 1998 and d_moy = 7) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
317,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 28 and 47 and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 133 and 147 and s2.ss_list_price between 133 and 147 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
318,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 and sr_return_amt / sr_return_quantity between 94 and 153 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 20 AND 23 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AL', 'KY', 'TX') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'S') and cd_education_status IN ('4 yr Degree', '2 yr Degree') and cd_gender = 'M' and c_birth_month = 5 and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id limit 100 ;"
319,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
320,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Women' and i_class = 'dresses' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 1 and d_year = 2000 and wholesale_cost BETWEEN 67 AND 97 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 67 AND 97  and s_state in ('IN','KY','MO'   ,'MS','NC','NE'   ,'NJ','NY','OR'   ,'TX')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 1)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 1) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
321,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Children', 'Home', 'Music') and i_manager_id BETWEEN 63 and 72 and ss_wholesale_cost BETWEEN 32 AND 52 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Children', 'Home', 'Music') and i_manager_id BETWEEN 63 and 72 and cs_wholesale_cost BETWEEN 32 AND 52 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 32 AND 52 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Home', 'Music') and i_manager_id BETWEEN 63 and 72 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 32 AND 52  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 32 AND 52  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 32 AND 52 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 2) and i_category IN ('Children', 'Home', 'Music') and i_manager_id BETWEEN 63 and 72 and ss_wholesale_cost BETWEEN 32 AND 52 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 2) and i_category IN ('Children', 'Home', 'Music') and ss_wholesale_cost BETWEEN 32 AND 52 and i_manager_id BETWEEN 63 and 72 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
322,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,stddev_samp(ss_net_profit) as store_sales_profit ,stddev_samp(sr_net_loss) as store_returns_loss ,stddev_samp(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 1999 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
323,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Greenwood' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 1 * 10000 and ib_upper_bound <= 1 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
324,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Children', 'Home', 'Women') and i_manager_id BETWEEN 62 and 71 and ss_wholesale_cost BETWEEN 77 AND 97 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Children', 'Home', 'Women') and i_manager_id BETWEEN 62 and 71 and cs_wholesale_cost BETWEEN 77 AND 97 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 77 AND 97 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Home', 'Women') and i_manager_id BETWEEN 62 and 71 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 77 AND 97  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 77 AND 97  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 77 AND 97 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 5) and i_category IN ('Children', 'Home', 'Women') and i_manager_id BETWEEN 62 and 71 and ss_wholesale_cost BETWEEN 77 AND 97 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 5) and i_category IN ('Children', 'Home', 'Women') and ss_wholesale_cost BETWEEN 77 AND 97 and i_manager_id BETWEEN 62 and 71 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
325,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'TX', 'VA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'VA', 'WA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MN', 'WV', 'WY') and ss_net_profit between 50 and 250 ))  ;"
326,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Anchorage Borough','Burleson County','Douglas County','La Porte County','Marshall County') and c.c_birth_month in (6, 12) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'M', 'M') and cd_education_status in ('Primary', '4 yr Degree', 'Advanced Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 4 and 4+3 and  ss_item_sk = i_item_sk and  i_category in ('Jewelry', 'Sports', 'Women')  and ss_sales_price / ss_list_price BETWEEN 32 * 0.01 AND 42 * 0.01  and i_manager_id BETWEEN 8 and 17  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 4 ANd 4+3 and  ws_item_sk = i_item_sk and  i_category in ('Jewelry', 'Sports', 'Women')  and i_manager_id BETWEEN 8 and 17  and ws_sales_price / ws_list_price BETWEEN 32 * 0.01 AND 42 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 4 and 4+3 and  cs_item_sk = i_item_sk and  i_category in ('Jewelry', 'Sports', 'Women')  and i_manager_id BETWEEN 8 and 17  and cs_sales_price / cs_list_price BETWEEN 32 * 0.01 AND 42 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
327,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-07-03')) and ss_sold_date_sk = d_date_sk and ss_list_price between 9 and 38 and i_manager_id BETWEEN 16 and 45 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1958 AND 1964 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-07-03')) and cs_sold_date_sk = d_date_sk and cs_list_price between 9 and 38 and i_manager_id BETWEEN 16 and 45 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1958 AND 1964 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-07-03')) and ws_sold_date_sk = d_date_sk and ws_list_price between 9 and 38 and i_manager_id BETWEEN 16 and 45 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1958 AND 1964 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
328,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
329,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'OK'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
330,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 11 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
331,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -7  ;"
332,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 1998  ;"
333,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 2 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 2 and 2 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 2 and 2 + 2 and d3.d_year  = 1999  ;"
334,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 1 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -6  ;"
335,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Advanced Degree' and c_current_addr_sk = ca_address_sk and d_year = 1998 and c_birth_month = 8 and ca_state in ('KS', 'OK', 'WI') and cs_wholesale_cost BETWEEN 19 AND 24 AND i_category = 'Jewelry' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
336,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'S' and  cd_education_status = 'Unknown' and  d_year = 2000 and  s_state = 'OK' and i_category = 'Home'  ;"
337,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = '4 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2001 and c_birth_month = 9 and ca_state in ('IL', 'MS', 'VA') and cs_wholesale_cost BETWEEN 78 AND 83 AND i_category = 'Jewelry' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
338,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Friendship' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 2 * 10000 and ib_upper_bound <= 2 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
339,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'ID'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
340,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Music' and i_class = 'pop' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 8 and d_year = 1999 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1931 AND 1944 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('DE','GA','IN'   ,'MA','MT','OK'   ,'OR','SD','TN'   ,'TX')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1999 and d_moy = 8)   and (select distinct d_month_seq+3   from date_dim where d_year = 1999 and d_moy = 8) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
341,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1197 and 1197+11 and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1197 and 1197+11 and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 27 and 31  and s_state in ('KS','LA','OK') order by s_store_name, i_item_desc limit 100 ;"
342,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 2 AND 22 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 7 and 7 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'N' and ad2.ca_state in ('FL','NE','VA') and ss_wholesale_cost BETWEEN 2 AND 22 and cd1.cd_marital_status in ('M', 'S', 'M') and cd1.cd_education_status in ('4 yr Degree', 'Unknown', 'Unknown') and cd2.cd_marital_status in ('M', 'S', 'M') and cd2.cd_education_status in ('4 yr Degree', 'Unknown', 'Unknown') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
343,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-07-05')) and ss_sold_date_sk = d_date_sk and ss_list_price between 128 and 157 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1966 AND 1972 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-07-05')) and cs_sold_date_sk = d_date_sk and cs_list_price between 128 and 157 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1966 AND 1972 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-07-05')) and ws_sold_date_sk = d_date_sk and ws_list_price between 128 and 157 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1966 AND 1972 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
344,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Home', 'Jewelry') and i_manager_id BETWEEN 34 and 43 and ss_wholesale_cost BETWEEN 15 AND 35 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Home', 'Jewelry') and i_manager_id BETWEEN 34 and 43 and cs_wholesale_cost BETWEEN 15 AND 35 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 15 AND 35 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Home', 'Jewelry') and i_manager_id BETWEEN 34 and 43 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 15 AND 35  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 15 AND 35  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 15 AND 35 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 12) and i_category IN ('Books', 'Home', 'Jewelry') and i_manager_id BETWEEN 34 and 43 and ss_wholesale_cost BETWEEN 15 AND 35 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 12) and i_category IN ('Books', 'Home', 'Jewelry') and ss_wholesale_cost BETWEEN 15 AND 35 and i_manager_id BETWEEN 34 and 43 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
345,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and d_year = 2000 and s_state = 'GA' and i_category = 'Jewelry' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
346,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'S' and  cd_education_status = '2 yr Degree' and  d_year = 2002 and  s_state = 'KS' and i_category = 'Children'  ;"
347,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 10 and 19 and wr_return_amt / wr_return_quantity between 54 and 83 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('IL', 'MI', 'SD', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (43, 69) and c_birth_year BETWEEN 1965 AND 1971 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
348,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 62 AND 82 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 30 and 30 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('AR','KS','TX') and ss_wholesale_cost BETWEEN 62 AND 82 and cd1.cd_marital_status in ('U', 'U', 'S') and cd1.cd_education_status in ('4 yr Degree', 'Secondary', 'Primary') and cd2.cd_marital_status in ('U', 'U', 'S') and cd2.cd_education_status in ('4 yr Degree', 'Secondary', 'Primary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
349,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IA', 'MN', 'TN') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IA', 'MO', 'VT') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AK', 'MN', 'NV') and ss_net_profit between 50 and 250 ))  ;"
350,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 10 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7  ;"
351,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 1998  ;"
352,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Belknap County','Clark County','Conecuh County','Pike County','Rock County') and c.c_birth_month in (6, 11) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'S', 'D') and cd_education_status in ('2 yr Degree', '2 yr Degree', 'Secondary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 5 and 5+3 and  ss_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Sports')  and ss_sales_price / ss_list_price BETWEEN 24 * 0.01 AND 34 * 0.01  and i_manager_id BETWEEN 35 and 44  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 5 ANd 5+3 and  ws_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Sports')  and i_manager_id BETWEEN 35 and 44  and ws_sales_price / ws_list_price BETWEEN 24 * 0.01 AND 34 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 5 and 5+3 and  cs_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Sports')  and i_manager_id BETWEEN 35 and 44  and cs_sales_price / cs_list_price BETWEEN 24 * 0.01 AND 34 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
353,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -7  ;"
354,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('cyan', 'royal') and i_manager_id BETWEEN 11 and 30 and ss_list_price between 182 and 196 and ca_state in ('NM','VT') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('cyan', 'royal') and i_manager_id BETWEEN 11 and 30 and ws_list_price between 182 and 196 and ca_state in ('NM','VT') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q1_q2_increase ;"
355,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Jewelry') and item2.i_manager_id between 52 and 71 and cd_marital_status = 'M' and cd_education_status = 'Primary' and s1.ss_list_price between 63 and 77 and s2.ss_list_price between 63 and 77  ;"
356,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Jewelry') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 190 and 204 and s2.ss_list_price between 190 and 204 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
357,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Jewelry' and i_class = 'earings' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 6 and d_year = 2001 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1927 AND 1940 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('AR','GA','IN'   ,'KY','LA','MI'   ,'ND','PA','SC'   ,'VA')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 6)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 6) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
358,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-01-31','1999-04-17','1999-08-23','1999-10-24'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 45 and 54 and sr_return_amt / sr_return_quantity between 162 and 191 and sr_reason_sk in (8, 21, 34, 35, 57) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-01-31','1999-04-17','1999-08-23','1999-10-24'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 45 and 54 and cr_return_amount / cr_return_quantity between 162 and 191 and cr_reason_sk in (8, 21, 34, 35, 57) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-01-31','1999-04-17','1999-08-23','1999-10-24'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 45 and 54 and wr_return_amt / wr_return_quantity between 162 and 191 and wr_reason_sk in (8, 21, 34, 35, 57) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
359,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Children') and item2.i_manager_id between 39 and 58 and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 50 and 64 and s2.ss_list_price between 50 and 64 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
360,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-03-21','1999-06-23','1999-08-11','1999-11-05'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Home') and i_manager_id BETWEEN 60 and 69 and sr_return_amt / sr_return_quantity between 63 and 92 and sr_reason_sk in (29, 31, 57, 68, 74) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-03-21','1999-06-23','1999-08-11','1999-11-05'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Home') and i_manager_id BETWEEN 60 and 69 and cr_return_amount / cr_return_quantity between 63 and 92 and cr_reason_sk in (29, 31, 57, 68, 74) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-03-21','1999-06-23','1999-08-11','1999-11-05'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Home') and i_manager_id BETWEEN 60 and 69 and wr_return_amt / wr_return_quantity between 63 and 92 and wr_reason_sk in (29, 31, 57, 68, 74) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
361,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Brewster County','Dunn County','Pepin County','Perquimans County','Sumter County') and c.c_birth_month in (8, 11) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'S', 'W') and cd_education_status in ('Secondary', '2 yr Degree', 'Advanced Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 and 6+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Music', 'Women')  and ss_sales_price / ss_list_price BETWEEN 16 * 0.01 AND 26 * 0.01  and i_manager_id BETWEEN 52 and 61  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 ANd 6+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Music', 'Women')  and i_manager_id BETWEEN 52 and 61  and ws_sales_price / ws_list_price BETWEEN 16 * 0.01 AND 26 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 and 6+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Music', 'Women')  and i_manager_id BETWEEN 52 and 61  and cs_sales_price / cs_list_price BETWEEN 16 * 0.01 AND 26 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
362,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('chartreuse', 'misty') and i_manager_id BETWEEN 58 and 77 and ss_list_price between 75 and 89 and ca_state in ('MI','PA') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('chartreuse', 'misty') and i_manager_id BETWEEN 58 and 77 and ws_list_price between 75 and 89 and ca_state in ('MI','PA') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year ;"
363,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 2 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -6  ;"
364,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 28 and 47 and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 133 and 147 and s2.ss_list_price between 133 and 147  ;"
365,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Advanced Degree' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 7 and ca_state in ('GA', 'HI', 'ID') and cs_wholesale_cost BETWEEN 78 AND 83 AND i_category = 'Children' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
366,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Harmony' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 2 * 10000 and ib_upper_bound <= 2 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
367,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2001 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 76 and 85 and wr_return_amt / wr_return_quantity between 138 and 167 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('IL', 'MS', 'SC', 'WI')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (24, 74) and c_birth_year BETWEEN 1942 AND 1948 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
368,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 80 AND 100 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 22 and 22 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('PA','TN','WI') and ss_wholesale_cost BETWEEN 80 AND 100 and cd1.cd_marital_status in ('M', 'S', 'S') and cd1.cd_education_status in ('Secondary', '4 yr Degree', 'Unknown') and cd2.cd_marital_status in ('M', 'S', 'S') and cd2.cd_education_status in ('Secondary', '4 yr Degree', 'Unknown') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2000 and cs2.syear = 2000 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
369,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Lakeview' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 6 * 10000 and ib_upper_bound <= 6 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
370,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 12 and 21 and ss_wholesale_cost BETWEEN 19 AND 39 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 12 and 21 and cs_wholesale_cost BETWEEN 19 AND 39 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 19 AND 39 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 12 and 21 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 19 AND 39  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 19 AND 39  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 19 AND 39 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 17) and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 12 and 21 and ss_wholesale_cost BETWEEN 19 AND 39 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 17) and i_category IN ('Books', 'Children', 'Jewelry') and ss_wholesale_cost BETWEEN 19 AND 39 and i_manager_id BETWEEN 12 and 21 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
371,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 and i_category IN ('Jewelry', 'Men', 'Women') and i_manager_id BETWEEN 38 and 47 and ss_wholesale_cost BETWEEN 19 AND 39 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 and i_category IN ('Jewelry', 'Men', 'Women') and i_manager_id BETWEEN 38 and 47 and cs_wholesale_cost BETWEEN 19 AND 39 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 19 AND 39 and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Jewelry', 'Men', 'Women') and i_manager_id BETWEEN 38 and 47 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and ss_wholesale_cost BETWEEN 19 AND 39  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and cs_wholesale_cost BETWEEN 19 AND 39  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 19 AND 39 and d_year between 1999 and 1999 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999 + 1   and d_moy = 12   and d_dom = 4) and i_category IN ('Jewelry', 'Men', 'Women') and i_manager_id BETWEEN 38 and 47 and ss_wholesale_cost BETWEEN 19 AND 39 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999   and d_moy = 12   and d_dom = 4) and i_category IN ('Jewelry', 'Men', 'Women') and ss_wholesale_cost BETWEEN 19 AND 39 and i_manager_id BETWEEN 38 and 47 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
372,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2000 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'IA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
373,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'KY', 'MO') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'TN', 'UT') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('NE', 'OH', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
374,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Secondary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('HI', 'OH', 'UT') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'OK', 'TX') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NC', 'VA', 'WI') and ss_net_profit between 50 and 250 ))  ;"
375,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Children' and i_class = 'infants' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 11 and d_year = 2002 and wholesale_cost BETWEEN 17 AND 47 and c_birth_year BETWEEN 1956 AND 1969 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 17 AND 47  and s_state in ('IN','KS','LA'   ,'MI','NJ','NY'   ,'SC','SD','WI'   ,'WV')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2002 and d_moy = 11)   and (select distinct d_month_seq+3   from date_dim where d_year = 2002 and d_moy = 11) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
376,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Children') and item2.i_manager_id between 39 and 58 and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 50 and 64 and s2.ss_list_price between 50 and 64  ;"
377,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Books' and i_class = 'business' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 3 and d_year = 1999 and wholesale_cost BETWEEN 29 AND 59 and c_birth_year BETWEEN 1927 AND 1940 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 29 AND 59  and s_state in ('AL','FL','IA'   ,'LA','MI','MO'   ,'NC','OK','PA'   ,'TN')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1999 and d_moy = 3)   and (select distinct d_month_seq+3   from date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
378,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'U' and  cd_education_status = 'Advanced Degree' and  d_year = 2002 and  s_state = 'VA' and i_category = 'Books'  ;"
379,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 1 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -6  ;"
380,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 1998  ;"
381,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 40 and 49 and wr_return_amt / wr_return_quantity between 174 and 203 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AR', 'ND', 'SD', 'TN')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (27, 46) and c_birth_year BETWEEN 1925 AND 1931 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
382,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Women' and i_class = 'fragrances' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 6 and d_year = 1998 and wholesale_cost BETWEEN 48 AND 78 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 48 AND 78  and s_state in ('GA','IN','KS'   ,'KY','MD','MN'   ,'NC','TN','VA'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1998 and d_moy = 6)   and (select distinct d_month_seq+3   from date_dim where d_year = 1998 and d_moy = 6) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
383,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Men' and i_class = 'sports-apparel' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 1 and d_year = 2000 and wholesale_cost BETWEEN 42 AND 72 and c_birth_year BETWEEN 1942 AND 1955 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 42 AND 72  and s_state in ('AL','FL','GA'   ,'HI','ID','KS'   ,'PA','TX','VA'   ,'WY')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 1)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 1) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
384,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-03-01','1999-05-11','1999-08-26','1999-11-05'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 91 and 100 and sr_return_amt / sr_return_quantity between 115 and 144 and sr_reason_sk in (4, 14, 30, 46, 55) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-03-01','1999-05-11','1999-08-26','1999-11-05'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 91 and 100 and cr_return_amount / cr_return_quantity between 115 and 144 and cr_reason_sk in (4, 14, 30, 46, 55) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-03-01','1999-05-11','1999-08-26','1999-11-05'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 115 and 144 and wr_reason_sk in (4, 14, 30, 46, 55) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
385,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 9 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -7  ;"
386,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Walnut Grove' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 6 * 10000 and ib_upper_bound <= 6 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
387,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('chocolate', 'cornsilk') and i_manager_id BETWEEN 40 and 59 and ss_list_price between 2 and 16 and ca_state in ('CO','NC') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('chocolate', 'cornsilk') and i_manager_id BETWEEN 40 and 59 and ws_list_price between 2 and 16 and ca_state in ('CO','NC') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q2_q3_increase ;"
388,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1196 and 1196 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 260 and 289 and sm_type = 'TWO DAY' and cc_class = 'small' and w_gmt_offset = -5  ;"
389,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
390,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 54 * 0.01 AND 74 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1192 and 1192 + 11  and s_state in ('CO','GA','MN'   ,'ND','NE','PA','TN','WI')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1192+ 12 and 1192 + 23  and s_state in ('CO','GA','MN'   ,'ND','NE','PA','TN','WI')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
391,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 52 * 0.01 AND 72 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1205 and 1205 + 11  and s_state in ('AL','DE','IL'   ,'KS','MT','SD','TN','WA')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1205+ 12 and 1205 + 23  and s_state in ('AL','DE','IL'   ,'KS','MT','SD','TN','WA')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
392,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Children' and i_class = 'toddlers' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 12 and d_year = 2001 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1969 AND 1982 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('GA','MA','MN'   ,'OH','OR','PA'   ,'SC','TX','WA'   ,'WY')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 12)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 12) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
393,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Jewelry') and item2.i_manager_id between 50 and 69 and cd_marital_status = 'S' and cd_education_status = 'Unknown' and s1.ss_list_price between 195 and 209 and s2.ss_list_price between 195 and 209  ;"
394,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Summit' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 29262 and ib_upper_bound <= 29262 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
395,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = 'Unknown' and  c_current_addr_sk = ca_address_sk and  d_year = 2001 and  c_birth_month = 10 and  ca_state in ('DC', 'OK', 'PA')  and cs_wholesale_cost BETWEEN 95 AND 100  AND i_category = 'Home'  ;"
396,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
397,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 46 AND 66 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 0 and 0 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'N' and ad2.ca_state in ('KY','SD','TX') and ss_wholesale_cost BETWEEN 46 AND 66 and cd1.cd_marital_status in ('S', 'D', 'U') and cd1.cd_education_status in ('Unknown', '4 yr Degree', '4 yr Degree') and cd2.cd_marital_status in ('S', 'D', 'U') and cd2.cd_education_status in ('Unknown', '4 yr Degree', '4 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
398,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 11 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -7  ;"
399,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 4 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -6  ;"
400,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1179 and 1179 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 261 and 290 and sm_type = 'EXPRESS' and cc_class = 'large' and w_gmt_offset = -5  ;"
401,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Home') and item2.i_manager_id between 27 and 46 and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 95 and 109 and s2.ss_list_price between 95 and 109  ;"
402,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'MT', 'NE') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'MS', 'UT') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'SD', 'TX') and ss_net_profit between 50 and 250 ))  ;"
403,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1186 and 1186 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 240 and 269 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5  ;"
404,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 2002  ;"
405,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 1998 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
406,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Women') and item2.i_manager_id between 22 and 41 and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 286 and 300 and s2.ss_list_price between 286 and 300  ;"
407,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Children', 'Electronics') and i_manager_id BETWEEN 88 and 97 and ss_wholesale_cost BETWEEN 13 AND 33 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Children', 'Electronics') and i_manager_id BETWEEN 88 and 97 and cs_wholesale_cost BETWEEN 13 AND 33 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 13 AND 33 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Children', 'Electronics') and i_manager_id BETWEEN 88 and 97 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 13 AND 33  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 13 AND 33  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 13 AND 33 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 2) and i_category IN ('Books', 'Children', 'Electronics') and i_manager_id BETWEEN 88 and 97 and ss_wholesale_cost BETWEEN 13 AND 33 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 2) and i_category IN ('Books', 'Children', 'Electronics') and ss_wholesale_cost BETWEEN 13 AND 33 and i_manager_id BETWEEN 88 and 97 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
408,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 6 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -6  ;"
409,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = '4 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2001 and c_birth_month = 6 and ca_state in ('GA', 'IL', 'TX') and cs_wholesale_cost BETWEEN 7 AND 12 AND i_category = 'Children' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
410,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '2 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 1999 and  c_birth_month = 7 and  ca_state in ('FL', 'IA', 'MO')  and cs_wholesale_cost BETWEEN 16 AND 21  AND i_category = 'Women'  ;"
411,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Oak Ridge' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 45122 and ib_upper_bound <= 45122 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
412,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 48 and 57 and wr_return_amt / wr_return_quantity between 66 and 95 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CA', 'OR', 'TN', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (21, 54) and c_birth_year BETWEEN 1939 AND 1945 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
413,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Electronics' and i_class = 'musical' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 11 and d_year = 1999 and wholesale_cost BETWEEN 30 AND 60 and c_birth_year BETWEEN 1968 AND 1981 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 30 AND 60  and s_state in ('AK','AL','IA'   ,'MN','MS','MT'   ,'NC','NE','TX'   ,'WA')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1999 and d_moy = 11)   and (select distinct d_month_seq+3   from date_dim where d_year = 1999 and d_moy = 11) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
414,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Music' and i_class = 'classical' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 7 and d_year = 2000 and wholesale_cost BETWEEN 52 AND 82 and c_birth_year BETWEEN 1941 AND 1954 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 52 AND 82  and s_state in ('AL','GA','IL'   ,'KY','NE','PA'   ,'TN','TX','VT'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 7)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 7) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
415,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'NH'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
416,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Jewelry', 'Sports') and i_manager_id BETWEEN 19 and 28 and ss_wholesale_cost BETWEEN 15 AND 35 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Jewelry', 'Sports') and i_manager_id BETWEEN 19 and 28 and cs_wholesale_cost BETWEEN 15 AND 35 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 15 AND 35 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Jewelry', 'Sports') and i_manager_id BETWEEN 19 and 28 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 15 AND 35  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 15 AND 35  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 15 AND 35 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 15) and i_category IN ('Books', 'Jewelry', 'Sports') and i_manager_id BETWEEN 19 and 28 and ss_wholesale_cost BETWEEN 15 AND 35 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 15) and i_category IN ('Books', 'Jewelry', 'Sports') and ss_wholesale_cost BETWEEN 15 AND 35 and i_manager_id BETWEEN 19 and 28 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
417,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Secondary' and  c_current_addr_sk = ca_address_sk and  d_year = 1999 and  c_birth_month = 2 and  ca_state in ('MO', 'MS', 'NY')  and cs_wholesale_cost BETWEEN 95 AND 100  AND i_category = 'Jewelry'  ;"
418,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 29 and 88 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 43 AND 46 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('GA', 'NE', 'TX') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'S') and cd_education_status IN ('Secondary', 'Advanced Degree') and cd_gender = 'M' and c_birth_month = 8 and c_birth_year BETWEEN 1966 AND 1972 order by c_customer_id limit 100 ;"
419,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 77 * 0.01 AND 97 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1212 and 1212 + 11  and s_state in ('GA','IA','IL'   ,'KS','LA','ME','MI','NC')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1212+ 12 and 1212 + 23  and s_state in ('GA','IA','IL'   ,'KS','LA','ME','MI','NC')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
420,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 32 and 41 and wr_return_amt / wr_return_quantity between 148 and 177 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CO', 'MI', 'NC', 'NV')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (46, 61) and c_birth_year BETWEEN 1947 AND 1953 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
421,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Newtown' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 7 * 10000 and ib_upper_bound <= 7 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
422,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('dark', 'floral') and i_manager_id BETWEEN 45 and 64 and ss_list_price between 226 and 240 and ca_state in ('IA','TN') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('dark', 'floral') and i_manager_id BETWEEN 45 and 64 and ws_list_price between 226 and 240 and ca_state in ('IA','TN') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.ca_county ;"
423,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Sports' and i_class = 'basketball' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 7 and d_year = 2001 and wholesale_cost BETWEEN 18 AND 48 and c_birth_year BETWEEN 1954 AND 1967 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 18 AND 48  and s_state in ('AZ','CO','IL'   ,'KS','MI','MO'   ,'MS','NC','RI'   ,'VT')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 7)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 7) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
424,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'S' and  cd_education_status = '4 yr Degree' and  d_year = 1998 and  s_state = 'NH' and i_category = 'Home'  ;"
425,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('NC', 'NE', 'SD') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AL', 'AR', 'NH') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AL', 'MO', 'NE') and ws_net_profit between 50 and 250 ) )  ;"
426,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'MN'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
427,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('brown', 'midnight') and i_manager_id BETWEEN 44 and 63 and ss_list_price between 196 and 210 and ca_state in ('AR','MN') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('brown', 'midnight') and i_manager_id BETWEEN 44 and 63 and ws_list_price between 196 and 210 and ca_state in ('AR','MN') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2002 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2002 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2002 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2002 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2002 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2002 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q2_q3_increase ;"
428,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Five Forks' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 2 * 10000 and ib_upper_bound <= 2 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
429,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('powder', 'spring') and i_manager_id BETWEEN 29 and 48 and ss_list_price between 123 and 137 and ca_state in ('OR','TX') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('powder', 'spring') and i_manager_id BETWEEN 29 and 48 and ws_list_price between 123 and 137 and ca_state in ('OR','TX') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2001 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2001 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2001 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2001 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2001 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2001 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q2_q3_increase ;"
430,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 8 AND 28 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 42 and 42 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('AK','MO','NV') and ss_wholesale_cost BETWEEN 8 AND 28 and cd1.cd_marital_status in ('U', 'U', 'U') and cd1.cd_education_status in ('Secondary', 'Advanced Degree', '4 yr Degree') and cd2.cd_marital_status in ('U', 'U', 'U') and cd2.cd_education_status in ('Secondary', 'Advanced Degree', '4 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
431,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -6  ;"
432,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,stddev_samp(ss_net_profit) as store_sales_profit ,stddev_samp(sr_net_loss) as store_returns_loss ,stddev_samp(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 8 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 8 and 8 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 8 and 8 + 2 and d3.d_year  = 1999 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
433,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Oakland' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 7 * 10000 and ib_upper_bound <= 7 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
434,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = '4 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2001 and c_birth_month = 9 and ca_state in ('NC', 'OH', 'TN') and cs_wholesale_cost BETWEEN 56 AND 61 AND i_category = 'Home' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
435,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Books' and i_class = 'romance' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 11 and d_year = 2002 and wholesale_cost BETWEEN 53 AND 83 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 53 AND 83  and s_state in ('IL','IN','KS'   ,'MI','MO','NE'   ,'OH','OK','VA'   ,'WV')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2002 and d_moy = 11)   and (select distinct d_month_seq+3   from date_dim where d_year = 2002 and d_moy = 11) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
436,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,avg(ss_net_profit) as store_sales_profit ,avg(sr_net_loss) as store_returns_loss ,avg(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 2 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 2 and 2 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 2 and 2 + 2 and d3.d_year  = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
437,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 21 and 30 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 21 and 30 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 80 AND 100 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 21 and 30 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 80 AND 100  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 80 AND 100  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 80 AND 100 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 3) and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 21 and 30 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 3) and i_category IN ('Books', 'Children', 'Jewelry') and ss_wholesale_cost BETWEEN 80 AND 100 and i_manager_id BETWEEN 21 and 30 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
438,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = '4 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 1998 and c_birth_month = 6 and ca_state in ('AR', 'CT', 'MI') and cs_wholesale_cost BETWEEN 23 AND 28 AND i_category = 'Books' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
439,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Boise County','Grant County','Jackson County','Rockcastle County','Sabine County') and c.c_birth_month in (6, 9) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'D', 'M') and cd_education_status in ('Unknown', 'Advanced Degree', 'Secondary') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 and 9+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Shoes')  and ss_sales_price / ss_list_price BETWEEN 12 * 0.01 AND 22 * 0.01  and i_manager_id BETWEEN 25 and 34  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 ANd 9+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Shoes')  and i_manager_id BETWEEN 25 and 34  and ws_sales_price / ws_list_price BETWEEN 12 * 0.01 AND 22 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 and 9+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Shoes')  and i_manager_id BETWEEN 25 and 34  and cs_sales_price / cs_list_price BETWEEN 12 * 0.01 AND 22 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
440,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -6  ;"
441,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,avg(ss_net_profit) as store_sales_profit ,avg(sr_net_loss) as store_returns_loss ,avg(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 9 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 9 and 9 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 9 and 9 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
442,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 81 and 90 and ss_wholesale_cost BETWEEN 48 AND 68 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 81 and 90 and cs_wholesale_cost BETWEEN 48 AND 68 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 48 AND 68 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 81 and 90 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 48 AND 68  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 48 AND 68  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 48 AND 68 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 20) and i_category IN ('Books', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 81 and 90 and ss_wholesale_cost BETWEEN 48 AND 68 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 20) and i_category IN ('Books', 'Jewelry', 'Shoes') and ss_wholesale_cost BETWEEN 48 AND 68 and i_manager_id BETWEEN 81 and 90 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
443,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('navy', 'thistle') and i_manager_id BETWEEN 52 and 71 and ss_list_price between 55 and 69 and ca_state in ('FL','VA') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('navy', 'thistle') and i_manager_id BETWEEN 52 and 71 and ws_list_price between 55 and 69 and ca_state in ('FL','VA') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.ca_county ;"
444,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1182 and 1182+11 and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1182 and 1182+11 and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 11 and 15  and s_state in ('MO','NE','UT') order by s_store_name, i_item_desc limit 100 ;"
445,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 and sr_return_amt / sr_return_quantity between 28 and 87 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 18 AND 21 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('KS', 'OH', 'OK') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'M') and cd_education_status IN ('Secondary', '2 yr Degree') and cd_gender = 'M' and c_birth_month = 12 and c_birth_year BETWEEN 1949 AND 1955 order by c_customer_id limit 100 ;"
446,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1180 and 1180 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 73 and 102 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
447,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'MS', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'IL', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'NE', 'WV') and ss_net_profit between 50 and 250 ))  ;"
448,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'U' and  cd_education_status = 'Secondary' and  d_year = 2001 and  s_state = 'MO' and i_category = 'Electronics'  ;"
449,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Children') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 149 and 163 and s2.ss_list_price between 149 and 163  ;"
450,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 1999 and  c_birth_month = 2 and  ca_state in ('GA', 'TN', 'TX')  and cs_wholesale_cost BETWEEN 81 AND 86  AND i_category = 'Books'  ;"
451,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Men' and i_class = 'shirts' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 12 and d_year = 2001 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('AL','FL','IL'   ,'IN','KS','LA'   ,'ND','PA','TX'   ,'VA')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 12)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 12) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
452,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Books' and i_class = 'home repair' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 11 and d_year = 2001 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1927 AND 1940 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('AL','GA','IL'   ,'KY','LA','MA'   ,'MN','MO','NY'   ,'UT')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 11)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 11) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
453,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 75 and 84 and wr_return_amt / wr_return_quantity between 91 and 120 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('IN', 'LA', 'MO', 'MT')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (34, 68) and c_birth_year BETWEEN 1955 AND 1961 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
454,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Home', 'Shoes') and i_manager_id BETWEEN 77 and 86 and ss_wholesale_cost BETWEEN 28 AND 48 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Home', 'Shoes') and i_manager_id BETWEEN 77 and 86 and cs_wholesale_cost BETWEEN 28 AND 48 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 28 AND 48 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Home', 'Shoes') and i_manager_id BETWEEN 77 and 86 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 28 AND 48  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 28 AND 48  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 28 AND 48 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 28) and i_category IN ('Books', 'Home', 'Shoes') and i_manager_id BETWEEN 77 and 86 and ss_wholesale_cost BETWEEN 28 AND 48 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 28) and i_category IN ('Books', 'Home', 'Shoes') and ss_wholesale_cost BETWEEN 28 AND 48 and i_manager_id BETWEEN 77 and 86 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
455,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Oakdale' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 3 * 10000 and ib_upper_bound <= 3 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
456,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 63 and 82 and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 244 and 258 and s2.ss_list_price between 244 and 258  ;"
457,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1177 and 1177 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 20 and 49 and sm_type = 'TWO DAY' and cc_class = 'small' and w_gmt_offset = -5  ;"
458,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'WI'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
459,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Bent County','Hancock County','Hood County','Marion County','Thurston County') and c.c_birth_month in (6, 11) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'M', 'S') and cd_education_status in ('4 yr Degree', 'Advanced Degree', '4 yr Degree') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 and 3+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Shoes')  and ss_sales_price / ss_list_price BETWEEN 57 * 0.01 AND 67 * 0.01  and i_manager_id BETWEEN 32 and 41  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 ANd 3+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Shoes')  and i_manager_id BETWEEN 32 and 41  and ws_sales_price / ws_list_price BETWEEN 57 * 0.01 AND 67 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 and 3+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Shoes')  and i_manager_id BETWEEN 32 and 41  and cs_sales_price / cs_list_price BETWEEN 57 * 0.01 AND 67 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
460,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -7  ;"
461,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Children') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'S' and cd_education_status = 'Unknown' and s1.ss_list_price between 195 and 209 and s2.ss_list_price between 195 and 209  ;"
462,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'M' and  cd_education_status = 'Unknown' and  d_year = 2002 and  s_state = 'NC' and i_category = 'Shoes'  ;"
463,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Men') and item2.i_manager_id between 38 and 57 and cd_marital_status = 'M' and cd_education_status = 'Secondary' and s1.ss_list_price between 278 and 292 and s2.ss_list_price between 278 and 292  ;"
464,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
465,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,max(ss_net_profit) as store_sales_profit ,max(sr_net_loss) as store_returns_loss ,max(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
466,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 9 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 9 and 9 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 9 and 9 + 2 and d3.d_year  = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
467,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'M' and  cd_education_status = 'Primary' and  d_year = 1999 and  s_state = 'WV' and i_category = 'Jewelry'  ;"
468,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -7  ;"
469,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Home') and item2.i_manager_id between 8 and 27 and cd_marital_status = 'W' and cd_education_status = 'Unknown' and s1.ss_list_price between 184 and 198 and s2.ss_list_price between 184 and 198 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
470,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,max(ss_net_profit) as store_sales_profit ,max(sr_net_loss) as store_returns_loss ,max(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 3 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 3 and 3 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 3 and 3 + 2 and d3.d_year  = 1998 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
471,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 19 * 0.01 AND 39 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1203 and 1203 + 11  and s_state in ('AR','GA','MN'   ,'NC','NE','SC','TX','VA')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1203+ 12 and 1203 + 23  and s_state in ('AR','GA','MN'   ,'NC','NE','SC','TX','VA')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
472,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 10 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -6  ;"
473,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-01-11')) and ss_sold_date_sk = d_date_sk and ss_list_price between 194 and 223 and i_manager_id BETWEEN 52 and 81 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1928 AND 1934 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-01-11')) and cs_sold_date_sk = d_date_sk and cs_list_price between 194 and 223 and i_manager_id BETWEEN 52 and 81 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1928 AND 1934 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-01-11')) and ws_sold_date_sk = d_date_sk and ws_list_price between 194 and 223 and i_manager_id BETWEEN 52 and 81 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1928 AND 1934 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
474,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'KS'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
475,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Lincoln' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 7 * 10000 and ib_upper_bound <= 7 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
476,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Lakeside' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 7 * 10000 and ib_upper_bound <= 7 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
477,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
478,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'S' and cd_education_status = 'Unknown' and d_year = 2001 and s_state = 'MN' and i_category = 'Shoes' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
479,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 17 and 36 and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 94 and 108 and s2.ss_list_price between 94 and 108  ;"
480,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 1998  ;"
481,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('cream', 'olive') and i_manager_id BETWEEN 36 and 55 and ss_list_price between 225 and 239 and ca_state in ('KY','NY') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('cream', 'olive') and i_manager_id BETWEEN 36 and 55 and ws_list_price between 225 and 239 and ca_state in ('KY','NY') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2001 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2001 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2001 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2001 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2001 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2001 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year ;"
482,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Clifton' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 7 * 10000 and ib_upper_bound <= 7 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
483,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1201 and 1201 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 248 and 277 and sm_type = 'LIBRARY' and cc_class = 'small' and w_gmt_offset = -5  ;"
484,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'M' and  cd_education_status = '2 yr Degree' and  d_year = 2002 and  s_state = 'TX' and i_category = 'Children'  ;"
485,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Secondary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AK', 'NC', 'WA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MN', 'NC', 'NE') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IA', 'MO', 'TX') and ss_net_profit between 50 and 250 ))  ;"
486,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 80 AND 100 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 77 and 77 + 10 and p_channel_email = 'Y' and p_channel_tv = 'Y' and p_channel_radio = 'N' and ad2.ca_state in ('KY','ND','TX') and ss_wholesale_cost BETWEEN 80 AND 100 and cd1.cd_marital_status in ('M', 'U', 'M') and cd1.cd_education_status in ('Secondary', 'Primary', 'Advanced Degree') and cd2.cd_marital_status in ('M', 'U', 'M') and cd2.cd_education_status in ('Secondary', 'Primary', 'Advanced Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
487,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'M' and  cd_education_status = 'Primary' and  d_year = 1999 and  s_state = 'IN' and i_category = 'Home'  ;"
488,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'IL'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
489,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
490,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2000 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'WV'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
491,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'AL'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
492,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-02-15','2001-04-22','2001-09-10','2001-11-03'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Shoes') and i_manager_id BETWEEN 55 and 64 and sr_return_amt / sr_return_quantity between 7 and 36 and sr_reason_sk in (20, 29, 33, 55, 73) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-02-15','2001-04-22','2001-09-10','2001-11-03'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Shoes') and i_manager_id BETWEEN 55 and 64 and cr_return_amount / cr_return_quantity between 7 and 36 and cr_reason_sk in (20, 29, 33, 55, 73) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-02-15','2001-04-22','2001-09-10','2001-11-03'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Shoes') and i_manager_id BETWEEN 55 and 64 and wr_return_amt / wr_return_quantity between 7 and 36 and wr_reason_sk in (20, 29, 33, 55, 73) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
493,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'MN'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
494,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,max(ss_net_profit) as store_sales_profit ,max(sr_net_loss) as store_returns_loss ,max(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 9 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 9 and 9 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 9 and 9 + 2 and d3.d_year  = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
495,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-02-07','2001-06-21','2001-07-08','2001-10-25'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Sports', 'Women') and i_manager_id BETWEEN 38 and 47 and sr_return_amt / sr_return_quantity between 191 and 220 and sr_reason_sk in (25, 29, 46, 57, 73) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-02-07','2001-06-21','2001-07-08','2001-10-25'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Sports', 'Women') and i_manager_id BETWEEN 38 and 47 and cr_return_amount / cr_return_quantity between 191 and 220 and cr_reason_sk in (25, 29, 46, 57, 73) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-02-07','2001-06-21','2001-07-08','2001-10-25'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Sports', 'Women') and i_manager_id BETWEEN 38 and 47 and wr_return_amt / wr_return_quantity between 191 and 220 and wr_reason_sk in (25, 29, 46, 57, 73) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
496,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Advanced Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 1999 and  c_birth_month = 2 and  ca_state in ('MT', 'SC', 'VA')  and cs_wholesale_cost BETWEEN 56 AND 61  AND i_category = 'Books'  ;"
497,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,max(ss_net_profit) as store_sales_profit ,max(sr_net_loss) as store_returns_loss ,max(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 1999 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
498,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'GA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
499,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
