,db_id,original_sql
0,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 1 AND 21 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 29 and 29 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('NY','SD','VA') and ss_wholesale_cost BETWEEN 1 AND 21 and cd1.cd_marital_status in ('M', 'M', 'M') and cd1.cd_education_status in ('4 yr Degree', 'Primary', 'Secondary') and cd2.cd_marital_status in ('M', 'M', 'M') and cd2.cd_education_status in ('4 yr Degree', 'Primary', 'Secondary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
1,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('peru', 'salmon') and i_manager_id BETWEEN 40 and 59 and ss_list_price between 120 and 134 and ca_state in ('IA','MN') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('peru', 'salmon') and i_manager_id BETWEEN 40 and 59 and ws_list_price between 120 and 134 and ca_state in ('IA','MN') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;"
2,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1178 and 1178 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 17 and 46 and sm_type = 'TWO DAY' and cc_class = 'medium' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
3,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = '4 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 1999 and c_birth_month = 9 and ca_state in ('MO', 'NJ', 'NY') and cs_wholesale_cost BETWEEN 5 AND 10 AND i_category = 'Shoes' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
4,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 78 and 97 AND i_category IN ('Books', 'Children', 'Men') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 78 AND 88  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1953 AND 1959 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1999 and d_moy = 10 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 78 AND 88 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1999 and d_moy = 10 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 78 AND 88) tmp2 limit 100 ;"
5,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('CA', 'KS', 'PA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AL', 'ID', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'MD', 'WI') and ws_net_profit between 50 and 250 ) )  ;"
6,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 100 * 0.01 AND 120 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1195 and 1195 + 11  and s_state in ('CA','IN','KS'   ,'KY','LA','MO','SC','SD')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1195+ 12 and 1195 + 23  and s_state in ('CA','IN','KS'   ,'KY','LA','MO','SC','SD')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
7,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'W' and cd_education_status = 'Unknown' and d_year = 2001 and s_state = 'NE' and i_category = 'Home' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
8,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IN', 'SD', 'WV') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IN', 'LA', 'MI') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'KS', 'TX') and ws_net_profit between 50 and 250 ) )  ;"
9,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('KY','MO','WV') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('D', 'S', 'M') and cd_education_status in ('Unknown', '2 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 6 and 6+2  and ss_list_price between 211 and 300 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 6 and 6+2  and ws_list_price between 211 and 300  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 6 and 6+2  and cs_list_price between 211 and 300)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
10,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 7 and 26 AND i_category IN ('Electronics', 'Music', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 73 AND 83  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1971 AND 1977 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1999 and d_moy = 9 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 73 AND 83 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1999 and d_moy = 9 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 73 AND 83) tmp2 limit 100 ;"
11,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 5 AND 25 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 5 and 5 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('IN','MO','TX') and ss_wholesale_cost BETWEEN 5 AND 25 and cd1.cd_marital_status in ('D', 'S', 'S') and cd1.cd_education_status in ('Advanced Degree', '4 yr Degree', '4 yr Degree') and cd2.cd_marital_status in ('D', 'S', 'S') and cd2.cd_education_status in ('Advanced Degree', '4 yr Degree', '4 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2000 and cs2.syear = 2000 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
12,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2000 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'GA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
13,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2002 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Children', 'Jewelry', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and ss_wholesale_cost BETWEEN 90 AND 100  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1935 AND 1941 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2002 and d_moy = 12 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 90 AND 100 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2002 and d_moy = 12 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 90 AND 100) tmp2 limit 100 ;"
14,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 2 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
15,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 3 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 3 and 3 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 3 and 3 + 2 and d3.d_year  = 2002  ;"
16,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and d_year = 2000 and s_state = 'WI' and i_category = 'Home' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
17,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'KY'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
18,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Arlington' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 66690 and ib_upper_bound <= 66690 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
19,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'S' and cd_education_status = 'Secondary' and s1.ss_list_price between 225 and 239 and s2.ss_list_price between 225 and 239  ;"
20,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1202 and 1202 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 180 and 209 and sm_type = 'REGULAR' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
21,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'IL', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'MN', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CA', 'NJ', 'SC') and ss_net_profit between 50 and 250 ))  ;"
22,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Barton County','Elliott County','Fairfax County','Madison Parish','Mellette County') and c.c_birth_month in (4, 8) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'S', 'S') and cd_education_status in ('Unknown', '4 yr Degree', '2 yr Degree') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 4 and 4+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Shoes')  and ss_sales_price / ss_list_price BETWEEN 31 * 0.01 AND 41 * 0.01  and i_manager_id BETWEEN 54 and 63  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 4 ANd 4+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Shoes')  and i_manager_id BETWEEN 54 and 63  and ws_sales_price / ws_list_price BETWEEN 31 * 0.01 AND 41 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 4 and 4+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Shoes')  and i_manager_id BETWEEN 54 and 63  and cs_sales_price / cs_list_price BETWEEN 31 * 0.01 AND 41 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
23,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'AL'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
24,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 19 * 0.01 AND 39 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1194 and 1194 + 11  and s_state in ('ID','MN','NC'   ,'NE','NY','OH','TN','TX')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1194+ 12 and 1194 + 23  and s_state in ('ID','MN','NC'   ,'NE','NY','OH','TN','TX')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
25,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Bee County','Bell County','Comanche County','Hardin County','Twin Falls County') and c.c_birth_month in (2, 3) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'S', 'S') and cd_education_status in ('4 yr Degree', 'Advanced Degree', '4 yr Degree') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 3 and 3+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and ss_sales_price / ss_list_price BETWEEN 15 * 0.01 AND 25 * 0.01  and i_manager_id BETWEEN 34 and 43  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 3 ANd 3+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and i_manager_id BETWEEN 34 and 43  and ws_sales_price / ws_list_price BETWEEN 15 * 0.01 AND 25 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 3 and 3+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and i_manager_id BETWEEN 34 and 43  and cs_sales_price / cs_list_price BETWEEN 15 * 0.01 AND 25 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
26,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('IL','MT','OH') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'W', 'M') and cd_education_status in ('2 yr Degree', '2 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 4 and 4+2  and ss_list_price between 6 and 95 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 4 and 4+2  and ws_list_price between 6 and 95  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 4 and 4+2  and cs_list_price between 6 and 95)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
27,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'CO'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
28,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,stddev_samp(ss_net_profit) as store_sales_profit ,stddev_samp(sr_net_loss) as store_returns_loss ,stddev_samp(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 2001 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
29,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_STORE_CREDIT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 120 and 179 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 37 AND 40 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('GA', 'IL', 'NC') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'W') and cd_education_status IN ('Advanced Degree', '4 yr Degree') and cd_gender = 'M' and c_birth_month = 2 and c_birth_year BETWEEN 1942 AND 1948 order by c_customer_id limit 100 ;"
30,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('LA','MI','MO') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'W', 'W') and cd_education_status in ('4 yr Degree', '2 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 7 and 7+2  and ss_list_price between 211 and 300 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 7 and 7+2  and ws_list_price between 211 and 300  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 7 and 7+2  and cs_list_price between 211 and 300)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
31,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'MI', 'WV') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CO', 'KY', 'WI') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MN', 'OK', 'WV') and ss_net_profit between 50 and 250 ))  ;"
32,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 50 and 59 and wr_return_amt / wr_return_quantity between 46 and 75 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AL', 'NE', 'TX', 'WI')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (61, 68) and c_birth_year BETWEEN 1963 AND 1969 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
33,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'S' and  cd_education_status = '2 yr Degree' and  d_year = 1999 and  s_state = 'MO' and i_category = 'Books'  ;"
34,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CA', 'MN', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'MO', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'SC', 'TX') and ss_net_profit between 50 and 250 ))  ;"
35,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 165 and 224 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 70 AND 73 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AR', 'MI', 'VA') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('U', 'U') and cd_education_status IN ('Secondary', 'Secondary') and cd_gender = 'M' and c_birth_month = 8 and c_birth_year BETWEEN 1938 AND 1944 order by c_customer_id limit 100 ;"
36,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2000 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Home', 'Jewelry', 'Shoes') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2000 and ss_wholesale_cost BETWEEN 66 AND 76  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1974 AND 1980 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2000 and d_moy = 11 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 66 AND 76 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2000 and d_moy = 11 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 66 AND 76) tmp2 limit 100 ;"
37,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1211 and 1211 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 31 and 60 and sm_type = 'OVERNIGHT' and cc_class = 'medium' and w_gmt_offset = -5  ;"
38,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Secondary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('LA', 'ND', 'PA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'FL', 'MI') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'IN', 'NC') and ss_net_profit between 50 and 250 ))  ;"
39,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Secondary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'MN', 'TN') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MN', 'NJ', 'SD') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CO', 'ID', 'TX') and ss_net_profit between 50 and 250 ))  ;"
40,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Blaine County','Calhoun County','Lafayette County','Lincoln County','Nicollet County') and c.c_birth_month in (5, 10) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'S', 'S') and cd_education_status in ('4 yr Degree', 'Primary', '2 yr Degree') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 9 and 9+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Shoes')  and ss_sales_price / ss_list_price BETWEEN 42 * 0.01 AND 52 * 0.01  and i_manager_id BETWEEN 42 and 51  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 9 ANd 9+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Shoes')  and i_manager_id BETWEEN 42 and 51  and ws_sales_price / ws_list_price BETWEEN 42 * 0.01 AND 52 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 9 and 9+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Shoes')  and i_manager_id BETWEEN 42 and 51  and cs_sales_price / cs_list_price BETWEEN 42 * 0.01 AND 52 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
41,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 and sr_return_amt / sr_return_quantity between 185 and 244 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 23 AND 26 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('IN', 'ME', 'MI') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'M') and cd_education_status IN ('Secondary', 'Secondary') and cd_gender = 'M' and c_birth_month = 10 and c_birth_year BETWEEN 1971 AND 1977 order by c_customer_id limit 100 ;"
42,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=1999 and d_moy = 6 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MO' and c_birth_month = 1 and ss_wholesale_cost BETWEEN 80 AND 100  ;"
43,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 60 and 79 and cd_marital_status = 'M' and cd_education_status = 'Primary' and s1.ss_list_price between 194 and 208 and s2.ss_list_price between 194 and 208 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
44,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Lakeview' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 27129 and ib_upper_bound <= 27129 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
45,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1998-01-08','1998-04-22','1998-08-29','1998-10-22'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Jewelry') and i_manager_id BETWEEN 50 and 59 and sr_return_amt / sr_return_quantity between 156 and 185 and sr_reason_sk in (4, 21, 23, 35, 40) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-01-08','1998-04-22','1998-08-29','1998-10-22'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Jewelry') and i_manager_id BETWEEN 50 and 59 and cr_return_amount / cr_return_quantity between 156 and 185 and cr_reason_sk in (4, 21, 23, 35, 40) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-01-08','1998-04-22','1998-08-29','1998-10-22'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Jewelry') and i_manager_id BETWEEN 50 and 59 and wr_return_amt / wr_return_quantity between 156 and 185 and wr_reason_sk in (4, 21, 23, 35, 40) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
46,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1214 and 1214+11 and ss_list_price between 229 and 258 and c_birth_year BETWEEN 1978 AND 1984 and ss_wholesale_cost BETWEEN 21 AND 31 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1214 and 1214+11 and cs_list_price between 229 and 258 and c_birth_year BETWEEN 1978 AND 1984 and cs_wholesale_cost BETWEEN 21 AND 31 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1214 and 1214+11 and ws_list_price between 229 and 258 and c_birth_year BETWEEN 1978 AND 1984 and ws_wholesale_cost BETWEEN 21 AND 31 ) ) cool_cust  ;"
47,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 and sr_return_amt / sr_return_quantity between 20 and 79 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 49 AND 52 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('FL', 'GA', 'NY') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'W') and cd_education_status IN ('4 yr Degree', 'Primary') and cd_gender = 'M' and c_birth_month = 11 and c_birth_year BETWEEN 1974 AND 1980 order by c_customer_id limit 100 ;"
48,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Deerfield' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 5 * 10000 and ib_upper_bound <= 5 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
49,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 9 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
50,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1178 and 1178 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 96 and 125 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5  ;"
51,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Midway' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 16967 and ib_upper_bound <= 16967 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
52,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Secondary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('LA', 'ND', 'PA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'FL', 'MI') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'IN', 'NC') and ss_net_profit between 50 and 250 ))  ;"
53,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Secondary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MA', 'OR', 'WA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'TX', 'WY') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('OH', 'SC', 'TX') and ss_net_profit between 50 and 250 ))  ;"
54,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1203 and 1203+11 and ss_list_price between 46 and 75 and c_birth_year BETWEEN 1980 AND 1986 and ss_wholesale_cost BETWEEN 58 AND 68 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1203 and 1203+11 and cs_list_price between 46 and 75 and c_birth_year BETWEEN 1980 AND 1986 and cs_wholesale_cost BETWEEN 58 AND 68 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1203 and 1203+11 and ws_list_price between 46 and 75 and c_birth_year BETWEEN 1980 AND 1986 and ws_wholesale_cost BETWEEN 58 AND 68 ) ) cool_cust  ;"
55,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('FL','MT','RI') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'D', 'M') and cd_education_status in ('4 yr Degree', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 3 and 3+2  and ss_list_price between 211 and 300 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 3 and 3+2  and ws_list_price between 211 and 300  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 3 and 3+2  and cs_list_price between 211 and 300)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
56,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 46 AND 66 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 72 and 72 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('IL','NJ','OH') and ss_wholesale_cost BETWEEN 46 AND 66 and cd1.cd_marital_status in ('S', 'M', 'W') and cd1.cd_education_status in ('Primary', '4 yr Degree', '2 yr Degree') and cd2.cd_marital_status in ('S', 'M', 'W') and cd2.cd_education_status in ('Primary', '4 yr Degree', '2 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1999 and cs2.syear = 1999 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
57,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,avg(ss_net_profit) as store_sales_profit ,avg(sr_net_loss) as store_returns_loss ,avg(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 2001 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
58,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Home') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'S' and cd_education_status = 'Primary' and s1.ss_list_price between 83 and 97 and s2.ss_list_price between 83 and 97 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
59,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2000 and d_moy = 12 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'WI' and c_birth_month = 9 and ss_wholesale_cost BETWEEN 66 AND 86  ;"
60,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Jewelry') and item2.i_manager_id between 75 and 94 and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 66 and 80 and s2.ss_list_price between 66 and 80 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
61,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Shoes') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = 'Unknown' and s1.ss_list_price between 153 and 167 and s2.ss_list_price between 153 and 167  ;"
62,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 2 * 0.01 AND 22 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1190 and 1190 + 11  and s_state in ('CA','NC','NE'   ,'NJ','OH','OK','WI','WV')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1190+ 12 and 1190 + 23  and s_state in ('CA','NC','NE'   ,'NJ','OH','OK','WI','WV')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
63,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Home', 'Men', 'Women') and i_manager_id BETWEEN 1 and 10 and ss_wholesale_cost BETWEEN 36 AND 56 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Home', 'Men', 'Women') and i_manager_id BETWEEN 1 and 10 and cs_wholesale_cost BETWEEN 36 AND 56 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 36 AND 56 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Home', 'Men', 'Women') and i_manager_id BETWEEN 1 and 10 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 36 AND 56  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 36 AND 56  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 36 AND 56 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 3) and i_category IN ('Home', 'Men', 'Women') and i_manager_id BETWEEN 1 and 10 and ss_wholesale_cost BETWEEN 36 AND 56 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 3) and i_category IN ('Home', 'Men', 'Women') and ss_wholesale_cost BETWEEN 36 AND 56 and i_manager_id BETWEEN 1 and 10 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
64,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'OH'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
65,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1196 and 1196+11 and ss_sales_price / ss_list_price BETWEEN 34 * 0.01 AND 44 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1196 and 1196+11 and ss_sales_price / ss_list_price BETWEEN 34 * 0.01 AND 44 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 38 and 42  and s_state in ('KS','MN','VA') order by s_store_name, i_item_desc limit 100 ;"
66,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2002 and d_moy = 8 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'CA' and c_birth_month = 1 and ss_wholesale_cost BETWEEN 13 AND 33 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
67,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1193 and 1193 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 112 and 141 and sm_type = 'REGULAR' and cc_class = 'medium' and w_gmt_offset = -5  ;"
68,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=2002 and d_moy = 6 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'TX' and c_birth_month = 6 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
69,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-03-16','2001-06-01','2001-09-17','2001-11-06'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 91 and 100 and sr_return_amt / sr_return_quantity between 15 and 44 and sr_reason_sk in (2, 12, 27, 39, 50) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-03-16','2001-06-01','2001-09-17','2001-11-06'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 91 and 100 and cr_return_amount / cr_return_quantity between 15 and 44 and cr_reason_sk in (2, 12, 27, 39, 50) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-03-16','2001-06-01','2001-09-17','2001-11-06'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 15 and 44 and wr_reason_sk in (2, 12, 27, 39, 50) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
70,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('FL', 'PA', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AL', 'VA', 'WY') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'HI', 'ID') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
71,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('ID','ME','OK') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'S', 'W') and cd_education_status in ('4 yr Degree', 'Secondary') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 and 8+2  and ss_list_price between 211 and 300 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 and 8+2  and ws_list_price between 211 and 300  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 and 8+2  and cs_list_price between 211 and 300)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
72,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KY', 'MN', 'NE') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('KY', 'OH', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'OK', 'WI') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
73,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 3 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 3 and 3 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 3 and 3 + 2 and d3.d_year  = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
74,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and d_year = 2000 and s_state = 'NM' and i_category = 'Jewelry' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
75,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 1 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 1 and 1 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 1 and 1 + 2 and d3.d_year  = 2001  ;"
76,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Women') and item2.i_manager_id between 67 and 86 and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 126 and 140 and s2.ss_list_price between 126 and 140 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
77,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1192 and 1192 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 45 and 74 and sm_type = 'REGULAR' and cc_class = 'small' and w_gmt_offset = -5  ;"
78,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 1 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 1 and 1 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 1 and 1 + 2 and d3.d_year  = 2000  ;"
79,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = 'Secondary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'PA', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'VA', 'WY') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'HI', 'ID') and ss_net_profit between 50 and 250 ))  ;"
80,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1204 and 1204+11 and ss_list_price between 239 and 268 and c_birth_year BETWEEN 1941 AND 1947 and ss_wholesale_cost BETWEEN 90 AND 100 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1204 and 1204+11 and cs_list_price between 239 and 268 and c_birth_year BETWEEN 1941 AND 1947 and cs_wholesale_cost BETWEEN 90 AND 100 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1204 and 1204+11 and ws_list_price between 239 and 268 and c_birth_year BETWEEN 1941 AND 1947 and ws_wholesale_cost BETWEEN 90 AND 100 ) ) cool_cust  ;"
81,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'MO', 'NC') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NJ', 'NY', 'SC') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'KS', 'WI') and ss_net_profit between 50 and 250 ))  ;"
82,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1202 and 1202 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 271 and 300 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
83,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 9 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
84,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 2000  ;"
85,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-03-11','2001-04-28','2001-09-20','2001-10-21'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Jewelry') and i_manager_id BETWEEN 91 and 100 and sr_return_amt / sr_return_quantity between 258 and 287 and sr_reason_sk in (9, 16, 18, 21, 53) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-03-11','2001-04-28','2001-09-20','2001-10-21'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Jewelry') and i_manager_id BETWEEN 91 and 100 and cr_return_amount / cr_return_quantity between 258 and 287 and cr_reason_sk in (9, 16, 18, 21, 53) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-03-11','2001-04-28','2001-09-20','2001-10-21'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Jewelry') and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 258 and 287 and wr_reason_sk in (9, 16, 18, 21, 53) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
86,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2000-02-10','2000-04-28','2000-07-11','2000-10-18'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Shoes') and i_manager_id BETWEEN 32 and 41 and sr_return_amt / sr_return_quantity between 186 and 215 and sr_reason_sk in (7, 8, 33, 38, 45) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-02-10','2000-04-28','2000-07-11','2000-10-18'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Shoes') and i_manager_id BETWEEN 32 and 41 and cr_return_amount / cr_return_quantity between 186 and 215 and cr_reason_sk in (7, 8, 33, 38, 45) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-02-10','2000-04-28','2000-07-11','2000-10-18'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Shoes') and i_manager_id BETWEEN 32 and 41 and wr_return_amt / wr_return_quantity between 186 and 215 and wr_reason_sk in (7, 8, 33, 38, 45) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
87,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2000-03-14','2000-06-12','2000-07-07','2000-11-13'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Children') and i_manager_id BETWEEN 15 and 24 and sr_return_amt / sr_return_quantity between 149 and 178 and sr_reason_sk in (46, 48, 50, 56, 71) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-03-14','2000-06-12','2000-07-07','2000-11-13'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Children') and i_manager_id BETWEEN 15 and 24 and cr_return_amount / cr_return_quantity between 149 and 178 and cr_reason_sk in (46, 48, 50, 56, 71) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-03-14','2000-06-12','2000-07-07','2000-11-13'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Children') and i_manager_id BETWEEN 15 and 24 and wr_return_amt / wr_return_quantity between 149 and 178 and wr_reason_sk in (46, 48, 50, 56, 71) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
88,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 41 * 0.01 AND 61 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1185 and 1185 + 11  and s_state in ('AL','CA','IA'   ,'KY','MO','NE','NY','TX')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1185+ 12 and 1185 + 23  and s_state in ('AL','CA','IA'   ,'KY','MO','NE','NY','TX')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
89,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 and sr_return_amt / sr_return_quantity between 78 and 137 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 23 AND 26 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AR', 'NY', 'TX') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'M') and cd_education_status IN ('4 yr Degree', 'Unknown') and cd_gender = 'F' and c_birth_month = 3 and c_birth_year BETWEEN 1945 AND 1951 order by c_customer_id limit 100 ;"
90,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Archer County','Candler County','Cook County','Morrow County','Oneida County') and c.c_birth_month in (2, 12) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'W', 'S') and cd_education_status in ('2 yr Degree', '4 yr Degree', '2 yr Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 5 and 5+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Music')  and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  and i_manager_id BETWEEN 57 and 66  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 5 ANd 5+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Music')  and i_manager_id BETWEEN 57 and 66  and ws_sales_price / ws_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 5 and 5+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Music')  and i_manager_id BETWEEN 57 and 66  and cs_sales_price / cs_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
91,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=2000 and d_moy = 1 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'OH' and c_birth_month = 3 and ss_wholesale_cost BETWEEN 56 AND 76  ;"
92,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and d_year = 2002 and s_state = 'WA' and i_category = 'Children' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
93,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 152 and 211 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 53 AND 56 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('MI', 'VA', 'WI') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'M') and cd_education_status IN ('4 yr Degree', 'Unknown') and cd_gender = 'M' and c_birth_month = 9 and c_birth_year BETWEEN 1957 AND 1963 order by c_customer_id limit 100 ;"
94,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('MN','NH','TN') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'U', 'M') and cd_education_status in ('Secondary', 'Primary') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 10 and 10+2  and ss_list_price between 201 and 290 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 10 and 10+2  and ws_list_price between 201 and 290  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 10 and 10+2  and cs_list_price between 201 and 290)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
95,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 7 and 26 AND i_category IN ('Books', 'Jewelry', 'Shoes') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 77 AND 87  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1932 AND 1938 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1999 and d_moy = 3 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 77 AND 87 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1999 and d_moy = 3 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 77 AND 87) tmp2 limit 100 ;"
96,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Shoes' and d_year=1999 and d_moy = 4 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'KS' and c_birth_month = 3 and ss_wholesale_cost BETWEEN 53 AND 73 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
97,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Burlington County','Jefferson County','Scott County','Somerset County','Wilkinson County') and c.c_birth_month in (3, 12) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'U', 'U') and cd_education_status in ('Secondary', 'Advanced Degree', '4 yr Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Sports')  and ss_sales_price / ss_list_price BETWEEN 54 * 0.01 AND 64 * 0.01  and i_manager_id BETWEEN 5 and 14  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 ANd 9+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Sports')  and i_manager_id BETWEEN 5 and 14  and ws_sales_price / ws_list_price BETWEEN 54 * 0.01 AND 64 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Sports')  and i_manager_id BETWEEN 5 and 14  and cs_sales_price / cs_list_price BETWEEN 54 * 0.01 AND 64 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
98,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1998-01-22','1998-05-30','1998-08-18','1998-11-12'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Jewelry') and i_manager_id BETWEEN 84 and 93 and sr_return_amt / sr_return_quantity between 234 and 263 and sr_reason_sk in (20, 21, 53, 56, 66) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-01-22','1998-05-30','1998-08-18','1998-11-12'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Jewelry') and i_manager_id BETWEEN 84 and 93 and cr_return_amount / cr_return_quantity between 234 and 263 and cr_reason_sk in (20, 21, 53, 56, 66) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-01-22','1998-05-30','1998-08-18','1998-11-12'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Jewelry') and i_manager_id BETWEEN 84 and 93 and wr_return_amt / wr_return_quantity between 234 and 263 and wr_reason_sk in (20, 21, 53, 56, 66) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
99,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 1998  ;"
100,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Books' and d_year=2000 and d_moy = 1 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'CO' and c_birth_month = 6 and ss_wholesale_cost BETWEEN 39 AND 59 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
101,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_STORE_CREDIT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2000 and sr_return_amt / sr_return_quantity between 213 and 272 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 47 AND 50 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('GA', 'PA', 'VA') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'S') and cd_education_status IN ('2 yr Degree', '2 yr Degree') and cd_gender = 'M' and c_birth_month = 6 and c_birth_year BETWEEN 1930 AND 1936 order by c_customer_id limit 100 ;"
102,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Mountain View' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 4 * 10000 and ib_upper_bound <= 4 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
103,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Children', 'Home', 'Women') and i_manager_id BETWEEN 17 and 26 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Children', 'Home', 'Women') and i_manager_id BETWEEN 17 and 26 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 80 AND 100 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Home', 'Women') and i_manager_id BETWEEN 17 and 26 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 80 AND 100  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 80 AND 100  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 80 AND 100 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 3) and i_category IN ('Children', 'Home', 'Women') and i_manager_id BETWEEN 17 and 26 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 3) and i_category IN ('Children', 'Home', 'Women') and ss_wholesale_cost BETWEEN 80 AND 100 and i_manager_id BETWEEN 17 and 26 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
104,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Lakeside' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 6 * 10000 and ib_upper_bound <= 6 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
105,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'MD', 'MS') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'IN', 'PA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'KS', 'TX') and ss_net_profit between 50 and 250 ))  ;"
106,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Home') and item2.i_manager_id between 53 and 72 and cd_marital_status = 'M' and cd_education_status = 'Secondary' and s1.ss_list_price between 89 and 103 and s2.ss_list_price between 89 and 103  ;"
107,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1191 and 1191 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 271 and 300 and sm_type = 'OVERNIGHT' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
108,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,avg(ss_net_profit) as store_sales_profit ,avg(sr_net_loss) as store_returns_loss ,avg(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 2 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 2 and 2 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 2 and 2 + 2 and d3.d_year  = 1998 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
109,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IA', 'MN', 'TN') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IA', 'MO', 'VT') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AK', 'MN', 'NV') and ss_net_profit between 50 and 250 ))  ;"
110,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Secondary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'NE', 'VA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'ID', 'KS') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MD', 'TX', 'UT') and ss_net_profit between 50 and 250 ))  ;"
111,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 4 * 0.01 AND 24 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1185 and 1185 + 11  and s_state in ('AR','IN','KY'   ,'MO','MS','NJ','NY','TX')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1185+ 12 and 1185 + 23  and s_state in ('AR','IN','KY'   ,'MO','MS','NJ','NY','TX')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
112,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'MO', 'NM') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IL', 'TN', 'VT') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('MO', 'NM', 'TX') and ws_net_profit between 50 and 250 ) )  ;"
113,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-02-15','2001-05-16','2001-08-11','2001-10-09'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Women') and i_manager_id BETWEEN 91 and 100 and sr_return_amt / sr_return_quantity between 271 and 300 and sr_reason_sk in (2, 26, 33, 52, 60) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-02-15','2001-05-16','2001-08-11','2001-10-09'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Women') and i_manager_id BETWEEN 91 and 100 and cr_return_amount / cr_return_quantity between 271 and 300 and cr_reason_sk in (2, 26, 33, 52, 60) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-02-15','2001-05-16','2001-08-11','2001-10-09'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Women') and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 271 and 300 and wr_reason_sk in (2, 26, 33, 52, 60) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
114,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Home' and i_class = 'rugs' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 12 and d_year = 1999 and wholesale_cost BETWEEN 49 AND 79 and c_birth_year BETWEEN 1945 AND 1958 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 49 AND 79  and s_state in ('FL','IL','IN'   ,'NC','NE','NM'   ,'OK','TX','VA'   ,'WY')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1999 and d_moy = 12)   and (select distinct d_month_seq+3   from date_dim where d_year = 1999 and d_moy = 12) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
115,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'MT', 'NE') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'MS', 'UT') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'SD', 'TX') and ss_net_profit between 50 and 250 ))  ;"
116,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'S' and  cd_education_status = '4 yr Degree' and  d_year = 2001 and  s_state = 'NV' and i_category = 'Jewelry'  ;"
117,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2001 and  c_birth_month = 9 and  ca_state in ('NC', 'OH', 'TN')  and cs_wholesale_cost BETWEEN 56 AND 61  AND i_category = 'Home'  ;"
118,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Union Hill' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 9365 and ib_upper_bound <= 9365 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
119,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 15 * 0.01 AND 35 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1193 and 1193 + 11  and s_state in ('AR','KS','MN'   ,'MS','ND','OR','TX','VA')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1193+ 12 and 1193 + 23  and s_state in ('AR','KS','MN'   ,'MS','ND','OR','TX','VA')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
120,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1181 and 1181 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 155 and 184 and sm_type = 'OVERNIGHT' and cc_class = 'medium' and w_gmt_offset = -5  ;"
121,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and d_year = 1999 and s_state = 'MO' and i_category = 'Books' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
122,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'TN', 'WV') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'OH', 'SD') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('DC', 'OK', 'PA') and ss_net_profit between 50 and 250 ))  ;"
123,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 54 * 0.01 AND 74 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1184 and 1184 + 11  and s_state in ('AL','GA','IL'   ,'LA','MA','MN','MO','UT')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1184+ 12 and 1184 + 23  and s_state in ('AL','GA','IL'   ,'LA','MA','MN','MO','UT')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
124,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1209 and 1209+11 and ss_sales_price / ss_list_price BETWEEN 87 * 0.01 AND 97 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1209 and 1209+11 and ss_sales_price / ss_list_price BETWEEN 87 * 0.01 AND 97 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 15 and 19  and s_state in ('AK','IN','NV') order by s_store_name, i_item_desc limit 100 ;"
125,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1176 and 1176 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 35 and 64 and sm_type = 'LIBRARY' and cc_class = 'small' and w_gmt_offset = -5  ;"
126,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('AR','CA','TN') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'U', 'S') and cd_education_status in ('Advanced Degree', 'Secondary') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 2 and 2+2  and ss_list_price between 211 and 300 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 2 and 2+2  and ws_list_price between 211 and 300  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 2 and 2+2  and cs_list_price between 211 and 300)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
127,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-04-07')) and ss_sold_date_sk = d_date_sk and ss_list_price between 215 and 244 and i_manager_id BETWEEN 58 and 87 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1984 AND 1990 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-04-07')) and cs_sold_date_sk = d_date_sk and cs_list_price between 215 and 244 and i_manager_id BETWEEN 58 and 87 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1984 AND 1990 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-04-07')) and ws_sold_date_sk = d_date_sk and ws_list_price between 215 and 244 and i_manager_id BETWEEN 58 and 87 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1984 AND 1990 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
128,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2000 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'KS'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
129,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 59 and 118 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 14 AND 17 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('IN', 'SD', 'WV') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'W') and cd_education_status IN ('2 yr Degree', '2 yr Degree') and cd_gender = 'M' and c_birth_month = 3 and c_birth_year BETWEEN 1979 AND 1985 order by c_customer_id limit 100 ;"
130,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Books' and d_year=1998 and d_moy = 5 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MN' and c_birth_month = 11 and ss_wholesale_cost BETWEEN 54 AND 74 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
131,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 17 and 36 and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 94 and 108 and s2.ss_list_price between 94 and 108 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
132,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Union Hill' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 7 * 10000 and ib_upper_bound <= 7 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
133,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 and sr_return_amt / sr_return_quantity between 191 and 250 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 34 AND 37 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('NE', 'SD', 'WV') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'S') and cd_education_status IN ('Secondary', 'Secondary') and cd_gender = 'M' and c_birth_month = 9 and c_birth_year BETWEEN 1981 AND 1987 order by c_customer_id limit 100 ;"
134,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Mountain View' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 36376 and ib_upper_bound <= 36376 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
135,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 2000  ;"
136,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188 + 11 and c_birth_month in (3, 5, 6, 11) and ss_list_price between 66 and 125 and ss_wholesale_cost BETWEEN 16 AND 36 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188 + 11 and c_birth_month in (3, 5, 6, 11) and cs_list_price between 66 and 125 and cs_wholesale_cost BETWEEN 16 AND 36 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188 + 11 and c_birth_month in (3, 5, 6, 11) and ws_list_price between 66 and 125 and ws_wholesale_cost BETWEEN 16 AND 36 ) hot_cust limit 100 ;"
137,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('AR','NY','TX') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'M', 'M') and cd_education_status in ('4 yr Degree', 'Unknown') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+2  and ss_list_price between 56 and 145 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+2  and ws_list_price between 56 and 145  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+2  and cs_list_price between 56 and 145)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
138,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 10 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -6  ;"
139,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('CA','NJ','OH') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'S', 'W') and cd_education_status in ('Secondary', '2 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 and 6+2  and ss_list_price between 34 and 123 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 and 6+2  and ws_list_price between 34 and 123  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 and 6+2  and cs_list_price between 34 and 123)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
140,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=2002 and d_moy = 11 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'SC' and c_birth_month = 4 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
141,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1205 and 1205 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 132 and 161 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5  ;"
142,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-02-13')) and ss_sold_date_sk = d_date_sk and ss_list_price between 198 and 227 and i_manager_id BETWEEN 50 and 79 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1928 AND 1934 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-02-13')) and cs_sold_date_sk = d_date_sk and cs_list_price between 198 and 227 and i_manager_id BETWEEN 50 and 79 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1928 AND 1934 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-02-13')) and ws_sold_date_sk = d_date_sk and ws_list_price between 198 and 227 and i_manager_id BETWEEN 50 and 79 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1928 AND 1934 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
143,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
144,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7  ;"
145,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1179 and 1179 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 221 and 250 and sm_type = 'TWO DAY' and cc_class = 'medium' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
146,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 68 AND 88 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 40 and 40 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('AR','GA','MN') and ss_wholesale_cost BETWEEN 68 AND 88 and cd1.cd_marital_status in ('D', 'M', 'M') and cd1.cd_education_status in ('Advanced Degree', '4 yr Degree', 'Advanced Degree') and cd2.cd_marital_status in ('D', 'M', 'M') and cd2.cd_education_status in ('Advanced Degree', '4 yr Degree', 'Advanced Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
147,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 9 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
148,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
149,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2000 and sr_return_amt / sr_return_quantity between 63 and 122 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 62 AND 65 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('IL', 'KY', 'WI') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'S') and cd_education_status IN ('Unknown', '4 yr Degree') and cd_gender = 'F' and c_birth_month = 1 and c_birth_year BETWEEN 1974 AND 1980 order by c_customer_id limit 100 ;"
150,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 20 and 29 and wr_return_amt / wr_return_quantity between 184 and 213 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('IL', 'MI', 'NE', 'OH')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (20, 34) and c_birth_year BETWEEN 1940 AND 1946 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
151,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('FL', 'GA', 'KS') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IN', 'TX', 'VA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'NE', 'VA') and ws_net_profit between 50 and 250 ) )  ;"
152,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Mount Pleasant' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 32741 and ib_upper_bound <= 32741 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
153,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
154,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'U' and cd_education_status = 'Primary' and d_year = 1998 and s_state = 'AK' and i_category = 'Women' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
155,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'GA', 'SD') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('LA', 'MS', 'NC') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MI', 'MO', 'PA') and ss_net_profit between 50 and 250 ))  ;"
156,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-06-02')) and ss_sold_date_sk = d_date_sk and ss_list_price between 163 and 192 and i_manager_id BETWEEN 69 and 98 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-06-02')) and cs_sold_date_sk = d_date_sk and cs_list_price between 163 and 192 and i_manager_id BETWEEN 69 and 98 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-06-02')) and ws_sold_date_sk = d_date_sk and ws_list_price between 163 and 192 and i_manager_id BETWEEN 69 and 98 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
157,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 17 and 26 and wr_return_amt / wr_return_quantity between 46 and 75 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AR', 'IL', 'KS', 'MN')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (12, 32) and c_birth_year BETWEEN 1963 AND 1969 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
158,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1201 and 1201+11 and ss_sales_price / ss_list_price BETWEEN 67 * 0.01 AND 77 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1201 and 1201+11 and ss_sales_price / ss_list_price BETWEEN 67 * 0.01 AND 77 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 85 and 89  and s_state in ('IN','MN','TN') order by s_store_name, i_item_desc limit 100 ;"
159,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
160,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1197 and 1197+11 and ss_list_price between 27 and 56 and c_birth_year BETWEEN 1937 AND 1943 and ss_wholesale_cost BETWEEN 77 AND 87 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1197 and 1197+11 and cs_list_price between 27 and 56 and c_birth_year BETWEEN 1937 AND 1943 and cs_wholesale_cost BETWEEN 77 AND 87 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1197 and 1197+11 and ws_list_price between 27 and 56 and c_birth_year BETWEEN 1937 AND 1943 and ws_wholesale_cost BETWEEN 77 AND 87 ) ) cool_cust  ;"
161,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Pleasant Grove' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 5 * 10000 and ib_upper_bound <= 5 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
162,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1186 and 1186 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 240 and 269 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
163,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1184 and 1184 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 183 and 212 and sm_type = 'LIBRARY' and cc_class = 'small' and w_gmt_offset = -5  ;"
164,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=1998 and d_moy = 1 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'SD' and c_birth_month = 1 and ss_wholesale_cost BETWEEN 9 AND 29 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
165,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1188 and 1188+11 and ss_sales_price / ss_list_price BETWEEN 43 * 0.01 AND 53 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1188 and 1188+11 and ss_sales_price / ss_list_price BETWEEN 43 * 0.01 AND 53 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 52 and 56  and s_state in ('MI','NM','NY') order by s_store_name, i_item_desc limit 100 ;"
166,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-01-25','1999-04-28','1999-07-15','1999-11-07'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Shoes') and i_manager_id BETWEEN 67 and 76 and sr_return_amt / sr_return_quantity between 271 and 300 and sr_reason_sk in (13, 17, 22, 37, 43) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-01-25','1999-04-28','1999-07-15','1999-11-07'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Shoes') and i_manager_id BETWEEN 67 and 76 and cr_return_amount / cr_return_quantity between 271 and 300 and cr_reason_sk in (13, 17, 22, 37, 43) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-01-25','1999-04-28','1999-07-15','1999-11-07'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Shoes') and i_manager_id BETWEEN 67 and 76 and wr_return_amt / wr_return_quantity between 271 and 300 and wr_reason_sk in (13, 17, 22, 37, 43) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
167,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Children') and item2.i_manager_id between 26 and 45 and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 107 and 121 and s2.ss_list_price between 107 and 121 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
168,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7  ;"
169,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Men' and d_year=1998 and d_moy = 2 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'KS' and c_birth_month = 3 and ss_wholesale_cost BETWEEN 28 AND 48 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
170,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Children', 'Home', 'Women') and i_manager_id BETWEEN 82 and 91 and ss_wholesale_cost BETWEEN 61 AND 81 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Children', 'Home', 'Women') and i_manager_id BETWEEN 82 and 91 and cs_wholesale_cost BETWEEN 61 AND 81 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 61 AND 81 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Home', 'Women') and i_manager_id BETWEEN 82 and 91 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 61 AND 81  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 61 AND 81  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 61 AND 81 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 26) and i_category IN ('Children', 'Home', 'Women') and i_manager_id BETWEEN 82 and 91 and ss_wholesale_cost BETWEEN 61 AND 81 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 26) and i_category IN ('Children', 'Home', 'Women') and ss_wholesale_cost BETWEEN 61 AND 81 and i_manager_id BETWEEN 82 and 91 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
171,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'College' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('GA', 'IL', 'PA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('LA', 'MT', 'UT') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('ID', 'NE', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
172,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AR', 'IN', 'NE') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IA', 'MS', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('KY', 'MT', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
173,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = 'Unknown' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 6 and  ca_state in ('FL', 'KY', 'OK')  and cs_wholesale_cost BETWEEN 100 AND 105  AND i_category = 'Shoes'  ;"
174,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-02-19')) and ss_sold_date_sk = d_date_sk and ss_list_price between 126 and 155 and i_manager_id BETWEEN 42 and 71 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1926 AND 1932 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-02-19')) and cs_sold_date_sk = d_date_sk and cs_list_price between 126 and 155 and i_manager_id BETWEEN 42 and 71 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1926 AND 1932 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-02-19')) and ws_sold_date_sk = d_date_sk and ws_list_price between 126 and 155 and i_manager_id BETWEEN 42 and 71 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1926 AND 1932 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
175,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=1999 and d_moy = 9 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'IA' and c_birth_month = 5 and ss_wholesale_cost BETWEEN 80 AND 100  ;"
176,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Sports') and item2.i_manager_id between 36 and 55 and cd_marital_status = 'M' and cd_education_status = 'Primary' and s1.ss_list_price between 147 and 161 and s2.ss_list_price between 147 and 161  ;"
177,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and d_year = 1998 and s_state = 'NH' and i_category = 'Home' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
178,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('CO','MI','MN') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'W', 'S') and cd_education_status in ('2 yr Degree', 'Advanced Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 1 and 1+2  and ss_list_price between 211 and 300 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 1 and 1+2  and ws_list_price between 211 and 300  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 1 and 1+2  and cs_list_price between 211 and 300)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
179,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 1999 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
180,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 1998  ;"
181,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Columbia County','Forsyth County','Kearney County','Martin County','Powell County') and c.c_birth_month in (8, 12) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'M', 'M') and cd_education_status in ('Unknown', 'Unknown', 'Unknown') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 and 3+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Jewelry')  and ss_sales_price / ss_list_price BETWEEN 22 * 0.01 AND 32 * 0.01  and i_manager_id BETWEEN 24 and 33  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 ANd 3+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Jewelry')  and i_manager_id BETWEEN 24 and 33  and ws_sales_price / ws_list_price BETWEEN 22 * 0.01 AND 32 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 and 3+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Jewelry')  and i_manager_id BETWEEN 24 and 33  and cs_sales_price / cs_list_price BETWEEN 22 * 0.01 AND 32 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
182,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AL', 'OK', 'UT') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('FL', 'NC', 'OH') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('ID', 'MN', 'TN') and ws_net_profit between 50 and 250 ) )  ;"
183,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AL', 'ID', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('MD', 'MS', 'UT') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'IN', 'NY') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
184,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 53 * 0.01 AND 73 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1184 and 1184 + 11  and s_state in ('IN','KS','MI'   ,'MO','NE','OH','OK','TX')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1184+ 12 and 1184 + 23  and s_state in ('IN','KS','MI'   ,'MO','NE','OH','OK','TX')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
185,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Home' and d_year=2002 and d_moy = 6 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'GA' and c_birth_month = 9 and ss_wholesale_cost BETWEEN 28 AND 48  ;"
186,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=1999 and d_moy = 2 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'WV' and c_birth_month = 4 and ss_wholesale_cost BETWEEN 48 AND 68  ;"
187,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2002 and  c_birth_month = 3 and  ca_state in ('IL', 'MN', 'TN')  and cs_wholesale_cost BETWEEN 32 AND 37  AND i_category = 'Electronics'  ;"
188,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'TN', 'WA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MD', 'TN', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'NH', 'TX') and ss_net_profit between 50 and 250 ))  ;"
189,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 229 and 288 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 55 AND 58 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('MO', 'TX', 'VA') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'U') and cd_education_status IN ('Secondary', 'Advanced Degree') and cd_gender = 'M' and c_birth_month = 9 and c_birth_year BETWEEN 1938 AND 1944 order by c_customer_id limit 100 ;"
190,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Electronics' and d_year=2001 and d_moy = 2 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'TX' and c_birth_month = 12 and ss_wholesale_cost BETWEEN 2 AND 22  ;"
191,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'MO', 'RI') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IL', 'MI', 'NE') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AR', 'CT', 'MI') and ws_net_profit between 50 and 250 ) )  ;"
192,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 238 and 297 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 51 AND 54 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AL', 'MT', 'WI') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'S') and cd_education_status IN ('2 yr Degree', '2 yr Degree') and cd_gender = 'M' and c_birth_month = 2 and c_birth_year BETWEEN 1940 AND 1946 order by c_customer_id limit 100 ;"
193,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 73 AND 93 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 80 and 80 + 10 and p_channel_email = 'Y' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('IL','ME','MI') and ss_wholesale_cost BETWEEN 73 AND 93 and cd1.cd_marital_status in ('M', 'M', 'S') and cd1.cd_education_status in ('Unknown', '2 yr Degree', '2 yr Degree') and cd2.cd_marital_status in ('M', 'M', 'S') and cd2.cd_education_status in ('Unknown', '2 yr Degree', '2 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
194,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-03-14')) and ss_sold_date_sk = d_date_sk and ss_list_price between 212 and 241 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1970 AND 1976 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-03-14')) and cs_sold_date_sk = d_date_sk and cs_list_price between 212 and 241 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1970 AND 1976 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-03-14')) and ws_sold_date_sk = d_date_sk and ws_list_price between 212 and 241 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1970 AND 1976 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
195,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1180 and 1180 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 73 and 102 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5  ;"
196,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and d_year = 1999 and s_state = 'KS' and i_category = 'Shoes' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
197,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 8 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 8 and 8 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 8 and 8 + 2 and d3.d_year  = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
198,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=2002 and d_moy = 11 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'AR' and c_birth_month = 12 and ss_wholesale_cost BETWEEN 51 AND 71  ;"
199,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1191 and 1191 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 271 and 300 and sm_type = 'OVERNIGHT' and cc_class = 'large' and w_gmt_offset = -5  ;"
200,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MA', 'OR', 'WY') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'SC', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('OH', 'TX', 'VA') and ws_net_profit between 50 and 250 ) )  ;"
201,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Bridgeport' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 6 * 10000 and ib_upper_bound <= 6 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
202,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1204 and 1204 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 124 and 153 and sm_type = 'REGULAR' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
203,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,stddev_samp(ss_net_profit) as store_sales_profit ,stddev_samp(sr_net_loss) as store_returns_loss ,stddev_samp(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
204,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MD', 'WI', 'WV') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('NC', 'NH', 'TN') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'MD', 'WA') and ws_net_profit between 50 and 250 ) )  ;"
205,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 22 and 41 AND i_category IN ('Children', 'Jewelry', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 90 AND 100  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1976 AND 1982 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1999 and d_moy = 8 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 90 AND 100 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1999 and d_moy = 8 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 90 AND 100) tmp2 limit 100 ;"
206,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,avg(ss_net_profit) as store_sales_profit ,avg(sr_net_loss) as store_returns_loss ,avg(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 1 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 1 and 1 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 1 and 1 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
207,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'GA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
208,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 1999 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
209,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Lakeview' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 35416 and ib_upper_bound <= 35416 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
210,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Advanced Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 1999 and  c_birth_month = 9 and  ca_state in ('GA', 'MN', 'TX')  and cs_wholesale_cost BETWEEN 43 AND 48  AND i_category = 'Home'  ;"
211,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 2001  ;"
212,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 54 AND 74 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 10 and 10 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('IL','MD','WI') and ss_wholesale_cost BETWEEN 54 AND 74 and cd1.cd_marital_status in ('S', 'S', 'S') and cd1.cd_education_status in ('4 yr Degree', '4 yr Degree', '2 yr Degree') and cd2.cd_marital_status in ('S', 'S', 'S') and cd2.cd_education_status in ('4 yr Degree', '4 yr Degree', '2 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
213,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Dyer County','Monroe County','Muscatine County','Union County','Westmoreland County') and c.c_birth_month in (3, 6) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'S', 'M') and cd_education_status in ('Unknown', '4 yr Degree', 'Unknown') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 5 and 5+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Shoes')  and ss_sales_price / ss_list_price BETWEEN 33 * 0.01 AND 43 * 0.01  and i_manager_id BETWEEN 91 and 100  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 5 ANd 5+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Shoes')  and i_manager_id BETWEEN 91 and 100  and ws_sales_price / ws_list_price BETWEEN 33 * 0.01 AND 43 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 5 and 5+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Shoes')  and i_manager_id BETWEEN 91 and 100  and cs_sales_price / cs_list_price BETWEEN 33 * 0.01 AND 43 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
214,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 2001 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
215,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Springdale' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 28254 and ib_upper_bound <= 28254 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
216,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Electronics' and d_year=2001 and d_moy = 2 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'TX' and c_birth_month = 12 and ss_wholesale_cost BETWEEN 2 AND 22 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
217,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = '2 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2001 and c_birth_month = 11 and ca_state in ('MN', 'OK', 'WV') and cs_wholesale_cost BETWEEN 43 AND 48 AND i_category = 'Home' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
218,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1212 and 1212 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 136 and 165 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5  ;"
219,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Secondary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Secondary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MN', 'VT', 'WA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MT', 'SC', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'GA', 'MO') and ss_net_profit between 50 and 250 ))  ;"
220,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and d_year = 1998 and s_state = 'MD' and i_category = 'Children' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
221,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AR', 'KS', 'OH') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('PA', 'TN', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('CO', 'CT', 'MN') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
222,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Jewelry' and i_class = 'costume' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 2 and d_year = 2001 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('GA','KS','KY'   ,'MN','NM','NY'   ,'OH','OK','TX'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 2)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 2) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
223,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 80 AND 100 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 76 and 76 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('LA','SD','WV') and ss_wholesale_cost BETWEEN 80 AND 100 and cd1.cd_marital_status in ('W', 'M', 'S') and cd1.cd_education_status in ('2 yr Degree', 'Secondary', 'Secondary') and cd2.cd_marital_status in ('W', 'M', 'S') and cd2.cd_education_status in ('2 yr Degree', 'Secondary', 'Secondary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1999 and cs2.syear = 1999 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
224,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = 'Advanced Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 1999 and  c_birth_month = 6 and  ca_state in ('KY', 'MO', 'OH')  and cs_wholesale_cost BETWEEN 33 AND 38  AND i_category = 'Music'  ;"
225,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1207 and 1207 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 195 and 224 and sm_type = 'TWO DAY' and cc_class = 'large' and w_gmt_offset = -5  ;"
226,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 68 * 0.01 AND 88 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1207 and 1207 + 11  and s_state in ('DC','IA','MO'   ,'OH','OK','PA','SD','WI')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1207+ 12 and 1207 + 23  and s_state in ('DC','IA','MO'   ,'OH','OK','PA','SD','WI')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
227,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=2000 and d_moy = 12 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'AZ' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
228,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 76 * 0.01 AND 96 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1190 and 1190 + 11  and s_state in ('AR','GA','ID'   ,'KS','MO','MS','SC','WI')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1190+ 12 and 1190 + 23  and s_state in ('AR','GA','ID'   ,'KS','MO','MS','SC','WI')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
229,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'VA', 'WI') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'MI', 'TX') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'SD', 'TX') and ss_net_profit between 50 and 250 ))  ;"
230,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'MT'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
231,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Books' and d_year=2000 and d_moy = 9 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'CA' and c_birth_month = 12 and ss_wholesale_cost BETWEEN 42 AND 62  ;"
232,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1196 and 1196 + 11 and c_birth_month in (2, 4, 6, 9) and ss_list_price between 170 and 229 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1196 and 1196 + 11 and c_birth_month in (2, 4, 6, 9) and cs_list_price between 170 and 229 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1196 and 1196 + 11 and c_birth_month in (2, 4, 6, 9) and ws_list_price between 170 and 229 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
233,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MT', 'NC', 'NY') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'NE', 'OK') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AR', 'OK', 'VA') and ws_net_profit between 50 and 250 ) )  ;"
234,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Advanced Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 1998 and  c_birth_month = 6 and  ca_state in ('AK', 'MN', 'NV')  and cs_wholesale_cost BETWEEN 59 AND 64  AND i_category = 'Children'  ;"
235,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1179 and 1179 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 107 and 136 and sm_type = 'REGULAR' and cc_class = 'small' and w_gmt_offset = -5  ;"
236,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'KS', 'NY') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NM', 'TX', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'NY', 'TX') and ss_net_profit between 50 and 250 ))  ;"
237,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 7 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7  ;"
238,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Pleasant Grove' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 45732 and ib_upper_bound <= 45732 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
239,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('mint', 'sandy') and i_manager_id BETWEEN 5 and 24 and ss_list_price between 278 and 292 and ca_state in ('AR','GA') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('mint', 'sandy') and i_manager_id BETWEEN 5 and 24 and ws_list_price between 278 and 292 and ca_state in ('AR','GA') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year ;"
240,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 35 and 54 and cd_marital_status = 'U' and cd_education_status = 'Primary' and s1.ss_list_price between 286 and 300 and s2.ss_list_price between 286 and 300 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
241,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'U' and cd_education_status = 'Primary' and d_year = 1998 and s_state = 'MS' and i_category = 'Women' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
242,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Women') and item2.i_manager_id between 67 and 86 and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 126 and 140 and s2.ss_list_price between 126 and 140  ;"
243,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REVERSED_TEXTGE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2000 and sr_return_amt / sr_return_quantity between 168 and 227 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 21 AND 24 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('CA', 'CO', 'KY') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'S') and cd_education_status IN ('4 yr Degree', '4 yr Degree') and cd_gender = 'M' and c_birth_month = 5 and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id limit 100 ;"
244,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2001 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 54 and 63 and wr_return_amt / wr_return_quantity between 128 and 157 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('IA', 'MN', 'MO', 'PA')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (32, 66) and c_birth_year BETWEEN 1940 AND 1946 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
245,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 36 and 45 and ss_wholesale_cost BETWEEN 50 AND 70 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 36 and 45 and cs_wholesale_cost BETWEEN 50 AND 70 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 50 AND 70 and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 36 and 45 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and ss_wholesale_cost BETWEEN 50 AND 70  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and cs_wholesale_cost BETWEEN 50 AND 70  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 50 AND 70 and d_year between 1999 and 1999 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999 + 1   and d_moy = 12   and d_dom = 4) and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 36 and 45 and ss_wholesale_cost BETWEEN 50 AND 70 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999   and d_moy = 12   and d_dom = 4) and i_category IN ('Children', 'Jewelry', 'Women') and ss_wholesale_cost BETWEEN 50 AND 70 and i_manager_id BETWEEN 36 and 45 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
246,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Liberty' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 7 * 10000 and ib_upper_bound <= 7 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
247,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=2000 and d_moy = 1 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'OH' and c_birth_month = 3 and ss_wholesale_cost BETWEEN 56 AND 76 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
248,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2002 and d_moy = 3 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'AL' and c_birth_month = 6 and ss_wholesale_cost BETWEEN 42 AND 62  ;"
249,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 10 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
250,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'IL', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'MN', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CA', 'NJ', 'SC') and ss_net_profit between 50 and 250 ))  ;"
251,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=1998 and d_moy = 6 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'OR' and c_birth_month = 12 and ss_wholesale_cost BETWEEN 38 AND 58  ;"
252,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2000 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Home', 'Shoes', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2000 and ss_wholesale_cost BETWEEN 74 AND 84  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1948 AND 1954 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2000 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 74 AND 84 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2000 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 74 AND 84) tmp2 limit 100 ;"
253,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-07-16')) and ss_sold_date_sk = d_date_sk and ss_list_price between 271 and 300 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-07-16')) and cs_sold_date_sk = d_date_sk and cs_list_price between 271 and 300 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-07-16')) and ws_sold_date_sk = d_date_sk and ws_list_price between 271 and 300 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
254,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'M' and cd_education_status = 'Primary' and d_year = 2000 and s_state = 'KS' and i_category = 'Women' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
255,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 21 and 80 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 71 AND 74 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AL', 'OK', 'TN') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'U') and cd_education_status IN ('Secondary', 'Primary') and cd_gender = 'M' and c_birth_month = 4 and c_birth_year BETWEEN 1947 AND 1953 order by c_customer_id limit 100 ;"
256,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Clare County','Harrison County','Hillsborough County','Keith County','Marion County') and c.c_birth_month in (3, 9) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'U', 'M') and cd_education_status in ('Secondary', 'Advanced Degree', 'Primary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 1 and 1+3 and  ss_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Women')  and ss_sales_price / ss_list_price BETWEEN 1 * 0.01 AND 11 * 0.01  and i_manager_id BETWEEN 10 and 19  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 1 ANd 1+3 and  ws_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Women')  and i_manager_id BETWEEN 10 and 19  and ws_sales_price / ws_list_price BETWEEN 1 * 0.01 AND 11 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 1 and 1+3 and  cs_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Women')  and i_manager_id BETWEEN 10 and 19  and cs_sales_price / cs_list_price BETWEEN 1 * 0.01 AND 11 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
257,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'MI', 'MO') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CT', 'MI', 'NE') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'AR', 'WV') and ss_net_profit between 50 and 250 ))  ;"
258,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 3 AND 23 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 28 and 28 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('AL','KS','PA') and ss_wholesale_cost BETWEEN 3 AND 23 and cd1.cd_marital_status in ('M', 'D', 'S') and cd1.cd_education_status in ('Advanced Degree', 'Unknown', '4 yr Degree') and cd2.cd_marital_status in ('M', 'D', 'S') and cd2.cd_education_status in ('Advanced Degree', 'Unknown', '4 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
259,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Cecil County','Chattooga County','Kaufman County','Somervell County','Wilkinson County') and c.c_birth_month in (1, 6) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'S', 'S') and cd_education_status in ('4 yr Degree', '4 yr Degree', '4 yr Degree') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 5 and 5+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Electronics', 'Jewelry')  and ss_sales_price / ss_list_price BETWEEN 32 * 0.01 AND 42 * 0.01  and i_manager_id BETWEEN 54 and 63  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 5 ANd 5+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Electronics', 'Jewelry')  and i_manager_id BETWEEN 54 and 63  and ws_sales_price / ws_list_price BETWEEN 32 * 0.01 AND 42 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 5 and 5+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Electronics', 'Jewelry')  and i_manager_id BETWEEN 54 and 63  and cs_sales_price / cs_list_price BETWEEN 32 * 0.01 AND 42 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
260,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1205 and 1205+11 and ss_list_price between 217 and 246 and c_birth_year BETWEEN 1985 AND 1991 and ss_wholesale_cost BETWEEN 13 AND 23 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1205 and 1205+11 and cs_list_price between 217 and 246 and c_birth_year BETWEEN 1985 AND 1991 and cs_wholesale_cost BETWEEN 13 AND 23 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1205 and 1205+11 and ws_list_price between 217 and 246 and c_birth_year BETWEEN 1985 AND 1991 and ws_wholesale_cost BETWEEN 13 AND 23 ) ) cool_cust  ;"
261,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Jewelry') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 190 and 204 and s2.ss_list_price between 190 and 204  ;"
262,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Secondary' and c_current_addr_sk = ca_address_sk and d_year = 1999 and c_birth_month = 2 and ca_state in ('MO', 'MS', 'NY') and cs_wholesale_cost BETWEEN 95 AND 100 AND i_category = 'Jewelry' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
263,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-03-22','1999-05-29','1999-08-16','1999-11-12'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Music') and i_manager_id BETWEEN 34 and 43 and sr_return_amt / sr_return_quantity between 132 and 161 and sr_reason_sk in (20, 58, 59, 63, 68) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-03-22','1999-05-29','1999-08-16','1999-11-12'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Music') and i_manager_id BETWEEN 34 and 43 and cr_return_amount / cr_return_quantity between 132 and 161 and cr_reason_sk in (20, 58, 59, 63, 68) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-03-22','1999-05-29','1999-08-16','1999-11-12'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Music') and i_manager_id BETWEEN 34 and 43 and wr_return_amt / wr_return_quantity between 132 and 161 and wr_reason_sk in (20, 58, 59, 63, 68) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
264,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'IL', 'NC') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('OK', 'TX', 'VT') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'NJ', 'WI') and ss_net_profit between 50 and 250 ))  ;"
265,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('AL','MN','OK') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'M', 'U') and cd_education_status in ('Secondary', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 1 and 1+2  and ss_list_price between 125 and 214 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 1 and 1+2  and ws_list_price between 125 and 214  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 1 and 1+2  and cs_list_price between 125 and 214)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
266,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'NH', 'NM') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('CO', 'OH', 'WV') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('OH', 'SC', 'TN') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
267,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Caddo Parish','El Paso County','Franklin Parish','Jones County','York County') and c.c_birth_month in (1, 8) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'W', 'S') and cd_education_status in ('Primary', 'Primary', '4 yr Degree') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 7 and 7+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Men')  and ss_sales_price / ss_list_price BETWEEN 42 * 0.01 AND 52 * 0.01  and i_manager_id BETWEEN 32 and 41  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 7 ANd 7+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Men')  and i_manager_id BETWEEN 32 and 41  and ws_sales_price / ws_list_price BETWEEN 42 * 0.01 AND 52 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 7 and 7+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Men')  and i_manager_id BETWEEN 32 and 41  and cs_sales_price / cs_list_price BETWEEN 42 * 0.01 AND 52 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
268,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2001 and i_manager_id BETWEEN 26 and 45 AND i_category IN ('Books', 'Men', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and ss_wholesale_cost BETWEEN 59 AND 69  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1939 AND 1945 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2001 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 59 AND 69 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2001 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 59 AND 69) tmp2 limit 100 ;"
269,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Advanced Degree' and c_current_addr_sk = ca_address_sk and d_year = 1999 and c_birth_month = 2 and ca_state in ('MT', 'SC', 'VA') and cs_wholesale_cost BETWEEN 56 AND 61 AND i_category = 'Books' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
270,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 and sr_return_amt / sr_return_quantity between 64 and 123 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 3 AND 6 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('KS', 'OK', 'WI') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('U', 'U') and cd_education_status IN ('Advanced Degree', 'Secondary') and cd_gender = 'M' and c_birth_month = 1 and c_birth_year BETWEEN 1967 AND 1973 order by c_customer_id limit 100 ;"
271,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('azure', 'orange') and i_manager_id BETWEEN 12 and 31 and ss_list_price between 83 and 97 and ca_state in ('KY','SD') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('azure', 'orange') and i_manager_id BETWEEN 12 and 31 and ws_list_price between 83 and 97 and ca_state in ('KY','SD') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;"
272,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IL', 'MO', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('LA', 'MI', 'WY') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IN', 'SD', 'VT') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
273,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Shoes') and item2.i_manager_id between 100 and 119 and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 146 and 160 and s2.ss_list_price between 146 and 160  ;"
274,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Secondary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'MO', 'MS') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'WA', 'WI') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'MO', 'MT') and ss_net_profit between 50 and 250 ))  ;"
275,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 2 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
276,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'D' and  cd_education_status = '2 yr Degree' and  d_year = 2002 and  s_state = 'NV' and i_category = 'Children'  ;"
277,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'College' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'MS', 'ND') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AR', 'OR', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('KS', 'MN', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
278,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1186 and 1186 + 11 and c_birth_month in (4, 5, 6, 10) and ss_list_price between 241 and 300 and ss_wholesale_cost BETWEEN 24 AND 44 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1186 and 1186 + 11 and c_birth_month in (4, 5, 6, 10) and cs_list_price between 241 and 300 and cs_wholesale_cost BETWEEN 24 AND 44 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1186 and 1186 + 11 and c_birth_month in (4, 5, 6, 10) and ws_list_price between 241 and 300 and ws_wholesale_cost BETWEEN 24 AND 44 ) hot_cust limit 100 ;"
279,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_STORE_CREDIT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 and sr_return_amt / sr_return_quantity between 4 and 63 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 72 AND 75 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('OH', 'TN', 'WV') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'S') and cd_education_status IN ('2 yr Degree', '2 yr Degree') and cd_gender = 'F' and c_birth_month = 10 and c_birth_year BETWEEN 1951 AND 1957 order by c_customer_id limit 100 ;"
280,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AL', 'OK', 'UT') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('FL', 'NC', 'OH') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('ID', 'MN', 'TN') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
281,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Men' and i_class = 'pants' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 9 and d_year = 2001 and wholesale_cost BETWEEN 35 AND 65 and c_birth_year BETWEEN 1948 AND 1961 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 35 AND 65  and s_state in ('AL','GA','ID'   ,'IN','KS','MD'   ,'MS','NE','TX'   ,'UT')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 9)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 9) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
282,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Shoes' and d_year=2002 and d_moy = 5 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'ID' and c_birth_month = 10 and ss_wholesale_cost BETWEEN 57 AND 77 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
283,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=2002 and d_moy = 6 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'TX' and c_birth_month = 6 and ss_wholesale_cost BETWEEN 80 AND 100  ;"
284,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Books' and d_year=2002 and d_moy = 12 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MN' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 15 AND 35 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
285,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1190 and 1190 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 149 and 178 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5  ;"
286,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 45 and 54 and ss_wholesale_cost BETWEEN 62 AND 82 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 45 and 54 and cs_wholesale_cost BETWEEN 62 AND 82 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 62 AND 82 and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 45 and 54 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and ss_wholesale_cost BETWEEN 62 AND 82  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and cs_wholesale_cost BETWEEN 62 AND 82  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 62 AND 82 and d_year between 1999 and 1999 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999 + 1   and d_moy = 12   and d_dom = 1) and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 45 and 54 and ss_wholesale_cost BETWEEN 62 AND 82 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999   and d_moy = 12   and d_dom = 1) and i_category IN ('Children', 'Jewelry', 'Women') and ss_wholesale_cost BETWEEN 62 AND 82 and i_manager_id BETWEEN 45 and 54 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
287,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 13 AND 33 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 45 and 45 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('GA','MA','UT') and ss_wholesale_cost BETWEEN 13 AND 33 and cd1.cd_marital_status in ('U', 'U', 'S') and cd1.cd_education_status in ('Advanced Degree', 'Secondary', 'Secondary') and cd2.cd_marital_status in ('U', 'U', 'S') and cd2.cd_education_status in ('Advanced Degree', 'Secondary', 'Secondary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2000 and cs2.syear = 2000 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
288,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1998 and i_manager_id BETWEEN 26 and 45 AND i_category IN ('Home', 'Jewelry', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1998 and ss_wholesale_cost BETWEEN 88 AND 98  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1998 and d_moy = 12 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 88 AND 98 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1998 and d_moy = 12 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 88 AND 98) tmp2 limit 100 ;"
289,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1194 and 1194 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 167 and 196 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5  ;"
290,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'College' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NJ', 'TN', 'WY') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MS', 'NM', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'IL', 'PA') and ss_net_profit between 50 and 250 ))  ;"
291,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 36 AND 56 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 41 and 41 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('GA','IL','WA') and ss_wholesale_cost BETWEEN 36 AND 56 and cd1.cd_marital_status in ('W', 'W', 'S') and cd1.cd_education_status in ('4 yr Degree', '4 yr Degree', '4 yr Degree') and cd2.cd_marital_status in ('W', 'W', 'S') and cd2.cd_education_status in ('4 yr Degree', '4 yr Degree', '4 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
292,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1219 and 1219+11 and ss_list_price between 192 and 221 and c_birth_year BETWEEN 1987 AND 1993 and ss_wholesale_cost BETWEEN 90 AND 100 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1219 and 1219+11 and cs_list_price between 192 and 221 and c_birth_year BETWEEN 1987 AND 1993 and cs_wholesale_cost BETWEEN 90 AND 100 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1219 and 1219+11 and ws_list_price between 192 and 221 and c_birth_year BETWEEN 1987 AND 1993 and ws_wholesale_cost BETWEEN 90 AND 100 ) ) cool_cust  ;"
293,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-01-10')) and ss_sold_date_sk = d_date_sk and ss_list_price between 21 and 50 and i_manager_id BETWEEN 22 and 51 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1982 AND 1988 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-01-10')) and cs_sold_date_sk = d_date_sk and cs_list_price between 21 and 50 and i_manager_id BETWEEN 22 and 51 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1982 AND 1988 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-01-10')) and ws_sold_date_sk = d_date_sk and ws_list_price between 21 and 50 and i_manager_id BETWEEN 22 and 51 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1982 AND 1988 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
294,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('FL', 'NV', 'SD') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('KS', 'OK', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'LA', 'NC') and ws_net_profit between 50 and 250 ) )  ;"
295,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Music' and d_year=2001 and d_moy = 8 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MN' and c_birth_month = 6 and ss_wholesale_cost BETWEEN 8 AND 28  ;"
296,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-07-11')) and ss_sold_date_sk = d_date_sk and ss_list_price between 94 and 123 and i_manager_id BETWEEN 19 and 48 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1941 AND 1947 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-07-11')) and cs_sold_date_sk = d_date_sk and cs_list_price between 94 and 123 and i_manager_id BETWEEN 19 and 48 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1941 AND 1947 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-07-11')) and ws_sold_date_sk = d_date_sk and ws_list_price between 94 and 123 and i_manager_id BETWEEN 19 and 48 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1941 AND 1947 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
297,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1207 and 1207 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 156 and 185 and sm_type = 'REGULAR' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
298,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 55 and 74 and cd_marital_status = 'U' and cd_education_status = 'Primary' and s1.ss_list_price between 238 and 252 and s2.ss_list_price between 238 and 252 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
299,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('red', 'spring') and i_manager_id BETWEEN 100 and 119 and ss_list_price between 195 and 209 and ca_state in ('GA','KY') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('red', 'spring') and i_manager_id BETWEEN 100 and 119 and ws_list_price between 195 and 209 and ca_state in ('GA','KY') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;"
300,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Carroll County','Dorchester County','Kanawha County','Miller County','Morgan County') and c.c_birth_month in (8, 11) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'S', 'M') and cd_education_status in ('Advanced Degree', 'Advanced Degree', 'Advanced Degree') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 and 8+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Music', 'Shoes')  and ss_sales_price / ss_list_price BETWEEN 56 * 0.01 AND 66 * 0.01  and i_manager_id BETWEEN 8 and 17  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 ANd 8+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Music', 'Shoes')  and i_manager_id BETWEEN 8 and 17  and ws_sales_price / ws_list_price BETWEEN 56 * 0.01 AND 66 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 and 8+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Music', 'Shoes')  and i_manager_id BETWEEN 8 and 17  and cs_sales_price / cs_list_price BETWEEN 56 * 0.01 AND 66 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
301,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AL', 'GA', 'NC') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AR', 'GA', 'IA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IA', 'MN', 'TX') and ws_net_profit between 50 and 250 ) )  ;"
302,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2001 and i_manager_id BETWEEN 72 and 91 AND i_category IN ('Children', 'Jewelry', 'Music') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and ss_wholesale_cost BETWEEN 67 AND 77  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1956 AND 1962 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2001 and d_moy = 6 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 67 AND 77 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2001 and d_moy = 6 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 67 AND 77) tmp2 limit 100 ;"
303,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 40 and 59 and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 196 and 210 and s2.ss_list_price between 196 and 210 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
304,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Children', 'Women') and i_manager_id BETWEEN 55 and 64 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Children', 'Women') and i_manager_id BETWEEN 55 and 64 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 80 AND 100 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Children', 'Women') and i_manager_id BETWEEN 55 and 64 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 80 AND 100  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 80 AND 100  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 80 AND 100 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 4) and i_category IN ('Books', 'Children', 'Women') and i_manager_id BETWEEN 55 and 64 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 4) and i_category IN ('Books', 'Children', 'Women') and ss_wholesale_cost BETWEEN 80 AND 100 and i_manager_id BETWEEN 55 and 64 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
305,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Shoes') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = 'Unknown' and s1.ss_list_price between 153 and 167 and s2.ss_list_price between 153 and 167 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
306,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Shoes' and d_year=1998 and d_moy = 1 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'IA' and c_birth_month = 6 and ss_wholesale_cost BETWEEN 56 AND 76 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
307,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2000 and i_manager_id BETWEEN 54 and 73 AND i_category IN ('Electronics', 'Home', 'Jewelry') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2000 and ss_wholesale_cost BETWEEN 14 AND 24  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1957 AND 1963 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2000 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 14 AND 24 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2000 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 14 AND 24) tmp2 limit 100 ;"
308,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-02-23')) and ss_sold_date_sk = d_date_sk and ss_list_price between 109 and 138 and i_manager_id BETWEEN 7 and 36 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1936 AND 1942 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-02-23')) and cs_sold_date_sk = d_date_sk and cs_list_price between 109 and 138 and i_manager_id BETWEEN 7 and 36 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1936 AND 1942 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-02-23')) and ws_sold_date_sk = d_date_sk and ws_list_price between 109 and 138 and i_manager_id BETWEEN 7 and 36 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1936 AND 1942 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
309,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('NC', 'NE', 'SD') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AL', 'AR', 'NH') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AL', 'MO', 'NE') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
310,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Children') and item2.i_manager_id between 40 and 59 and cd_marital_status = 'M' and cd_education_status = 'Primary' and s1.ss_list_price between 286 and 300 and s2.ss_list_price between 286 and 300  ;"
311,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2002-02-20','2002-04-06','2002-09-02','2002-10-06'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Jewelry') and i_manager_id BETWEEN 59 and 68 and sr_return_amt / sr_return_quantity between 271 and 300 and sr_reason_sk in (5, 13, 24, 48, 75) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-02-20','2002-04-06','2002-09-02','2002-10-06'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Jewelry') and i_manager_id BETWEEN 59 and 68 and cr_return_amount / cr_return_quantity between 271 and 300 and cr_reason_sk in (5, 13, 24, 48, 75) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-02-20','2002-04-06','2002-09-02','2002-10-06'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Jewelry') and i_manager_id BETWEEN 59 and 68 and wr_return_amt / wr_return_quantity between 271 and 300 and wr_reason_sk in (5, 13, 24, 48, 75) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
312,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 60 and 69 and wr_return_amt / wr_return_quantity between 81 and 110 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('GA', 'IN', 'NJ', 'VA')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (7, 38) and c_birth_year BETWEEN 1960 AND 1966 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
313,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1195 and 1195+11 and ss_list_price between 182 and 211 and c_birth_year BETWEEN 1986 AND 1992 and ss_wholesale_cost BETWEEN 10 AND 20 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1195 and 1195+11 and cs_list_price between 182 and 211 and c_birth_year BETWEEN 1986 AND 1992 and cs_wholesale_cost BETWEEN 10 AND 20 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1195 and 1195+11 and ws_list_price between 182 and 211 and c_birth_year BETWEEN 1986 AND 1992 and ws_wholesale_cost BETWEEN 10 AND 20 ) ) cool_cust  ;"
314,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 80 * 0.01 AND 100 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1210 and 1210 + 11  and s_state in ('CA','FL','KY'   ,'NY','OK','PA','RI','TX')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1210+ 12 and 1210 + 23  and s_state in ('CA','FL','KY'   ,'NY','OK','PA','RI','TX')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
315,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'MT'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
316,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('orchid', 'steel') and i_manager_id BETWEEN 31 and 50 and ss_list_price between 190 and 204 and ca_state in ('AL','MA') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('orchid', 'steel') and i_manager_id BETWEEN 31 and 50 and ws_list_price between 190 and 204 and ca_state in ('AL','MA') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2001 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2001 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2001 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2001 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2001 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2001 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q1_q2_increase ;"
317,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=1998 and d_moy = 12 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'GA' and c_birth_month = 10 and ss_wholesale_cost BETWEEN 13 AND 33  ;"
318,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1218 and 1218+11 and ss_sales_price / ss_list_price BETWEEN 72 * 0.01 AND 82 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1218 and 1218+11 and ss_sales_price / ss_list_price BETWEEN 72 * 0.01 AND 82 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 55 and 59  and s_state in ('MN','MO','TX') order by s_store_name, i_item_desc limit 100 ;"
319,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,stddev_samp(ss_net_profit) as store_sales_profit ,stddev_samp(sr_net_loss) as store_returns_loss ,stddev_samp(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
320,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1180 and 1180 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 29 and 58 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
321,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('GA', 'MN', 'MS') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AR', 'NC', 'SC') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AL', 'MO', 'WI') and ws_net_profit between 50 and 250 ) )  ;"
322,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-02-18')) and ss_sold_date_sk = d_date_sk and ss_list_price between 65 and 94 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1934 AND 1940 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-02-18')) and cs_sold_date_sk = d_date_sk and cs_list_price between 65 and 94 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1934 AND 1940 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-02-18')) and ws_sold_date_sk = d_date_sk and ws_list_price between 65 and 94 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1934 AND 1940 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
323,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MS', 'SD', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AK', 'IN', 'NV') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('KY', 'NY', 'TX') and ws_net_profit between 50 and 250 ) )  ;"
324,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-03-08','1999-04-30','1999-08-13','1999-11-22'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Sports') and i_manager_id BETWEEN 81 and 90 and sr_return_amt / sr_return_quantity between 64 and 93 and sr_reason_sk in (3, 33, 58, 66, 67) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-03-08','1999-04-30','1999-08-13','1999-11-22'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Sports') and i_manager_id BETWEEN 81 and 90 and cr_return_amount / cr_return_quantity between 64 and 93 and cr_reason_sk in (3, 33, 58, 66, 67) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-03-08','1999-04-30','1999-08-13','1999-11-22'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Sports') and i_manager_id BETWEEN 81 and 90 and wr_return_amt / wr_return_quantity between 64 and 93 and wr_reason_sk in (3, 33, 58, 66, 67) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
325,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2000-01-11','2000-06-12','2000-09-01','2000-11-17'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 36 and 45 and sr_return_amt / sr_return_quantity between 72 and 101 and sr_reason_sk in (4, 18, 21, 34, 41) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-01-11','2000-06-12','2000-09-01','2000-11-17'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 36 and 45 and cr_return_amount / cr_return_quantity between 72 and 101 and cr_reason_sk in (4, 18, 21, 34, 41) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-01-11','2000-06-12','2000-09-01','2000-11-17'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Women') and i_manager_id BETWEEN 36 and 45 and wr_return_amt / wr_return_quantity between 72 and 101 and wr_reason_sk in (4, 18, 21, 34, 41) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
326,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2000 and i_manager_id BETWEEN 21 and 40 AND i_category IN ('Children', 'Home', 'Jewelry') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2000 and ss_wholesale_cost BETWEEN 44 AND 54  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1947 AND 1953 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2000 and d_moy = 9 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 44 AND 54 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2000 and d_moy = 9 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 44 AND 54) tmp2 limit 100 ;"
327,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2001 and  c_birth_month = 6 and  ca_state in ('GA', 'IL', 'TX')  and cs_wholesale_cost BETWEEN 7 AND 12  AND i_category = 'Children'  ;"
328,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'MI', 'VA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'IL', 'KS') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IA', 'MD', 'OR') and ss_net_profit between 50 and 250 ))  ;"
329,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'MI'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
330,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Home' and d_year=2001 and d_moy = 10 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'OR' and c_birth_month = 12 and ss_wholesale_cost BETWEEN 51 AND 71  ;"
331,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'TN', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'KY', 'NE') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CO', 'NM', 'TX') and ss_net_profit between 50 and 250 ))  ;"
332,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('GA','MT','OR') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'M', 'U') and cd_education_status in ('Advanced Degree', 'Secondary') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 4 and 4+2  and ss_list_price between 66 and 155 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 4 and 4+2  and ws_list_price between 66 and 155  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 4 and 4+2  and cs_list_price between 66 and 155)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
333,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Arlington' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 2 * 10000 and ib_upper_bound <= 2 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
334,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 9 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 9 and 9 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 9 and 9 + 2 and d3.d_year  = 1998  ;"
335,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
336,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 62 and 71 and wr_return_amt / wr_return_quantity between 110 and 139 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CA', 'FL', 'MN', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (64, 65) and c_birth_year BETWEEN 1976 AND 1982 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
337,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Shoes') and item2.i_manager_id between 40 and 59 and cd_marital_status = 'W' and cd_education_status = 'Unknown' and s1.ss_list_price between 162 and 176 and s2.ss_list_price between 162 and 176 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
338,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'MO', 'RI') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IL', 'MI', 'NE') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AR', 'CT', 'MI') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
339,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=2002 and d_moy = 4 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'VA' and c_birth_month = 2 and ss_wholesale_cost BETWEEN 2 AND 22  ;"
340,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212 + 11 and c_birth_month in (3, 4, 9, 11) and ss_list_price between 158 and 217 and ss_wholesale_cost BETWEEN 71 AND 91 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212 + 11 and c_birth_month in (3, 4, 9, 11) and cs_list_price between 158 and 217 and cs_wholesale_cost BETWEEN 71 AND 91 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212 + 11 and c_birth_month in (3, 4, 9, 11) and ws_list_price between 158 and 217 and ws_wholesale_cost BETWEEN 71 AND 91 ) hot_cust limit 100 ;"
341,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 80 AND 100 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 25 and 25 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('DC','PA','WI') and ss_wholesale_cost BETWEEN 80 AND 100 and cd1.cd_marital_status in ('M', 'M', 'S') and cd1.cd_education_status in ('Unknown', 'Unknown', '4 yr Degree') and cd2.cd_marital_status in ('M', 'M', 'S') and cd2.cd_education_status in ('Unknown', 'Unknown', '4 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
342,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 1999  ;"
343,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 1 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 1 and 1 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 1 and 1 + 2 and d3.d_year  = 1998  ;"
344,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Children', 'Home', 'Shoes') and i_manager_id BETWEEN 2 and 11 and ss_wholesale_cost BETWEEN 61 AND 81 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Children', 'Home', 'Shoes') and i_manager_id BETWEEN 2 and 11 and cs_wholesale_cost BETWEEN 61 AND 81 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 61 AND 81 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Home', 'Shoes') and i_manager_id BETWEEN 2 and 11 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 61 AND 81  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 61 AND 81  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 61 AND 81 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 1) and i_category IN ('Children', 'Home', 'Shoes') and i_manager_id BETWEEN 2 and 11 and ss_wholesale_cost BETWEEN 61 AND 81 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 1) and i_category IN ('Children', 'Home', 'Shoes') and ss_wholesale_cost BETWEEN 61 AND 81 and i_manager_id BETWEEN 2 and 11 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
345,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1222 and 1222 + 11 and c_birth_month in (1, 5, 7, 9) and ss_list_price between 28 and 87 and ss_wholesale_cost BETWEEN 0 AND 20 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1222 and 1222 + 11 and c_birth_month in (1, 5, 7, 9) and cs_list_price between 28 and 87 and cs_wholesale_cost BETWEEN 0 AND 20 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1222 and 1222 + 11 and c_birth_month in (1, 5, 7, 9) and ws_list_price between 28 and 87 and ws_wholesale_cost BETWEEN 0 AND 20 ) hot_cust limit 100 ;"
346,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-02-05','1999-05-08','1999-08-27','1999-10-13'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Music') and i_manager_id BETWEEN 73 and 82 and sr_return_amt / sr_return_quantity between 30 and 59 and sr_reason_sk in (3, 21, 43, 48, 62) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-02-05','1999-05-08','1999-08-27','1999-10-13'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Music') and i_manager_id BETWEEN 73 and 82 and cr_return_amount / cr_return_quantity between 30 and 59 and cr_reason_sk in (3, 21, 43, 48, 62) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-02-05','1999-05-08','1999-08-27','1999-10-13'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Music') and i_manager_id BETWEEN 73 and 82 and wr_return_amt / wr_return_quantity between 30 and 59 and wr_reason_sk in (3, 21, 43, 48, 62) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
347,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1212 and 1212+11 and ss_sales_price / ss_list_price BETWEEN 69 * 0.01 AND 79 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1212 and 1212+11 and ss_sales_price / ss_list_price BETWEEN 69 * 0.01 AND 79 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 83 and 87  and s_state in ('AK','MN','NV') order by s_store_name, i_item_desc limit 100 ;"
348,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 241 and 300 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 64 AND 67 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('ID', 'LA', 'MT') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'M') and cd_education_status IN ('4 yr Degree', 'Secondary') and cd_gender = 'M' and c_birth_month = 10 and c_birth_year BETWEEN 1957 AND 1963 order by c_customer_id limit 100 ;"
349,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AL', 'MO', 'NY') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('CA', 'KY', 'WI') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('NC', 'OK', 'WV') and ws_net_profit between 50 and 250 ) )  ;"
350,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Women') and item2.i_manager_id between 67 and 86 and cd_marital_status = 'M' and cd_education_status = 'Secondary' and s1.ss_list_price between 179 and 193 and s2.ss_list_price between 179 and 193  ;"
351,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Greenwood' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 37022 and ib_upper_bound <= 37022 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
352,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Green Acres' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 1 * 10000 and ib_upper_bound <= 1 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
353,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2001 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Books', 'Jewelry', 'Shoes') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and ss_wholesale_cost BETWEEN 90 AND 100  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1964 AND 1970 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2001 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 90 AND 100 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2001 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 90 AND 100) tmp2 limit 100 ;"
354,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Secondary' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 9 and ca_state in ('IL', 'MT', 'TX') and cs_wholesale_cost BETWEEN 92 AND 97 AND i_category = 'Jewelry' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
355,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = '2 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 1999 and c_birth_month = 7 and ca_state in ('FL', 'IA', 'MO') and cs_wholesale_cost BETWEEN 16 AND 21 AND i_category = 'Women' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
356,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2000 and d_moy = 4 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'OH' and c_birth_month = 4 and ss_wholesale_cost BETWEEN 80 AND 100  ;"
357,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Home', 'Women') and i_manager_id BETWEEN 83 and 92 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Home', 'Women') and i_manager_id BETWEEN 83 and 92 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 80 AND 100 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Home', 'Women') and i_manager_id BETWEEN 83 and 92 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 80 AND 100  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 80 AND 100  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 80 AND 100 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 23) and i_category IN ('Books', 'Home', 'Women') and i_manager_id BETWEEN 83 and 92 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 23) and i_category IN ('Books', 'Home', 'Women') and ss_wholesale_cost BETWEEN 80 AND 100 and i_manager_id BETWEEN 83 and 92 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
358,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'M' and cd_education_status = 'Primary' and d_year = 2000 and s_state = 'VA' and i_category = 'Jewelry' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
359,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = 'Advanced Degree' and c_current_addr_sk = ca_address_sk and d_year = 2002 and c_birth_month = 7 and ca_state in ('IL', 'VA', 'WV') and cs_wholesale_cost BETWEEN 35 AND 40 AND i_category = 'Books' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
360,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,stddev_samp(ss_net_profit) as store_sales_profit ,stddev_samp(sr_net_loss) as store_returns_loss ,stddev_samp(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 9 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 9 and 9 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 9 and 9 + 2 and d3.d_year  = 1999 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
361,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = '4 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2001 and c_birth_month = 9 and ca_state in ('IN', 'SD', 'TX') and cs_wholesale_cost BETWEEN 65 AND 70 AND i_category = 'Children' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
362,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('chartreuse', 'pale') and i_manager_id BETWEEN 36 and 55 and ss_list_price between 203 and 217 and ca_state in ('MN','WV') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('chartreuse', 'pale') and i_manager_id BETWEEN 36 and 55 and ws_list_price between 203 and 217 and ca_state in ('MN','WV') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;"
363,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-05-29')) and ss_sold_date_sk = d_date_sk and ss_list_price between 154 and 183 and i_manager_id BETWEEN 29 and 58 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1958 AND 1964 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-05-29')) and cs_sold_date_sk = d_date_sk and cs_list_price between 154 and 183 and i_manager_id BETWEEN 29 and 58 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1958 AND 1964 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-05-29')) and ws_sold_date_sk = d_date_sk and ws_list_price between 154 and 183 and i_manager_id BETWEEN 29 and 58 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1958 AND 1964 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
364,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('NE', 'PA', 'VT') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'KY', 'TN') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('KY', 'NE', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
365,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MN', 'OK', 'WV') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IL', 'OK', 'VA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'KY', 'VA') and ws_net_profit between 50 and 250 ) )  ;"
366,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Springdale' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 4 * 10000 and ib_upper_bound <= 4 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
367,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and d_year = 2001 and s_state = 'NV' and i_category = 'Jewelry' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
368,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IA', 'OK', 'OR') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'NC', 'NY') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'OK', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
369,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 8 AND 28 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 63 and 63 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('GA','OH','TN') and ss_wholesale_cost BETWEEN 8 AND 28 and cd1.cd_marital_status in ('M', 'S', 'M') and cd1.cd_education_status in ('Advanced Degree', 'Secondary', 'Advanced Degree') and cd2.cd_marital_status in ('M', 'S', 'M') and cd2.cd_education_status in ('Advanced Degree', 'Secondary', 'Advanced Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
370,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=1999 and d_moy = 9 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MI' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 62 AND 82 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
371,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Christian County','Jefferson County','Leavenworth County','Queen Anne County','Ringgold County') and c.c_birth_month in (11, 12) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'U', 'S') and cd_education_status in ('Secondary', 'Advanced Degree', 'Secondary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 and 9+3 and  ss_item_sk = i_item_sk and  i_category in ('Jewelry', 'Men', 'Women')  and ss_sales_price / ss_list_price BETWEEN 34 * 0.01 AND 44 * 0.01  and i_manager_id BETWEEN 38 and 47  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 ANd 9+3 and  ws_item_sk = i_item_sk and  i_category in ('Jewelry', 'Men', 'Women')  and i_manager_id BETWEEN 38 and 47  and ws_sales_price / ws_list_price BETWEEN 34 * 0.01 AND 44 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 and 9+3 and  cs_item_sk = i_item_sk and  i_category in ('Jewelry', 'Men', 'Women')  and i_manager_id BETWEEN 38 and 47  and cs_sales_price / cs_list_price BETWEEN 34 * 0.01 AND 44 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
372,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1195 and 1195 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 238 and 267 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
373,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KY', 'MN', 'NE') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('KY', 'OH', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'OK', 'WI') and ws_net_profit between 50 and 250 ) )  ;"
374,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 40 and 59 AND i_category IN ('Books', 'Children', 'Home') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 23 AND 33  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1980 AND 1986 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1999 and d_moy = 8 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 23 AND 33 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1999 and d_moy = 8 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 23 AND 33) tmp2 limit 100 ;"
375,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('KS','OK','WI') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'U', 'U') and cd_education_status in ('Advanced Degree', 'Secondary') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 2 and 2+2  and ss_list_price between 211 and 300 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 2 and 2+2  and ws_list_price between 211 and 300  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 2 and 2+2  and cs_list_price between 211 and 300)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
376,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('IL','OK','VA') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'M', 'S') and cd_education_status in ('4 yr Degree', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 8 and 8+2  and ss_list_price between 70 and 159 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 8 and 8+2  and ws_list_price between 70 and 159  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 8 and 8+2  and cs_list_price between 70 and 159)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
377,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Primary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MN', 'MS', 'MT') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CA', 'KS', 'SD') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NY', 'SC', 'VA') and ss_net_profit between 50 and 250 ))  ;"
378,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('FL','NC','UT') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'S', 'M') and cd_education_status in ('Unknown', 'Advanced Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+2  and ss_list_price between 199 and 288 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+2  and ws_list_price between 199 and 288  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+2  and cs_list_price between 199 and 288)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
379,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('GA', 'MN', 'MS') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AR', 'NC', 'SC') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AL', 'MO', 'WI') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
380,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'VA', 'WI') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'MI', 'TX') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'SD', 'TX') and ss_net_profit between 50 and 250 ))  ;"
381,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 48 * 0.01 AND 68 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1204 and 1204 + 11  and s_state in ('GA','IL','KS'   ,'KY','MD','MN','NC','VA')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1204+ 12 and 1204 + 23  and s_state in ('GA','IL','KS'   ,'KY','MD','MN','NC','VA')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
382,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Unknown' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 11 and ca_state in ('GA', 'MO', 'VA') and cs_wholesale_cost BETWEEN 86 AND 91 AND i_category = 'Children' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
383,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1219 and 1219+11 and ss_sales_price / ss_list_price BETWEEN 43 * 0.01 AND 53 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1219 and 1219+11 and ss_sales_price / ss_list_price BETWEEN 43 * 0.01 AND 53 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 19 and 23  and s_state in ('AR','KY','SD') order by s_store_name, i_item_desc limit 100 ;"
384,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 29 and 38 and ss_wholesale_cost BETWEEN 8 AND 28 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 29 and 38 and cs_wholesale_cost BETWEEN 8 AND 28 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 8 AND 28 and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 29 and 38 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and ss_wholesale_cost BETWEEN 8 AND 28  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and cs_wholesale_cost BETWEEN 8 AND 28  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 8 AND 28 and d_year between 1999 and 1999 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999 + 1   and d_moy = 12   and d_dom = 2) and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 29 and 38 and ss_wholesale_cost BETWEEN 8 AND 28 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999   and d_moy = 12   and d_dom = 2) and i_category IN ('Children', 'Jewelry', 'Women') and ss_wholesale_cost BETWEEN 8 AND 28 and i_manager_id BETWEEN 29 and 38 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
385,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('peru', 'sandy') and i_manager_id BETWEEN 10 and 29 and ss_list_price between 166 and 180 and ca_state in ('MO','VT') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('peru', 'sandy') and i_manager_id BETWEEN 10 and 29 and ws_list_price between 166 and 180 and ca_state in ('MO','VT') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year ;"
386,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1196 and 1196 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 156 and 185 and sm_type = 'TWO DAY' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
387,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1214 and 1214 + 11 and c_birth_month in (2, 4, 6, 8) and ss_list_price between 154 and 213 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1214 and 1214 + 11 and c_birth_month in (2, 4, 6, 8) and cs_list_price between 154 and 213 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1214 and 1214 + 11 and c_birth_month in (2, 4, 6, 8) and ws_list_price between 154 and 213 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
388,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Riverdale' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 54638 and ib_upper_bound <= 54638 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
389,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Secondary' and c_current_addr_sk = ca_address_sk and d_year = 1999 and c_birth_month = 11 and ca_state in ('GA', 'NC', 'OH') and cs_wholesale_cost BETWEEN 95 AND 100 AND i_category = 'Children' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
390,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-02-19')) and ss_sold_date_sk = d_date_sk and ss_list_price between 244 and 273 and i_manager_id BETWEEN 58 and 87 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1985 AND 1991 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-02-19')) and cs_sold_date_sk = d_date_sk and cs_list_price between 244 and 273 and i_manager_id BETWEEN 58 and 87 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1985 AND 1991 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-02-19')) and ws_sold_date_sk = d_date_sk and ws_list_price between 244 and 273 and i_manager_id BETWEEN 58 and 87 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1985 AND 1991 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
391,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 230 and 289 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 52 AND 55 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('GA', 'IN', 'MD') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('D', 'M') and cd_education_status IN ('4 yr Degree', 'Advanced Degree') and cd_gender = 'F' and c_birth_month = 2 and c_birth_year BETWEEN 1966 AND 1972 order by c_customer_id limit 100 ;"
392,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = '2 yr Degree' and d_year = 2002 and s_state = 'TX' and i_category = 'Children' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
393,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 40 and 59 and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 196 and 210 and s2.ss_list_price between 196 and 210  ;"
394,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
395,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2002 and i_manager_id BETWEEN 11 and 30 AND i_category IN ('Children', 'Electronics', 'Jewelry') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and ss_wholesale_cost BETWEEN 61 AND 71  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2002 and d_moy = 8 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 61 AND 71 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2002 and d_moy = 8 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 61 AND 71) tmp2 limit 100 ;"
396,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2000 and d_moy = 7 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'TX' and c_birth_month = 2 and ss_wholesale_cost BETWEEN 56 AND 76  ;"
397,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Jamestown' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 50507 and ib_upper_bound <= 50507 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
398,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 136 and 165 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AL', 'IL', 'KS', 'MO')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (7, 64) and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
399,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'MO', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'MT', 'NM') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('KY', 'NY', 'OH') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
400,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = 'Advanced Degree' and c_current_addr_sk = ca_address_sk and d_year = 1999 and c_birth_month = 6 and ca_state in ('KY', 'MO', 'OH') and cs_wholesale_cost BETWEEN 33 AND 38 AND i_category = 'Music' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
401,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2000 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Books', 'Electronics', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2000 and ss_wholesale_cost BETWEEN 28 AND 38  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1974 AND 1980 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2000 and d_moy = 3 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 28 AND 38 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2000 and d_moy = 3 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 28 AND 38) tmp2 limit 100 ;"
402,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 53 and 62 and wr_return_amt / wr_return_quantity between 242 and 271 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('GA', 'MO', 'SC', 'VA')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (2, 70) and c_birth_year BETWEEN 1972 AND 1978 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
403,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-02-10','1999-05-13','1999-07-17','1999-11-07'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Men') and i_manager_id BETWEEN 89 and 98 and sr_return_amt / sr_return_quantity between 21 and 50 and sr_reason_sk in (6, 55, 56, 65, 66) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-02-10','1999-05-13','1999-07-17','1999-11-07'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Men') and i_manager_id BETWEEN 89 and 98 and cr_return_amount / cr_return_quantity between 21 and 50 and cr_reason_sk in (6, 55, 56, 65, 66) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-02-10','1999-05-13','1999-07-17','1999-11-07'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Men') and i_manager_id BETWEEN 89 and 98 and wr_return_amt / wr_return_quantity between 21 and 50 and wr_reason_sk in (6, 55, 56, 65, 66) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
404,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 51 and 60 and wr_return_amt / wr_return_quantity between 241 and 270 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CT', 'IA', 'MD', 'NC')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (32, 48) and c_birth_year BETWEEN 1980 AND 1986 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
405,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1176 and 1176+11 and ss_list_price between 23 and 52 and c_birth_year BETWEEN 1927 AND 1933 and ss_wholesale_cost BETWEEN 66 AND 76 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1176 and 1176+11 and cs_list_price between 23 and 52 and c_birth_year BETWEEN 1927 AND 1933 and cs_wholesale_cost BETWEEN 66 AND 76 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1176 and 1176+11 and ws_list_price between 23 and 52 and c_birth_year BETWEEN 1927 AND 1933 and ws_wholesale_cost BETWEEN 66 AND 76 ) ) cool_cust  ;"
406,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Home' and d_year=2002 and d_moy = 11 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'FL' and c_birth_month = 2 and ss_wholesale_cost BETWEEN 76 AND 96 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
407,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'MI', 'NE') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('NE', 'OH', 'VA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'IN', 'WV') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
408,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'W' and cd_education_status = 'Primary' and s1.ss_list_price between 203 and 217 and s2.ss_list_price between 203 and 217 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
409,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 134 and 193 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 51 AND 54 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AR', 'NE', 'VA') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('U', 'S') and cd_education_status IN ('Primary', 'College') and cd_gender = 'M' and c_birth_month = 12 and c_birth_year BETWEEN 1962 AND 1968 order by c_customer_id limit 100 ;"
410,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1213 and 1213+11 and ss_list_price between 98 and 127 and c_birth_year BETWEEN 1928 AND 1934 and ss_wholesale_cost BETWEEN 0 AND 10 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1213 and 1213+11 and cs_list_price between 98 and 127 and c_birth_year BETWEEN 1928 AND 1934 and cs_wholesale_cost BETWEEN 0 AND 10 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1213 and 1213+11 and ws_list_price between 98 and 127 and c_birth_year BETWEEN 1928 AND 1934 and ws_wholesale_cost BETWEEN 0 AND 10 ) ) cool_cust  ;"
411,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Shoes' and d_year=1998 and d_moy = 2 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'CT' and c_birth_month = 5 and ss_wholesale_cost BETWEEN 55 AND 75 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
412,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Music') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 67 and 81 and s2.ss_list_price between 67 and 81  ;"
413,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-01-06')) and ss_sold_date_sk = d_date_sk and ss_list_price between 201 and 230 and i_manager_id BETWEEN 26 and 55 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1967 AND 1973 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-01-06')) and cs_sold_date_sk = d_date_sk and cs_list_price between 201 and 230 and i_manager_id BETWEEN 26 and 55 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1967 AND 1973 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-01-06')) and ws_sold_date_sk = d_date_sk and ws_list_price between 201 and 230 and i_manager_id BETWEEN 26 and 55 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1967 AND 1973 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
414,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MA', 'NC', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IN', 'MT', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AL', 'NY', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
415,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1196 and 1196+11 and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1196 and 1196+11 and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 79 and 83  and s_state in ('FL','NC','OH') order by s_store_name, i_item_desc limit 100 ;"
416,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('FL', 'NE', 'OR') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('OK', 'TX', 'VA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'NC', 'WY') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
417,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Children', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 16 and 25 and ss_wholesale_cost BETWEEN 48 AND 68 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Children', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 16 and 25 and cs_wholesale_cost BETWEEN 48 AND 68 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 48 AND 68 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 16 and 25 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 48 AND 68  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 48 AND 68  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 48 AND 68 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 2) and i_category IN ('Children', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 16 and 25 and ss_wholesale_cost BETWEEN 48 AND 68 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 2) and i_category IN ('Children', 'Jewelry', 'Shoes') and ss_wholesale_cost BETWEEN 48 AND 68 and i_manager_id BETWEEN 16 and 25 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
418,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 10 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
419,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('puff', 'salmon') and i_manager_id BETWEEN 81 and 100 and ss_list_price between 126 and 140 and ca_state in ('AK','NV') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('puff', 'salmon') and i_manager_id BETWEEN 81 and 100 and ws_list_price between 126 and 140 and ca_state in ('AK','NV') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2001 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2001 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2001 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2001 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2001 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2001 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;"
420,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Shoes' and d_year=1998 and d_moy = 1 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'IA' and c_birth_month = 6 and ss_wholesale_cost BETWEEN 56 AND 76  ;"
421,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Lakeview' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 6 * 10000 and ib_upper_bound <= 6 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
422,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1190 and 1190 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 210 and 239 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5  ;"
423,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 60 and 69 and ss_wholesale_cost BETWEEN 19 AND 39 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 60 and 69 and cs_wholesale_cost BETWEEN 19 AND 39 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 19 AND 39 and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 60 and 69 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and ss_wholesale_cost BETWEEN 19 AND 39  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and cs_wholesale_cost BETWEEN 19 AND 39  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 19 AND 39 and d_year between 1999 and 1999 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999 + 1   and d_moy = 12   and d_dom = 17) and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 60 and 69 and ss_wholesale_cost BETWEEN 19 AND 39 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999   and d_moy = 12   and d_dom = 17) and i_category IN ('Books', 'Children', 'Jewelry') and ss_wholesale_cost BETWEEN 19 AND 39 and i_manager_id BETWEEN 60 and 69 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
424,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188+11 and ss_list_price between 216 and 245 and c_birth_year BETWEEN 1958 AND 1964 and ss_wholesale_cost BETWEEN 31 AND 41 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188+11 and cs_list_price between 216 and 245 and c_birth_year BETWEEN 1958 AND 1964 and cs_wholesale_cost BETWEEN 31 AND 41 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188+11 and ws_list_price between 216 and 245 and c_birth_year BETWEEN 1958 AND 1964 and ws_wholesale_cost BETWEEN 31 AND 41 ) ) cool_cust  ;"
425,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
426,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 2001  ;"
427,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-03-23')) and ss_sold_date_sk = d_date_sk and ss_list_price between 14 and 43 and i_manager_id BETWEEN 4 and 33 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1980 AND 1986 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-03-23')) and cs_sold_date_sk = d_date_sk and cs_list_price between 14 and 43 and i_manager_id BETWEEN 4 and 33 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1980 AND 1986 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-03-23')) and ws_sold_date_sk = d_date_sk and ws_list_price between 14 and 43 and i_manager_id BETWEEN 4 and 33 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1980 AND 1986 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
428,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'TN', 'WA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MD', 'TN', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'NH', 'TX') and ss_net_profit between 50 and 250 ))  ;"
429,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 7 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -6  ;"
430,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Home') and item2.i_manager_id between 47 and 66 and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 97 and 111 and s2.ss_list_price between 97 and 111 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
431,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NE', 'TX', 'VA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'MS', 'WV') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CA', 'KS', 'TX') and ss_net_profit between 50 and 250 ))  ;"
432,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Secondary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'MS', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'NJ', 'NY') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'MO', 'TX') and ss_net_profit between 50 and 250 ))  ;"
433,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 195 and 254 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 4 AND 7 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('IL', 'MN', 'TN') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'S') and cd_education_status IN ('Unknown', 'Unknown') and cd_gender = 'F' and c_birth_month = 4 and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id limit 100 ;"
434,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = 'Advanced Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2002 and  c_birth_month = 7 and  ca_state in ('IL', 'VA', 'WV')  and cs_wholesale_cost BETWEEN 35 AND 40  AND i_category = 'Books'  ;"
435,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '2 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 1999 and  c_birth_month = 6 and  ca_state in ('AL', 'ID', 'IL')  and cs_wholesale_cost BETWEEN 12 AND 17  AND i_category = 'Home'  ;"
436,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Children' and i_class = 'infants' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 1 and d_year = 2000 and wholesale_cost BETWEEN 37 AND 67 and c_birth_year BETWEEN 1954 AND 1967 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 37 AND 67  and s_state in ('AR','CA','GA'   ,'MN','MO','NE'   ,'SC','TX','VA'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 1)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 1) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
437,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IN', 'SC', 'WI') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('CA', 'MN', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'MO', 'VA') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
438,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Jewelry') and item2.i_manager_id between 55 and 74 and cd_marital_status = 'U' and cd_education_status = 'Secondary' and s1.ss_list_price between 251 and 265 and s2.ss_list_price between 251 and 265  ;"
439,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1217 and 1217+11 and ss_list_price between 27 and 56 and c_birth_year BETWEEN 1985 AND 1991 and ss_wholesale_cost BETWEEN 40 AND 50 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1217 and 1217+11 and cs_list_price between 27 and 56 and c_birth_year BETWEEN 1985 AND 1991 and cs_wholesale_cost BETWEEN 40 AND 50 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1217 and 1217+11 and ws_list_price between 27 and 56 and c_birth_year BETWEEN 1985 AND 1991 and ws_wholesale_cost BETWEEN 40 AND 50 ) ) cool_cust  ;"
440,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REVERSED_TEXTGE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 and sr_return_amt / sr_return_quantity between 149 and 208 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 51 AND 54 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('GA', 'IL', 'KY') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('D', 'M') and cd_education_status IN ('Secondary', '4 yr Degree') and cd_gender = 'F' and c_birth_month = 1 and c_birth_year BETWEEN 1938 AND 1944 order by c_customer_id limit 100 ;"
441,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'MI', 'VA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'IL', 'KS') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IA', 'MD', 'OR') and ss_net_profit between 50 and 250 ))  ;"
442,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1192 and 1192 + 11 and c_birth_month in (9, 10, 11, 12) and ss_list_price between 204 and 263 and ss_wholesale_cost BETWEEN 1 AND 21 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1192 and 1192 + 11 and c_birth_month in (9, 10, 11, 12) and cs_list_price between 204 and 263 and cs_wholesale_cost BETWEEN 1 AND 21 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1192 and 1192 + 11 and c_birth_month in (9, 10, 11, 12) and ws_list_price between 204 and 263 and ws_wholesale_cost BETWEEN 1 AND 21 ) hot_cust limit 100 ;"
443,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1215 and 1215+11 and ss_list_price between 21 and 50 and c_birth_year BETWEEN 1973 AND 1979 and ss_wholesale_cost BETWEEN 57 AND 67 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1215 and 1215+11 and cs_list_price between 21 and 50 and c_birth_year BETWEEN 1973 AND 1979 and cs_wholesale_cost BETWEEN 57 AND 67 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1215 and 1215+11 and ws_list_price between 21 and 50 and c_birth_year BETWEEN 1973 AND 1979 and ws_wholesale_cost BETWEEN 57 AND 67 ) ) cool_cust  ;"
444,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 70 AND 90 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 24 and 24 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'N' and ad2.ca_state in ('KS','MI','NE') and ss_wholesale_cost BETWEEN 70 AND 90 and cd1.cd_marital_status in ('M', 'S', 'S') and cd1.cd_education_status in ('2 yr Degree', '2 yr Degree', 'Unknown') and cd2.cd_marital_status in ('M', 'S', 'S') and cd2.cd_education_status in ('2 yr Degree', '2 yr Degree', 'Unknown') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2000 and cs2.syear = 2000 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
445,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1204 and 1204 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 124 and 153 and sm_type = 'REGULAR' and cc_class = 'large' and w_gmt_offset = -5  ;"
446,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 2001  ;"
447,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -6  ;"
448,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 4 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
449,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 35 and 54 AND i_category IN ('Children', 'Sports', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 38 AND 48  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1959 AND 1965 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1999 and d_moy = 4 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 38 AND 48 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1999 and d_moy = 4 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 38 AND 48) tmp2 limit 100 ;"
450,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Secondary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MT', 'SD', 'TN') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'TN', 'WA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'KS', 'WA') and ss_net_profit between 50 and 250 ))  ;"
451,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=2000 and d_moy = 2 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'FL' and c_birth_month = 2 and ss_wholesale_cost BETWEEN 9 AND 29  ;"
452,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'S' and  cd_education_status = 'Unknown' and  d_year = 2001 and  s_state = 'MN' and i_category = 'Shoes'  ;"
453,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Books' and i_class = 'mystery' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 11 and d_year = 1999 and wholesale_cost BETWEEN 27 AND 57 and c_birth_year BETWEEN 1955 AND 1968 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 27 AND 57  and s_state in ('FL','GA','IL'   ,'IN','KS','MD'   ,'MT','NE','TX'   ,'VA')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1999 and d_moy = 11)   and (select distinct d_month_seq+3   from date_dim where d_year = 1999 and d_moy = 11) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
454,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'PA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
455,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Oak Ridge' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 2 * 10000 and ib_upper_bound <= 2 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
456,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'D' and  cd_education_status = '4 yr Degree' and  d_year = 1998 and  s_state = 'IN' and i_category = 'Books'  ;"
457,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2000-02-29','2000-06-22','2000-08-05','2000-10-28'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Music') and i_manager_id BETWEEN 28 and 37 and sr_return_amt / sr_return_quantity between 187 and 216 and sr_reason_sk in (4, 6, 37, 43, 61) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-02-29','2000-06-22','2000-08-05','2000-10-28'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Music') and i_manager_id BETWEEN 28 and 37 and cr_return_amount / cr_return_quantity between 187 and 216 and cr_reason_sk in (4, 6, 37, 43, 61) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-02-29','2000-06-22','2000-08-05','2000-10-28'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Music') and i_manager_id BETWEEN 28 and 37 and wr_return_amt / wr_return_quantity between 187 and 216 and wr_reason_sk in (4, 6, 37, 43, 61) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
458,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 13 AND 33 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 66 and 66 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('KY','ND','NM') and ss_wholesale_cost BETWEEN 13 AND 33 and cd1.cd_marital_status in ('M', 'M', 'W') and cd1.cd_education_status in ('Advanced Degree', 'Secondary', 'Secondary') and cd2.cd_marital_status in ('M', 'M', 'W') and cd2.cd_education_status in ('Advanced Degree', 'Secondary', 'Secondary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2000 and cs2.syear = 2000 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
459,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-05-24')) and ss_sold_date_sk = d_date_sk and ss_list_price between 85 and 114 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1954 AND 1960 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-05-24')) and cs_sold_date_sk = d_date_sk and cs_list_price between 85 and 114 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1954 AND 1960 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-05-24')) and ws_sold_date_sk = d_date_sk and ws_list_price between 85 and 114 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1954 AND 1960 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
460,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1179 and 1179+11 and ss_sales_price / ss_list_price BETWEEN 34 * 0.01 AND 44 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1179 and 1179+11 and ss_sales_price / ss_list_price BETWEEN 34 * 0.01 AND 44 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 46 and 50  and s_state in ('AR','OR','TX') order by s_store_name, i_item_desc limit 100 ;"
461,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('CA', 'NJ', 'NY') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('KY', 'NE', 'OH') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('MO', 'SC', 'TX') and ws_net_profit between 50 and 250 ) )  ;"
462,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 63 and 72 and wr_return_amt / wr_return_quantity between 157 and 186 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AZ', 'GA', 'MI', 'TN')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (10, 55) and c_birth_year BETWEEN 1940 AND 1946 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
463,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 16 and 25 and wr_return_amt / wr_return_quantity between 41 and 70 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CO', 'MI', 'MN', 'OK')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (29, 66) and c_birth_year BETWEEN 1969 AND 1975 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
464,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1187 and 1187+11 and ss_list_price between 271 and 300 and c_birth_year BETWEEN 1925 AND 1931 and ss_wholesale_cost BETWEEN 90 AND 100 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1187 and 1187+11 and cs_list_price between 271 and 300 and c_birth_year BETWEEN 1925 AND 1931 and cs_wholesale_cost BETWEEN 90 AND 100 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1187 and 1187+11 and ws_list_price between 271 and 300 and c_birth_year BETWEEN 1925 AND 1931 and ws_wholesale_cost BETWEEN 90 AND 100 ) ) cool_cust  ;"
465,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 2002  ;"
466,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 11 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
467,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'MS', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'GA', 'NY') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'IL', 'OH') and ss_net_profit between 50 and 250 ))  ;"
468,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_STORE_CREDIT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 and sr_return_amt / sr_return_quantity between 83 and 142 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 58 AND 61 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AR', 'GA', 'MO') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'D') and cd_education_status IN ('Secondary', 'Advanced Degree') and cd_gender = 'M' and c_birth_month = 9 and c_birth_year BETWEEN 1960 AND 1966 order by c_customer_id limit 100 ;"
469,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1998 and i_manager_id BETWEEN 14 and 33 AND i_category IN ('Jewelry', 'Sports', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1998 and ss_wholesale_cost BETWEEN 1 AND 11  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1980 AND 1986 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1998 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 1 AND 11 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1998 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 1 AND 11) tmp2 limit 100 ;"
470,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-05-14')) and ss_sold_date_sk = d_date_sk and ss_list_price between 108 and 137 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1984 AND 1990 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-05-14')) and cs_sold_date_sk = d_date_sk and cs_list_price between 108 and 137 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1984 AND 1990 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-05-14')) and ws_sold_date_sk = d_date_sk and ws_list_price between 108 and 137 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1984 AND 1990 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
471,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 180 and 239 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 66 AND 69 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('LA', 'MS', 'NE') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'W') and cd_education_status IN ('4 yr Degree', '4 yr Degree') and cd_gender = 'M' and c_birth_month = 8 and c_birth_year BETWEEN 1937 AND 1943 order by c_customer_id limit 100 ;"
472,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'M' and  cd_education_status = '4 yr Degree' and  d_year = 1998 and  s_state = 'AR' and i_category = 'Shoes'  ;"
473,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2000 and i_manager_id BETWEEN 73 and 92 AND i_category IN ('Children', 'Jewelry', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2000 and ss_wholesale_cost BETWEEN 49 AND 59  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1945 AND 1951 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2000 and d_moy = 8 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 49 AND 59 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2000 and d_moy = 8 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 49 AND 59) tmp2 limit 100 ;"
474,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 1 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
475,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1181 and 1181 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 155 and 184 and sm_type = 'OVERNIGHT' and cc_class = 'medium' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
476,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 80 AND 100 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 84 and 84 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'N' and ad2.ca_state in ('GA','SC','TX') and ss_wholesale_cost BETWEEN 80 AND 100 and cd1.cd_marital_status in ('U', 'U', 'W') and cd1.cd_education_status in ('Unknown', 'Secondary', 'Primary') and cd2.cd_marital_status in ('U', 'U', 'W') and cd2.cd_education_status in ('Unknown', 'Secondary', 'Primary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2000 and cs2.syear = 2000 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
477,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 80 * 0.01 AND 100 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1194 and 1194 + 11  and s_state in ('AK','CO','FL'   ,'GA','MT','NE','VA','WV')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1194+ 12 and 1194 + 23  and s_state in ('AK','CO','FL'   ,'GA','MT','NE','VA','WV')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
478,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2002-03-18','2002-06-19','2002-09-08','2002-10-11'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 14 and 23 and sr_return_amt / sr_return_quantity between 33 and 62 and sr_reason_sk in (17, 24, 47, 49, 66) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-03-18','2002-06-19','2002-09-08','2002-10-11'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 14 and 23 and cr_return_amount / cr_return_quantity between 33 and 62 and cr_reason_sk in (17, 24, 47, 49, 66) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-03-18','2002-06-19','2002-09-08','2002-10-11'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 14 and 23 and wr_return_amt / wr_return_quantity between 33 and 62 and wr_reason_sk in (17, 24, 47, 49, 66) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
479,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1197 and 1197 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 44 and 73 and sm_type = 'OVERNIGHT' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
480,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2001 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 46 and 55 and wr_return_amt / wr_return_quantity between 100 and 129 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AR', 'NC', 'NE', 'PA')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (13, 27) and c_birth_year BETWEEN 1951 AND 1957 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
481,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IA', 'NY', 'TN') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AK', 'AR', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'PA', 'VA') and ws_net_profit between 50 and 250 ) )  ;"
482,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-01-02')) and ss_sold_date_sk = d_date_sk and ss_list_price between 95 and 124 and i_manager_id BETWEEN 7 and 36 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1934 AND 1940 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-01-02')) and cs_sold_date_sk = d_date_sk and cs_list_price between 95 and 124 and i_manager_id BETWEEN 7 and 36 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1934 AND 1940 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-01-02')) and ws_sold_date_sk = d_date_sk and ws_list_price between 95 and 124 and i_manager_id BETWEEN 7 and 36 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1934 AND 1940 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
483,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1179 and 1179 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 221 and 250 and sm_type = 'TWO DAY' and cc_class = 'medium' and w_gmt_offset = -5  ;"
484,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189 + 11 and c_birth_month in (1, 6, 7, 10) and ss_list_price between 153 and 212 and ss_wholesale_cost BETWEEN 16 AND 36 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189 + 11 and c_birth_month in (1, 6, 7, 10) and cs_list_price between 153 and 212 and cs_wholesale_cost BETWEEN 16 AND 36 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189 + 11 and c_birth_month in (1, 6, 7, 10) and ws_list_price between 153 and 212 and ws_wholesale_cost BETWEEN 16 AND 36 ) hot_cust limit 100 ;"
485,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2001 and i_manager_id BETWEEN 1 and 20 AND i_category IN ('Children', 'Home', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and ss_wholesale_cost BETWEEN 74 AND 84  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1943 AND 1949 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2001 and d_moy = 6 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 74 AND 84 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2001 and d_moy = 6 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 74 AND 84) tmp2 limit 100 ;"
486,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 78 and 97 and cd_marital_status = 'M' and cd_education_status = 'Unknown' and s1.ss_list_price between 205 and 219 and s2.ss_list_price between 205 and 219 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
487,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Farmington' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 2 * 10000 and ib_upper_bound <= 2 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
488,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1200 and 1200 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 106 and 135 and sm_type = 'EXPRESS' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
489,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 19 and 38 and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 111 and 125 and s2.ss_list_price between 111 and 125  ;"
490,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2002 and d_moy = 3 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'AL' and c_birth_month = 6 and ss_wholesale_cost BETWEEN 42 AND 62 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
491,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1191 and 1191 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 271 and 300 and sm_type = 'OVERNIGHT' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
492,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('FL', 'PA', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AL', 'VA', 'WY') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'HI', 'ID') and ws_net_profit between 50 and 250 ) )  ;"
493,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and d_year = 2001 and s_state = 'MT' and i_category = 'Jewelry' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
494,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189+11 and ss_list_price between 271 and 300 and c_birth_year BETWEEN 1963 AND 1969 and ss_wholesale_cost BETWEEN 90 AND 100 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189+11 and cs_list_price between 271 and 300 and c_birth_year BETWEEN 1963 AND 1969 and cs_wholesale_cost BETWEEN 90 AND 100 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189+11 and ws_list_price between 271 and 300 and c_birth_year BETWEEN 1963 AND 1969 and ws_wholesale_cost BETWEEN 90 AND 100 ) ) cool_cust  ;"
495,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2000 and d_moy = 3 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MD' and c_birth_month = 11 and ss_wholesale_cost BETWEEN 54 AND 74 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
496,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1198 and 1198 + 11 and c_birth_month in (4, 5, 7, 9) and ss_list_price between 29 and 88 and ss_wholesale_cost BETWEEN 3 AND 23 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1198 and 1198 + 11 and c_birth_month in (4, 5, 7, 9) and cs_list_price between 29 and 88 and cs_wholesale_cost BETWEEN 3 AND 23 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1198 and 1198 + 11 and c_birth_month in (4, 5, 7, 9) and ws_list_price between 29 and 88 and ws_wholesale_cost BETWEEN 3 AND 23 ) hot_cust limit 100 ;"
497,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Sports' and i_class = 'football' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 7 and d_year = 2002 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1928 AND 1941 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('IL','KY','MI'   ,'MO','ND','SD'   ,'TX','UT','VA'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2002 and d_moy = 7)   and (select distinct d_month_seq+3   from date_dim where d_year = 2002 and d_moy = 7) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
498,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MO', 'TX', 'VA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('WA', 'WV', 'WY') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'MN', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
499,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-04-07')) and ss_sold_date_sk = d_date_sk and ss_list_price between 159 and 188 and i_manager_id BETWEEN 38 and 67 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1929 AND 1935 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-04-07')) and cs_sold_date_sk = d_date_sk and cs_list_price between 159 and 188 and i_manager_id BETWEEN 38 and 67 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1929 AND 1935 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-04-07')) and ws_sold_date_sk = d_date_sk and ws_list_price between 159 and 188 and i_manager_id BETWEEN 38 and 67 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1929 AND 1935 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
500,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1184 and 1184 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 36 and 65 and sm_type = 'LIBRARY' and cc_class = 'small' and w_gmt_offset = -5  ;"
501,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1184 and 1184 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 36 and 65 and sm_type = 'LIBRARY' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
502,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1198 and 1198+11 and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1198 and 1198+11 and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 67 and 71  and s_state in ('MD','NC','WI') order by s_store_name, i_item_desc limit 100 ;"
503,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 14 and 23 and wr_return_amt / wr_return_quantity between 91 and 120 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('MO', 'OK', 'PA', 'WV')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (5, 55) and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
504,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'M' and cd_education_status = 'Primary' and d_year = 1998 and s_state = 'CA' and i_category = 'Children' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
505,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Unknown' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 7 and  ca_state in ('GA', 'KS', 'MI')  and cs_wholesale_cost BETWEEN 1 AND 6  AND i_category = 'Music'  ;"
506,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2001 and  c_birth_month = 9 and  ca_state in ('IN', 'SD', 'TX')  and cs_wholesale_cost BETWEEN 65 AND 70  AND i_category = 'Children'  ;"
507,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1203 and 1203+11 and ss_sales_price / ss_list_price BETWEEN 35 * 0.01 AND 45 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1203 and 1203+11 and ss_sales_price / ss_list_price BETWEEN 35 * 0.01 AND 45 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 46 and 50  and s_state in ('GA','IL','TX') order by s_store_name, i_item_desc limit 100 ;"
508,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'WA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
509,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Lakeside' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 16512 and ib_upper_bound <= 16512 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
510,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'W' and cd_education_status = 'Primary' and s1.ss_list_price between 203 and 217 and s2.ss_list_price between 203 and 217  ;"
511,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -7  ;"
512,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 6 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
513,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'College' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KY', 'MN', 'VT') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('SC', 'VA', 'WA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'MO', 'MT') and ws_net_profit between 50 and 250 ) )  ;"
514,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('FL', 'NV', 'SD') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('KS', 'OK', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'LA', 'NC') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
515,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'VA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
516,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Springfield' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 28518 and ib_upper_bound <= 28518 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
517,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = '4 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 6 and ca_state in ('KS', 'MO', 'NM') and cs_wholesale_cost BETWEEN 16 AND 21 AND i_category = 'Jewelry' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
518,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Men', 'Women') and item2.i_manager_id between 52 and 71 and cd_marital_status = 'U' and cd_education_status = 'Primary' and s1.ss_list_price between 73 and 87 and s2.ss_list_price between 73 and 87  ;"
519,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,avg(ss_net_profit) as store_sales_profit ,avg(sr_net_loss) as store_returns_loss ,avg(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
520,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 62 AND 82 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 0 and 0 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('TN','VA','WY') and ss_wholesale_cost BETWEEN 62 AND 82 and cd1.cd_marital_status in ('M', 'U', 'M') and cd1.cd_education_status in ('Primary', 'Primary', 'Secondary') and cd2.cd_marital_status in ('M', 'U', 'M') and cd2.cd_education_status in ('Primary', 'Primary', 'Secondary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
521,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = 'Unknown' and  c_current_addr_sk = ca_address_sk and  d_year = 1999 and  c_birth_month = 6 and  ca_state in ('IA', 'MN', 'TX')  and cs_wholesale_cost BETWEEN 56 AND 61  AND i_category = 'Electronics'  ;"
522,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Greenville' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 57263 and ib_upper_bound <= 57263 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
523,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MI', 'PA', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IL', 'NE', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('HI', 'OH', 'UT') and ws_net_profit between 50 and 250 ) )  ;"
524,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and d_year = 2000 and s_state = 'GA' and i_category = 'Home' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
525,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AL', 'AZ', 'VA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AK', 'AR', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'KS', 'MN') and ws_net_profit between 50 and 250 ) )  ;"
526,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 62 AND 82 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 18 and 18 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('LA','MI','MO') and ss_wholesale_cost BETWEEN 62 AND 82 and cd1.cd_marital_status in ('M', 'S', 'S') and cd1.cd_education_status in ('4 yr Degree', '4 yr Degree', '2 yr Degree') and cd2.cd_marital_status in ('M', 'S', 'S') and cd2.cd_education_status in ('4 yr Degree', '4 yr Degree', '2 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
527,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,stddev_samp(ss_net_profit) as store_sales_profit ,stddev_samp(sr_net_loss) as store_returns_loss ,stddev_samp(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 1998 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
528,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
529,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -7  ;"
530,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2001 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 67 and 76 and wr_return_amt / wr_return_quantity between 271 and 300 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('NY', 'OK', 'TN', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (6, 39) and c_birth_year BETWEEN 1938 AND 1944 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
531,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_STORE_CREDIT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 132 and 191 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 28 AND 31 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('GA', 'MA', 'WY') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('U', 'W') and cd_education_status IN ('Secondary', 'Secondary') and cd_gender = 'M' and c_birth_month = 4 and c_birth_year BETWEEN 1953 AND 1959 order by c_customer_id limit 100 ;"
532,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('orchid', 'pale') and i_manager_id BETWEEN 49 and 68 and ss_list_price between 210 and 224 and ca_state in ('AR','IL') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('orchid', 'pale') and i_manager_id BETWEEN 49 and 68 and ws_list_price between 210 and 224 and ca_state in ('AR','IL') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q2_q3_increase ;"
533,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = '2 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2002 and c_birth_month = 6 and ca_state in ('KS', 'MO', 'MS') and cs_wholesale_cost BETWEEN 56 AND 61 AND i_category = 'Women' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
534,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 217 and 246 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CA', 'CO', 'FL', 'NY')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (46, 69) and c_birth_year BETWEEN 1943 AND 1949 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
535,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and d_year = 2002 and s_state = 'VA' and i_category = 'Books' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
536,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1209 and 1209 + 11 and c_birth_month in (1, 4, 11, 12) and ss_list_price between 114 and 173 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1209 and 1209 + 11 and c_birth_month in (1, 4, 11, 12) and cs_list_price between 114 and 173 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1209 and 1209 + 11 and c_birth_month in (1, 4, 11, 12) and ws_list_price between 114 and 173 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
537,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=1999 and d_moy = 4 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'SC' and c_birth_month = 11 and ss_wholesale_cost BETWEEN 47 AND 67  ;"
538,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Advanced Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2002 and  c_birth_month = 5 and  ca_state in ('NJ', 'TN', 'WY')  and cs_wholesale_cost BETWEEN 10 AND 15  AND i_category = 'Men'  ;"
539,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Sports' and d_year=2002 and d_moy = 10 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'TN' and c_birth_month = 9 and ss_wholesale_cost BETWEEN 72 AND 92  ;"
540,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 220 and 279 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 40 AND 43 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('GA', 'ID', 'VA') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'U') and cd_education_status IN ('Primary', 'College') and cd_gender = 'M' and c_birth_month = 5 and c_birth_year BETWEEN 1950 AND 1956 order by c_customer_id limit 100 ;"
541,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 31 and 40 and wr_return_amt / wr_return_quantity between 156 and 185 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CO', 'IA', 'LA', 'OK')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (34, 35) and c_birth_year BETWEEN 1962 AND 1968 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
542,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 46 and 65 and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 256 and 270 and s2.ss_list_price between 256 and 270 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
543,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('GA', 'LA', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'TX', 'WI') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AK', 'NC', 'NE') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
544,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1182 and 1182 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 191 and 220 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
545,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Walnut Grove' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 46206 and ib_upper_bound <= 46206 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
546,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 235 and 294 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 68 AND 71 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AR', 'KY', 'SD') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'W') and cd_education_status IN ('2 yr Degree', '4 yr Degree') and cd_gender = 'M' and c_birth_month = 10 and c_birth_year BETWEEN 1938 AND 1944 order by c_customer_id limit 100 ;"
547,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'College' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Primary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'MS', 'ND') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'OR', 'TX') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'MN', 'TX') and ss_net_profit between 50 and 250 ))  ;"
548,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1207 and 1207+11 and ss_list_price between 194 and 223 and c_birth_year BETWEEN 1935 AND 1941 and ss_wholesale_cost BETWEEN 88 AND 98 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1207 and 1207+11 and cs_list_price between 194 and 223 and c_birth_year BETWEEN 1935 AND 1941 and cs_wholesale_cost BETWEEN 88 AND 98 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1207 and 1207+11 and ws_list_price between 194 and 223 and c_birth_year BETWEEN 1935 AND 1941 and ws_wholesale_cost BETWEEN 88 AND 98 ) ) cool_cust  ;"
549,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Jewelry') and item2.i_manager_id between 55 and 74 and cd_marital_status = 'U' and cd_education_status = 'Secondary' and s1.ss_list_price between 251 and 265 and s2.ss_list_price between 251 and 265 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
550,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1998-02-02','1998-06-17','1998-09-21','1998-11-11'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Sports') and i_manager_id BETWEEN 17 and 26 and sr_return_amt / sr_return_quantity between 7 and 36 and sr_reason_sk in (17, 26, 50, 53, 56) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-02-02','1998-06-17','1998-09-21','1998-11-11'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Sports') and i_manager_id BETWEEN 17 and 26 and cr_return_amount / cr_return_quantity between 7 and 36 and cr_reason_sk in (17, 26, 50, 53, 56) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-02-02','1998-06-17','1998-09-21','1998-11-11'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Sports') and i_manager_id BETWEEN 17 and 26 and wr_return_amt / wr_return_quantity between 7 and 36 and wr_reason_sk in (17, 26, 50, 53, 56) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
551,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
552,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MS', 'SD', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AK', 'IN', 'NV') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('KY', 'NY', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
553,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 72 * 0.01 AND 92 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1191 and 1191 + 11  and s_state in ('AK','CO','GA'   ,'NC','NE','NM','OR','TX')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1191+ 12 and 1191 + 23  and s_state in ('AK','CO','GA'   ,'NC','NE','NM','OR','TX')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
554,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Oakwood' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 1 * 10000 and ib_upper_bound <= 1 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
555,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 2002  ;"
556,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 7 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -6  ;"
557,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'MI', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('OH', 'PA', 'SD') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'KY', 'WI') and ss_net_profit between 50 and 250 ))  ;"
558,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1208 and 1208+11 and ss_sales_price / ss_list_price BETWEEN 85 * 0.01 AND 95 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1208 and 1208+11 and ss_sales_price / ss_list_price BETWEEN 85 * 0.01 AND 95 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 53 and 57  and s_state in ('IA','TN','WI') order by s_store_name, i_item_desc limit 100 ;"
559,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Children' and i_class = 'newborn' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 8 and d_year = 2001 and wholesale_cost BETWEEN 20 AND 50 and c_birth_year BETWEEN 1938 AND 1951 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 20 AND 50  and s_state in ('GA','IL','KY'   ,'LA','ME','OH'   ,'TN','TX','VA'   ,'WY')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 8)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 8) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
560,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-01-03','2001-05-12','2001-07-05','2001-11-05'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Women') and i_manager_id BETWEEN 39 and 48 and sr_return_amt / sr_return_quantity between 190 and 219 and sr_reason_sk in (3, 31, 40, 60, 73) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-01-03','2001-05-12','2001-07-05','2001-11-05'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Women') and i_manager_id BETWEEN 39 and 48 and cr_return_amount / cr_return_quantity between 190 and 219 and cr_reason_sk in (3, 31, 40, 60, 73) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-01-03','2001-05-12','2001-07-05','2001-11-05'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Women') and i_manager_id BETWEEN 39 and 48 and wr_return_amt / wr_return_quantity between 190 and 219 and wr_reason_sk in (3, 31, 40, 60, 73) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
561,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 41 * 0.01 AND 61 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1209 and 1209 + 11  and s_state in ('KY','MD','NC'   ,'ND','NM','PA','SD','TN')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1209+ 12 and 1209 + 23  and s_state in ('KY','MD','NC'   ,'ND','NM','PA','SD','TN')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
562,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1223 and 1223+11 and ss_sales_price / ss_list_price BETWEEN 68 * 0.01 AND 78 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1223 and 1223+11 and ss_sales_price / ss_list_price BETWEEN 68 * 0.01 AND 78 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 95 and 99  and s_state in ('MO','OH','SD') order by s_store_name, i_item_desc limit 100 ;"
563,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 9 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -6  ;"
564,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Glendale' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 47622 and ib_upper_bound <= 47622 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
565,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=1998 and d_moy = 3 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'NV' and c_birth_month = 1 and ss_wholesale_cost BETWEEN 8 AND 28  ;"
566,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and d_year = 2000 and s_state = 'WV' and i_category = 'Sports' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
567,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('IN','TN','WV') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'W', 'S') and cd_education_status in ('2 yr Degree', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 and 8+2  and ss_list_price between 109 and 198 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 and 8+2  and ws_list_price between 109 and 198  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 and 8+2  and cs_list_price between 109 and 198)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
568,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221 + 11 and c_birth_month in (5, 8, 10, 12) and ss_list_price between 241 and 300 and ss_wholesale_cost BETWEEN 15 AND 35 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221 + 11 and c_birth_month in (5, 8, 10, 12) and cs_list_price between 241 and 300 and cs_wholesale_cost BETWEEN 15 AND 35 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221 + 11 and c_birth_month in (5, 8, 10, 12) and ws_list_price between 241 and 300 and ws_wholesale_cost BETWEEN 15 AND 35 ) hot_cust limit 100 ;"
569,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1194 and 1194 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 228 and 257 and sm_type = 'EXPRESS' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
570,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 4 * 0.01 AND 24 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1206 and 1206 + 11  and s_state in ('AZ','KS','MI'   ,'MO','MS','NC','RI','VT')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1206+ 12 and 1206 + 23  and s_state in ('AZ','KS','MI'   ,'MO','MS','NC','RI','VT')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
571,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 7 AND 27 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 76 and 76 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('AR','IN','TN') and ss_wholesale_cost BETWEEN 7 AND 27 and cd1.cd_marital_status in ('S', 'W', 'W') and cd1.cd_education_status in ('2 yr Degree', '2 yr Degree', 'Secondary') and cd2.cd_marital_status in ('S', 'W', 'W') and cd2.cd_education_status in ('2 yr Degree', '2 yr Degree', 'Secondary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
572,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'M' and cd_education_status = 'Secondary' and d_year = 1998 and s_state = 'AR' and i_category = 'Women' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
573,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1199 and 1199 + 11 and c_birth_month in (1, 8, 9, 12) and ss_list_price between 88 and 147 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1199 and 1199 + 11 and c_birth_month in (1, 8, 9, 12) and cs_list_price between 88 and 147 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1199 and 1199 + 11 and c_birth_month in (1, 8, 9, 12) and ws_list_price between 88 and 147 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
574,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Maple Grove' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 19177 and ib_upper_bound <= 19177 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
575,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 57 * 0.01 AND 77 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1198 and 1198 + 11  and s_state in ('AL','AR','GA'   ,'IA','MN','NC','TX','WV')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1198+ 12 and 1198 + 23  and s_state in ('AL','AR','GA'   ,'IA','MN','NC','TX','WV')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
576,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 63 AND 83 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 44 and 44 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('AL','MO','NE') and ss_wholesale_cost BETWEEN 63 AND 83 and cd1.cd_marital_status in ('W', 'W', 'W') and cd1.cd_education_status in ('Secondary', 'Secondary', '2 yr Degree') and cd2.cd_marital_status in ('W', 'W', 'W') and cd2.cd_education_status in ('Secondary', 'Secondary', '2 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1999 and cs2.syear = 1999 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
577,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1189 and 1189 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 19 and 48 and sm_type = 'OVERNIGHT' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
578,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Oakdale' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 43147 and ib_upper_bound <= 43147 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
579,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'ND', 'OK') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'LA', 'NC') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'ME', 'MI') and ws_net_profit between 50 and 250 ) )  ;"
580,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 80 AND 100 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 23 and 23 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('AL','IN','WV') and ss_wholesale_cost BETWEEN 80 AND 100 and cd1.cd_marital_status in ('M', 'M', 'W') and cd1.cd_education_status in ('4 yr Degree', '4 yr Degree', '2 yr Degree') and cd2.cd_marital_status in ('M', 'M', 'W') and cd2.cd_education_status in ('4 yr Degree', '4 yr Degree', '2 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
581,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 19 and 28 and wr_return_amt / wr_return_quantity between 17 and 46 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('KY', 'ME', 'ND', 'NY')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (21, 48) and c_birth_year BETWEEN 1956 AND 1962 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
582,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-01-18','1999-04-04','1999-09-15','1999-10-06'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Music') and i_manager_id BETWEEN 91 and 100 and sr_return_amt / sr_return_quantity between 98 and 127 and sr_reason_sk in (43, 57, 62, 68, 74) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-01-18','1999-04-04','1999-09-15','1999-10-06'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Music') and i_manager_id BETWEEN 91 and 100 and cr_return_amount / cr_return_quantity between 98 and 127 and cr_reason_sk in (43, 57, 62, 68, 74) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-01-18','1999-04-04','1999-09-15','1999-10-06'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Music') and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 98 and 127 and wr_reason_sk in (43, 57, 62, 68, 74) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
583,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Secondary' and  c_current_addr_sk = ca_address_sk and  d_year = 1998 and  c_birth_month = 1 and  ca_state in ('LA', 'MA', 'MN')  and cs_wholesale_cost BETWEEN 48 AND 53  AND i_category = 'Jewelry'  ;"
584,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2000 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Books', 'Children', 'Sports') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2000 and ss_wholesale_cost BETWEEN 39 AND 49  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1970 AND 1976 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2000 and d_moy = 2 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 39 AND 49 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2000 and d_moy = 2 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 39 AND 49) tmp2 limit 100 ;"
585,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Secondary' and  c_current_addr_sk = ca_address_sk and  d_year = 1999 and  c_birth_month = 11 and  ca_state in ('GA', 'NC', 'OH')  and cs_wholesale_cost BETWEEN 95 AND 100  AND i_category = 'Children'  ;"
586,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'College' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NJ', 'TN', 'WY') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MS', 'NM', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'IL', 'PA') and ss_net_profit between 50 and 250 ))  ;"
587,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 3 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 3 and 3 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 3 and 3 + 2 and d3.d_year  = 1999  ;"
588,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -7  ;"
589,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'W' and  cd_education_status = 'Unknown' and  d_year = 2002 and  s_state = 'MO' and i_category = 'Women'  ;"
590,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 36 * 0.01 AND 56 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1188 and 1188 + 11  and s_state in ('FL','GA','IL'   ,'MO','MS','NY','OH','TX')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1188+ 12 and 1188 + 23  and s_state in ('FL','GA','IL'   ,'MO','MS','NY','OH','TX')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
591,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Electronics', 'Music', 'Shoes') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 87 AND 97  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1999 and d_moy = 3 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 87 AND 97 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1999 and d_moy = 3 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 87 AND 97) tmp2 limit 100 ;"
592,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Shoes') and item2.i_manager_id between 48 and 67 and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 80 and 94 and s2.ss_list_price between 80 and 94  ;"
593,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1181 and 1181+11 and ss_list_price between 156 and 185 and c_birth_year BETWEEN 1968 AND 1974 and ss_wholesale_cost BETWEEN 87 AND 97 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1181 and 1181+11 and cs_list_price between 156 and 185 and c_birth_year BETWEEN 1968 AND 1974 and cs_wholesale_cost BETWEEN 87 AND 97 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1181 and 1181+11 and ws_list_price between 156 and 185 and c_birth_year BETWEEN 1968 AND 1974 and ws_wholesale_cost BETWEEN 87 AND 97 ) ) cool_cust  ;"
594,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 1 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
595,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 43 and 52 and wr_return_amt / wr_return_quantity between 92 and 121 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('GA', 'KS', 'MN', 'NM')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (47, 67) and c_birth_year BETWEEN 1942 AND 1948 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
596,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'W' and cd_education_status = 'Unknown' and d_year = 2002 and s_state = 'MO' and i_category = 'Women' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
597,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212+11 and ss_list_price between 267 and 296 and c_birth_year BETWEEN 1949 AND 1955 and ss_wholesale_cost BETWEEN 54 AND 64 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212+11 and cs_list_price between 267 and 296 and c_birth_year BETWEEN 1949 AND 1955 and cs_wholesale_cost BETWEEN 54 AND 64 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212+11 and ws_list_price between 267 and 296 and c_birth_year BETWEEN 1949 AND 1955 and ws_wholesale_cost BETWEEN 54 AND 64 ) ) cool_cust  ;"
598,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'W' and cd_education_status = 'Secondary' and d_year = 2002 and s_state = 'MO' and i_category = 'Women' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
599,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = '2 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 3 and ca_state in ('GA', 'ME', 'NC') and cs_wholesale_cost BETWEEN 84 AND 89 AND i_category = 'Books' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
600,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2002 and i_manager_id BETWEEN 9 and 28 AND i_category IN ('Children', 'Home', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and ss_wholesale_cost BETWEEN 88 AND 98  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1981 AND 1987 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2002 and d_moy = 12 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 88 AND 98 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2002 and d_moy = 12 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 88 AND 98) tmp2 limit 100 ;"
601,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'S' and  cd_education_status = 'Advanced Degree' and  d_year = 2002 and  s_state = 'IL' and i_category = 'Men'  ;"
602,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 11 and 30 AND i_category IN ('Children', 'Jewelry', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 9 AND 19  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1961 AND 1967 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1999 and d_moy = 12 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 9 AND 19 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1999 and d_moy = 12 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 9 AND 19) tmp2 limit 100 ;"
603,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and d_year = 2001 and s_state = 'AR' and i_category = 'Children' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
604,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'KY', 'NC') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'NE', 'UT') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'MN', 'NE') and ss_net_profit between 50 and 250 ))  ;"
605,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('brown', 'navy') and i_manager_id BETWEEN 81 and 100 and ss_list_price between 187 and 201 and ca_state in ('GA','VA') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('brown', 'navy') and i_manager_id BETWEEN 81 and 100 and ws_list_price between 187 and 201 and ca_state in ('GA','VA') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q1_q2_increase ;"
606,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 16 and 25 and wr_return_amt / wr_return_quantity between 250 and 279 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('IA', 'MO', 'MS', 'NM')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (16, 57) and c_birth_year BETWEEN 1931 AND 1937 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
607,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Conecuh County','Harmon County','Kaufman County','Nemaha County','Taney County') and c.c_birth_month in (8, 12) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'D', 'S') and cd_education_status in ('Unknown', '4 yr Degree', 'Primary') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 3 and 3+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Shoes')  and ss_sales_price / ss_list_price BETWEEN 83 * 0.01 AND 93 * 0.01  and i_manager_id BETWEEN 66 and 75  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 3 ANd 3+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Shoes')  and i_manager_id BETWEEN 66 and 75  and ws_sales_price / ws_list_price BETWEEN 83 * 0.01 AND 93 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 3 and 3+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Home', 'Shoes')  and i_manager_id BETWEEN 66 and 75  and cs_sales_price / cs_list_price BETWEEN 83 * 0.01 AND 93 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
608,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-01-07','2001-06-10','2001-08-21','2001-11-04'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Electronics') and i_manager_id BETWEEN 30 and 39 and sr_return_amt / sr_return_quantity between 197 and 226 and sr_reason_sk in (47, 53, 56, 69, 71) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-01-07','2001-06-10','2001-08-21','2001-11-04'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Electronics') and i_manager_id BETWEEN 30 and 39 and cr_return_amount / cr_return_quantity between 197 and 226 and cr_reason_sk in (47, 53, 56, 69, 71) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-01-07','2001-06-10','2001-08-21','2001-11-04'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Electronics') and i_manager_id BETWEEN 30 and 39 and wr_return_amt / wr_return_quantity between 197 and 226 and wr_reason_sk in (47, 53, 56, 69, 71) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
609,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Glendale' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 3 * 10000 and ib_upper_bound <= 3 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
610,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('GA', 'LA', 'VA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'ME', 'VA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'KY', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
611,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'MI', 'WV') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CO', 'KY', 'WI') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MN', 'OK', 'WV') and ss_net_profit between 50 and 250 ))  ;"
612,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2002 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Books', 'Home', 'Jewelry') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and ss_wholesale_cost BETWEEN 60 AND 70  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1985 AND 1991 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2002 and d_moy = 9 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 60 AND 70 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2002 and d_moy = 9 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 60 AND 70) tmp2 limit 100 ;"
613,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Shoes') and item2.i_manager_id between 68 and 87 and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 125 and 139 and s2.ss_list_price between 125 and 139 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
614,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
615,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1212 and 1212 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 13 and 42 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
616,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('ND', 'NY', 'VT') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('OR', 'PA', 'VA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'OH', 'TN') and ws_net_profit between 50 and 250 ) )  ;"
617,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Secondary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('HI', 'OH', 'UT') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'OK', 'TX') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NC', 'VA', 'WI') and ss_net_profit between 50 and 250 ))  ;"
618,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('IL','NM','TN') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'U', 'S') and cd_education_status in ('Primary', 'Advanced Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 and 6+2  and ss_list_price between 211 and 300 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 and 6+2  and ws_list_price between 211 and 300  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 and 6+2  and cs_list_price between 211 and 300)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
619,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'TN', 'WV') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'OH', 'SD') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('DC', 'OK', 'PA') and ss_net_profit between 50 and 250 ))  ;"
620,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1178 and 1178 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 153 and 182 and sm_type = 'REGULAR' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
621,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 47 * 0.01 AND 67 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1182 and 1182 + 11  and s_state in ('GA','IL','IN'   ,'MI','MN','MS','NJ','PA')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1182+ 12 and 1182 + 23  and s_state in ('GA','IL','IN'   ,'MI','MN','MS','NJ','PA')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
622,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Books' and d_year=2002 and d_moy = 12 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MN' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 15 AND 35  ;"
623,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-04-15')) and ss_sold_date_sk = d_date_sk and ss_list_price between 32 and 61 and i_manager_id BETWEEN 25 and 54 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-04-15')) and cs_sold_date_sk = d_date_sk and cs_list_price between 32 and 61 and i_manager_id BETWEEN 25 and 54 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-04-15')) and ws_sold_date_sk = d_date_sk and ws_list_price between 32 and 61 and i_manager_id BETWEEN 25 and 54 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
624,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CA', 'KS', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'ID', 'IL') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MD', 'NC', 'WI') and ss_net_profit between 50 and 250 ))  ;"
625,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1214 and 1214+11 and ss_list_price between 181 and 210 and c_birth_year BETWEEN 1942 AND 1948 and ss_wholesale_cost BETWEEN 7 AND 17 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1214 and 1214+11 and cs_list_price between 181 and 210 and c_birth_year BETWEEN 1942 AND 1948 and cs_wholesale_cost BETWEEN 7 AND 17 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1214 and 1214+11 and ws_list_price between 181 and 210 and c_birth_year BETWEEN 1942 AND 1948 and ws_wholesale_cost BETWEEN 7 AND 17 ) ) cool_cust  ;"
626,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'MD', 'NC') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'MN', 'TN') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MN', 'PA', 'WI') and ss_net_profit between 50 and 250 ))  ;"
627,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Secondary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'NE', 'VA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'ID', 'KS') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MD', 'TX', 'UT') and ss_net_profit between 50 and 250 ))  ;"
628,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
629,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('ND', 'NY', 'VT') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('OR', 'PA', 'VA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'OH', 'TN') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
630,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 80 AND 100 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 82 and 82 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('GA','NM','TX') and ss_wholesale_cost BETWEEN 80 AND 100 and cd1.cd_marital_status in ('M', 'S', 'S') and cd1.cd_education_status in ('Unknown', 'Unknown', 'Primary') and cd2.cd_marital_status in ('M', 'S', 'S') and cd2.cd_education_status in ('Unknown', 'Unknown', 'Primary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
631,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Union Hill' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 56854 and ib_upper_bound <= 56854 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
632,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and d_year = 1999 and s_state = 'MN' and i_category = 'Jewelry' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
633,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 55 and 64 and ss_wholesale_cost BETWEEN 72 AND 92 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 55 and 64 and cs_wholesale_cost BETWEEN 72 AND 92 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 72 AND 92 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 55 and 64 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 72 AND 92  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 72 AND 92  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 72 AND 92 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 25) and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 55 and 64 and ss_wholesale_cost BETWEEN 72 AND 92 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 25) and i_category IN ('Home', 'Jewelry', 'Women') and ss_wholesale_cost BETWEEN 72 AND 92 and i_manager_id BETWEEN 55 and 64 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
634,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 68 * 0.01 AND 88 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1205 and 1205 + 11  and s_state in ('AL','KY','MT'   ,'NY','OR','SC','SD','VA')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1205+ 12 and 1205 + 23  and s_state in ('AL','KY','MT'   ,'NY','OR','SC','SD','VA')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
635,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('NC', 'NE', 'SC') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('LA', 'NC', 'SD') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('ND', 'TN', 'TX') and ws_net_profit between 50 and 250 ) )  ;"
636,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=2000 and d_moy = 2 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'FL' and c_birth_month = 2 and ss_wholesale_cost BETWEEN 9 AND 29 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
637,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 1999  ;"
638,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 11 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -6  ;"
639,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1212 and 1212 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 130 and 159 and sm_type = 'EXPRESS' and cc_class = 'large' and w_gmt_offset = -5  ;"
640,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-05-14')) and ss_sold_date_sk = d_date_sk and ss_list_price between 47 and 76 and i_manager_id BETWEEN 47 and 76 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1940 AND 1946 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-05-14')) and cs_sold_date_sk = d_date_sk and cs_list_price between 47 and 76 and i_manager_id BETWEEN 47 and 76 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1940 AND 1946 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-05-14')) and ws_sold_date_sk = d_date_sk and ws_list_price between 47 and 76 and i_manager_id BETWEEN 47 and 76 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1940 AND 1946 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
641,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2002-03-23','2002-04-13','2002-09-13','2002-10-31'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Electronics', 'Music') and i_manager_id BETWEEN 9 and 18 and sr_return_amt / sr_return_quantity between 171 and 200 and sr_reason_sk in (8, 13, 21, 48, 67) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-03-23','2002-04-13','2002-09-13','2002-10-31'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Electronics', 'Music') and i_manager_id BETWEEN 9 and 18 and cr_return_amount / cr_return_quantity between 171 and 200 and cr_reason_sk in (8, 13, 21, 48, 67) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-03-23','2002-04-13','2002-09-13','2002-10-31'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Electronics', 'Music') and i_manager_id BETWEEN 9 and 18 and wr_return_amt / wr_return_quantity between 171 and 200 and wr_reason_sk in (8, 13, 21, 48, 67) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
642,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Red Hill' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 60470 and ib_upper_bound <= 60470 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
643,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 and sr_return_amt / sr_return_quantity between 128 and 187 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 57 AND 60 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AR', 'ND', 'WV') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('U', 'S') and cd_education_status IN ('Advanced Degree', 'Secondary') and cd_gender = 'M' and c_birth_month = 11 and c_birth_year BETWEEN 1951 AND 1957 order by c_customer_id limit 100 ;"
644,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 1998 and  c_birth_month = 6 and  ca_state in ('AR', 'CT', 'MI')  and cs_wholesale_cost BETWEEN 23 AND 28  AND i_category = 'Books'  ;"
645,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('IN','KS','SD') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'U', 'W') and cd_education_status in ('2 yr Degree', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 10 and 10+2  and ss_list_price between 153 and 242 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 10 and 10+2  and ws_list_price between 153 and 242  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 10 and 10+2  and cs_list_price between 153 and 242)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
646,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212 + 11 and c_birth_month in (5, 6, 9, 11) and ss_list_price between 29 and 88 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212 + 11 and c_birth_month in (5, 6, 9, 11) and cs_list_price between 29 and 88 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212 + 11 and c_birth_month in (5, 6, 9, 11) and ws_list_price between 29 and 88 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
647,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1190 and 1190 + 11 and c_birth_month in (1, 5, 9, 11) and ss_list_price between 77 and 136 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1190 and 1190 + 11 and c_birth_month in (1, 5, 9, 11) and cs_list_price between 77 and 136 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1190 and 1190 + 11 and c_birth_month in (1, 5, 9, 11) and ws_list_price between 77 and 136 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
648,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 23 and 42 AND i_category IN ('Children', 'Jewelry', 'Music') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 55 AND 65  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1978 AND 1984 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1999 and d_moy = 8 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 55 AND 65 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1999 and d_moy = 8 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 55 AND 65) tmp2 limit 100 ;"
649,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('GA', 'LA', 'VA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'ME', 'VA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'KY', 'TX') and ws_net_profit between 50 and 250 ) )  ;"
650,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1194 and 1194 + 11 and c_birth_month in (1, 6, 7, 12) and ss_list_price between 120 and 179 and ss_wholesale_cost BETWEEN 38 AND 58 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1194 and 1194 + 11 and c_birth_month in (1, 6, 7, 12) and cs_list_price between 120 and 179 and cs_wholesale_cost BETWEEN 38 AND 58 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1194 and 1194 + 11 and c_birth_month in (1, 6, 7, 12) and ws_list_price between 120 and 179 and ws_wholesale_cost BETWEEN 38 AND 58 ) hot_cust limit 100 ;"
651,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('GA','MO','VA') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'S', 'M') and cd_education_status in ('Secondary', '2 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 and 9+2  and ss_list_price between 119 and 208 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 and 9+2  and ws_list_price between 119 and 208  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 and 9+2  and cs_list_price between 119 and 208)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
652,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 57 * 0.01 AND 77 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1189 and 1189 + 11  and s_state in ('CO','KS','NH'   ,'NM','OH','SD','TN','TX')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1189+ 12 and 1189 + 23  and s_state in ('CO','KS','NH'   ,'NM','OH','SD','TN','TX')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
653,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1213 and 1213+11 and ss_list_price between 260 and 289 and c_birth_year BETWEEN 1962 AND 1968 and ss_wholesale_cost BETWEEN 90 AND 100 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1213 and 1213+11 and cs_list_price between 260 and 289 and c_birth_year BETWEEN 1962 AND 1968 and cs_wholesale_cost BETWEEN 90 AND 100 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1213 and 1213+11 and ws_list_price between 260 and 289 and c_birth_year BETWEEN 1962 AND 1968 and ws_wholesale_cost BETWEEN 90 AND 100 ) ) cool_cust  ;"
654,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'TX', 'WI') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('ID', 'VT', 'WI') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('ID', 'ME', 'OK') and ws_net_profit between 50 and 250 ) )  ;"
655,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=1998 and d_moy = 12 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'WV' and c_birth_month = 6 and ss_wholesale_cost BETWEEN 31 AND 51 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
656,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2001 and i_manager_id BETWEEN 68 and 87 AND i_category IN ('Books', 'Home', 'Shoes') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and ss_wholesale_cost BETWEEN 48 AND 58  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1950 AND 1956 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2001 and d_moy = 8 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 48 AND 58 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2001 and d_moy = 8 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 48 AND 58) tmp2 limit 100 ;"
657,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1222 and 1222+11 and ss_sales_price / ss_list_price BETWEEN 72 * 0.01 AND 82 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1222 and 1222+11 and ss_sales_price / ss_list_price BETWEEN 72 * 0.01 AND 82 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 20 and 24  and s_state in ('GA','SC','TX') order by s_store_name, i_item_desc limit 100 ;"
658,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 88 and 97 and ss_wholesale_cost BETWEEN 27 AND 47 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 88 and 97 and cs_wholesale_cost BETWEEN 27 AND 47 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 27 AND 47 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 88 and 97 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 27 AND 47  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 27 AND 47  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 27 AND 47 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 4) and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 88 and 97 and ss_wholesale_cost BETWEEN 27 AND 47 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 4) and i_category IN ('Home', 'Jewelry', 'Women') and ss_wholesale_cost BETWEEN 27 AND 47 and i_manager_id BETWEEN 88 and 97 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
659,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KY', 'MS', 'NC') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('KY', 'NE', 'WI') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IA', 'ME', 'NE') and ws_net_profit between 50 and 250 ) )  ;"
660,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'MS', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'GA', 'NY') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'IL', 'OH') and ss_net_profit between 50 and 250 ))  ;"
661,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = '4 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 1999 and c_birth_month = 10 and ca_state in ('NC', 'SC', 'TX') and cs_wholesale_cost BETWEEN 89 AND 94 AND i_category = 'Home' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
662,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2000 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Children', 'Home', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2000 and ss_wholesale_cost BETWEEN 39 AND 49  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1978 AND 1984 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2000 and d_moy = 10 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 39 AND 49 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2000 and d_moy = 10 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 39 AND 49) tmp2 limit 100 ;"
663,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1201 and 1201 + 11 and c_birth_month in (2, 4, 10, 12) and ss_list_price between 78 and 137 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1201 and 1201 + 11 and c_birth_month in (2, 4, 10, 12) and cs_list_price between 78 and 137 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1201 and 1201 + 11 and c_birth_month in (2, 4, 10, 12) and ws_list_price between 78 and 137 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
664,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'TX', 'WI') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('ID', 'OK', 'VT') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('ID', 'ME', 'NM') and ss_net_profit between 50 and 250 ))  ;"
665,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1219 and 1219+11 and ss_list_price between 190 and 219 and c_birth_year BETWEEN 1965 AND 1971 and ss_wholesale_cost BETWEEN 55 AND 65 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1219 and 1219+11 and cs_list_price between 190 and 219 and c_birth_year BETWEEN 1965 AND 1971 and cs_wholesale_cost BETWEEN 55 AND 65 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1219 and 1219+11 and ws_list_price between 190 and 219 and c_birth_year BETWEEN 1965 AND 1971 and ws_wholesale_cost BETWEEN 55 AND 65 ) ) cool_cust  ;"
666,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Grant County','Iron County','Macon County','Noxubee County','Piatt County') and c.c_birth_month in (4, 6) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'W', 'W') and cd_education_status in ('2 yr Degree', '4 yr Degree', '4 yr Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 1 and 1+3 and  ss_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Women')  and ss_sales_price / ss_list_price BETWEEN 9 * 0.01 AND 19 * 0.01  and i_manager_id BETWEEN 53 and 62  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 1 ANd 1+3 and  ws_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Women')  and i_manager_id BETWEEN 53 and 62  and ws_sales_price / ws_list_price BETWEEN 9 * 0.01 AND 19 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 1 and 1+3 and  cs_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Women')  and i_manager_id BETWEEN 53 and 62  and cs_sales_price / cs_list_price BETWEEN 9 * 0.01 AND 19 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
667,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 241 and 300 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 16 AND 19 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('KS', 'NC', 'WV') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'S') and cd_education_status IN ('4 yr Degree', 'Secondary') and cd_gender = 'M' and c_birth_month = 3 and c_birth_year BETWEEN 1969 AND 1975 order by c_customer_id limit 100 ;"
668,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 2002  ;"
669,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 46 and 65 and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 14 and 28 and s2.ss_list_price between 14 and 28 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
670,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Children' and i_class = 'infants' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 8 and d_year = 2002 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1958 AND 1971 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('GA','MN','ND'   ,'NY','OR','PA'   ,'TN','TX','VA'   ,'VT')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2002 and d_moy = 8)   and (select distinct d_month_seq+3   from date_dim where d_year = 2002 and d_moy = 8) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
671,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'U' and cd_education_status = 'Unknown' and d_year = 2002 and s_state = 'AR' and i_category = 'Children' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
672,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 1 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -6  ;"
673,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
674,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Bridgeport' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 2184 and ib_upper_bound <= 2184 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
675,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1217 and 1217 + 11 and c_birth_month in (3, 4, 6, 8) and ss_list_price between 241 and 300 and ss_wholesale_cost BETWEEN 48 AND 68 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1217 and 1217 + 11 and c_birth_month in (3, 4, 6, 8) and cs_list_price between 241 and 300 and cs_wholesale_cost BETWEEN 48 AND 68 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1217 and 1217 + 11 and c_birth_month in (3, 4, 6, 8) and ws_list_price between 241 and 300 and ws_wholesale_cost BETWEEN 48 AND 68 ) hot_cust limit 100 ;"
676,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 90 and 99 and wr_return_amt / wr_return_quantity between 235 and 264 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('KS', 'LA', 'OK', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (28, 43) and c_birth_year BETWEEN 1952 AND 1958 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
677,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 80 * 0.01 AND 100 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1177 and 1177 + 11  and s_state in ('AK','AR','IL'   ,'KS','MN','SC','TX','VA')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1177+ 12 and 1177 + 23  and s_state in ('AK','AR','IL'   ,'KS','MN','SC','TX','VA')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
678,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KY', 'MS', 'NC') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('KY', 'NE', 'WI') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IA', 'ME', 'NE') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
679,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 45 AND 65 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 41 and 41 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('IL','PA','UT') and ss_wholesale_cost BETWEEN 45 AND 65 and cd1.cd_marital_status in ('U', 'S', 'U') and cd1.cd_education_status in ('4 yr Degree', 'College', 'Secondary') and cd2.cd_marital_status in ('U', 'S', 'U') and cd2.cd_education_status in ('4 yr Degree', 'College', 'Secondary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2000 and cs2.syear = 2000 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
680,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1179 and 1179+11 and ss_list_price between 95 and 124 and c_birth_year BETWEEN 1987 AND 1993 and ss_wholesale_cost BETWEEN 63 AND 73 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1179 and 1179+11 and cs_list_price between 95 and 124 and c_birth_year BETWEEN 1987 AND 1993 and cs_wholesale_cost BETWEEN 63 AND 73 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1179 and 1179+11 and ws_list_price between 95 and 124 and c_birth_year BETWEEN 1987 AND 1993 and ws_wholesale_cost BETWEEN 63 AND 73 ) ) cool_cust  ;"
681,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('FL', 'IL', 'MT') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AK', 'FL', 'NY') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('FL', 'NE', 'VA') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
682,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 235 and 294 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 15 AND 18 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('GA', 'MO', 'VA') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'S') and cd_education_status IN ('Secondary', '2 yr Degree') and cd_gender = 'M' and c_birth_month = 9 and c_birth_year BETWEEN 1964 AND 1970 order by c_customer_id limit 100 ;"
683,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('GA', 'NY', 'WI') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IN', 'MO', 'TN') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'IN', 'MT') and ws_net_profit between 50 and 250 ) )  ;"
684,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Secondary' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 2 and  ca_state in ('KY', 'TX', 'WI')  and cs_wholesale_cost BETWEEN 84 AND 89  AND i_category = 'Children'  ;"
685,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2001 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Books', 'Home', 'Shoes') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and ss_wholesale_cost BETWEEN 4 AND 14  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1928 AND 1934 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2001 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 4 AND 14 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2001 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 4 AND 14) tmp2 limit 100 ;"
686,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1202 and 1202 + 11 and c_birth_month in (3, 5, 6, 7) and ss_list_price between 241 and 300 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1202 and 1202 + 11 and c_birth_month in (3, 5, 6, 7) and cs_list_price between 241 and 300 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1202 and 1202 + 11 and c_birth_month in (3, 5, 6, 7) and ws_list_price between 241 and 300 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
687,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Marion' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 3 * 10000 and ib_upper_bound <= 3 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
688,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = 'Secondary' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 11 and ca_state in ('OH', 'SC', 'TN') and cs_wholesale_cost BETWEEN 8 AND 13 AND i_category = 'Shoes' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
689,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 11 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -7  ;"
690,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 9 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
691,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -7  ;"
692,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Electronics' and d_year=1998 and d_moy = 11 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'NJ' and c_birth_month = 4 and ss_wholesale_cost BETWEEN 0 AND 20  ;"
693,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221 + 11 and c_birth_month in (2, 8, 10, 11) and ss_list_price between 241 and 300 and ss_wholesale_cost BETWEEN 73 AND 93 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221 + 11 and c_birth_month in (2, 8, 10, 11) and cs_list_price between 241 and 300 and cs_wholesale_cost BETWEEN 73 AND 93 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221 + 11 and c_birth_month in (2, 8, 10, 11) and ws_list_price between 241 and 300 and ws_wholesale_cost BETWEEN 73 AND 93 ) hot_cust limit 100 ;"
694,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'M' and cd_education_status = 'Secondary' and d_year = 2002 and s_state = 'OR' and i_category = 'Children' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
695,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1998 and i_manager_id BETWEEN 32 and 51 AND i_category IN ('Books', 'Home', 'Jewelry') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1998 and ss_wholesale_cost BETWEEN 69 AND 79  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1985 AND 1991 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1998 and d_moy = 6 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 69 AND 79 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1998 and d_moy = 6 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 69 AND 79) tmp2 limit 100 ;"
696,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=1998 and d_moy = 2 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'CA' and c_birth_month = 10 and ss_wholesale_cost BETWEEN 34 AND 54 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
697,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-05-02')) and ss_sold_date_sk = d_date_sk and ss_list_price between 96 and 125 and i_manager_id BETWEEN 62 and 91 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1964 AND 1970 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-05-02')) and cs_sold_date_sk = d_date_sk and cs_list_price between 96 and 125 and i_manager_id BETWEEN 62 and 91 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1964 AND 1970 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-05-02')) and ws_sold_date_sk = d_date_sk and ws_list_price between 96 and 125 and i_manager_id BETWEEN 62 and 91 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1964 AND 1970 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
698,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and d_year = 1998 and s_state = 'UT' and i_category = 'Jewelry' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
699,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Jewelry', 'Women') and i_manager_id BETWEEN 46 and 55 and ss_wholesale_cost BETWEEN 13 AND 33 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Jewelry', 'Women') and i_manager_id BETWEEN 46 and 55 and cs_wholesale_cost BETWEEN 13 AND 33 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 13 AND 33 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Jewelry', 'Women') and i_manager_id BETWEEN 46 and 55 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 13 AND 33  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 13 AND 33  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 13 AND 33 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 3) and i_category IN ('Books', 'Jewelry', 'Women') and i_manager_id BETWEEN 46 and 55 and ss_wholesale_cost BETWEEN 13 AND 33 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 3) and i_category IN ('Books', 'Jewelry', 'Women') and ss_wholesale_cost BETWEEN 13 AND 33 and i_manager_id BETWEEN 46 and 55 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
700,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 54 and 63 and wr_return_amt / wr_return_quantity between 165 and 194 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AL', 'GA', 'SC', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (1, 73) and c_birth_year BETWEEN 1959 AND 1965 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
701,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('OH','TX','WI') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'U', 'W') and cd_education_status in ('4 yr Degree', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 5 and 5+2  and ss_list_price between 32 and 121 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 5 and 5+2  and ws_list_price between 32 and 121  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 5 and 5+2  and cs_list_price between 32 and 121)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
702,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Home' and d_year=2001 and d_moy = 12 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'TX' and c_birth_month = 5 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
703,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'D' and cd_education_status = '2 yr Degree' and d_year = 2002 and s_state = 'NV' and i_category = 'Children' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
704,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1998 and i_manager_id BETWEEN 6 and 25 AND i_category IN ('Books', 'Jewelry', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1998 and ss_wholesale_cost BETWEEN 100 AND 110  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1954 AND 1960 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1998 and d_moy = 6 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 100 AND 110 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1998 and d_moy = 6 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 100 AND 110) tmp2 limit 100 ;"
705,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Pine Grove' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 10345 and ib_upper_bound <= 10345 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
706,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CA', 'MN', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'MO', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'SC', 'TX') and ss_net_profit between 50 and 250 ))  ;"
707,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 1999 and  c_birth_month = 9 and  ca_state in ('MO', 'NJ', 'NY')  and cs_wholesale_cost BETWEEN 5 AND 10  AND i_category = 'Shoes'  ;"
708,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 43 and 52 and ss_wholesale_cost BETWEEN 55 AND 75 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 43 and 52 and cs_wholesale_cost BETWEEN 55 AND 75 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 55 AND 75 and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 43 and 52 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and ss_wholesale_cost BETWEEN 55 AND 75  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and cs_wholesale_cost BETWEEN 55 AND 75  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 55 AND 75 and d_year between 1999 and 1999 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999 + 1   and d_moy = 12   and d_dom = 20) and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 43 and 52 and ss_wholesale_cost BETWEEN 55 AND 75 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999   and d_moy = 12   and d_dom = 20) and i_category IN ('Children', 'Jewelry', 'Women') and ss_wholesale_cost BETWEEN 55 AND 75 and i_manager_id BETWEEN 43 and 52 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
709,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7  ;"
710,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('IN','TN','WI') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('D', 'W', 'S') and cd_education_status in ('Unknown', 'Advanced Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 6 and 6+2  and ss_list_price between 77 and 166 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 6 and 6+2  and ws_list_price between 77 and 166  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 6 and 6+2  and cs_list_price between 77 and 166)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
711,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Jamestown' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 4 * 10000 and ib_upper_bound <= 4 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
712,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('peach', 'plum') and i_manager_id BETWEEN 64 and 83 and ss_list_price between 211 and 225 and ca_state in ('MT','NE') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('peach', 'plum') and i_manager_id BETWEEN 64 and 83 and ws_list_price between 211 and 225 and ca_state in ('MT','NE') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2001 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2001 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2001 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2001 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2001 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2001 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.ca_county ;"
713,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=1998 and d_moy = 4 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MD' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 70 AND 90  ;"
714,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Children' and i_class = 'toddlers' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 7 and d_year = 2001 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1938 AND 1951 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('AL','AR','CO'   ,'CT','MI','MN'   ,'OH','PA','TN'   ,'TX')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 7)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 7) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
715,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IN', 'KY', 'MS') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('MI', 'NM', 'NY') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AL', 'GA', 'IL') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
716,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 60 and 79 and cd_marital_status = 'W' and cd_education_status = 'Primary' and s1.ss_list_price between 135 and 149 and s2.ss_list_price between 135 and 149 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
717,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IN', 'SD', 'WV') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IN', 'LA', 'MI') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'KS', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
718,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Comanche County','Larue County','Lee County','Mercer County','Robertson County') and c.c_birth_month in (11, 12) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'W', 'W') and cd_education_status in ('4 yr Degree', '2 yr Degree', 'Secondary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 5 and 5+3 and  ss_item_sk = i_item_sk and  i_category in ('Home', 'Music', 'Sports')  and ss_sales_price / ss_list_price BETWEEN 12 * 0.01 AND 22 * 0.01  and i_manager_id BETWEEN 56 and 65  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 5 ANd 5+3 and  ws_item_sk = i_item_sk and  i_category in ('Home', 'Music', 'Sports')  and i_manager_id BETWEEN 56 and 65  and ws_sales_price / ws_list_price BETWEEN 12 * 0.01 AND 22 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 5 and 5+3 and  cs_item_sk = i_item_sk and  i_category in ('Home', 'Music', 'Sports')  and i_manager_id BETWEEN 56 and 65  and cs_sales_price / cs_list_price BETWEEN 12 * 0.01 AND 22 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
719,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1998 and i_manager_id BETWEEN 17 and 36 AND i_category IN ('Children', 'Home', 'Shoes') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1998 and ss_wholesale_cost BETWEEN 60 AND 70  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1998 and d_moy = 3 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 60 AND 70 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1998 and d_moy = 3 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 60 AND 70) tmp2 limit 100 ;"
720,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-02-21')) and ss_sold_date_sk = d_date_sk and ss_list_price between 271 and 300 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1980 AND 1986 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-02-21')) and cs_sold_date_sk = d_date_sk and cs_list_price between 271 and 300 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1980 AND 1986 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-02-21')) and ws_sold_date_sk = d_date_sk and ws_list_price between 271 and 300 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1980 AND 1986 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
721,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-02-07','2001-04-26','2001-07-08','2001-11-15'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 91 and 100 and sr_return_amt / sr_return_quantity between 259 and 288 and sr_reason_sk in (31, 42, 54, 67, 71) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-02-07','2001-04-26','2001-07-08','2001-11-15'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 91 and 100 and cr_return_amount / cr_return_quantity between 259 and 288 and cr_reason_sk in (31, 42, 54, 67, 71) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-02-07','2001-04-26','2001-07-08','2001-11-15'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 259 and 288 and wr_reason_sk in (31, 42, 54, 67, 71) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
722,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Harmony' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 63201 and ib_upper_bound <= 63201 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
723,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,max(ss_net_profit) as store_sales_profit ,max(sr_net_loss) as store_returns_loss ,max(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 1998 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
724,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1201 and 1201 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 248 and 277 and sm_type = 'LIBRARY' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
725,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = '2 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2002 and c_birth_month = 12 and ca_state in ('ID', 'ME', 'OK') and cs_wholesale_cost BETWEEN 39 AND 44 AND i_category = 'Home' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
726,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-04-17')) and ss_sold_date_sk = d_date_sk and ss_list_price between 98 and 127 and i_manager_id BETWEEN 28 and 57 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1952 AND 1958 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-04-17')) and cs_sold_date_sk = d_date_sk and cs_list_price between 98 and 127 and i_manager_id BETWEEN 28 and 57 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1952 AND 1958 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-04-17')) and ws_sold_date_sk = d_date_sk and ws_list_price between 98 and 127 and i_manager_id BETWEEN 28 and 57 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1952 AND 1958 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
727,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 55 and 64 and wr_return_amt / wr_return_quantity between 271 and 300 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('LA', 'ND', 'TN', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (4, 7) and c_birth_year BETWEEN 1977 AND 1983 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
728,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 and sr_return_amt / sr_return_quantity between 23 and 82 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 60 AND 63 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('MD', 'NH', 'WV') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'W') and cd_education_status IN ('Secondary', 'Secondary') and cd_gender = 'M' and c_birth_month = 3 and c_birth_year BETWEEN 1933 AND 1939 order by c_customer_id limit 100 ;"
729,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1998-01-29','1998-05-22','1998-09-21','1998-11-09'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Men', 'Women') and i_manager_id BETWEEN 81 and 90 and sr_return_amt / sr_return_quantity between 149 and 178 and sr_reason_sk in (14, 48, 50, 64, 73) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-01-29','1998-05-22','1998-09-21','1998-11-09'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Men', 'Women') and i_manager_id BETWEEN 81 and 90 and cr_return_amount / cr_return_quantity between 149 and 178 and cr_reason_sk in (14, 48, 50, 64, 73) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-01-29','1998-05-22','1998-09-21','1998-11-09'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Men', 'Women') and i_manager_id BETWEEN 81 and 90 and wr_return_amt / wr_return_quantity between 149 and 178 and wr_reason_sk in (14, 48, 50, 64, 73) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
730,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 16 * 0.01 AND 36 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1205 and 1205 + 11  and s_state in ('AL','FL','IL'   ,'MO','MT','ND','OK','RI')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1205+ 12 and 1205 + 23  and s_state in ('AL','FL','IL'   ,'MO','MT','ND','OK','RI')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
731,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Brownsville' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 16006 and ib_upper_bound <= 16006 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
732,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Books' and d_year=2001 and d_moy = 2 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'IL' and c_birth_month = 9 and ss_wholesale_cost BETWEEN 73 AND 93 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
733,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-01-10')) and ss_sold_date_sk = d_date_sk and ss_list_price between 256 and 285 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1976 AND 1982 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-01-10')) and cs_sold_date_sk = d_date_sk and cs_list_price between 256 and 285 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1976 AND 1982 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-01-10')) and ws_sold_date_sk = d_date_sk and ws_list_price between 256 and 285 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1976 AND 1982 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
734,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1203 and 1203+11 and ss_sales_price / ss_list_price BETWEEN 77 * 0.01 AND 87 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1203 and 1203+11 and ss_sales_price / ss_list_price BETWEEN 77 * 0.01 AND 87 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 72 and 76  and s_state in ('GA','NM','SC') order by s_store_name, i_item_desc limit 100 ;"
735,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and d_year = 1999 and s_state = 'GA' and i_category = 'Home' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
736,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11 and ss_list_price between 236 and 265 and c_birth_year BETWEEN 1987 AND 1993 and ss_wholesale_cost BETWEEN 70 AND 80 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11 and cs_list_price between 236 and 265 and c_birth_year BETWEEN 1987 AND 1993 and cs_wholesale_cost BETWEEN 70 AND 80 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11 and ws_list_price between 236 and 265 and c_birth_year BETWEEN 1987 AND 1993 and ws_wholesale_cost BETWEEN 70 AND 80 ) ) cool_cust  ;"
737,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('bisque', 'cream') and i_manager_id BETWEEN 2 and 21 and ss_list_price between 199 and 213 and ca_state in ('IN','NE') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('bisque', 'cream') and i_manager_id BETWEEN 2 and 21 and ws_list_price between 199 and 213 and ca_state in ('IN','NE') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.ca_county ;"
738,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Sports' and d_year=1999 and d_moy = 3 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'OK' and c_birth_month = 11 and ss_wholesale_cost BETWEEN 71 AND 91  ;"
739,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('CA', 'NJ', 'NY') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('KY', 'NE', 'OH') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('MO', 'SC', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
740,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2001 and i_manager_id BETWEEN 30 and 49 AND i_category IN ('Children', 'Home', 'Jewelry') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and ss_wholesale_cost BETWEEN 64 AND 74  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1966 AND 1972 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2001 and d_moy = 11 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 64 AND 74 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2001 and d_moy = 11 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 64 AND 74) tmp2 limit 100 ;"
741,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'MO', 'NM') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IL', 'TN', 'VT') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('MO', 'NM', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
742,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Woodlawn' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 43480 and ib_upper_bound <= 43480 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
743,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 1 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
744,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1208 and 1208 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 229 and 258 and sm_type = 'LIBRARY' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
745,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'M' and  cd_education_status = 'Primary' and  d_year = 2000 and  s_state = 'VA' and i_category = 'Jewelry'  ;"
746,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 10 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
747,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'MI', 'MO') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CT', 'MI', 'NE') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'AR', 'WV') and ss_net_profit between 50 and 250 ))  ;"
748,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Men' and i_class = 'sports-apparel' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 8 and d_year = 2000 and wholesale_cost BETWEEN 59 AND 89 and c_birth_year BETWEEN 1936 AND 1949 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 59 AND 89  and s_state in ('IL','LA','MO'   ,'MS','NJ','OH'   ,'SD','TN','VA'   ,'WY')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 8)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 8) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
749,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Children' and i_class = 'infants' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 1 and d_year = 2001 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('GA','IA','ID'   ,'KY','MO','MT'   ,'NM','NY','OH'   ,'TX')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 1)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 1) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
750,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-04-28')) and ss_sold_date_sk = d_date_sk and ss_list_price between 204 and 233 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1957 AND 1963 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-04-28')) and cs_sold_date_sk = d_date_sk and cs_list_price between 204 and 233 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1957 AND 1963 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-04-28')) and ws_sold_date_sk = d_date_sk and ws_list_price between 204 and 233 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1957 AND 1963 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
751,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Oakwood' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 54334 and ib_upper_bound <= 54334 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
752,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = 'Unknown' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '2 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CA', 'NY', 'RI') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'KY', 'OK') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'SD', 'VA') and ss_net_profit between 50 and 250 ))  ;"
753,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'IN'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
754,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1195 and 1195+11 and ss_sales_price / ss_list_price BETWEEN 9 * 0.01 AND 19 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1195 and 1195+11 and ss_sales_price / ss_list_price BETWEEN 9 * 0.01 AND 19 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 82 and 86  and s_state in ('KY','MI','WV') order by s_store_name, i_item_desc limit 100 ;"
755,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('orange', 'sienna') and i_manager_id BETWEEN 72 and 91 and ss_list_price between 143 and 157 and ca_state in ('NV','OH') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('orange', 'sienna') and i_manager_id BETWEEN 72 and 91 and ws_list_price between 143 and 157 and ca_state in ('NV','OH') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year ;"
756,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-03-18')) and ss_sold_date_sk = d_date_sk and ss_list_price between 185 and 214 and i_manager_id BETWEEN 46 and 75 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1977 AND 1983 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-03-18')) and cs_sold_date_sk = d_date_sk and cs_list_price between 185 and 214 and i_manager_id BETWEEN 46 and 75 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1977 AND 1983 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-03-18')) and ws_sold_date_sk = d_date_sk and ws_list_price between 185 and 214 and i_manager_id BETWEEN 46 and 75 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1977 AND 1983 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
757,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'NH'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
758,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'IL'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
759,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1199 and 1199+11 and ss_list_price between 190 and 219 and c_birth_year BETWEEN 1951 AND 1957 and ss_wholesale_cost BETWEEN 72 AND 82 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1199 and 1199+11 and cs_list_price between 190 and 219 and c_birth_year BETWEEN 1951 AND 1957 and cs_wholesale_cost BETWEEN 72 AND 82 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1199 and 1199+11 and ws_list_price between 190 and 219 and c_birth_year BETWEEN 1951 AND 1957 and ws_wholesale_cost BETWEEN 72 AND 82 ) ) cool_cust  ;"
760,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1200 and 1200 + 11 and c_birth_month in (3, 7, 11, 12) and ss_list_price between 84 and 143 and ss_wholesale_cost BETWEEN 73 AND 93 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1200 and 1200 + 11 and c_birth_month in (3, 7, 11, 12) and cs_list_price between 84 and 143 and cs_wholesale_cost BETWEEN 73 AND 93 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1200 and 1200 + 11 and c_birth_month in (3, 7, 11, 12) and ws_list_price between 84 and 143 and ws_wholesale_cost BETWEEN 73 AND 93 ) hot_cust limit 100 ;"
761,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('GA','KS','LA') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'W', 'W') and cd_education_status in ('Secondary', '2 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 7 and 7+2  and ss_list_price between 69 and 158 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 7 and 7+2  and ws_list_price between 69 and 158  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 7 and 7+2  and cs_list_price between 69 and 158)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
762,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'S' and  cd_education_status = 'Advanced Degree' and  d_year = 2000 and  s_state = 'GA' and i_category = 'Electronics'  ;"
763,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1212 and 1212 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 130 and 159 and sm_type = 'EXPRESS' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
764,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'College' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IL', 'MI', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('KY', 'SD', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('ND', 'TN', 'UT') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
765,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 9 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 9 and 9 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 9 and 9 + 2 and d3.d_year  = 1998  ;"
766,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1192 and 1192 + 11 and c_birth_month in (1, 10, 11, 12) and ss_list_price between 205 and 264 and ss_wholesale_cost BETWEEN 27 AND 47 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1192 and 1192 + 11 and c_birth_month in (1, 10, 11, 12) and cs_list_price between 205 and 264 and cs_wholesale_cost BETWEEN 27 AND 47 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1192 and 1192 + 11 and c_birth_month in (1, 10, 11, 12) and ws_list_price between 205 and 264 and ws_wholesale_cost BETWEEN 27 AND 47 ) hot_cust limit 100 ;"
767,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Clarke County','Franklin County','Jim Wells County','Licking County','Windham County') and c.c_birth_month in (8, 9) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'S', 'W') and cd_education_status in ('Advanced Degree', 'Advanced Degree', '4 yr Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 5 and 5+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and ss_sales_price / ss_list_price BETWEEN 82 * 0.01 AND 92 * 0.01  and i_manager_id BETWEEN 47 and 56  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 5 ANd 5+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and i_manager_id BETWEEN 47 and 56  and ws_sales_price / ws_list_price BETWEEN 82 * 0.01 AND 92 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 5 and 5+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and i_manager_id BETWEEN 47 and 56  and cs_sales_price / cs_list_price BETWEEN 82 * 0.01 AND 92 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
768,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=2002 and d_moy = 10 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MN' and c_birth_month = 11 and ss_wholesale_cost BETWEEN 55 AND 75 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
769,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Home' and d_year=2002 and d_moy = 5 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'TN' and c_birth_month = 5 and ss_wholesale_cost BETWEEN 74 AND 94  ;"
770,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NC', 'TX', 'VA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'IN', 'WY') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'NM', 'NY') and ss_net_profit between 50 and 250 ))  ;"
771,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('peru', 'violet') and i_manager_id BETWEEN 51 and 70 and ss_list_price between 55 and 69 and ca_state in ('AL','MI') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('peru', 'violet') and i_manager_id BETWEEN 51 and 70 and ws_list_price between 55 and 69 and ca_state in ('AL','MI') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year ;"
772,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2000 and i_manager_id BETWEEN 9 and 28 AND i_category IN ('Books', 'Children', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2000 and ss_wholesale_cost BETWEEN 16 AND 26  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1932 AND 1938 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2000 and d_moy = 1 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 16 AND 26 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2000 and d_moy = 1 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 16 AND 26) tmp2 limit 100 ;"
773,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'W' and  cd_education_status = 'Unknown' and  d_year = 2001 and  s_state = 'NE' and i_category = 'Home'  ;"
774,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,avg(ss_net_profit) as store_sales_profit ,avg(sr_net_loss) as store_returns_loss ,avg(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
775,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('navajo', 'purple') and i_manager_id BETWEEN 81 and 100 and ss_list_price between 17 and 31 and ca_state in ('MD','WI') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('navajo', 'purple') and i_manager_id BETWEEN 81 and 100 and ws_list_price between 17 and 31 and ca_state in ('MD','WI') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q1_q2_increase ;"
776,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 70 and 79 and wr_return_amt / wr_return_quantity between 253 and 282 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AL', 'NE', 'NY', 'OK')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (8, 28) and c_birth_year BETWEEN 1955 AND 1961 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
777,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Advanced Degree' and c_current_addr_sk = ca_address_sk and d_year = 1999 and c_birth_month = 9 and ca_state in ('GA', 'MN', 'TX') and cs_wholesale_cost BETWEEN 43 AND 48 AND i_category = 'Home' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
778,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1184 and 1184+11 and ss_sales_price / ss_list_price BETWEEN 32 * 0.01 AND 42 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1184 and 1184+11 and ss_sales_price / ss_list_price BETWEEN 32 * 0.01 AND 42 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 15 and 19  and s_state in ('CO','ID','TX') order by s_store_name, i_item_desc limit 100 ;"
779,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 20 and 29 and wr_return_amt / wr_return_quantity between 241 and 270 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('FL', 'IL', 'KY', 'VA')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (12, 22) and c_birth_year BETWEEN 1965 AND 1971 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
780,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 2002  ;"
781,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1214 and 1214+11 and ss_list_price between 145 and 174 and c_birth_year BETWEEN 1961 AND 1967 and ss_wholesale_cost BETWEEN 75 AND 85 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1214 and 1214+11 and cs_list_price between 145 and 174 and c_birth_year BETWEEN 1961 AND 1967 and cs_wholesale_cost BETWEEN 75 AND 85 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1214 and 1214+11 and ws_list_price between 145 and 174 and c_birth_year BETWEEN 1961 AND 1967 and ws_wholesale_cost BETWEEN 75 AND 85 ) ) cool_cust  ;"
782,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1193 and 1193 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 112 and 141 and sm_type = 'REGULAR' and cc_class = 'medium' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
783,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2000 and sr_return_amt / sr_return_quantity between 241 and 300 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 28 AND 31 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('MO', 'ND', 'OK') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'S') and cd_education_status IN ('4 yr Degree', 'Advanced Degree') and cd_gender = 'F' and c_birth_month = 11 and c_birth_year BETWEEN 1925 AND 1931 order by c_customer_id limit 100 ;"
784,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('purple', 'slate') and i_manager_id BETWEEN 35 and 54 and ss_list_price between 139 and 153 and ca_state in ('MO','MS') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('purple', 'slate') and i_manager_id BETWEEN 35 and 54 and ws_list_price between 139 and 153 and ca_state in ('MO','MS') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q1_q2_increase ;"
785,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1210 and 1210 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 211 and 240 and sm_type = 'NEXT DAY' and cc_class = 'medium' and w_gmt_offset = -5  ;"
786,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1212 and 1212 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 13 and 42 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5  ;"
787,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1213 and 1213+11 and ss_list_price between 256 and 285 and c_birth_year BETWEEN 1959 AND 1965 and ss_wholesale_cost BETWEEN 82 AND 92 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1213 and 1213+11 and cs_list_price between 256 and 285 and c_birth_year BETWEEN 1959 AND 1965 and cs_wholesale_cost BETWEEN 82 AND 92 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1213 and 1213+11 and ws_list_price between 256 and 285 and c_birth_year BETWEEN 1959 AND 1965 and ws_wholesale_cost BETWEEN 82 AND 92 ) ) cool_cust  ;"
788,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2001 and i_manager_id BETWEEN 66 and 85 AND i_category IN ('Children', 'Jewelry', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and ss_wholesale_cost BETWEEN 62 AND 72  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1965 AND 1971 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2001 and d_moy = 12 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 62 AND 72 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2001 and d_moy = 12 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 62 AND 72) tmp2 limit 100 ;"
789,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'TX', 'WI') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('ID', 'OK', 'VT') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('ID', 'ME', 'NM') and ss_net_profit between 50 and 250 ))  ;"
790,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 8 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 8 and 8 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 8 and 8 + 2 and d3.d_year  = 2002  ;"
791,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1180 and 1180 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 23 and 52 and sm_type = 'REGULAR' and cc_class = 'large' and w_gmt_offset = -5  ;"
792,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=1998 and d_moy = 12 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'WV' and c_birth_month = 6 and ss_wholesale_cost BETWEEN 31 AND 51  ;"
793,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 1 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 1 and 1 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 1 and 1 + 2 and d3.d_year  = 2002  ;"
794,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=2002 and d_moy = 11 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'SC' and c_birth_month = 4 and ss_wholesale_cost BETWEEN 80 AND 100  ;"
795,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 9 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
796,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Primary' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 6 and  ca_state in ('AK', 'AZ', 'VA')  and cs_wholesale_cost BETWEEN 52 AND 57  AND i_category = 'Women'  ;"
797,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Primary' and  c_current_addr_sk = ca_address_sk and  d_year = 2002 and  c_birth_month = 9 and  ca_state in ('AR', 'OR', 'TX')  and cs_wholesale_cost BETWEEN 13 AND 18  AND i_category = 'Jewelry'  ;"
798,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('PA', 'TN', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CO', 'CT', 'MN') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'CO', 'MI') and ss_net_profit between 50 and 250 ))  ;"
799,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = '4 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2002 and c_birth_month = 7 and ca_state in ('IL', 'TN', 'WA') and cs_wholesale_cost BETWEEN 66 AND 71 AND i_category = 'Children' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
800,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1190 and 1190 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 58 and 87 and sm_type = 'EXPRESS' and cc_class = 'large' and w_gmt_offset = -5  ;"
801,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212+11 and ss_list_price between 183 and 212 and c_birth_year BETWEEN 1928 AND 1934 and ss_wholesale_cost BETWEEN 10 AND 20 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212+11 and cs_list_price between 183 and 212 and c_birth_year BETWEEN 1928 AND 1934 and cs_wholesale_cost BETWEEN 10 AND 20 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212+11 and ws_list_price between 183 and 212 and c_birth_year BETWEEN 1928 AND 1934 and ws_wholesale_cost BETWEEN 10 AND 20 ) ) cool_cust  ;"
802,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Oak Ridge' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 5797 and ib_upper_bound <= 5797 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
803,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1191 and 1191 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 12 and 41 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5  ;"
804,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 2001  ;"
805,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('IN','NM','WY') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'M', 'M') and cd_education_status in ('Unknown', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 3 and 3+2  and ss_list_price between 13 and 102 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 3 and 3+2  and ws_list_price between 13 and 102  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 3 and 3+2  and cs_list_price between 13 and 102)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
806,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AL', 'IL', 'NY') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('LA', 'MN', 'MO') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'MA', 'UT') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
807,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'MN', 'WV') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'KY', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'NY', 'TX') and ss_net_profit between 50 and 250 ))  ;"
808,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 211 and 270 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 3 AND 6 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AL', 'GA', 'NC') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'W') and cd_education_status IN ('Unknown', '4 yr Degree') and cd_gender = 'F' and c_birth_month = 2 and c_birth_year BETWEEN 1930 AND 1936 order by c_customer_id limit 100 ;"
809,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IA', 'OK', 'OR') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'NC', 'NY') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'OK', 'TX') and ws_net_profit between 50 and 250 ) )  ;"
810,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('salmon', 'spring') and i_manager_id BETWEEN 5 and 24 and ss_list_price between 132 and 146 and ca_state in ('KS','WI') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('salmon', 'spring') and i_manager_id BETWEEN 5 and 24 and ws_list_price between 132 and 146 and ca_state in ('KS','WI') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2002 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2002 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2002 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2002 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2002 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2002 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q2_q3_increase ;"
811,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2000 and d_moy  = 7 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
812,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1998-03-14','1998-06-06','1998-08-04','1998-11-01'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Sports', 'Women') and i_manager_id BETWEEN 38 and 47 and sr_return_amt / sr_return_quantity between 193 and 222 and sr_reason_sk in (8, 61, 65, 67, 69) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-03-14','1998-06-06','1998-08-04','1998-11-01'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Sports', 'Women') and i_manager_id BETWEEN 38 and 47 and cr_return_amount / cr_return_quantity between 193 and 222 and cr_reason_sk in (8, 61, 65, 67, 69) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-03-14','1998-06-06','1998-08-04','1998-11-01'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Sports', 'Women') and i_manager_id BETWEEN 38 and 47 and wr_return_amt / wr_return_quantity between 193 and 222 and wr_reason_sk in (8, 61, 65, 67, 69) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
813,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 14 and 23 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 14 and 23 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 80 AND 100 and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 14 and 23 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and ss_wholesale_cost BETWEEN 80 AND 100  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and cs_wholesale_cost BETWEEN 80 AND 100  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 80 AND 100 and d_year between 1999 and 1999 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999 + 1   and d_moy = 12   and d_dom = 8) and i_category IN ('Children', 'Jewelry', 'Women') and i_manager_id BETWEEN 14 and 23 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999   and d_moy = 12   and d_dom = 8) and i_category IN ('Children', 'Jewelry', 'Women') and ss_wholesale_cost BETWEEN 80 AND 100 and i_manager_id BETWEEN 14 and 23 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
814,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 16 AND 36 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 2 and 2 + 10 and p_channel_email = 'Y' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('MO','NM','VT') and ss_wholesale_cost BETWEEN 16 AND 36 and cd1.cd_marital_status in ('W', 'S', 'W') and cd1.cd_education_status in ('Secondary', '4 yr Degree', '2 yr Degree') and cd2.cd_marital_status in ('W', 'S', 'W') and cd2.cd_education_status in ('Secondary', '4 yr Degree', '2 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
815,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 9 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 9 and 9 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 9 and 9 + 2 and d3.d_year  = 1999  ;"
816,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('AK','NV','NY') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'S', 'S') and cd_education_status in ('2 yr Degree', 'Secondary') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 8 and 8+2  and ss_list_price between 119 and 208 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 8 and 8+2  and ws_list_price between 119 and 208  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 8 and 8+2  and cs_list_price between 119 and 208)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
817,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1192 and 1192 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 45 and 74 and sm_type = 'REGULAR' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
818,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = '2 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2001 and c_birth_month = 7 and ca_state in ('MN', 'NC', 'NE') and cs_wholesale_cost BETWEEN 95 AND 100 AND i_category = 'Music' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
819,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1224 and 1224 + 11 and c_birth_month in (1, 4, 5, 11) and ss_list_price between 87 and 146 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1224 and 1224 + 11 and c_birth_month in (1, 4, 5, 11) and cs_list_price between 87 and 146 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1224 and 1224 + 11 and c_birth_month in (1, 4, 5, 11) and ws_list_price between 87 and 146 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
820,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Secondary' and c_current_addr_sk = ca_address_sk and d_year = 1999 and c_birth_month = 6 and ca_state in ('IL', 'ME', 'MN') and cs_wholesale_cost BETWEEN 19 AND 24 AND i_category = 'Children' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
821,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'College' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Primary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'MS', 'ND') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'OR', 'TX') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'MN', 'TX') and ss_net_profit between 50 and 250 ))  ;"
822,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1192 and 1192 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 127 and 156 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5  ;"
823,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189+11 and ss_list_price between 96 and 125 and c_birth_year BETWEEN 1960 AND 1966 and ss_wholesale_cost BETWEEN 39 AND 49 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189+11 and cs_list_price between 96 and 125 and c_birth_year BETWEEN 1960 AND 1966 and cs_wholesale_cost BETWEEN 39 AND 49 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189+11 and ws_list_price between 96 and 125 and c_birth_year BETWEEN 1960 AND 1966 and ws_wholesale_cost BETWEEN 39 AND 49 ) ) cool_cust  ;"
824,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'FL', 'UT') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NC', 'OH', 'TN') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('ID', 'MN', 'NY') and ss_net_profit between 50 and 250 ))  ;"
825,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1178 and 1178+11 and ss_sales_price / ss_list_price BETWEEN 82 * 0.01 AND 92 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1178 and 1178+11 and ss_sales_price / ss_list_price BETWEEN 82 * 0.01 AND 92 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 84 and 88  and s_state in ('AL','GA','UT') order by s_store_name, i_item_desc limit 100 ;"
826,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-03-16')) and ss_sold_date_sk = d_date_sk and ss_list_price between 83 and 112 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1981 AND 1987 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-03-16')) and cs_sold_date_sk = d_date_sk and cs_list_price between 83 and 112 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1981 AND 1987 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-03-16')) and ws_sold_date_sk = d_date_sk and ws_list_price between 83 and 112 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1981 AND 1987 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
827,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'MT', 'RI') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'IL', 'NY') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AK', 'FL', 'VA') and ss_net_profit between 50 and 250 ))  ;"
828,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 5 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
829,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 36 * 0.01 AND 56 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1179 and 1179 + 11  and s_state in ('IL','MD','NC'   ,'NH','OH','TN','WI','WV')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1179+ 12 and 1179 + 23  and s_state in ('IL','MD','NC'   ,'NH','OH','TN','WI','WV')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
830,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('plum', 'rose') and i_manager_id BETWEEN 75 and 94 and ss_list_price between 199 and 213 and ca_state in ('WA','WY') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('plum', 'rose') and i_manager_id BETWEEN 75 and 94 and ws_list_price between 199 and 213 and ca_state in ('WA','WY') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q1_q2_increase ;"
831,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 80 * 0.01 AND 100 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1186 and 1186 + 11  and s_state in ('AL','AR','CT'   ,'IN','KY','MI','OR','WV')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1186+ 12 and 1186 + 23  and s_state in ('AL','AR','CT'   ,'IN','KY','MI','OR','WV')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
832,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('AK','TX','VA') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'M', 'M') and cd_education_status in ('Advanced Degree', 'Advanced Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 2 and 2+2  and ss_list_price between 211 and 300 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 2 and 2+2  and ws_list_price between 211 and 300  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 2 and 2+2  and cs_list_price between 211 and 300)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
833,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1185 and 1185+11 and ss_sales_price / ss_list_price BETWEEN 16 * 0.01 AND 26 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1185 and 1185+11 and ss_sales_price / ss_list_price BETWEEN 16 * 0.01 AND 26 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 66 and 70  and s_state in ('IL','NM','TN') order by s_store_name, i_item_desc limit 100 ;"
834,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-04-30')) and ss_sold_date_sk = d_date_sk and ss_list_price between 157 and 186 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1950 AND 1956 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-04-30')) and cs_sold_date_sk = d_date_sk and cs_list_price between 157 and 186 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1950 AND 1956 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-04-30')) and ws_sold_date_sk = d_date_sk and ws_list_price between 157 and 186 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1950 AND 1956 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
835,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 22 and 81 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 7 AND 10 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('ID', 'NC', 'SD') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('U', 'U') and cd_education_status IN ('Advanced Degree', 'Advanced Degree') and cd_gender = 'M' and c_birth_month = 4 and c_birth_year BETWEEN 1945 AND 1951 order by c_customer_id limit 100 ;"
836,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('AL','IL','VA') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'W', 'S') and cd_education_status in ('2 yr Degree', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 7 and 7+2  and ss_list_price between 59 and 148 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 7 and 7+2  and ws_list_price between 59 and 148  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 7 and 7+2  and cs_list_price between 59 and 148)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
837,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 7 AND 27 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 59 and 59 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('IL','KS','SD') and ss_wholesale_cost BETWEEN 7 AND 27 and cd1.cd_marital_status in ('U', 'U', 'M') and cd1.cd_education_status in ('Advanced Degree', 'Secondary', 'Advanced Degree') and cd2.cd_marital_status in ('U', 'U', 'M') and cd2.cd_education_status in ('Advanced Degree', 'Secondary', 'Advanced Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1999 and cs2.syear = 1999 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
838,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Unknown' and d_year = 2000 and s_state = 'AZ' and i_category = 'Books' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
839,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Children') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 149 and 163 and s2.ss_list_price between 149 and 163 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
840,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=2001 and d_moy = 12 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'OR' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 70 AND 90 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
841,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Men') and item2.i_manager_id between 38 and 57 and cd_marital_status = 'M' and cd_education_status = 'Secondary' and s1.ss_list_price between 278 and 292 and s2.ss_list_price between 278 and 292 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
842,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IA', 'NE', 'NY') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'KY', 'MO') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CA', 'OK', 'WI') and ss_net_profit between 50 and 250 ))  ;"
843,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'M' and cd_education_status = 'Secondary' and d_year = 2002 and s_state = 'KS' and i_category = 'Jewelry' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
844,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1192 and 1192+11 and ss_list_price between 35 and 64 and c_birth_year BETWEEN 1944 AND 1950 and ss_wholesale_cost BETWEEN 74 AND 84 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1192 and 1192+11 and cs_list_price between 35 and 64 and c_birth_year BETWEEN 1944 AND 1950 and cs_wholesale_cost BETWEEN 74 AND 84 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1192 and 1192+11 and ws_list_price between 35 and 64 and c_birth_year BETWEEN 1944 AND 1950 and ws_wholesale_cost BETWEEN 74 AND 84 ) ) cool_cust  ;"
845,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1212 and 1212+11 and ss_sales_price / ss_list_price BETWEEN 13 * 0.01 AND 23 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1212 and 1212+11 and ss_sales_price / ss_list_price BETWEEN 13 * 0.01 AND 23 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 88 and 92  and s_state in ('KS','NC','RI') order by s_store_name, i_item_desc limit 100 ;"
846,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1207 and 1207 + 11 and c_birth_month in (1, 2, 5, 8) and ss_list_price between 105 and 164 and ss_wholesale_cost BETWEEN 75 AND 95 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1207 and 1207 + 11 and c_birth_month in (1, 2, 5, 8) and cs_list_price between 105 and 164 and cs_wholesale_cost BETWEEN 75 AND 95 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1207 and 1207 + 11 and c_birth_month in (1, 2, 5, 8) and ws_list_price between 105 and 164 and ws_wholesale_cost BETWEEN 75 AND 95 ) hot_cust limit 100 ;"
847,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 11 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
848,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'MD'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
849,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AR', 'KS', 'OH') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('PA', 'TN', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('CO', 'CT', 'MN') and ws_net_profit between 50 and 250 ) )  ;"
850,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 36 AND 56 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 78 and 78 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('MD','MS','UT') and ss_wholesale_cost BETWEEN 36 AND 56 and cd1.cd_marital_status in ('M', 'U', 'M') and cd1.cd_education_status in ('Advanced Degree', 'Secondary', 'Secondary') and cd2.cd_marital_status in ('M', 'U', 'M') and cd2.cd_education_status in ('Advanced Degree', 'Secondary', 'Secondary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
851,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 18 * 0.01 AND 38 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1210 and 1210 + 11  and s_state in ('IL','KS','KY'   ,'MN','MS','MT','OH','TN')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1210+ 12 and 1210 + 23  and s_state in ('IL','KS','KY'   ,'MN','MS','MT','OH','TN')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
852,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1182 and 1182+11 and ss_list_price between 127 and 156 and c_birth_year BETWEEN 1973 AND 1979 and ss_wholesale_cost BETWEEN 78 AND 88 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1182 and 1182+11 and cs_list_price between 127 and 156 and c_birth_year BETWEEN 1973 AND 1979 and cs_wholesale_cost BETWEEN 78 AND 88 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1182 and 1182+11 and ws_list_price between 127 and 156 and c_birth_year BETWEEN 1973 AND 1979 and ws_wholesale_cost BETWEEN 78 AND 88 ) ) cool_cust  ;"
853,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = 'Unknown' and  c_current_addr_sk = ca_address_sk and  d_year = 1999 and  c_birth_month = 3 and  ca_state in ('CA', 'KS', 'SC')  and cs_wholesale_cost BETWEEN 53 AND 58  AND i_category = 'Jewelry'  ;"
854,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Electronics' and d_year=1998 and d_moy = 11 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'NJ' and c_birth_month = 4 and ss_wholesale_cost BETWEEN 0 AND 20 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
855,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('moccasin', 'royal') and i_manager_id BETWEEN 53 and 72 and ss_list_price between 132 and 146 and ca_state in ('IN','NM') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('moccasin', 'royal') and i_manager_id BETWEEN 53 and 72 and ws_list_price between 132 and 146 and ca_state in ('IN','NM') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q1_q2_increase ;"
856,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Home' and d_year=2001 and d_moy = 10 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'IL' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 21 AND 41 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
857,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 and sr_return_amt / sr_return_quantity between 11 and 70 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 64 AND 67 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('NC', 'NJ', 'WV') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'W') and cd_education_status IN ('4 yr Degree', '2 yr Degree') and cd_gender = 'M' and c_birth_month = 7 and c_birth_year BETWEEN 1962 AND 1968 order by c_customer_id limit 100 ;"
858,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Atkinson County','Cumberland County','Huron County','Jefferson Parish','Rockingham County') and c.c_birth_month in (9, 11) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'W', 'S') and cd_education_status in ('4 yr Degree', 'Secondary', 'Primary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 8 and 8+3 and  ss_item_sk = i_item_sk and  i_category in ('Home', 'Shoes', 'Women')  and ss_sales_price / ss_list_price BETWEEN 39 * 0.01 AND 49 * 0.01  and i_manager_id BETWEEN 32 and 41  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 8 ANd 8+3 and  ws_item_sk = i_item_sk and  i_category in ('Home', 'Shoes', 'Women')  and i_manager_id BETWEEN 32 and 41  and ws_sales_price / ws_list_price BETWEEN 39 * 0.01 AND 49 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 8 and 8+3 and  cs_item_sk = i_item_sk and  i_category in ('Home', 'Shoes', 'Women')  and i_manager_id BETWEEN 32 and 41  and cs_sales_price / cs_list_price BETWEEN 39 * 0.01 AND 49 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
859,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'FL', 'UT') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NC', 'OH', 'TN') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('ID', 'MN', 'NY') and ss_net_profit between 50 and 250 ))  ;"
860,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2000 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'MN'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
861,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Home' and d_year=2002 and d_moy = 5 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'TN' and c_birth_month = 5 and ss_wholesale_cost BETWEEN 74 AND 94 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
862,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Shoes' and d_year=1999 and d_moy = 4 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'KS' and c_birth_month = 3 and ss_wholesale_cost BETWEEN 53 AND 73  ;"
863,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'Primary' and d_year = 1999 and s_state = 'MI' and i_category = 'Home' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
864,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '2 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2002 and  c_birth_month = 6 and  ca_state in ('KS', 'MO', 'MS')  and cs_wholesale_cost BETWEEN 56 AND 61  AND i_category = 'Women'  ;"
865,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,stddev_samp(ss_net_profit) as store_sales_profit ,stddev_samp(sr_net_loss) as store_returns_loss ,stddev_samp(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 8 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 8 and 8 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 8 and 8 + 2 and d3.d_year  = 1998 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
866,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Home', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 49 and 58 and ss_wholesale_cost BETWEEN 25 AND 45 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Home', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 49 and 58 and cs_wholesale_cost BETWEEN 25 AND 45 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 25 AND 45 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Home', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 49 and 58 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 25 AND 45  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 25 AND 45  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 25 AND 45 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 20) and i_category IN ('Home', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 49 and 58 and ss_wholesale_cost BETWEEN 25 AND 45 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 20) and i_category IN ('Home', 'Jewelry', 'Shoes') and ss_wholesale_cost BETWEEN 25 AND 45 and i_manager_id BETWEEN 49 and 58 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
867,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1194 and 1194 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 228 and 257 and sm_type = 'EXPRESS' and cc_class = 'large' and w_gmt_offset = -5  ;"
868,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Books', 'Children', 'Jewelry') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 13 AND 23  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1944 AND 1950 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1999 and d_moy = 5 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 13 AND 23 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1999 and d_moy = 5 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 13 AND 23) tmp2 limit 100 ;"
869,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('forest', 'orange') and i_manager_id BETWEEN 81 and 100 and ss_list_price between 15 and 29 and ca_state in ('GA','MN') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('forest', 'orange') and i_manager_id BETWEEN 81 and 100 and ws_list_price between 15 and 29 and ca_state in ('GA','MN') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q1_q2_increase ;"
870,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'TN'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
871,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11 and ss_list_price between 260 and 289 and c_birth_year BETWEEN 1961 AND 1967 and ss_wholesale_cost BETWEEN 90 AND 100 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11 and cs_list_price between 260 and 289 and c_birth_year BETWEEN 1961 AND 1967 and cs_wholesale_cost BETWEEN 90 AND 100 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11 and ws_list_price between 260 and 289 and c_birth_year BETWEEN 1961 AND 1967 and ws_wholesale_cost BETWEEN 90 AND 100 ) ) cool_cust  ;"
872,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1183 and 1183+11 and ss_sales_price / ss_list_price BETWEEN 65 * 0.01 AND 75 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1183 and 1183+11 and ss_sales_price / ss_list_price BETWEEN 65 * 0.01 AND 75 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 5 and 9  and s_state in ('IA','MN','TN') order by s_store_name, i_item_desc limit 100 ;"
873,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 12 AND 32 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 66 and 66 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('IL','KS','VA') and ss_wholesale_cost BETWEEN 12 AND 32 and cd1.cd_marital_status in ('M', 'S', 'M') and cd1.cd_education_status in ('Unknown', '4 yr Degree', 'Unknown') and cd2.cd_marital_status in ('M', 'S', 'M') and cd2.cd_education_status in ('Unknown', '4 yr Degree', 'Unknown') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
874,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=1999 and d_moy = 6 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MO' and c_birth_month = 1 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
875,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
876,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1196 and 1196 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 156 and 185 and sm_type = 'TWO DAY' and cc_class = 'large' and w_gmt_offset = -5  ;"
877,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_STORE_CREDIT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 203 and 262 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 44 AND 47 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('GA', 'MT', 'NE') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'W') and cd_education_status IN ('4 yr Degree', '4 yr Degree') and cd_gender = 'M' and c_birth_month = 4 and c_birth_year BETWEEN 1952 AND 1958 order by c_customer_id limit 100 ;"
878,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = '4 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2002 and c_birth_month = 3 and ca_state in ('SD', 'TN', 'TX') and cs_wholesale_cost BETWEEN 88 AND 93 AND i_category = 'Home' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
879,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'MS', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'IL', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'NE', 'WV') and ss_net_profit between 50 and 250 ))  ;"
880,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Shoes' and d_year=1998 and d_moy = 2 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'CT' and c_birth_month = 5 and ss_wholesale_cost BETWEEN 55 AND 75  ;"
881,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('antique', 'smoke') and i_manager_id BETWEEN 81 and 100 and ss_list_price between 88 and 102 and ca_state in ('MS','NC') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('antique', 'smoke') and i_manager_id BETWEEN 81 and 100 and ws_list_price between 88 and 102 and ca_state in ('MS','NC') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q1_q2_increase ;"
882,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'MO', 'NC') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NJ', 'NY', 'SC') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'KS', 'WI') and ss_net_profit between 50 and 250 ))  ;"
883,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-06-17')) and ss_sold_date_sk = d_date_sk and ss_list_price between 109 and 138 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1931 AND 1937 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-06-17')) and cs_sold_date_sk = d_date_sk and cs_list_price between 109 and 138 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1931 AND 1937 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-06-17')) and ws_sold_date_sk = d_date_sk and ws_list_price between 109 and 138 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1931 AND 1937 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
884,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '2 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 3 and  ca_state in ('KY', 'MT', 'OH')  and cs_wholesale_cost BETWEEN 56 AND 61  AND i_category = 'Children'  ;"
885,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-06-03')) and ss_sold_date_sk = d_date_sk and ss_list_price between 224 and 253 and i_manager_id BETWEEN 4 and 33 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1958 AND 1964 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-06-03')) and cs_sold_date_sk = d_date_sk and cs_list_price between 224 and 253 and i_manager_id BETWEEN 4 and 33 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1958 AND 1964 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-06-03')) and ws_sold_date_sk = d_date_sk and ws_list_price between 224 and 253 and i_manager_id BETWEEN 4 and 33 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1958 AND 1964 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
886,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MO', 'MS', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'MI', 'WV') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('FL', 'ID', 'WI') and ws_net_profit between 50 and 250 ) )  ;"
887,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Butler County','Grant County','Haskell County','Pulaski County','Williamson County') and c.c_birth_month in (9, 11) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'W', 'W') and cd_education_status in ('2 yr Degree', 'Advanced Degree', 'Secondary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Electronics', 'Home')  and ss_sales_price / ss_list_price BETWEEN 38 * 0.01 AND 48 * 0.01  and i_manager_id BETWEEN 88 and 97  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 ANd 7+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Electronics', 'Home')  and i_manager_id BETWEEN 88 and 97  and ws_sales_price / ws_list_price BETWEEN 38 * 0.01 AND 48 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Electronics', 'Home')  and i_manager_id BETWEEN 88 and 97  and cs_sales_price / cs_list_price BETWEEN 38 * 0.01 AND 48 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
888,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Children', 'Women') and i_manager_id BETWEEN 13 and 22 and ss_wholesale_cost BETWEEN 78 AND 98 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Children', 'Women') and i_manager_id BETWEEN 13 and 22 and cs_wholesale_cost BETWEEN 78 AND 98 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 78 AND 98 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Children', 'Women') and i_manager_id BETWEEN 13 and 22 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 78 AND 98  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 78 AND 98  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 78 AND 98 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 20) and i_category IN ('Books', 'Children', 'Women') and i_manager_id BETWEEN 13 and 22 and ss_wholesale_cost BETWEEN 78 AND 98 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 20) and i_category IN ('Books', 'Children', 'Women') and ss_wholesale_cost BETWEEN 78 AND 98 and i_manager_id BETWEEN 13 and 22 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
889,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1179 and 1179 + 11 and c_birth_month in (1, 2, 5, 7) and ss_list_price between 216 and 275 and ss_wholesale_cost BETWEEN 44 AND 64 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1179 and 1179 + 11 and c_birth_month in (1, 2, 5, 7) and cs_list_price between 216 and 275 and cs_wholesale_cost BETWEEN 44 AND 64 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1179 and 1179 + 11 and c_birth_month in (1, 2, 5, 7) and ws_list_price between 216 and 275 and ws_wholesale_cost BETWEEN 44 AND 64 ) hot_cust limit 100 ;"
890,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1182 and 1182+11 and ss_list_price between 51 and 80 and c_birth_year BETWEEN 1942 AND 1948 and ss_wholesale_cost BETWEEN 25 AND 35 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1182 and 1182+11 and cs_list_price between 51 and 80 and c_birth_year BETWEEN 1942 AND 1948 and cs_wholesale_cost BETWEEN 25 AND 35 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1182 and 1182+11 and ws_list_price between 51 and 80 and c_birth_year BETWEEN 1942 AND 1948 and ws_wholesale_cost BETWEEN 25 AND 35 ) ) cool_cust  ;"
891,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-05-25')) and ss_sold_date_sk = d_date_sk and ss_list_price between 167 and 196 and i_manager_id BETWEEN 18 and 47 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1925 AND 1931 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-05-25')) and cs_sold_date_sk = d_date_sk and cs_list_price between 167 and 196 and i_manager_id BETWEEN 18 and 47 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1925 AND 1931 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-05-25')) and ws_sold_date_sk = d_date_sk and ws_list_price between 167 and 196 and i_manager_id BETWEEN 18 and 47 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1925 AND 1931 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
892,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1191 and 1191 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 271 and 300 and sm_type = 'OVERNIGHT' and cc_class = 'large' and w_gmt_offset = -5  ;"
893,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'KY'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
894,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 38 and 47 and wr_return_amt / wr_return_quantity between 20 and 49 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CO', 'NE', 'NY', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (11, 41) and c_birth_year BETWEEN 1963 AND 1969 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
895,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'NH', 'NM') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('CO', 'OH', 'WV') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('OH', 'SC', 'TN') and ws_net_profit between 50 and 250 ) )  ;"
896,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2001 and i_manager_id BETWEEN 40 and 59 AND i_category IN ('Children', 'Home', 'Jewelry') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and ss_wholesale_cost BETWEEN 42 AND 52  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1963 AND 1969 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2001 and d_moy = 5 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 42 AND 52 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2001 and d_moy = 5 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 42 AND 52) tmp2 limit 100 ;"
897,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Iron County','Potter County','Thomas County','Toombs County','Williamson County') and c.c_birth_month in (3, 10) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'U', 'M') and cd_education_status in ('4 yr Degree', 'Secondary', 'Unknown') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 1 and 1+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Jewelry')  and ss_sales_price / ss_list_price BETWEEN 8 * 0.01 AND 18 * 0.01  and i_manager_id BETWEEN 24 and 33  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 1 ANd 1+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Jewelry')  and i_manager_id BETWEEN 24 and 33  and ws_sales_price / ws_list_price BETWEEN 8 * 0.01 AND 18 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 1 and 1+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Jewelry')  and i_manager_id BETWEEN 24 and 33  and cs_sales_price / cs_list_price BETWEEN 8 * 0.01 AND 18 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
898,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 36 * 0.01 AND 56 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1192 and 1192 + 11  and s_state in ('IA','IL','KY'   ,'MN','NJ','SD','TN','TX')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1192+ 12 and 1192 + 23  and s_state in ('IA','IL','KY'   ,'MN','NJ','SD','TN','TX')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
899,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Summit' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 6 * 10000 and ib_upper_bound <= 6 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
900,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1215 and 1215 + 11 and c_birth_month in (6, 9, 11, 12) and ss_list_price between 8 and 67 and ss_wholesale_cost BETWEEN 36 AND 56 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1215 and 1215 + 11 and c_birth_month in (6, 9, 11, 12) and cs_list_price between 8 and 67 and cs_wholesale_cost BETWEEN 36 AND 56 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1215 and 1215 + 11 and c_birth_month in (6, 9, 11, 12) and ws_list_price between 8 and 67 and ws_wholesale_cost BETWEEN 36 AND 56 ) hot_cust limit 100 ;"
901,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Home' and d_year=2001 and d_moy = 10 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'OR' and c_birth_month = 12 and ss_wholesale_cost BETWEEN 51 AND 71 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
902,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1178 and 1178 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 153 and 182 and sm_type = 'REGULAR' and cc_class = 'small' and w_gmt_offset = -5  ;"
903,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 10 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -7  ;"
904,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('KY','MO','NE') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'W', 'W') and cd_education_status in ('Secondary', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 1 and 1+2  and ss_list_price between 59 and 148 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 1 and 1+2  and ws_list_price between 59 and 148  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 1 and 1+2  and cs_list_price between 59 and 148)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
905,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Primary' and  c_current_addr_sk = ca_address_sk and  d_year = 2001 and  c_birth_month = 9 and  ca_state in ('AR', 'IL', 'KS')  and cs_wholesale_cost BETWEEN 24 AND 29  AND i_category = 'Children'  ;"
906,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('khaki', 'thistle') and i_manager_id BETWEEN 77 and 96 and ss_list_price between 263 and 277 and ca_state in ('TN','WI') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('khaki', 'thistle') and i_manager_id BETWEEN 77 and 96 and ws_list_price between 263 and 277 and ca_state in ('TN','WI') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q2_q3_increase ;"
907,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1200 and 1200+11 and ss_sales_price / ss_list_price BETWEEN 23 * 0.01 AND 33 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1200 and 1200+11 and ss_sales_price / ss_list_price BETWEEN 23 * 0.01 AND 33 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 80 and 84  and s_state in ('NC','NH','WV') order by s_store_name, i_item_desc limit 100 ;"
908,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Women') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 228 and 242 and s2.ss_list_price between 228 and 242  ;"
909,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2000 and i_manager_id BETWEEN 47 and 66 AND i_category IN ('Children', 'Home', 'Jewelry') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2000 and ss_wholesale_cost BETWEEN 63 AND 73  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1985 AND 1991 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2000 and d_moy = 9 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 63 AND 73 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2000 and d_moy = 9 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 63 AND 73) tmp2 limit 100 ;"
910,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Advanced Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 7 and  ca_state in ('GA', 'HI', 'ID')  and cs_wholesale_cost BETWEEN 78 AND 83  AND i_category = 'Children'  ;"
911,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1208 and 1208+11 and ss_list_price between 203 and 232 and c_birth_year BETWEEN 1963 AND 1969 and ss_wholesale_cost BETWEEN 16 AND 26 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1208 and 1208+11 and cs_list_price between 203 and 232 and c_birth_year BETWEEN 1963 AND 1969 and cs_wholesale_cost BETWEEN 16 AND 26 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1208 and 1208+11 and ws_list_price between 203 and 232 and c_birth_year BETWEEN 1963 AND 1969 and ws_wholesale_cost BETWEEN 16 AND 26 ) ) cool_cust  ;"
912,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1197 and 1197 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 111 and 140 and sm_type = 'REGULAR' and cc_class = 'medium' and w_gmt_offset = -5  ;"
913,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1998-02-22','1998-06-03','1998-08-15','1998-11-20'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Women') and i_manager_id BETWEEN 83 and 92 and sr_return_amt / sr_return_quantity between 149 and 178 and sr_reason_sk in (9, 32, 38, 61, 70) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-02-22','1998-06-03','1998-08-15','1998-11-20'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Women') and i_manager_id BETWEEN 83 and 92 and cr_return_amount / cr_return_quantity between 149 and 178 and cr_reason_sk in (9, 32, 38, 61, 70) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-02-22','1998-06-03','1998-08-15','1998-11-20'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Women') and i_manager_id BETWEEN 83 and 92 and wr_return_amt / wr_return_quantity between 149 and 178 and wr_reason_sk in (9, 32, 38, 61, 70) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
914,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'MT', 'RI') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'IL', 'NY') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AK', 'FL', 'VA') and ss_net_profit between 50 and 250 ))  ;"
915,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Oakdale' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 55776 and ib_upper_bound <= 55776 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
916,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1184 and 1184 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 183 and 212 and sm_type = 'LIBRARY' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
917,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2000 and d_moy = 4 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'OH' and c_birth_month = 4 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
918,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'SC'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
919,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'TN', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'KY', 'NE') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CO', 'NM', 'TX') and ss_net_profit between 50 and 250 ))  ;"
920,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('chocolate', 'lime') and i_manager_id BETWEEN 18 and 37 and ss_list_price between 149 and 163 and ca_state in ('MN','NJ') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('chocolate', 'lime') and i_manager_id BETWEEN 18 and 37 and ws_list_price between 149 and 163 and ca_state in ('MN','NJ') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2001 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2001 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2001 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2001 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2001 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2001 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q1_q2_increase ;"
921,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Primary' and  c_current_addr_sk = ca_address_sk and  d_year = 2001 and  c_birth_month = 9 and  ca_state in ('MT', 'OR', 'SC')  and cs_wholesale_cost BETWEEN 80 AND 85  AND i_category = 'Children'  ;"
922,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Jewelry' and i_class = 'semi-precious' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 3 and d_year = 2000 and wholesale_cost BETWEEN 5 AND 35 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 5 AND 35  and s_state in ('DC','IA','KY'   ,'MN','OK','PA'   ,'SD','TN','WA'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 3)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
923,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = '2 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 1999 and c_birth_month = 6 and ca_state in ('AL', 'ID', 'IL') and cs_wholesale_cost BETWEEN 12 AND 17 AND i_category = 'Home' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
924,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 60 and 79 and cd_marital_status = 'W' and cd_education_status = 'Primary' and s1.ss_list_price between 135 and 149 and s2.ss_list_price between 135 and 149  ;"
925,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2000 and sr_return_amt / sr_return_quantity between 236 and 295 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 29 AND 32 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('IL', 'KS', 'OH') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'M') and cd_education_status IN ('4 yr Degree', 'Primary') and cd_gender = 'M' and c_birth_month = 2 and c_birth_year BETWEEN 1984 AND 1990 order by c_customer_id limit 100 ;"
926,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '2 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2001 and  c_birth_month = 7 and  ca_state in ('MN', 'NC', 'NE')  and cs_wholesale_cost BETWEEN 95 AND 100  AND i_category = 'Music'  ;"
927,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Home', 'Jewelry', 'Shoes') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 34 AND 44  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1945 AND 1951 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1999 and d_moy = 9 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 34 AND 44 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1999 and d_moy = 9 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 34 AND 44) tmp2 limit 100 ;"
928,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-03-23','2001-06-02','2001-07-23','2001-10-31'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Women') and i_manager_id BETWEEN 40 and 49 and sr_return_amt / sr_return_quantity between 153 and 182 and sr_reason_sk in (29, 31, 42, 54, 73) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-03-23','2001-06-02','2001-07-23','2001-10-31'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Women') and i_manager_id BETWEEN 40 and 49 and cr_return_amount / cr_return_quantity between 153 and 182 and cr_reason_sk in (29, 31, 42, 54, 73) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-03-23','2001-06-02','2001-07-23','2001-10-31'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Women') and i_manager_id BETWEEN 40 and 49 and wr_return_amt / wr_return_quantity between 153 and 182 and wr_reason_sk in (29, 31, 42, 54, 73) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
929,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1176 and 1176 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 35 and 64 and sm_type = 'LIBRARY' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
930,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Home') and item2.i_manager_id between 30 and 49 and cd_marital_status = 'S' and cd_education_status = 'Unknown' and s1.ss_list_price between 206 and 220 and s2.ss_list_price between 206 and 220  ;"
931,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('GA','MT','WV') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'M', 'S') and cd_education_status in ('Primary', 'Unknown') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 8 and 8+2  and ss_list_price between 190 and 279 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 8 and 8+2  and ws_list_price between 190 and 279  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 8 and 8+2  and cs_list_price between 190 and 279)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
932,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('brown', 'steel') and i_manager_id BETWEEN 72 and 91 and ss_list_price between 221 and 235 and ca_state in ('MS','NE') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('brown', 'steel') and i_manager_id BETWEEN 72 and 91 and ws_list_price between 221 and 235 and ca_state in ('MS','NE') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2001 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2001 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2001 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2001 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2001 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2001 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;"
933,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('chartreuse', 'moccasin') and i_manager_id BETWEEN 23 and 42 and ss_list_price between 229 and 243 and ca_state in ('NC','OH') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('chartreuse', 'moccasin') and i_manager_id BETWEEN 23 and 42 and ws_list_price between 229 and 243 and ca_state in ('NC','OH') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2001 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2001 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2001 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2001 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2001 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2001 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q1_q2_increase ;"
934,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Beauregard Parish','Iron County','Kemper County','Nash County','Ontonagon County') and c.c_birth_month in (6, 11) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'W', 'S') and cd_education_status in ('4 yr Degree', '4 yr Degree', '4 yr Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 7 and 7+3 and  ss_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Women')  and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  and i_manager_id BETWEEN 72 and 81  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 7 ANd 7+3 and  ws_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Women')  and i_manager_id BETWEEN 72 and 81  and ws_sales_price / ws_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 7 and 7+3 and  cs_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Women')  and i_manager_id BETWEEN 72 and 81  and cs_sales_price / cs_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
935,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Men' and i_class = 'shirts' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 10 and d_year = 2001 and wholesale_cost BETWEEN 47 AND 77 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 47 AND 77  and s_state in ('AR','IL','IN'   ,'MI','MN','MS'   ,'ND','NJ','PA'   ,'WV')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 10)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 10) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
936,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Women') and item2.i_manager_id between 13 and 32 and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 279 and 293 and s2.ss_list_price between 279 and 293  ;"
937,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2002 and i_manager_id BETWEEN 13 and 32 AND i_category IN ('Children', 'Home', 'Men') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and ss_wholesale_cost BETWEEN 6 AND 16  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1971 AND 1977 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2002 and d_moy = 9 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 6 AND 16 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2002 and d_moy = 9 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 6 AND 16) tmp2 limit 100 ;"
938,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1195 and 1195 + 11 and c_birth_month in (1, 4, 5, 7) and ss_list_price between 97 and 156 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1195 and 1195 + 11 and c_birth_month in (1, 4, 5, 7) and cs_list_price between 97 and 156 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1195 and 1195 + 11 and c_birth_month in (1, 4, 5, 7) and ws_list_price between 97 and 156 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
939,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2002-02-24','2002-05-16','2002-09-02','2002-11-12'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Sports', 'Women') and i_manager_id BETWEEN 91 and 100 and sr_return_amt / sr_return_quantity between 64 and 93 and sr_reason_sk in (38, 48, 57, 60, 72) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-02-24','2002-05-16','2002-09-02','2002-11-12'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Sports', 'Women') and i_manager_id BETWEEN 91 and 100 and cr_return_amount / cr_return_quantity between 64 and 93 and cr_reason_sk in (38, 48, 57, 60, 72) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-02-24','2002-05-16','2002-09-02','2002-11-12'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Sports', 'Women') and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 64 and 93 and wr_reason_sk in (38, 48, 57, 60, 72) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
940,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Women') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 119 and 133 and s2.ss_list_price between 119 and 133 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
941,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 8 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 8 and 8 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 8 and 8 + 2 and d3.d_year  = 1998  ;"
942,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IN', 'KY', 'MS') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('MI', 'NM', 'NY') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AL', 'GA', 'IL') and ws_net_profit between 50 and 250 ) )  ;"
943,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Children') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'S' and cd_education_status = 'Unknown' and s1.ss_list_price between 195 and 209 and s2.ss_list_price between 195 and 209 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
944,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Music') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 112 and 126 and s2.ss_list_price between 112 and 126 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
945,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Greenville' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 7 * 10000 and ib_upper_bound <= 7 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
946,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=1999 and d_moy = 9 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MI' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 62 AND 82  ;"
947,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1180 and 1180 + 11 and c_birth_month in (4, 7, 8, 9) and ss_list_price between 209 and 268 and ss_wholesale_cost BETWEEN 12 AND 32 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1180 and 1180 + 11 and c_birth_month in (4, 7, 8, 9) and cs_list_price between 209 and 268 and cs_wholesale_cost BETWEEN 12 AND 32 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1180 and 1180 + 11 and c_birth_month in (4, 7, 8, 9) and ws_list_price between 209 and 268 and ws_wholesale_cost BETWEEN 12 AND 32 ) hot_cust limit 100 ;"
948,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('NH','NM','OH') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'S', 'M') and cd_education_status in ('4 yr Degree', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 6 and 6+2  and ss_list_price between 211 and 300 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 6 and 6+2  and ws_list_price between 211 and 300  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 6 and 6+2  and cs_list_price between 211 and 300)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
949,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Humphreys County','Pope County','Putnam County','Rio Blanco County','Tipton County') and c.c_birth_month in (1, 7) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'S', 'W') and cd_education_status in ('Secondary', 'Advanced Degree', 'Advanced Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 7 and 7+3 and  ss_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Music')  and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  and i_manager_id BETWEEN 79 and 88  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 7 ANd 7+3 and  ws_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Music')  and i_manager_id BETWEEN 79 and 88  and ws_sales_price / ws_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 7 and 7+3 and  cs_item_sk = i_item_sk and  i_category in ('Home', 'Jewelry', 'Music')  and i_manager_id BETWEEN 79 and 88  and cs_sales_price / cs_list_price BETWEEN 90 * 0.01 AND 100 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
950,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CO', 'NC', 'WV') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'GA', 'NC') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'GA', 'IA') and ss_net_profit between 50 and 250 ))  ;"
951,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Secondary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Secondary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MN', 'VT', 'WA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MT', 'SC', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'GA', 'MO') and ss_net_profit between 50 and 250 ))  ;"
952,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'LA', 'OK') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'ME', 'NC') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IA', 'IL', 'MI') and ss_net_profit between 50 and 250 ))  ;"
953,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Cherokee County','McKean County','Midland County','Monmouth County','Poweshiek County') and c.c_birth_month in (9, 11) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'M', 'M') and cd_education_status in ('Secondary', 'Advanced Degree', 'Unknown') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 5 and 5+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Electronics', 'Women')  and ss_sales_price / ss_list_price BETWEEN 45 * 0.01 AND 55 * 0.01  and i_manager_id BETWEEN 56 and 65  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 5 ANd 5+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Electronics', 'Women')  and i_manager_id BETWEEN 56 and 65  and ws_sales_price / ws_list_price BETWEEN 45 * 0.01 AND 55 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 5 and 5+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Electronics', 'Women')  and i_manager_id BETWEEN 56 and 65  and cs_sales_price / cs_list_price BETWEEN 45 * 0.01 AND 55 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
954,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
955,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Advanced Degree' and c_current_addr_sk = ca_address_sk and d_year = 2002 and c_birth_month = 5 and ca_state in ('NJ', 'TN', 'WY') and cs_wholesale_cost BETWEEN 10 AND 15 AND i_category = 'Men' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
956,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Greenwood' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 52282 and ib_upper_bound <= 52282 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
957,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 82 and 91 and ss_wholesale_cost BETWEEN 49 AND 69 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 82 and 91 and cs_wholesale_cost BETWEEN 49 AND 69 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 49 AND 69 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 82 and 91 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 49 AND 69  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 49 AND 69  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 49 AND 69 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 6) and i_category IN ('Books', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 82 and 91 and ss_wholesale_cost BETWEEN 49 AND 69 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 6) and i_category IN ('Books', 'Jewelry', 'Shoes') and ss_wholesale_cost BETWEEN 49 AND 69 and i_manager_id BETWEEN 82 and 91 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
958,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'S' and cd_education_status = 'Unknown' and d_year = 2002 and s_state = 'CO' and i_category = 'Home' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
959,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('ID','NC','SD') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'U', 'U') and cd_education_status in ('Advanced Degree', 'Advanced Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 and 9+2  and ss_list_price between 127 and 216 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 and 9+2  and ws_list_price between 127 and 216  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 and 9+2  and cs_list_price between 127 and 216)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
960,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1998-03-14','1998-04-30','1998-08-19','1998-10-31'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Jewelry') and i_manager_id BETWEEN 91 and 100 and sr_return_amt / sr_return_quantity between 150 and 179 and sr_reason_sk in (24, 25, 31, 32, 54) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-03-14','1998-04-30','1998-08-19','1998-10-31'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Jewelry') and i_manager_id BETWEEN 91 and 100 and cr_return_amount / cr_return_quantity between 150 and 179 and cr_reason_sk in (24, 25, 31, 32, 54) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-03-14','1998-04-30','1998-08-19','1998-10-31'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Jewelry') and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 150 and 179 and wr_reason_sk in (24, 25, 31, 32, 54) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
961,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and d_year = 1998 and s_state = 'AR' and i_category = 'Shoes' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
962,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and d_year = 1999 and s_state = 'SD' and i_category = 'Home' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
963,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1207 and 1207 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 156 and 185 and sm_type = 'REGULAR' and cc_class = 'small' and w_gmt_offset = -5  ;"
964,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1210 and 1210+11 and ss_list_price between 90 and 119 and c_birth_year BETWEEN 1929 AND 1935 and ss_wholesale_cost BETWEEN 54 AND 64 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1210 and 1210+11 and cs_list_price between 90 and 119 and c_birth_year BETWEEN 1929 AND 1935 and cs_wholesale_cost BETWEEN 54 AND 64 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1210 and 1210+11 and ws_list_price between 90 and 119 and c_birth_year BETWEEN 1929 AND 1935 and ws_wholesale_cost BETWEEN 54 AND 64 ) ) cool_cust  ;"
965,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-01-23','2001-04-24','2001-08-24','2001-11-17'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Home') and i_manager_id BETWEEN 29 and 38 and sr_return_amt / sr_return_quantity between 6 and 35 and sr_reason_sk in (9, 33, 53, 56, 75) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-01-23','2001-04-24','2001-08-24','2001-11-17'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Home') and i_manager_id BETWEEN 29 and 38 and cr_return_amount / cr_return_quantity between 6 and 35 and cr_reason_sk in (9, 33, 53, 56, 75) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-01-23','2001-04-24','2001-08-24','2001-11-17'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Home') and i_manager_id BETWEEN 29 and 38 and wr_return_amt / wr_return_quantity between 6 and 35 and wr_reason_sk in (9, 33, 53, 56, 75) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
966,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('MI','PA','SD') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'S', 'M') and cd_education_status in ('Unknown', 'Unknown') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 3 and 3+2  and ss_list_price between 113 and 202 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 3 and 3+2  and ws_list_price between 113 and 202  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 3 and 3+2  and cs_list_price between 113 and 202)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
967,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'M' and  cd_education_status = 'Secondary' and  d_year = 2002 and  s_state = 'KS' and i_category = 'Jewelry'  ;"
968,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Home' and d_year=2000 and d_moy = 3 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'GA' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 40 AND 60 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
969,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('GA', 'LA', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'TX', 'WI') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AK', 'NC', 'NE') and ws_net_profit between 50 and 250 ) )  ;"
970,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Dooly County','Kane County','Mariposa County','Steuben County','Wayne County') and c.c_birth_month in (6, 11) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'S', 'W') and cd_education_status in ('Secondary', '4 yr Degree', 'Secondary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 7 and 7+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Men', 'Women')  and ss_sales_price / ss_list_price BETWEEN 100 * 0.01 AND 110 * 0.01  and i_manager_id BETWEEN 91 and 100  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 7 ANd 7+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Men', 'Women')  and i_manager_id BETWEEN 91 and 100  and ws_sales_price / ws_list_price BETWEEN 100 * 0.01 AND 110 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 7 and 7+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Men', 'Women')  and i_manager_id BETWEEN 91 and 100  and cs_sales_price / cs_list_price BETWEEN 100 * 0.01 AND 110 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
971,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'S' and  cd_education_status = '4 yr Degree' and  d_year = 1999 and  s_state = 'GA' and i_category = 'Home'  ;"
972,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1180 and 1180 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 29 and 58 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5  ;"
973,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1198 and 1198+11 and ss_sales_price / ss_list_price BETWEEN 14 * 0.01 AND 24 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1198 and 1198+11 and ss_sales_price / ss_list_price BETWEEN 14 * 0.01 AND 24 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 40 and 44  and s_state in ('AK','AZ','VA') order by s_store_name, i_item_desc limit 100 ;"
974,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 15 AND 35 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 36 and 36 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('IL','KY','WI') and ss_wholesale_cost BETWEEN 15 AND 35 and cd1.cd_marital_status in ('S', 'W', 'M') and cd1.cd_education_status in ('4 yr Degree', '2 yr Degree', '2 yr Degree') and cd2.cd_marital_status in ('S', 'W', 'M') and cd2.cd_education_status in ('4 yr Degree', '2 yr Degree', '2 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
975,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1177 and 1177 + 11 and c_birth_month in (3, 5, 8, 11) and ss_list_price between 150 and 209 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1177 and 1177 + 11 and c_birth_month in (3, 5, 8, 11) and cs_list_price between 150 and 209 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1177 and 1177 + 11 and c_birth_month in (3, 5, 8, 11) and ws_list_price between 150 and 209 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
976,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 5 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -7  ;"
977,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('chiffon', 'steel') and i_manager_id BETWEEN 73 and 92 and ss_list_price between 253 and 267 and ca_state in ('KY','MT') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('chiffon', 'steel') and i_manager_id BETWEEN 73 and 92 and ws_list_price between 253 and 267 and ca_state in ('KY','MT') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q1_q2_increase ;"
978,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Liberty' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 54057 and ib_upper_bound <= 54057 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
979,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2002 and d_moy = 8 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'CA' and c_birth_month = 1 and ss_wholesale_cost BETWEEN 13 AND 33  ;"
980,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 202 and 261 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 2 AND 5 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AL', 'KS', 'NY') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'S') and cd_education_status IN ('Advanced Degree', 'Unknown') and cd_gender = 'F' and c_birth_month = 6 and c_birth_year BETWEEN 1971 AND 1977 order by c_customer_id limit 100 ;"
981,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 1999  ;"
982,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189+11 and ss_list_price between 271 and 300 and c_birth_year BETWEEN 1987 AND 1993 and ss_wholesale_cost BETWEEN 47 AND 57 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189+11 and cs_list_price between 271 and 300 and c_birth_year BETWEEN 1987 AND 1993 and cs_wholesale_cost BETWEEN 47 AND 57 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189+11 and ws_list_price between 271 and 300 and c_birth_year BETWEEN 1987 AND 1993 and ws_wholesale_cost BETWEEN 47 AND 57 ) ) cool_cust  ;"
983,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=2001 and d_moy = 10 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'IL' and c_birth_month = 8 and ss_wholesale_cost BETWEEN 36 AND 56 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
984,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1190 and 1190 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 210 and 239 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
985,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 91 and 100 and ss_wholesale_cost BETWEEN 72 AND 92 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 91 and 100 and cs_wholesale_cost BETWEEN 72 AND 92 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 72 AND 92 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 91 and 100 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 72 AND 92  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 72 AND 92  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 72 AND 92 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 1) and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 91 and 100 and ss_wholesale_cost BETWEEN 72 AND 92 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 1) and i_category IN ('Books', 'Children', 'Jewelry') and ss_wholesale_cost BETWEEN 72 AND 92 and i_manager_id BETWEEN 91 and 100 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
986,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Mount Zion' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 63785 and ib_upper_bound <= 63785 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
987,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Sports' and d_year=1999 and d_moy = 3 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'OK' and c_birth_month = 11 and ss_wholesale_cost BETWEEN 71 AND 91 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
988,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=1998 and d_moy = 3 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'NV' and c_birth_month = 1 and ss_wholesale_cost BETWEEN 8 AND 28 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
989,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 6 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -7  ;"
990,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and d_year = 2000 and s_state = 'TN' and i_category = 'Women' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
991,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = '4 yr Degree' and d_year = 1998 and s_state = 'IN' and i_category = 'Books' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
992,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 73 AND 93 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 29 and 29 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'N' and ad2.ca_state in ('GA','NH','VA') and ss_wholesale_cost BETWEEN 73 AND 93 and cd1.cd_marital_status in ('W', 'W', 'W') and cd1.cd_education_status in ('Secondary', 'Secondary', '4 yr Degree') and cd2.cd_marital_status in ('W', 'W', 'W') and cd2.cd_education_status in ('Secondary', 'Secondary', '4 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
993,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IL', 'KS', 'VA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('LA', 'ND', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AL', 'IA', 'KS') and ws_net_profit between 50 and 250 ) )  ;"
994,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1215 and 1215 + 11 and c_birth_month in (5, 7, 8, 11) and ss_list_price between 241 and 300 and ss_wholesale_cost BETWEEN 8 AND 28 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1215 and 1215 + 11 and c_birth_month in (5, 7, 8, 11) and cs_list_price between 241 and 300 and cs_wholesale_cost BETWEEN 8 AND 28 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1215 and 1215 + 11 and c_birth_month in (5, 7, 8, 11) and ws_list_price between 241 and 300 and ws_wholesale_cost BETWEEN 8 AND 28 ) hot_cust limit 100 ;"
995,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'S' and  cd_education_status = 'Advanced Degree' and  d_year = 2000 and  s_state = 'GA' and i_category = 'Jewelry'  ;"
996,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'U' and cd_education_status = 'Secondary' and d_year = 2001 and s_state = 'MO' and i_category = 'Electronics' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
997,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('antique', 'floral') and i_manager_id BETWEEN 81 and 100 and ss_list_price between 254 and 268 and ca_state in ('CO','WI') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('antique', 'floral') and i_manager_id BETWEEN 81 and 100 and ws_list_price between 254 and 268 and ca_state in ('CO','WI') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;"
998,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'M' and  cd_education_status = 'Primary' and  d_year = 1999 and  s_state = 'MI' and i_category = 'Home'  ;"
999,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 1 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
1000,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 63 and 82 and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 244 and 258 and s2.ss_list_price between 244 and 258 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1001,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1199 and 1199 + 11 and c_birth_month in (5, 8, 11, 12) and ss_list_price between 229 and 288 and ss_wholesale_cost BETWEEN 8 AND 28 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1199 and 1199 + 11 and c_birth_month in (5, 8, 11, 12) and cs_list_price between 229 and 288 and cs_wholesale_cost BETWEEN 8 AND 28 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1199 and 1199 + 11 and c_birth_month in (5, 8, 11, 12) and ws_list_price between 229 and 288 and ws_wholesale_cost BETWEEN 8 AND 28 ) hot_cust limit 100 ;"
1002,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and d_year = 1999 and s_state = 'MO' and i_category = 'Children' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1003,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'TX', 'UT') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'PA', 'SD') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'NC', 'NM') and ss_net_profit between 50 and 250 ))  ;"
1004,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1207 and 1207 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 125 and 154 and sm_type = 'REGULAR' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1005,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('dark', 'steel') and i_manager_id BETWEEN 56 and 75 and ss_list_price between 195 and 209 and ca_state in ('AR','TX') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('dark', 'steel') and i_manager_id BETWEEN 56 and 75 and ws_list_price between 195 and 209 and ca_state in ('AR','TX') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.ca_county ;"
1006,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1183 and 1183 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 91 and 120 and sm_type = 'REGULAR' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1007,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Secondary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'LA', 'NC') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NC', 'OH', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'MA', 'MS') and ss_net_profit between 50 and 250 ))  ;"
1008,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1224 and 1224+11 and ss_list_price between 195 and 224 and c_birth_year BETWEEN 1950 AND 1956 and ss_wholesale_cost BETWEEN 11 AND 21 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1224 and 1224+11 and cs_list_price between 195 and 224 and c_birth_year BETWEEN 1950 AND 1956 and cs_wholesale_cost BETWEEN 11 AND 21 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1224 and 1224+11 and ws_list_price between 195 and 224 and c_birth_year BETWEEN 1950 AND 1956 and ws_wholesale_cost BETWEEN 11 AND 21 ) ) cool_cust  ;"
1009,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Green Acres' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 59954 and ib_upper_bound <= 59954 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1010,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 35 * 0.01 AND 55 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1189 and 1189 + 11  and s_state in ('AR','GA','KY'   ,'LA','MS','NC','SD','TX')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1189+ 12 and 1189 + 23  and s_state in ('AR','GA','KY'   ,'LA','MS','NC','SD','TX')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1011,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 64 and 73 and wr_return_amt / wr_return_quantity between 121 and 150 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('ND', 'TN', 'TX', 'WI')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (4, 65) and c_birth_year BETWEEN 1959 AND 1965 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1012,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 27 and 36 and wr_return_amt / wr_return_quantity between 112 and 141 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('KY', 'NC', 'NE', 'WI')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (33, 54) and c_birth_year BETWEEN 1928 AND 1934 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1013,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2002 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Books', 'Jewelry', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and ss_wholesale_cost BETWEEN 60 AND 70  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1942 AND 1948 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2002 and d_moy = 2 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 60 AND 70 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2002 and d_moy = 2 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 60 AND 70) tmp2 limit 100 ;"
1014,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 1 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 1 and 1 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 1 and 1 + 2 and d3.d_year  = 2000  ;"
1015,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2002-03-03','2002-05-03','2002-09-04','2002-11-20'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Women') and i_manager_id BETWEEN 16 and 25 and sr_return_amt / sr_return_quantity between 118 and 147 and sr_reason_sk in (30, 37, 46, 50, 58) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-03-03','2002-05-03','2002-09-04','2002-11-20'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Women') and i_manager_id BETWEEN 16 and 25 and cr_return_amount / cr_return_quantity between 118 and 147 and cr_reason_sk in (30, 37, 46, 50, 58) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-03-03','2002-05-03','2002-09-04','2002-11-20'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Women') and i_manager_id BETWEEN 16 and 25 and wr_return_amt / wr_return_quantity between 118 and 147 and wr_reason_sk in (30, 37, 46, 50, 58) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1016,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 1 * 0.01 AND 21 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1184 and 1184 + 11  and s_state in ('CO','ID','KS'   ,'ME','OK','TX','VT','WI')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1184+ 12 and 1184 + 23  and s_state in ('CO','ID','KS'   ,'ME','OK','TX','VT','WI')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1017,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1193 and 1193 + 11 and c_birth_month in (1, 3, 4, 10) and ss_list_price between 241 and 300 and ss_wholesale_cost BETWEEN 46 AND 66 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1193 and 1193 + 11 and c_birth_month in (1, 3, 4, 10) and cs_list_price between 241 and 300 and cs_wholesale_cost BETWEEN 46 AND 66 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1193 and 1193 + 11 and c_birth_month in (1, 3, 4, 10) and ws_list_price between 241 and 300 and ws_wholesale_cost BETWEEN 46 AND 66 ) hot_cust limit 100 ;"
1018,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Five Forks' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 27271 and ib_upper_bound <= 27271 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1019,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 24 and 33 and wr_return_amt / wr_return_quantity between 97 and 126 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('MO', 'MT', 'NE', 'UT')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (29, 69) and c_birth_year BETWEEN 1966 AND 1972 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1020,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1210 and 1210 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 261 and 290 and sm_type = 'OVERNIGHT' and cc_class = 'medium' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1021,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'S' and  cd_education_status = 'Advanced Degree' and  d_year = 1998 and  s_state = 'UT' and i_category = 'Jewelry'  ;"
1022,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2001 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 14 and 43 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AK', 'OR', 'WI', 'WY')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (4, 20) and c_birth_year BETWEEN 1936 AND 1942 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1023,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Cannon County','Gasconade County','Kewaunee County','Mobile County','Poquoson city') and c.c_birth_month in (3, 4) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('D', 'M', 'S') and cd_education_status in ('Unknown', '2 yr Degree', '4 yr Degree') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 3 and 3+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Shoes')  and ss_sales_price / ss_list_price BETWEEN 44 * 0.01 AND 54 * 0.01  and i_manager_id BETWEEN 91 and 100  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 3 ANd 3+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Shoes')  and i_manager_id BETWEEN 91 and 100  and ws_sales_price / ws_list_price BETWEEN 44 * 0.01 AND 54 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 3 and 3+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Shoes')  and i_manager_id BETWEEN 91 and 100  and cs_sales_price / cs_list_price BETWEEN 44 * 0.01 AND 54 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
1024,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 44 AND 64 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 37 and 37 + 10 and p_channel_email = 'Y' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('ID','MN','TN') and ss_wholesale_cost BETWEEN 44 AND 64 and cd1.cd_marital_status in ('S', 'M', 'M') and cd1.cd_education_status in ('4 yr Degree', 'Unknown', '4 yr Degree') and cd2.cd_marital_status in ('S', 'M', 'M') and cd2.cd_education_status in ('4 yr Degree', 'Unknown', '4 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2000 and cs2.syear = 2000 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
1025,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Green Acres' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 65890 and ib_upper_bound <= 65890 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1026,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1998 and i_manager_id BETWEEN 21 and 40 AND i_category IN ('Children', 'Jewelry', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1998 and ss_wholesale_cost BETWEEN 42 AND 52  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1930 AND 1936 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1998 and d_moy = 6 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 42 AND 52 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1998 and d_moy = 6 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 42 AND 52) tmp2 limit 100 ;"
1027,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1186 and 1186 + 11 and c_birth_month in (3, 8, 9, 11) and ss_list_price between 95 and 154 and ss_wholesale_cost BETWEEN 54 AND 74 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1186 and 1186 + 11 and c_birth_month in (3, 8, 9, 11) and cs_list_price between 95 and 154 and cs_wholesale_cost BETWEEN 54 AND 74 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1186 and 1186 + 11 and c_birth_month in (3, 8, 9, 11) and ws_list_price between 95 and 154 and ws_wholesale_cost BETWEEN 54 AND 74 ) hot_cust limit 100 ;"
1028,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=2001 and d_moy = 12 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'OR' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 70 AND 90  ;"
1029,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = 'Unknown' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 6 and ca_state in ('CO', 'NC', 'WV') and cs_wholesale_cost BETWEEN 87 AND 92 AND i_category = 'Shoes' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1030,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 1999  ;"
1031,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-01-08')) and ss_sold_date_sk = d_date_sk and ss_list_price between 165 and 194 and i_manager_id BETWEEN 35 and 64 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1944 AND 1950 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-01-08')) and cs_sold_date_sk = d_date_sk and cs_list_price between 165 and 194 and i_manager_id BETWEEN 35 and 64 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1944 AND 1950 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-01-08')) and ws_sold_date_sk = d_date_sk and ws_list_price between 165 and 194 and i_manager_id BETWEEN 35 and 64 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1944 AND 1950 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1032,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1201 and 1201 + 11 and c_birth_month in (1, 4, 6, 12) and ss_list_price between 10 and 69 and ss_wholesale_cost BETWEEN 5 AND 25 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1201 and 1201 + 11 and c_birth_month in (1, 4, 6, 12) and cs_list_price between 10 and 69 and cs_wholesale_cost BETWEEN 5 AND 25 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1201 and 1201 + 11 and c_birth_month in (1, 4, 6, 12) and ws_list_price between 10 and 69 and ws_wholesale_cost BETWEEN 5 AND 25 ) hot_cust limit 100 ;"
1033,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 21 * 0.01 AND 41 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1200 and 1200 + 11  and s_state in ('IL','KY','MN'   ,'NC','SC','VA','VT','WA')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1200+ 12 and 1200 + 23  and s_state in ('IL','KY','MN'   ,'NC','SC','VA','VT','WA')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1034,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('cornsilk', 'pink') and i_manager_id BETWEEN 81 and 100 and ss_list_price between 212 and 226 and ca_state in ('CO','GA') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('cornsilk', 'pink') and i_manager_id BETWEEN 81 and 100 and ws_list_price between 212 and 226 and ca_state in ('CO','GA') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q2_q3_increase ;"
1035,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Home' and d_year=2001 and d_moy = 10 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'IL' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 21 AND 41  ;"
1036,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_STORE_CREDIT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 and sr_return_amt / sr_return_quantity between 29 and 88 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 15 AND 18 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('FL', 'NE', 'OK') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('D', 'S') and cd_education_status IN ('4 yr Degree', '2 yr Degree') and cd_gender = 'F' and c_birth_month = 1 and c_birth_year BETWEEN 1953 AND 1959 order by c_customer_id limit 100 ;"
1037,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Jewelry', 'Sports', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 36 AND 46  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1965 AND 1971 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1999 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 36 AND 46 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1999 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 36 AND 46) tmp2 limit 100 ;"
1038,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Music' and d_year=2001 and d_moy = 8 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MN' and c_birth_month = 6 and ss_wholesale_cost BETWEEN 8 AND 28 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1039,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1203 and 1203 + 11 and c_birth_month in (2, 4, 8, 9) and ss_list_price between 226 and 285 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1203 and 1203 + 11 and c_birth_month in (2, 4, 8, 9) and cs_list_price between 226 and 285 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1203 and 1203 + 11 and c_birth_month in (2, 4, 8, 9) and ws_list_price between 226 and 285 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
1040,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=2000 and d_moy = 12 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'AZ' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 80 AND 100  ;"
1041,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
1042,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2000 and d_moy = 3 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MD' and c_birth_month = 11 and ss_wholesale_cost BETWEEN 54 AND 74  ;"
1043,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('cornsilk', 'rosy') and i_manager_id BETWEEN 80 and 99 and ss_list_price between 248 and 262 and ca_state in ('IL','MI') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('cornsilk', 'rosy') and i_manager_id BETWEEN 80 and 99 and ws_list_price between 248 and 262 and ca_state in ('IL','MI') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2002 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2002 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2002 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2002 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2002 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2002 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q1_q2_increase ;"
1044,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1223 and 1223+11 and ss_sales_price / ss_list_price BETWEEN 42 * 0.01 AND 52 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1223 and 1223+11 and ss_sales_price / ss_list_price BETWEEN 42 * 0.01 AND 52 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 15 and 19  and s_state in ('IA','MN','TX') order by s_store_name, i_item_desc limit 100 ;"
1045,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1179 and 1179 + 11 and c_birth_month in (1, 2, 10, 11) and ss_list_price between 46 and 105 and ss_wholesale_cost BETWEEN 13 AND 33 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1179 and 1179 + 11 and c_birth_month in (1, 2, 10, 11) and cs_list_price between 46 and 105 and cs_wholesale_cost BETWEEN 13 AND 33 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1179 and 1179 + 11 and c_birth_month in (1, 2, 10, 11) and ws_list_price between 46 and 105 and ws_wholesale_cost BETWEEN 13 AND 33 ) hot_cust limit 100 ;"
1046,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1204 and 1204 + 11 and c_birth_month in (3, 9, 10, 12) and ss_list_price between 32 and 91 and ss_wholesale_cost BETWEEN 77 AND 97 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1204 and 1204 + 11 and c_birth_month in (3, 9, 10, 12) and cs_list_price between 32 and 91 and cs_wholesale_cost BETWEEN 77 AND 97 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1204 and 1204 + 11 and c_birth_month in (3, 9, 10, 12) and ws_list_price between 32 and 91 and ws_wholesale_cost BETWEEN 77 AND 97 ) hot_cust limit 100 ;"
1047,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1197 and 1197 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 111 and 140 and sm_type = 'REGULAR' and cc_class = 'medium' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1048,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'IL', 'NC') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('OK', 'TX', 'VT') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'NJ', 'WI') and ss_net_profit between 50 and 250 ))  ;"
1049,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2000 and d_moy = 11 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'NC' and c_birth_month = 9 and ss_wholesale_cost BETWEEN 14 AND 34 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1050,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1211 and 1211 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 260 and 289 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1051,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'TX', 'UT') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'PA', 'SD') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'NC', 'NM') and ss_net_profit between 50 and 250 ))  ;"
1052,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IA', 'NE', 'NY') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'KY', 'MO') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CA', 'OK', 'WI') and ss_net_profit between 50 and 250 ))  ;"
1053,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and d_year = 2000 and s_state = 'KY' and i_category = 'Jewelry' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1054,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'KY', 'NC') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'NE', 'UT') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'MN', 'NE') and ss_net_profit between 50 and 250 ))  ;"
1055,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 80 * 0.01 AND 100 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1194 and 1194 + 11  and s_state in ('AK','IN','MO'   ,'MS','NV','SD','TX','UT')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1194+ 12 and 1194 + 23  and s_state in ('AK','IN','MO'   ,'MS','NV','SD','TX','UT')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1056,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 57 * 0.01 AND 77 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1201 and 1201 + 11  and s_state in ('GA','ID','IL'   ,'LA','MT','PA','TX','UT')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1201+ 12 and 1201 + 23  and s_state in ('GA','ID','IL'   ,'LA','MT','PA','TX','UT')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1057,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = '2 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2002 and c_birth_month = 2 and ca_state in ('AL', 'KY', 'WI') and cs_wholesale_cost BETWEEN 15 AND 20 AND i_category = 'Books' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1058,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-03-26')) and ss_sold_date_sk = d_date_sk and ss_list_price between 247 and 276 and i_manager_id BETWEEN 15 and 44 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1965 AND 1971 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-03-26')) and cs_sold_date_sk = d_date_sk and cs_list_price between 247 and 276 and i_manager_id BETWEEN 15 and 44 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1965 AND 1971 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-03-26')) and ws_sold_date_sk = d_date_sk and ws_list_price between 247 and 276 and i_manager_id BETWEEN 15 and 44 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1965 AND 1971 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1059,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 62 AND 82 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 57 and 57 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('MT','OK','TX') and ss_wholesale_cost BETWEEN 62 AND 82 and cd1.cd_marital_status in ('U', 'W', 'S') and cd1.cd_education_status in ('Advanced Degree', 'Advanced Degree', 'Advanced Degree') and cd2.cd_marital_status in ('U', 'W', 'S') and cd2.cd_education_status in ('Advanced Degree', 'Advanced Degree', 'Advanced Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
1060,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 and sr_return_amt / sr_return_quantity between 163 and 222 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 42 AND 45 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AL', 'MT', 'TX') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'S') and cd_education_status IN ('2 yr Degree', 'Advanced Degree') and cd_gender = 'M' and c_birth_month = 6 and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id limit 100 ;"
1061,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1207 and 1207+11 and ss_list_price between 55 and 84 and c_birth_year BETWEEN 1940 AND 1946 and ss_wholesale_cost BETWEEN 34 AND 44 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1207 and 1207+11 and cs_list_price between 55 and 84 and c_birth_year BETWEEN 1940 AND 1946 and cs_wholesale_cost BETWEEN 34 AND 44 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1207 and 1207+11 and ws_list_price between 55 and 84 and c_birth_year BETWEEN 1940 AND 1946 and ws_wholesale_cost BETWEEN 34 AND 44 ) ) cool_cust  ;"
1062,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Books' and i_class = 'mystery' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 1 and d_year = 2001 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1975 AND 1988 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('GA','IL','LA'   ,'MN','MS','NE'   ,'NM','NY','SC'   ,'TX')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 1)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 1) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
1063,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'CA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
1064,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=1998 and d_moy = 4 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MD' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 70 AND 90 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1065,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1200 and 1200+11 and ss_sales_price / ss_list_price BETWEEN 56 * 0.01 AND 66 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1200 and 1200+11 and ss_sales_price / ss_list_price BETWEEN 56 * 0.01 AND 66 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 9 and 13  and s_state in ('NE','NY','TX') order by s_store_name, i_item_desc limit 100 ;"
1066,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2000 and d_moy = 11 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'NC' and c_birth_month = 9 and ss_wholesale_cost BETWEEN 14 AND 34  ;"
1067,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 2 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 2 and 2 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 2 and 2 + 2 and d3.d_year  = 1999 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
1068,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = '4 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 1999 and c_birth_month = 8 and ca_state in ('KS', 'MD', 'NC') and cs_wholesale_cost BETWEEN 70 AND 75 AND i_category = 'Books' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1069,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -6  ;"
1070,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Antioch' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 11990 and ib_upper_bound <= 11990 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1071,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1188 and 1188+11 and ss_sales_price / ss_list_price BETWEEN 38 * 0.01 AND 48 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1188 and 1188+11 and ss_sales_price / ss_list_price BETWEEN 38 * 0.01 AND 48 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 91 and 95  and s_state in ('ID','OK','SD') order by s_store_name, i_item_desc limit 100 ;"
1072,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Secondary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AK', 'NC', 'WA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MN', 'NC', 'NE') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IA', 'MO', 'TX') and ss_net_profit between 50 and 250 ))  ;"
1073,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Marion' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 26340 and ib_upper_bound <= 26340 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1074,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'MN', 'WV') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'KY', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'NY', 'TX') and ss_net_profit between 50 and 250 ))  ;"
1075,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and d_year = 2002 and s_state = 'IL' and i_category = 'Men' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1076,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1998-03-09','1998-05-10','1998-07-15','1998-10-07'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Home') and i_manager_id BETWEEN 47 and 56 and sr_return_amt / sr_return_quantity between 158 and 187 and sr_reason_sk in (9, 13, 26, 40, 44) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-03-09','1998-05-10','1998-07-15','1998-10-07'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Home') and i_manager_id BETWEEN 47 and 56 and cr_return_amount / cr_return_quantity between 158 and 187 and cr_reason_sk in (9, 13, 26, 40, 44) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-03-09','1998-05-10','1998-07-15','1998-10-07'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Home') and i_manager_id BETWEEN 47 and 56 and wr_return_amt / wr_return_quantity between 158 and 187 and wr_reason_sk in (9, 13, 26, 40, 44) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1077,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1200 and 1200+11 and ss_sales_price / ss_list_price BETWEEN 30 * 0.01 AND 40 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1200 and 1200+11 and ss_sales_price / ss_list_price BETWEEN 30 * 0.01 AND 40 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 53 and 57  and s_state in ('IN','KY','OH') order by s_store_name, i_item_desc limit 100 ;"
1078,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Women') and item2.i_manager_id between 53 and 72 and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 73 and 87 and s2.ss_list_price between 73 and 87 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1079,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Hamilton' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 0 * 10000 and ib_upper_bound <= 0 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
1080,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1178 and 1178 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 17 and 46 and sm_type = 'TWO DAY' and cc_class = 'medium' and w_gmt_offset = -5  ;"
1081,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 and sr_return_amt / sr_return_quantity between 96 and 155 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 68 AND 71 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('MI', 'MO', 'RI') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'M') and cd_education_status IN ('2 yr Degree', '4 yr Degree') and cd_gender = 'F' and c_birth_month = 10 and c_birth_year BETWEEN 1930 AND 1936 order by c_customer_id limit 100 ;"
1082,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2002-02-01','2002-04-24','2002-07-27','2002-11-10'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Home') and i_manager_id BETWEEN 35 and 44 and sr_return_amt / sr_return_quantity between 69 and 98 and sr_reason_sk in (1, 20, 27, 55, 61) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-02-01','2002-04-24','2002-07-27','2002-11-10'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Home') and i_manager_id BETWEEN 35 and 44 and cr_return_amount / cr_return_quantity between 69 and 98 and cr_reason_sk in (1, 20, 27, 55, 61) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2002-02-01','2002-04-24','2002-07-27','2002-11-10'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Home') and i_manager_id BETWEEN 35 and 44 and wr_return_amt / wr_return_quantity between 69 and 98 and wr_reason_sk in (1, 20, 27, 55, 61) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1083,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1202 and 1202+11 and ss_list_price between 128 and 157 and c_birth_year BETWEEN 1945 AND 1951 and ss_wholesale_cost BETWEEN 84 AND 94 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1202 and 1202+11 and cs_list_price between 128 and 157 and c_birth_year BETWEEN 1945 AND 1951 and cs_wholesale_cost BETWEEN 84 AND 94 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1202 and 1202+11 and ws_list_price between 128 and 157 and c_birth_year BETWEEN 1945 AND 1951 and ws_wholesale_cost BETWEEN 84 AND 94 ) ) cool_cust  ;"
1084,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Primary' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 6 and ca_state in ('AK', 'AZ', 'VA') and cs_wholesale_cost BETWEEN 52 AND 57 AND i_category = 'Women' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1085,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Primary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MN', 'MS', 'MT') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CA', 'KS', 'SD') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NY', 'SC', 'VA') and ss_net_profit between 50 and 250 ))  ;"
1086,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 10 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
1087,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1200 and 1200 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 106 and 135 and sm_type = 'EXPRESS' and cc_class = 'large' and w_gmt_offset = -5  ;"
1088,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 236 and 265 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CO', 'FL', 'MO', 'WI')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (5, 6) and c_birth_year BETWEEN 1951 AND 1957 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1089,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2002 and i_manager_id BETWEEN 9 and 28 AND i_category IN ('Jewelry', 'Men', 'Music') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and ss_wholesale_cost BETWEEN 86 AND 96  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1934 AND 1940 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2002 and d_moy = 11 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 86 AND 96 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2002 and d_moy = 11 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 86 AND 96) tmp2 limit 100 ;"
1090,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('GA','MO','MT') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('D', 'U', 'S') and cd_education_status in ('Advanced Degree', 'Primary') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 10 and 10+2  and ss_list_price between 168 and 257 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 10 and 10+2  and ws_list_price between 168 and 257  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 10 and 10+2  and cs_list_price between 168 and 257)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1091,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = 'Unknown' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 7 and  ca_state in ('AK', 'GA', 'OR')  and cs_wholesale_cost BETWEEN 37 AND 42  AND i_category = 'Books'  ;"
1092,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Woodland' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 7 * 10000 and ib_upper_bound <= 7 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
1093,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-03-20','1999-05-09','1999-08-09','1999-11-12'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Men') and i_manager_id BETWEEN 53 and 62 and sr_return_amt / sr_return_quantity between 97 and 126 and sr_reason_sk in (7, 31, 54, 60, 71) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-03-20','1999-05-09','1999-08-09','1999-11-12'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Men') and i_manager_id BETWEEN 53 and 62 and cr_return_amount / cr_return_quantity between 97 and 126 and cr_reason_sk in (7, 31, 54, 60, 71) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-03-20','1999-05-09','1999-08-09','1999-11-12'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Men') and i_manager_id BETWEEN 53 and 62 and wr_return_amt / wr_return_quantity between 97 and 126 and wr_reason_sk in (7, 31, 54, 60, 71) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1094,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = 'Unknown' and c_current_addr_sk = ca_address_sk and d_year = 1999 and c_birth_month = 6 and ca_state in ('IA', 'MN', 'TX') and cs_wholesale_cost BETWEEN 56 AND 61 AND i_category = 'Electronics' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1095,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'Unknown' and d_year = 2002 and s_state = 'NC' and i_category = 'Shoes' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1096,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1190 and 1190 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 149 and 178 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1097,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Electronics', 'Jewelry') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = 'Secondary' and s1.ss_list_price between 216 and 230 and s2.ss_list_price between 216 and 230  ;"
1098,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IN', 'SD', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AK', 'GA', 'NC') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IN', 'ND', 'OK') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1099,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-06-21')) and ss_sold_date_sk = d_date_sk and ss_list_price between 146 and 175 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1963 AND 1969 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-06-21')) and cs_sold_date_sk = d_date_sk and cs_list_price between 146 and 175 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1963 AND 1969 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-06-21')) and ws_sold_date_sk = d_date_sk and ws_list_price between 146 and 175 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1963 AND 1969 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1100,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,stddev_samp(ss_net_profit) as store_sales_profit ,stddev_samp(sr_net_loss) as store_returns_loss ,stddev_samp(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 1998 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
1101,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1211 and 1211 + 11 and c_birth_month in (2, 6, 7, 12) and ss_list_price between 86 and 145 and ss_wholesale_cost BETWEEN 1 AND 21 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1211 and 1211 + 11 and c_birth_month in (2, 6, 7, 12) and cs_list_price between 86 and 145 and cs_wholesale_cost BETWEEN 1 AND 21 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1211 and 1211 + 11 and c_birth_month in (2, 6, 7, 12) and ws_list_price between 86 and 145 and ws_wholesale_cost BETWEEN 1 AND 21 ) hot_cust limit 100 ;"
1102,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = '4 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2002 and c_birth_month = 3 and ca_state in ('IL', 'MN', 'TN') and cs_wholesale_cost BETWEEN 32 AND 37 AND i_category = 'Electronics' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1103,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 80 * 0.01 AND 100 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1177 and 1177 + 11  and s_state in ('AL','GA','IL'   ,'KS','MI','MS','TX','VA')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1177+ 12 and 1177 + 23  and s_state in ('AL','GA','IL'   ,'KS','MI','MS','TX','VA')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1104,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Primary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NE', 'SC', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MT', 'NC', 'WI') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'MI', 'OH') and ss_net_profit between 50 and 250 ))  ;"
1105,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1192 and 1192+11 and ss_sales_price / ss_list_price BETWEEN 84 * 0.01 AND 94 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1192 and 1192+11 and ss_sales_price / ss_list_price BETWEEN 84 * 0.01 AND 94 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 51 and 55  and s_state in ('IN','MS','NJ') order by s_store_name, i_item_desc limit 100 ;"
1106,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = '2 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 3 and ca_state in ('KY', 'MT', 'OH') and cs_wholesale_cost BETWEEN 56 AND 61 AND i_category = 'Children' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1107,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 80 and 139 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 72 AND 75 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('CO', 'GA', 'NE') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'M') and cd_education_status IN ('2 yr Degree', '2 yr Degree') and cd_gender = 'F' and c_birth_month = 8 and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id limit 100 ;"
1108,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AL', 'TN', 'WA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IL', 'KS', 'SD') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('LA', 'MO', 'OH') and ws_net_profit between 50 and 250 ) )  ;"
1109,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 241 and 300 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 50 AND 53 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AR', 'GA', 'NC') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'S') and cd_education_status IN ('4 yr Degree', '2 yr Degree') and cd_gender = 'F' and c_birth_month = 7 and c_birth_year BETWEEN 1939 AND 1945 order by c_customer_id limit 100 ;"
1110,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 12 AND 32 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 54 and 54 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('GA','HI','ID') and ss_wholesale_cost BETWEEN 12 AND 32 and cd1.cd_marital_status in ('M', 'M', 'M') and cd1.cd_education_status in ('Advanced Degree', 'Secondary', '4 yr Degree') and cd2.cd_marital_status in ('M', 'M', 'M') and cd2.cd_education_status in ('Advanced Degree', 'Secondary', '4 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
1111,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 1 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7  ;"
1112,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'MI', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('OH', 'PA', 'SD') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'KY', 'WI') and ss_net_profit between 50 and 250 ))  ;"
1113,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 50 * 0.01 AND 70 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1176 and 1176 + 11  and s_state in ('IN','MI','MT'   ,'NC','OH','SC','TX','WI')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1176+ 12 and 1176 + 23  and s_state in ('IN','MI','MT'   ,'NC','OH','SC','TX','WI')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1114,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Sports' and i_class = 'basketball' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 5 and d_year = 1998 and wholesale_cost BETWEEN 36 AND 66 and c_birth_year BETWEEN 1942 AND 1955 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 36 AND 66  and s_state in ('GA','IL','MD'   ,'NC','NH','TN'   ,'VA','WA','WI'   ,'WV')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1998 and d_moy = 5)   and (select distinct d_month_seq+3   from date_dim where d_year = 1998 and d_moy = 5) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
1115,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 2001 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
1116,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-01-31')) and ss_sold_date_sk = d_date_sk and ss_list_price between 110 and 139 and i_manager_id BETWEEN 29 and 58 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1967 AND 1973 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-01-31')) and cs_sold_date_sk = d_date_sk and cs_list_price between 110 and 139 and i_manager_id BETWEEN 29 and 58 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1967 AND 1973 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-01-31')) and ws_sold_date_sk = d_date_sk and ws_list_price between 110 and 139 and i_manager_id BETWEEN 29 and 58 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1967 AND 1973 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1117,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 2000  ;"
1118,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Books' and d_year=2000 and d_moy = 1 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'CO' and c_birth_month = 6 and ss_wholesale_cost BETWEEN 39 AND 59  ;"
1119,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'W' and  cd_education_status = 'Secondary' and  d_year = 1998 and  s_state = 'TN' and i_category = 'Children'  ;"
1120,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 24 * 0.01 AND 44 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1190 and 1190 + 11  and s_state in ('CA','IN','MN'   ,'MO','OH','SC','TX','WI')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1190+ 12 and 1190 + 23  and s_state in ('CA','IN','MN'   ,'MO','OH','SC','TX','WI')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1121,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('AK','GA','OR') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'S', 'M') and cd_education_status in ('4 yr Degree', 'Unknown') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 1 and 1+2  and ss_list_price between 199 and 288 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 1 and 1+2  and ws_list_price between 199 and 288  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 1 and 1+2  and cs_list_price between 199 and 288)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1122,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Lincoln' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 54963 and ib_upper_bound <= 54963 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1123,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-04-15')) and ss_sold_date_sk = d_date_sk and ss_list_price between 126 and 155 and i_manager_id BETWEEN 51 and 80 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1942 AND 1948 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-04-15')) and cs_sold_date_sk = d_date_sk and cs_list_price between 126 and 155 and i_manager_id BETWEEN 51 and 80 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1942 AND 1948 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-04-15')) and ws_sold_date_sk = d_date_sk and ws_list_price between 126 and 155 and i_manager_id BETWEEN 51 and 80 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1942 AND 1948 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1124,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 8 * 0.01 AND 28 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1201 and 1201 + 11  and s_state in ('AL','CT','FL'   ,'GA','IL','MN','TX','VA')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1201+ 12 and 1201 + 23  and s_state in ('AL','CT','FL'   ,'GA','IL','MN','TX','VA')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1125,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 9 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7  ;"
1126,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188+11 and ss_list_price between 152 and 181 and c_birth_year BETWEEN 1971 AND 1977 and ss_wholesale_cost BETWEEN 88 AND 98 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188+11 and cs_list_price between 152 and 181 and c_birth_year BETWEEN 1971 AND 1977 and cs_wholesale_cost BETWEEN 88 AND 98 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188+11 and ws_list_price between 152 and 181 and c_birth_year BETWEEN 1971 AND 1977 and ws_wholesale_cost BETWEEN 88 AND 98 ) ) cool_cust  ;"
1127,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'W' and cd_education_status = 'Secondary' and d_year = 2001 and s_state = 'GA' and i_category = 'Jewelry' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1128,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('blanched', 'light') and i_manager_id BETWEEN 81 and 100 and ss_list_price between 286 and 300 and ca_state in ('OH','TN') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('blanched', 'light') and i_manager_id BETWEEN 81 and 100 and ws_list_price between 286 and 300 and ca_state in ('OH','TN') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;"
1129,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1183 and 1183 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 91 and 120 and sm_type = 'REGULAR' and cc_class = 'small' and w_gmt_offset = -5  ;"
1130,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2001 and d_moy = 11 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'SD' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 32 AND 52 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1131,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 91 and 100 and ss_wholesale_cost BETWEEN 73 AND 93 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 91 and 100 and cs_wholesale_cost BETWEEN 73 AND 93 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 73 AND 93 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 91 and 100 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 73 AND 93  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 73 AND 93  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 73 AND 93 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 13) and i_category IN ('Books', 'Jewelry', 'Shoes') and i_manager_id BETWEEN 91 and 100 and ss_wholesale_cost BETWEEN 73 AND 93 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 13) and i_category IN ('Books', 'Jewelry', 'Shoes') and ss_wholesale_cost BETWEEN 73 AND 93 and i_manager_id BETWEEN 91 and 100 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
1132,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Primary' and  c_current_addr_sk = ca_address_sk and  d_year = 1998 and  c_birth_month = 11 and  ca_state in ('MN', 'MS', 'MT')  and cs_wholesale_cost BETWEEN 68 AND 73  AND i_category = 'Children'  ;"
1133,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 2001  ;"
1134,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1998 and i_manager_id BETWEEN 54 and 73 AND i_category IN ('Home', 'Jewelry', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1998 and ss_wholesale_cost BETWEEN 90 AND 100  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1970 AND 1976 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1998 and d_moy = 10 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 90 AND 100 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1998 and d_moy = 10 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 90 AND 100) tmp2 limit 100 ;"
1135,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-02-05','2001-04-19','2001-09-10','2001-11-12'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Jewelry') and i_manager_id BETWEEN 47 and 56 and sr_return_amt / sr_return_quantity between 234 and 263 and sr_reason_sk in (3, 17, 18, 62, 69) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-02-05','2001-04-19','2001-09-10','2001-11-12'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Jewelry') and i_manager_id BETWEEN 47 and 56 and cr_return_amount / cr_return_quantity between 234 and 263 and cr_reason_sk in (3, 17, 18, 62, 69) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-02-05','2001-04-19','2001-09-10','2001-11-12'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Jewelry') and i_manager_id BETWEEN 47 and 56 and wr_return_amt / wr_return_quantity between 234 and 263 and wr_reason_sk in (3, 17, 18, 62, 69) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1136,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 41 and 50 and wr_return_amt / wr_return_quantity between 211 and 240 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('KS', 'LA', 'MO', 'NE')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (64, 67) and c_birth_year BETWEEN 1967 AND 1973 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1137,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Sports' and d_year=1999 and d_moy = 1 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'RI' and c_birth_month = 5 and ss_wholesale_cost BETWEEN 16 AND 36  ;"
1138,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1191 and 1191+11 and ss_list_price between 31 and 60 and c_birth_year BETWEEN 1984 AND 1990 and ss_wholesale_cost BETWEEN 59 AND 69 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1191 and 1191+11 and cs_list_price between 31 and 60 and c_birth_year BETWEEN 1984 AND 1990 and cs_wholesale_cost BETWEEN 59 AND 69 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1191 and 1191+11 and ws_list_price between 31 and 60 and c_birth_year BETWEEN 1984 AND 1990 and ws_wholesale_cost BETWEEN 59 AND 69 ) ) cool_cust  ;"
1139,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Shoes' and i_class = 'kids' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 4 and d_year = 2000 and wholesale_cost BETWEEN 32 AND 62 and c_birth_year BETWEEN 1962 AND 1975 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 32 AND 62  and s_state in ('FL','GA','IL'   ,'MO','MS','NM'   ,'NY','TN','TX'   ,'VT')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 4)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 4) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
1140,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 3 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 3 and 3 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 3 and 3 + 2 and d3.d_year  = 2000  ;"
1141,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'M' and  cd_education_status = 'Secondary' and  d_year = 2002 and  s_state = 'OR' and i_category = 'Children'  ;"
1142,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=1999 and d_moy = 6 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'OK' and c_birth_month = 5 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1143,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 89 and 98 and wr_return_amt / wr_return_quantity between 242 and 271 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('DE', 'KY', 'MO', 'NE')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (11, 17) and c_birth_year BETWEEN 1961 AND 1967 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1144,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 80 AND 100 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 29 and 29 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('KY','OH','TX') and ss_wholesale_cost BETWEEN 80 AND 100 and cd1.cd_marital_status in ('S', 'S', 'M') and cd1.cd_education_status in ('4 yr Degree', '2 yr Degree', '4 yr Degree') and cd2.cd_marital_status in ('S', 'S', 'M') and cd2.cd_education_status in ('4 yr Degree', '2 yr Degree', '4 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1999 and cs2.syear = 1999 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
1145,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1194 and 1194 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 167 and 196 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1146,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189 + 11 and c_birth_month in (1, 2, 3, 10) and ss_list_price between 14 and 73 and ss_wholesale_cost BETWEEN 52 AND 72 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189 + 11 and c_birth_month in (1, 2, 3, 10) and cs_list_price between 14 and 73 and cs_wholesale_cost BETWEEN 52 AND 72 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189 + 11 and c_birth_month in (1, 2, 3, 10) and ws_list_price between 14 and 73 and ws_wholesale_cost BETWEEN 52 AND 72 ) hot_cust limit 100 ;"
1147,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2000 and i_manager_id BETWEEN 40 and 59 AND i_category IN ('Books', 'Home', 'Shoes') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2000 and ss_wholesale_cost BETWEEN 61 AND 71  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1969 AND 1975 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2000 and d_moy = 12 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 61 AND 71 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2000 and d_moy = 12 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 61 AND 71) tmp2 limit 100 ;"
1148,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('GA','KY','PA') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'M', 'S') and cd_education_status in ('Unknown', 'Unknown') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 1 and 1+2  and ss_list_price between 23 and 112 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 1 and 1+2  and ws_list_price between 23 and 112  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 1 and 1+2  and cs_list_price between 23 and 112)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1149,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 21 and 30 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 21 and 30 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 80 AND 100 and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 21 and 30 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and ss_wholesale_cost BETWEEN 80 AND 100  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and cs_wholesale_cost BETWEEN 80 AND 100  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 80 AND 100 and d_year between 1999 and 1999 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999 + 1   and d_moy = 12   and d_dom = 13) and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 21 and 30 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999   and d_moy = 12   and d_dom = 13) and i_category IN ('Home', 'Jewelry', 'Women') and ss_wholesale_cost BETWEEN 80 AND 100 and i_manager_id BETWEEN 21 and 30 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
1150,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_STORE_CREDIT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 76 and 135 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 38 AND 41 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('MI', 'NE', 'OH') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'W') and cd_education_status IN ('2 yr Degree', 'Unknown') and cd_gender = 'F' and c_birth_month = 7 and c_birth_year BETWEEN 1982 AND 1988 order by c_customer_id limit 100 ;"
1151,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Brownsville' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 0 * 10000 and ib_upper_bound <= 0 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
1152,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2002 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Children', 'Home', 'Music') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and ss_wholesale_cost BETWEEN 30 AND 40  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1970 AND 1976 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2002 and d_moy = 6 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 30 AND 40 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2002 and d_moy = 6 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 30 AND 40) tmp2 limit 100 ;"
1153,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 78 and 97 and cd_marital_status = 'M' and cd_education_status = 'Unknown' and s1.ss_list_price between 205 and 219 and s2.ss_list_price between 205 and 219  ;"
1154,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 and sr_return_amt / sr_return_quantity between 168 and 227 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 32 AND 35 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('MT', 'NE', 'WV') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'S') and cd_education_status IN ('Unknown', '4 yr Degree') and cd_gender = 'F' and c_birth_month = 6 and c_birth_year BETWEEN 1936 AND 1942 order by c_customer_id limit 100 ;"
1155,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 19 * 0.01 AND 39 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1199 and 1199 + 11  and s_state in ('CT','GA','MA'   ,'MO','MT','OK','SD','TX')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1199+ 12 and 1199 + 23  and s_state in ('CT','GA','MA'   ,'MO','MT','OK','SD','TX')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1156,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Women') and item2.i_manager_id between 67 and 86 and cd_marital_status = 'M' and cd_education_status = 'Secondary' and s1.ss_list_price between 179 and 193 and s2.ss_list_price between 179 and 193 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1157,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Children', 'Home', 'Jewelry') and i_manager_id BETWEEN 75 and 84 and ss_wholesale_cost BETWEEN 49 AND 69 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Children', 'Home', 'Jewelry') and i_manager_id BETWEEN 75 and 84 and cs_wholesale_cost BETWEEN 49 AND 69 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 49 AND 69 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Home', 'Jewelry') and i_manager_id BETWEEN 75 and 84 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 49 AND 69  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 49 AND 69  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 49 AND 69 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 16) and i_category IN ('Children', 'Home', 'Jewelry') and i_manager_id BETWEEN 75 and 84 and ss_wholesale_cost BETWEEN 49 AND 69 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 16) and i_category IN ('Children', 'Home', 'Jewelry') and ss_wholesale_cost BETWEEN 49 AND 69 and i_manager_id BETWEEN 75 and 84 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
1158,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1195 and 1195 + 11 and c_birth_month in (5, 7, 10, 12) and ss_list_price between 241 and 300 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1195 and 1195 + 11 and c_birth_month in (5, 7, 10, 12) and cs_list_price between 241 and 300 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1195 and 1195 + 11 and c_birth_month in (5, 7, 10, 12) and ws_list_price between 241 and 300 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
1159,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Lakeside' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 7644 and ib_upper_bound <= 7644 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1160,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IN', 'SC', 'WI') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('CA', 'MN', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'MO', 'VA') and ws_net_profit between 50 and 250 ) )  ;"
1161,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Home' and i_class = 'furniture' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 12 and d_year = 1999 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1980 AND 1993 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('GA','IA','IL'   ,'KS','LA','ME'   ,'MI','NC','ND'   ,'OK')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1999 and d_moy = 12)   and (select distinct d_month_seq+3   from date_dim where d_year = 1999 and d_moy = 12) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
1162,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 87 and 146 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 46 AND 49 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AL', 'MT', 'SC') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('U', 'U') and cd_education_status IN ('Secondary', 'Secondary') and cd_gender = 'M' and c_birth_month = 10 and c_birth_year BETWEEN 1940 AND 1946 order by c_customer_id limit 100 ;"
1163,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Electronics') and item2.i_manager_id between 38 and 57 and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 61 and 75 and s2.ss_list_price between 61 and 75 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1164,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REVERSED_TEXTGE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2000 and sr_return_amt / sr_return_quantity between 54 and 113 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 35 AND 38 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('LA', 'MO', 'OH') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'U') and cd_education_status IN ('Secondary', 'Advanced Degree') and cd_gender = 'M' and c_birth_month = 12 and c_birth_year BETWEEN 1961 AND 1967 order by c_customer_id limit 100 ;"
1165,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-02-07','2001-05-05','2001-08-31','2001-10-13'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Shoes') and i_manager_id BETWEEN 35 and 44 and sr_return_amt / sr_return_quantity between 174 and 203 and sr_reason_sk in (8, 29, 30, 33, 65) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-02-07','2001-05-05','2001-08-31','2001-10-13'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Shoes') and i_manager_id BETWEEN 35 and 44 and cr_return_amount / cr_return_quantity between 174 and 203 and cr_reason_sk in (8, 29, 30, 33, 65) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-02-07','2001-05-05','2001-08-31','2001-10-13'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Shoes') and i_manager_id BETWEEN 35 and 44 and wr_return_amt / wr_return_quantity between 174 and 203 and wr_reason_sk in (8, 29, 30, 33, 65) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1166,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 27 * 0.01 AND 47 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1183 and 1183 + 11  and s_state in ('AL','IA','IL'   ,'KS','MD','MN','OR','WA')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1183+ 12 and 1183 + 23  and s_state in ('AL','IA','IL'   ,'KS','MD','MN','OR','WA')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1167,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'NM', 'SC') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'WA', 'WY') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'IL', 'TX') and ss_net_profit between 50 and 250 ))  ;"
1168,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1221 and 1221+11 and ss_sales_price / ss_list_price BETWEEN 58 * 0.01 AND 68 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1221 and 1221+11 and ss_sales_price / ss_list_price BETWEEN 58 * 0.01 AND 68 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 7 and 11  and s_state in ('FL','MI','VA') order by s_store_name, i_item_desc limit 100 ;"
1169,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7  ;"
1170,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 48 and 57 and wr_return_amt / wr_return_quantity between 34 and 63 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('FL', 'GA', 'IN', 'WV')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (10, 48) and c_birth_year BETWEEN 1949 AND 1955 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1171,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = '2 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2001 and  c_birth_month = 11 and  ca_state in ('MN', 'OK', 'WV')  and cs_wholesale_cost BETWEEN 43 AND 48  AND i_category = 'Home'  ;"
1172,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'KS', 'SD') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'IN', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'NE', 'TX') and ss_net_profit between 50 and 250 ))  ;"
1173,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-07-17')) and ss_sold_date_sk = d_date_sk and ss_list_price between 195 and 224 and i_manager_id BETWEEN 34 and 63 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1950 AND 1956 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-07-17')) and cs_sold_date_sk = d_date_sk and cs_list_price between 195 and 224 and i_manager_id BETWEEN 34 and 63 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1950 AND 1956 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-07-17')) and ws_sold_date_sk = d_date_sk and ws_list_price between 195 and 224 and i_manager_id BETWEEN 34 and 63 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1950 AND 1956 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1174,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 70 * 0.01 AND 90 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1206 and 1206 + 11  and s_state in ('GA','IL','KY'   ,'NE','PA','TN','VT','WI')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1206+ 12 and 1206 + 23  and s_state in ('GA','IL','KY'   ,'NE','PA','TN','VT','WI')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1175,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1191 and 1191 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 12 and 41 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1176,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 51 * 0.01 AND 71 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1210 and 1210 + 11  and s_state in ('CO','KY','MI'   ,'MN','MO','OK','WI','WV')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1210+ 12 and 1210 + 23  and s_state in ('CO','KY','MI'   ,'MN','MO','OK','WI','WV')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1177,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 41 and 50 and wr_return_amt / wr_return_quantity between 15 and 44 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('GA', 'IL', 'NC', 'VA')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (20, 68) and c_birth_year BETWEEN 1957 AND 1963 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1178,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1215 and 1215+11 and ss_list_price between 271 and 300 and c_birth_year BETWEEN 1970 AND 1976 and ss_wholesale_cost BETWEEN 90 AND 100 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1215 and 1215+11 and cs_list_price between 271 and 300 and c_birth_year BETWEEN 1970 AND 1976 and cs_wholesale_cost BETWEEN 90 AND 100 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1215 and 1215+11 and ws_list_price between 271 and 300 and c_birth_year BETWEEN 1970 AND 1976 and ws_wholesale_cost BETWEEN 90 AND 100 ) ) cool_cust  ;"
1179,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 20 and 39 AND i_category IN ('Children', 'Home', 'Shoes') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 55 AND 65  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1925 AND 1931 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1999 and d_moy = 2 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 55 AND 65 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1999 and d_moy = 2 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 55 AND 65) tmp2 limit 100 ;"
1180,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2000 and i_manager_id BETWEEN 38 and 57 AND i_category IN ('Jewelry', 'Men', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2000 and ss_wholesale_cost BETWEEN 52 AND 62  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1937 AND 1943 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2000 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 52 AND 62 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2000 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 52 AND 62) tmp2 limit 100 ;"
1181,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Books' and d_year=1998 and d_moy = 5 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MN' and c_birth_month = 11 and ss_wholesale_cost BETWEEN 54 AND 74  ;"
1182,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = 'Unknown' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 7 and ca_state in ('AK', 'GA', 'OR') and cs_wholesale_cost BETWEEN 37 AND 42 AND i_category = 'Books' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1183,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MO', 'MS', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'MI', 'WV') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('FL', 'ID', 'WI') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1184,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('hot', 'lime') and i_manager_id BETWEEN 35 and 54 and ss_list_price between 178 and 192 and ca_state in ('FL','MO') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('hot', 'lime') and i_manager_id BETWEEN 35 and 54 and ws_list_price between 178 and 192 and ca_state in ('FL','MO') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q2_q3_increase ;"
1185,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=2001 and d_moy = 10 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'NC' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 75 AND 95  ;"
1186,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('GA','MN','NC') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'U', 'S') and cd_education_status in ('4 yr Degree', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 4 and 4+2  and ss_list_price between 67 and 156 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 4 and 4+2  and ws_list_price between 67 and 156  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 4 and 4+2  and cs_list_price between 67 and 156)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1187,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 31 and 50 and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 238 and 252 and s2.ss_list_price between 238 and 252  ;"
1188,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1206 and 1206+11 and ss_list_price between 271 and 300 and c_birth_year BETWEEN 1972 AND 1978 and ss_wholesale_cost BETWEEN 73 AND 83 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1206 and 1206+11 and cs_list_price between 271 and 300 and c_birth_year BETWEEN 1972 AND 1978 and cs_wholesale_cost BETWEEN 73 AND 83 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1206 and 1206+11 and ws_list_price between 271 and 300 and c_birth_year BETWEEN 1972 AND 1978 and ws_wholesale_cost BETWEEN 73 AND 83 ) ) cool_cust  ;"
1189,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MI', 'PA', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IL', 'NE', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('HI', 'OH', 'UT') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1190,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Books' and d_year=2000 and d_moy = 8 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'OK' and c_birth_month = 6 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1191,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Children') and item2.i_manager_id between 40 and 59 and cd_marital_status = 'M' and cd_education_status = 'Primary' and s1.ss_list_price between 286 and 300 and s2.ss_list_price between 286 and 300 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1192,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Unknown' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 7 and ca_state in ('GA', 'KS', 'MI') and cs_wholesale_cost BETWEEN 1 AND 6 AND i_category = 'Music' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1193,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Home' and i_class = 'flatware' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 9 and d_year = 1998 and wholesale_cost BETWEEN 68 AND 98 and c_birth_year BETWEEN 1942 AND 1955 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 68 AND 98  and s_state in ('CA','IA','IL'   ,'KS','NC','NY'   ,'OK','OR','TX'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1998 and d_moy = 9)   and (select distinct d_month_seq+3   from date_dim where d_year = 1998 and d_moy = 9) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
1194,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1221 and 1221+11 and ss_sales_price / ss_list_price BETWEEN 30 * 0.01 AND 40 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1221 and 1221+11 and ss_sales_price / ss_list_price BETWEEN 30 * 0.01 AND 40 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 12 and 16  and s_state in ('AR','MN','WV') order by s_store_name, i_item_desc limit 100 ;"
1195,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-03-17','2001-04-19','2001-09-20','2001-11-03'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Jewelry') and i_manager_id BETWEEN 89 and 98 and sr_return_amt / sr_return_quantity between 186 and 215 and sr_reason_sk in (11, 20, 32, 39, 50) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-03-17','2001-04-19','2001-09-20','2001-11-03'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Jewelry') and i_manager_id BETWEEN 89 and 98 and cr_return_amount / cr_return_quantity between 186 and 215 and cr_reason_sk in (11, 20, 32, 39, 50) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-03-17','2001-04-19','2001-09-20','2001-11-03'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Jewelry') and i_manager_id BETWEEN 89 and 98 and wr_return_amt / wr_return_quantity between 186 and 215 and wr_reason_sk in (11, 20, 32, 39, 50) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1196,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'ND', 'OK') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'LA', 'NC') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'ME', 'MI') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1197,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=1999 and d_moy = 9 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'IA' and c_birth_month = 5 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1198,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KY', 'LA', 'SC') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('CA', 'IN', 'KS') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('OH', 'TN', 'WV') and ws_net_profit between 50 and 250 ) )  ;"
1199,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'WA'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
1200,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1193 and 1193 + 11 and c_birth_month in (2, 4, 5, 9) and ss_list_price between 241 and 300 and ss_wholesale_cost BETWEEN 32 AND 52 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1193 and 1193 + 11 and c_birth_month in (2, 4, 5, 9) and cs_list_price between 241 and 300 and cs_wholesale_cost BETWEEN 32 AND 52 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1193 and 1193 + 11 and c_birth_month in (2, 4, 5, 9) and ws_list_price between 241 and 300 and ws_wholesale_cost BETWEEN 32 AND 52 ) hot_cust limit 100 ;"
1201,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('almond', 'coral') and i_manager_id BETWEEN 81 and 100 and ss_list_price between 95 and 109 and ca_state in ('OH','TN') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('almond', 'coral') and i_manager_id BETWEEN 81 and 100 and ws_list_price between 95 and 109 and ca_state in ('OH','TN') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;"
1202,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,avg(ss_net_profit) as store_sales_profit ,avg(sr_net_loss) as store_returns_loss ,avg(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 9 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 9 and 9 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 9 and 9 + 2 and d3.d_year  = 1998 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
1203,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1207 and 1207 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 195 and 224 and sm_type = 'TWO DAY' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1204,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 1999 and  c_birth_month = 10 and  ca_state in ('NC', 'SC', 'TX')  and cs_wholesale_cost BETWEEN 89 AND 94  AND i_category = 'Home'  ;"
1205,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1195 and 1195+11 and ss_sales_price / ss_list_price BETWEEN 60 * 0.01 AND 70 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1195 and 1195+11 and ss_sales_price / ss_list_price BETWEEN 60 * 0.01 AND 70 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 15 and 19  and s_state in ('MO','TX','VA') order by s_store_name, i_item_desc limit 100 ;"
1206,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Farmington' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 3673 and ib_upper_bound <= 3673 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1207,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 25 and 44 AND i_category IN ('Children', 'Electronics', 'Jewelry') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 4 AND 14  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1970 AND 1976 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1999 and d_moy = 11 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 4 AND 14 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1999 and d_moy = 11 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 4 AND 14) tmp2 limit 100 ;"
1208,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2001 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 75 and 84 and wr_return_amt / wr_return_quantity between 271 and 300 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('GA', 'MN', 'TX', 'VT')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (31, 62) and c_birth_year BETWEEN 1936 AND 1942 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1209,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1207 and 1207+11 and ss_sales_price / ss_list_price BETWEEN 41 * 0.01 AND 51 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1207 and 1207+11 and ss_sales_price / ss_list_price BETWEEN 41 * 0.01 AND 51 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 54 and 58  and s_state in ('IA','IL','MI') order by s_store_name, i_item_desc limit 100 ;"
1210,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Advanced Degree' and c_current_addr_sk = ca_address_sk and d_year = 2001 and c_birth_month = 7 and ca_state in ('CA', 'NJ', 'SC') and cs_wholesale_cost BETWEEN 67 AND 72 AND i_category = 'Women' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1211,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 28 AND 48 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 31 and 31 + 10 and p_channel_email = 'Y' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('OH','TX','VA') and ss_wholesale_cost BETWEEN 28 AND 48 and cd1.cd_marital_status in ('W', 'W', 'M') and cd1.cd_education_status in ('College', 'Advanced Degree', 'Primary') and cd2.cd_marital_status in ('W', 'W', 'M') and cd2.cd_education_status in ('College', 'Advanced Degree', 'Primary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
1212,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Home') and item2.i_manager_id between 53 and 72 and cd_marital_status = 'M' and cd_education_status = 'Secondary' and s1.ss_list_price between 89 and 103 and s2.ss_list_price between 89 and 103 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1213,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'W' and  cd_education_status = 'Secondary' and  d_year = 2001 and  s_state = 'GA' and i_category = 'Jewelry'  ;"
1214,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = 'Unknown' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 6 and  ca_state in ('CO', 'NC', 'WV')  and cs_wholesale_cost BETWEEN 87 AND 92  AND i_category = 'Shoes'  ;"
1215,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NC', 'TX', 'VA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'IN', 'WY') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'NM', 'NY') and ss_net_profit between 50 and 250 ))  ;"
1216,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=1998 and d_moy = 2 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'CA' and c_birth_month = 10 and ss_wholesale_cost BETWEEN 34 AND 54  ;"
1217,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2000-01-19','2000-05-06','2000-07-16','2000-10-09'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Music') and i_manager_id BETWEEN 26 and 35 and sr_return_amt / sr_return_quantity between 218 and 247 and sr_reason_sk in (3, 21, 31, 56, 75) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-01-19','2000-05-06','2000-07-16','2000-10-09'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Music') and i_manager_id BETWEEN 26 and 35 and cr_return_amount / cr_return_quantity between 218 and 247 and cr_reason_sk in (3, 21, 31, 56, 75) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-01-19','2000-05-06','2000-07-16','2000-10-09'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Books', 'Music') and i_manager_id BETWEEN 26 and 35 and wr_return_amt / wr_return_quantity between 218 and 247 and wr_reason_sk in (3, 21, 31, 56, 75) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1218,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
1219,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-02-27')) and ss_sold_date_sk = d_date_sk and ss_list_price between 67 and 96 and i_manager_id BETWEEN 32 and 61 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-02-27')) and cs_sold_date_sk = d_date_sk and cs_list_price between 67 and 96 and i_manager_id BETWEEN 32 and 61 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-02-27')) and ws_sold_date_sk = d_date_sk and ws_list_price between 67 and 96 and i_manager_id BETWEEN 32 and 61 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1220,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 31 and 50 and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 238 and 252 and s2.ss_list_price between 238 and 252 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1221,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('AL','IL','MO') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'U', 'U') and cd_education_status in ('Advanced Degree', 'Advanced Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+2  and ss_list_price between 111 and 200 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+2  and ws_list_price between 111 and 200  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+2  and cs_list_price between 111 and 200)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1222,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 59 * 0.01 AND 79 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1193 and 1193 + 11  and s_state in ('GA','ID','IL'   ,'MO','OH','OK','SD','TN')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1193+ 12 and 1193 + 23  and s_state in ('GA','ID','IL'   ,'MO','OH','OK','SD','TN')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1223,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('AR','KS','MI') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'U', 'U') and cd_education_status in ('4 yr Degree', 'Secondary') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+2  and ss_list_price between 73 and 162 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+2  and ws_list_price between 73 and 162  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+2  and cs_list_price between 73 and 162)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1224,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 11 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
1225,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Music' and i_class = 'pop' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 9 and d_year = 1999 and wholesale_cost BETWEEN 67 AND 97 and c_birth_year BETWEEN 1938 AND 1951 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 67 AND 97  and s_state in ('AL','AR','IA'   ,'IL','KS','MD'   ,'MI','MN','OR'   ,'WA')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1999 and d_moy = 9)   and (select distinct d_month_seq+3   from date_dim where d_year = 1999 and d_moy = 9) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
1226,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1216 and 1216+11 and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1216 and 1216+11 and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 14 and 18  and s_state in ('MN','NC','NE') order by s_store_name, i_item_desc limit 100 ;"
1227,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'U' and  cd_education_status = 'Primary' and  d_year = 1998 and  s_state = 'MS' and i_category = 'Women'  ;"
1228,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Music' and d_year=1998 and d_moy = 7 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MO' and c_birth_month = 9 and ss_wholesale_cost BETWEEN 68 AND 88 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1229,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1178 and 1178 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 64 and 93 and sm_type = 'NEXT DAY' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1230,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 271 and 300 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('MO', 'OH', 'OK', 'SD')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (15, 50) and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1231,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'KS', 'SD') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'IN', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'NE', 'TX') and ss_net_profit between 50 and 250 ))  ;"
1232,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'WV'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
1233,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 11 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -6  ;"
1234,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1183 and 1183+11 and ss_list_price between 126 and 155 and c_birth_year BETWEEN 1967 AND 1973 and ss_wholesale_cost BETWEEN 86 AND 96 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1183 and 1183+11 and cs_list_price between 126 and 155 and c_birth_year BETWEEN 1967 AND 1973 and cs_wholesale_cost BETWEEN 86 AND 96 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1183 and 1183+11 and ws_list_price between 126 and 155 and c_birth_year BETWEEN 1967 AND 1973 and ws_wholesale_cost BETWEEN 86 AND 96 ) ) cool_cust  ;"
1235,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Home', 'Jewelry') and i_manager_id BETWEEN 26 and 35 and ss_wholesale_cost BETWEEN 30 AND 50 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Books', 'Home', 'Jewelry') and i_manager_id BETWEEN 26 and 35 and cs_wholesale_cost BETWEEN 30 AND 50 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 30 AND 50 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Home', 'Jewelry') and i_manager_id BETWEEN 26 and 35 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 30 AND 50  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 30 AND 50  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 30 AND 50 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 24) and i_category IN ('Books', 'Home', 'Jewelry') and i_manager_id BETWEEN 26 and 35 and ss_wholesale_cost BETWEEN 30 AND 50 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 24) and i_category IN ('Books', 'Home', 'Jewelry') and ss_wholesale_cost BETWEEN 30 AND 50 and i_manager_id BETWEEN 26 and 35 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
1236,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Sports' and d_year=1999 and d_moy = 1 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'RI' and c_birth_month = 5 and ss_wholesale_cost BETWEEN 16 AND 36 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1237,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'AK'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
1238,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1220 and 1220+11 and ss_sales_price / ss_list_price BETWEEN 1 * 0.01 AND 11 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1220 and 1220+11 and ss_sales_price / ss_list_price BETWEEN 1 * 0.01 AND 11 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 4 and 8  and s_state in ('MT','OR','SC') order by s_store_name, i_item_desc limit 100 ;"
1239,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1998 and i_manager_id BETWEEN 67 and 86 AND i_category IN ('Children', 'Home', 'Music') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1998 and ss_wholesale_cost BETWEEN 13 AND 23  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1950 AND 1956 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1998 and d_moy = 4 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 13 AND 23 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1998 and d_moy = 4 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 13 AND 23) tmp2 limit 100 ;"
1240,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=2001 and d_moy = 10 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'NC' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 75 AND 95 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1241,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11 and ss_list_price between 12 and 41 and c_birth_year BETWEEN 1949 AND 1955 and ss_wholesale_cost BETWEEN 8 AND 18 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11 and cs_list_price between 12 and 41 and c_birth_year BETWEEN 1949 AND 1955 and cs_wholesale_cost BETWEEN 8 AND 18 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11 and ws_list_price between 12 and 41 and c_birth_year BETWEEN 1949 AND 1955 and ws_wholesale_cost BETWEEN 8 AND 18 ) ) cool_cust  ;"
1242,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 24 and 33 and wr_return_amt / wr_return_quantity between 17 and 46 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CO', 'FL', 'NY', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (24, 54) and c_birth_year BETWEEN 1951 AND 1957 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1243,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Advanced Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2001 and  c_birth_month = 7 and  ca_state in ('CA', 'NJ', 'SC')  and cs_wholesale_cost BETWEEN 67 AND 72  AND i_category = 'Women'  ;"
1244,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Augusta County','Boone County','Clarke County','Dooly County','Milam County') and c.c_birth_month in (3, 12) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'U', 'U') and cd_education_status in ('Secondary', 'Advanced Degree', 'Secondary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Sports')  and ss_sales_price / ss_list_price BETWEEN 16 * 0.01 AND 26 * 0.01  and i_manager_id BETWEEN 91 and 100  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 ANd 7+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Sports')  and i_manager_id BETWEEN 91 and 100  and ws_sales_price / ws_list_price BETWEEN 16 * 0.01 AND 26 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Sports')  and i_manager_id BETWEEN 91 and 100  and cs_sales_price / cs_list_price BETWEEN 16 * 0.01 AND 26 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
1245,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Newtown' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 2 * 10000 and ib_upper_bound <= 2 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
1246,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('GA', 'NY', 'WI') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IN', 'MO', 'TN') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'IN', 'MT') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1247,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-06-04')) and ss_sold_date_sk = d_date_sk and ss_list_price between 54 and 83 and i_manager_id BETWEEN 25 and 54 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1972 AND 1978 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-06-04')) and cs_sold_date_sk = d_date_sk and cs_list_price between 54 and 83 and i_manager_id BETWEEN 25 and 54 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1972 AND 1978 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-06-04')) and ws_sold_date_sk = d_date_sk and ws_list_price between 54 and 83 and i_manager_id BETWEEN 25 and 54 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1972 AND 1978 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1248,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 158 and 217 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 19 AND 22 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('KY', 'NM', 'NY') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('U', 'M') and cd_education_status IN ('College', 'Primary') and cd_gender = 'M' and c_birth_month = 3 and c_birth_year BETWEEN 1927 AND 1933 order by c_customer_id limit 100 ;"
1249,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'S' and  cd_education_status = 'Unknown' and  d_year = 2001 and  s_state = 'MI' and i_category = 'Books'  ;"
1250,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 0 AND 20 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 69 and 69 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('AR','GA','MO') and ss_wholesale_cost BETWEEN 0 AND 20 and cd1.cd_marital_status in ('U', 'U', 'M') and cd1.cd_education_status in ('Advanced Degree', 'College', 'Advanced Degree') and cd2.cd_marital_status in ('U', 'U', 'M') and cd2.cd_education_status in ('Advanced Degree', 'College', 'Advanced Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
1251,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1211 and 1211 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 31 and 60 and sm_type = 'OVERNIGHT' and cc_class = 'medium' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1252,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 73 and 82 and wr_return_amt / wr_return_quantity between 130 and 159 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AR', 'FL', 'MI', 'NC')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (16, 50) and c_birth_year BETWEEN 1976 AND 1982 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1253,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1192 and 1192 + 11 and c_birth_month in (2, 5, 6, 11) and ss_list_price between 119 and 178 and ss_wholesale_cost BETWEEN 2 AND 22 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1192 and 1192 + 11 and c_birth_month in (2, 5, 6, 11) and cs_list_price between 119 and 178 and cs_wholesale_cost BETWEEN 2 AND 22 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1192 and 1192 + 11 and c_birth_month in (2, 5, 6, 11) and ws_list_price between 119 and 178 and ws_wholesale_cost BETWEEN 2 AND 22 ) hot_cust limit 100 ;"
1254,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1998-01-14','1998-06-21','1998-08-31','1998-10-13'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Women') and i_manager_id BETWEEN 90 and 99 and sr_return_amt / sr_return_quantity between 47 and 76 and sr_reason_sk in (2, 4, 17, 43, 60) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-01-14','1998-06-21','1998-08-31','1998-10-13'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Women') and i_manager_id BETWEEN 90 and 99 and cr_return_amount / cr_return_quantity between 47 and 76 and cr_reason_sk in (2, 4, 17, 43, 60) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-01-14','1998-06-21','1998-08-31','1998-10-13'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Women') and i_manager_id BETWEEN 90 and 99 and wr_return_amt / wr_return_quantity between 47 and 76 and wr_reason_sk in (2, 4, 17, 43, 60) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1255,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 29 and 38 and wr_return_amt / wr_return_quantity between 61 and 90 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('GA', 'KY', 'MN', 'WV')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (35, 75) and c_birth_year BETWEEN 1945 AND 1951 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1256,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Secondary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'College' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'NC', 'SD') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CT', 'MO', 'MT') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MA', 'OK', 'TX') and ss_net_profit between 50 and 250 ))  ;"
1257,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('FL', 'GA', 'KS') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IN', 'TX', 'VA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'NE', 'VA') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1258,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,avg(ss_net_profit) as store_sales_profit ,avg(sr_net_loss) as store_returns_loss ,avg(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 2001 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
1259,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 and sr_return_amt / sr_return_quantity between 143 and 202 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 31 AND 34 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('KY', 'MO', 'OH') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'M') and cd_education_status IN ('2 yr Degree', 'Unknown') and cd_gender = 'F' and c_birth_month = 6 and c_birth_year BETWEEN 1930 AND 1936 order by c_customer_id limit 100 ;"
1260,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('IA','NE','NY') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'M', 'W') and cd_education_status in ('Secondary', 'Advanced Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 and 3+2  and ss_list_price between 159 and 248 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 and 3+2  and ws_list_price between 159 and 248  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 and 3+2  and cs_list_price between 159 and 248)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1261,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1211 and 1211+11 and ss_list_price between 154 and 183 and c_birth_year BETWEEN 1979 AND 1985 and ss_wholesale_cost BETWEEN 59 AND 69 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1211 and 1211+11 and cs_list_price between 154 and 183 and c_birth_year BETWEEN 1979 AND 1985 and cs_wholesale_cost BETWEEN 59 AND 69 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1211 and 1211+11 and ws_list_price between 154 and 183 and c_birth_year BETWEEN 1979 AND 1985 and ws_wholesale_cost BETWEEN 59 AND 69 ) ) cool_cust  ;"
1262,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 2 and 11 and wr_return_amt / wr_return_quantity between 235 and 264 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AR', 'KS', 'MI', 'MO')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (30, 65) and c_birth_year BETWEEN 1985 AND 1991 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1263,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_REVERSED_TEXTGE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 and sr_return_amt / sr_return_quantity between 241 and 300 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 57 AND 60 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('DE', 'IN', 'OR') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('U', 'M') and cd_education_status IN ('Advanced Degree', '4 yr Degree') and cd_gender = 'M' and c_birth_month = 3 and c_birth_year BETWEEN 1936 AND 1942 order by c_customer_id limit 100 ;"
1264,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Athens County','Beaverhead County','Mitchell County','Pepin County','Roscommon County') and c.c_birth_month in (8, 9) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'M', 'D') and cd_education_status in ('Secondary', 'Secondary', 'Secondary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 and 6+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Men')  and ss_sales_price / ss_list_price BETWEEN 0 * 0.01 AND 10 * 0.01  and i_manager_id BETWEEN 17 and 26  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 ANd 6+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Men')  and i_manager_id BETWEEN 17 and 26  and ws_sales_price / ws_list_price BETWEEN 0 * 0.01 AND 10 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 6 and 6+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Men')  and i_manager_id BETWEEN 17 and 26  and cs_sales_price / cs_list_price BETWEEN 0 * 0.01 AND 10 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
1265,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Home' and d_year=2002 and d_moy = 11 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'FL' and c_birth_month = 2 and ss_wholesale_cost BETWEEN 76 AND 96  ;"
1266,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Centerville' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 40187 and ib_upper_bound <= 40187 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1267,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = '2 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2002 and  c_birth_month = 2 and  ca_state in ('AL', 'KY', 'WI')  and cs_wholesale_cost BETWEEN 15 AND 20  AND i_category = 'Books'  ;"
1268,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'Unknown' and d_year = 1998 and s_state = 'TX' and i_category = 'Shoes' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1269,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
1270,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'M' and  cd_education_status = 'Primary' and  d_year = 2000 and  s_state = 'KS' and i_category = 'Women'  ;"
1271,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('lemon', 'red') and i_manager_id BETWEEN 13 and 32 and ss_list_price between 201 and 215 and ca_state in ('KS','OH') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('lemon', 'red') and i_manager_id BETWEEN 13 and 32 and ws_list_price between 201 and 215 and ca_state in ('KS','OH') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2001 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2001 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2001 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2001 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2001 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2001 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.ca_county ;"
1272,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('deep', 'sienna') and i_manager_id BETWEEN 29 and 48 and ss_list_price between 121 and 135 and ca_state in ('PA','TX') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('deep', 'sienna') and i_manager_id BETWEEN 29 and 48 and ws_list_price between 121 and 135 and ca_state in ('PA','TX') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year ;"
1273,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1203 and 1203+11 and ss_sales_price / ss_list_price BETWEEN 65 * 0.01 AND 75 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1203 and 1203+11 and ss_sales_price / ss_list_price BETWEEN 65 * 0.01 AND 75 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 42 and 46  and s_state in ('AR','CA','TN') order by s_store_name, i_item_desc limit 100 ;"
1274,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=2002 and d_moy = 6 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'AK' and c_birth_month = 4 and ss_wholesale_cost BETWEEN 80 AND 100  ;"
1275,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -6  ;"
1276,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = '2 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 2001 and c_birth_month = 9 and ca_state in ('AR', 'GA', 'SD') and cs_wholesale_cost BETWEEN 63 AND 68 AND i_category = 'Women' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1277,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KY', 'ND', 'NM') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('MD', 'NC', 'TN') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('ID', 'NC', 'SD') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1278,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Sunnyside' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 54056 and ib_upper_bound <= 54056 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1279,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1204 and 1204 + 11 and c_birth_month in (3, 7, 9, 12) and ss_list_price between 232 and 291 and ss_wholesale_cost BETWEEN 7 AND 27 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1204 and 1204 + 11 and c_birth_month in (3, 7, 9, 12) and cs_list_price between 232 and 291 and cs_wholesale_cost BETWEEN 7 AND 27 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1204 and 1204 + 11 and c_birth_month in (3, 7, 9, 12) and ws_list_price between 232 and 291 and ws_wholesale_cost BETWEEN 7 AND 27 ) hot_cust limit 100 ;"
1280,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=2002 and d_moy = 11 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'AR' and c_birth_month = 12 and ss_wholesale_cost BETWEEN 51 AND 71 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1281,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1210 and 1210+11 and ss_sales_price / ss_list_price BETWEEN 13 * 0.01 AND 23 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1210 and 1210+11 and ss_sales_price / ss_list_price BETWEEN 13 * 0.01 AND 23 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 14 and 18  and s_state in ('IA','MD','OR') order by s_store_name, i_item_desc limit 100 ;"
1282,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,avg(ss_net_profit) as store_sales_profit ,avg(sr_net_loss) as store_returns_loss ,avg(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2001 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 4 and 4 + 2 and d2.d_year  = 2001 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 4 and 4 + 2 and d3.d_year  = 2001 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
1283,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('FL','KY','SD') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'M', 'M') and cd_education_status in ('Unknown', 'Unknown') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 1 and 1+2  and ss_list_price between 211 and 300 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 1 and 1+2  and ws_list_price between 211 and 300  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 1 and 1+2  and cs_list_price between 211 and 300)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1284,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188+11 and ss_list_price between 228 and 257 and c_birth_year BETWEEN 1976 AND 1982 and ss_wholesale_cost BETWEEN 48 AND 58 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188+11 and cs_list_price between 228 and 257 and c_birth_year BETWEEN 1976 AND 1982 and cs_wholesale_cost BETWEEN 48 AND 58 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188+11 and ws_list_price between 228 and 257 and c_birth_year BETWEEN 1976 AND 1982 and ws_wholesale_cost BETWEEN 48 AND 58 ) ) cool_cust  ;"
1285,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('KS','MS','TX') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'U', 'M') and cd_education_status in ('Advanced Degree', 'Advanced Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 and 9+2  and ss_list_price between 42 and 131 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 and 9+2  and ws_list_price between 42 and 131  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 9 and 9+2  and cs_list_price between 42 and 131)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1286,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1180 and 1180 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 271 and 300 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5  ;"
1287,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Books' and d_year=2001 and d_moy = 2 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'IL' and c_birth_month = 9 and ss_wholesale_cost BETWEEN 73 AND 93  ;"
1288,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Midway' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 5 * 10000 and ib_upper_bound <= 5 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
1289,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1186 and 1186 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 58 and 87 and sm_type = 'EXPRESS' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1290,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IL', 'KS', 'VA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('LA', 'ND', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AL', 'IA', 'KS') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1291,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=2002 and d_moy = 6 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'AK' and c_birth_month = 4 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1292,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1177 and 1177 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 20 and 49 and sm_type = 'TWO DAY' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1293,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1998-03-15','1998-04-10','1998-08-01','1998-10-05'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Shoes', 'Sports') and i_manager_id BETWEEN 80 and 89 and sr_return_amt / sr_return_quantity between 226 and 255 and sr_reason_sk in (17, 20, 22, 65, 73) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-03-15','1998-04-10','1998-08-01','1998-10-05'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Shoes', 'Sports') and i_manager_id BETWEEN 80 and 89 and cr_return_amount / cr_return_quantity between 226 and 255 and cr_reason_sk in (17, 20, 22, 65, 73) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-03-15','1998-04-10','1998-08-01','1998-10-05'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Shoes', 'Sports') and i_manager_id BETWEEN 80 and 89 and wr_return_amt / wr_return_quantity between 226 and 255 and wr_reason_sk in (17, 20, 22, 65, 73) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1294,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 47 and 56 and wr_return_amt / wr_return_quantity between 95 and 124 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('IL', 'NE', 'PA', 'VT')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (23, 38) and c_birth_year BETWEEN 1927 AND 1933 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1295,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1198 and 1198 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 229 and 258 and sm_type = 'NEXT DAY' and cc_class = 'small' and w_gmt_offset = -5  ;"
1296,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1207 and 1207+11 and ss_sales_price / ss_list_price BETWEEN 31 * 0.01 AND 41 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1207 and 1207+11 and ss_sales_price / ss_list_price BETWEEN 31 * 0.01 AND 41 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 24 and 28  and s_state in ('IL','MN','TN') order by s_store_name, i_item_desc limit 100 ;"
1297,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 20 * 0.01 AND 40 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1202 and 1202 + 11  and s_state in ('AL','FL','IA'   ,'MO','NC','OK','PA','TN')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1202+ 12 and 1202 + 23  and s_state in ('AL','FL','IA'   ,'MO','NC','OK','PA','TN')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1298,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1184 and 1184+11 and ss_list_price between 15 and 44 and c_birth_year BETWEEN 1965 AND 1971 and ss_wholesale_cost BETWEEN 18 AND 28 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1184 and 1184+11 and cs_list_price between 15 and 44 and c_birth_year BETWEEN 1965 AND 1971 and cs_wholesale_cost BETWEEN 18 AND 28 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1184 and 1184+11 and ws_list_price between 15 and 44 and c_birth_year BETWEEN 1965 AND 1971 and ws_wholesale_cost BETWEEN 18 AND 28 ) ) cool_cust  ;"
1299,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'GA', 'SD') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('LA', 'MS', 'NC') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MI', 'MO', 'PA') and ss_net_profit between 50 and 250 ))  ;"
1300,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 72 and 91 AND i_category IN ('Books', 'Shoes', 'Sports') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 69 AND 79  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1964 AND 1970 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1999 and d_moy = 3 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 69 AND 79 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1999 and d_moy = 3 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 69 AND 79) tmp2 limit 100 ;"
1301,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Primary' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 2 and  ca_state in ('MI', 'NJ', 'PA')  and cs_wholesale_cost BETWEEN 38 AND 43  AND i_category = 'Children'  ;"
1302,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'MO', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'MT', 'NM') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('KY', 'NY', 'OH') and ws_net_profit between 50 and 250 ) )  ;"
1303,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-02-23','1999-04-11','1999-07-12','1999-11-01'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Women') and i_manager_id BETWEEN 1 and 10 and sr_return_amt / sr_return_quantity between 70 and 99 and sr_reason_sk in (21, 26, 46, 55, 69) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-02-23','1999-04-11','1999-07-12','1999-11-01'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Women') and i_manager_id BETWEEN 1 and 10 and cr_return_amount / cr_return_quantity between 70 and 99 and cr_reason_sk in (21, 26, 46, 55, 69) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-02-23','1999-04-11','1999-07-12','1999-11-01'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Women') and i_manager_id BETWEEN 1 and 10 and wr_return_amt / wr_return_quantity between 70 and 99 and wr_reason_sk in (21, 26, 46, 55, 69) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1304,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1210 and 1210 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 211 and 240 and sm_type = 'NEXT DAY' and cc_class = 'medium' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1305,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 77 AND 97 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 29 and 29 + 10 and p_channel_email = 'Y' and p_channel_tv = 'Y' and p_channel_radio = 'N' and ad2.ca_state in ('IL','MT','VA') and ss_wholesale_cost BETWEEN 77 AND 97 and cd1.cd_marital_status in ('D', 'M', 'W') and cd1.cd_education_status in ('Advanced Degree', 'Primary', 'Unknown') and cd2.cd_marital_status in ('D', 'M', 'W') and cd2.cd_education_status in ('Advanced Degree', 'Primary', 'Unknown') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
1306,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('ID','OK','SD') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('D', 'M', 'M') and cd_education_status in ('4 yr Degree', 'Advanced Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 1 and 1+2  and ss_list_price between 211 and 300 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 1 and 1+2  and ws_list_price between 211 and 300  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 1 and 1+2  and cs_list_price between 211 and 300)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1307,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 67 and 76 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 67 and 76 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 80 AND 100 and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 67 and 76 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and ss_wholesale_cost BETWEEN 80 AND 100  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and cs_wholesale_cost BETWEEN 80 AND 100  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 80 AND 100 and d_year between 1999 and 1999 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999 + 1   and d_moy = 12   and d_dom = 9) and i_category IN ('Books', 'Children', 'Jewelry') and i_manager_id BETWEEN 67 and 76 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999   and d_moy = 12   and d_dom = 9) and i_category IN ('Books', 'Children', 'Jewelry') and ss_wholesale_cost BETWEEN 80 AND 100 and i_manager_id BETWEEN 67 and 76 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
1308,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1197 and 1197+11 and ss_sales_price / ss_list_price BETWEEN 21 * 0.01 AND 31 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1197 and 1197+11 and ss_sales_price / ss_list_price BETWEEN 21 * 0.01 AND 31 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 33 and 37  and s_state in ('MN','OK','WV') order by s_store_name, i_item_desc limit 100 ;"
1309,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'U' and  cd_education_status = 'Unknown' and  d_year = 2002 and  s_state = 'AR' and i_category = 'Children'  ;"
1310,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Secondary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MT', 'SD', 'TN') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'TN', 'WA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'KS', 'WA') and ss_net_profit between 50 and 250 ))  ;"
1311,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Women' and i_class = 'fragrances' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 5 and d_year = 1998 and wholesale_cost BETWEEN 38 AND 68 and c_birth_year BETWEEN 1959 AND 1972 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 38 AND 68  and s_state in ('AL','AR','CO'   ,'GA','IA','ID'   ,'MN','NC','SD'   ,'WV')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1998 and d_moy = 5)   and (select distinct d_month_seq+3   from date_dim where d_year = 1998 and d_moy = 5) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
1312,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-04-23')) and ss_sold_date_sk = d_date_sk and ss_list_price between 238 and 267 and i_manager_id BETWEEN 38 and 67 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1945 AND 1951 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-04-23')) and cs_sold_date_sk = d_date_sk and cs_list_price between 238 and 267 and i_manager_id BETWEEN 38 and 67 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1945 AND 1951 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-04-23')) and ws_sold_date_sk = d_date_sk and ws_list_price between 238 and 267 and i_manager_id BETWEEN 38 and 67 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1945 AND 1951 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1313,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 1998 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
1314,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Books' and i_class = 'romance' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 7 and d_year = 1998 and wholesale_cost BETWEEN 37 AND 67 and c_birth_year BETWEEN 1944 AND 1957 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 37 AND 67  and s_state in ('GA','IL','MN'   ,'MO','MS','TX'   ,'VA','WA','WV'   ,'WY')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1998 and d_moy = 7)   and (select distinct d_month_seq+3   from date_dim where d_year = 1998 and d_moy = 7) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
1315,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AR', 'IN', 'NE') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IA', 'MS', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('KY', 'MT', 'TX') and ws_net_profit between 50 and 250 ) )  ;"
1316,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2002 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Books', 'Children', 'Jewelry') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and ss_wholesale_cost BETWEEN 15 AND 25  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1978 AND 1984 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2002 and d_moy = 6 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 15 AND 25 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2002 and d_moy = 6 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 15 AND 25) tmp2 limit 100 ;"
1317,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'S' and  cd_education_status = 'Unknown' and  d_year = 1998 and  s_state = 'OK' and i_category = 'Shoes'  ;"
1318,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Children', 'Home', 'Jewelry') and i_manager_id BETWEEN 46 and 55 and ss_wholesale_cost BETWEEN 31 AND 51 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Children', 'Home', 'Jewelry') and i_manager_id BETWEEN 46 and 55 and cs_wholesale_cost BETWEEN 31 AND 51 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 31 AND 51 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Home', 'Jewelry') and i_manager_id BETWEEN 46 and 55 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 31 AND 51  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 31 AND 51  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 31 AND 51 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 18) and i_category IN ('Children', 'Home', 'Jewelry') and i_manager_id BETWEEN 46 and 55 and ss_wholesale_cost BETWEEN 31 AND 51 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 18) and i_category IN ('Children', 'Home', 'Jewelry') and ss_wholesale_cost BETWEEN 31 AND 51 and i_manager_id BETWEEN 46 and 55 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
1319,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-04-15')) and ss_sold_date_sk = d_date_sk and ss_list_price between 271 and 300 and i_manager_id BETWEEN 35 and 64 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1951 AND 1957 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-04-15')) and cs_sold_date_sk = d_date_sk and cs_list_price between 271 and 300 and i_manager_id BETWEEN 35 and 64 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1951 AND 1957 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-04-15')) and ws_sold_date_sk = d_date_sk and ws_list_price between 271 and 300 and i_manager_id BETWEEN 35 and 64 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1951 AND 1957 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1320,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'College' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KY', 'MN', 'VT') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('SC', 'VA', 'WA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'MO', 'MT') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1321,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1207 and 1207 + 11 and c_birth_month in (3, 4, 6, 8) and ss_list_price between 241 and 300 and ss_wholesale_cost BETWEEN 62 AND 82 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1207 and 1207 + 11 and c_birth_month in (3, 4, 6, 8) and cs_list_price between 241 and 300 and cs_wholesale_cost BETWEEN 62 AND 82 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1207 and 1207 + 11 and c_birth_month in (3, 4, 6, 8) and ws_list_price between 241 and 300 and ws_wholesale_cost BETWEEN 62 AND 82 ) hot_cust limit 100 ;"
1322,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'TX', 'WI') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('ID', 'VT', 'WI') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('ID', 'ME', 'OK') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1323,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('GA','PA','SD') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'M', 'M') and cd_education_status in ('4 yr Degree', 'Advanced Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+2  and ss_list_price between 12 and 101 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+2  and ws_list_price between 12 and 101  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 7 and 7+2  and cs_list_price between 12 and 101)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1324,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Centerville' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 4 * 10000 and ib_upper_bound <= 4 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
1325,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('NC', 'NE', 'SC') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('LA', 'NC', 'SD') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('ND', 'TN', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1326,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188 + 11 and c_birth_month in (6, 9, 10, 11) and ss_list_price between 113 and 172 and ss_wholesale_cost BETWEEN 4 AND 24 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188 + 11 and c_birth_month in (6, 9, 10, 11) and cs_list_price between 113 and 172 and cs_wholesale_cost BETWEEN 4 AND 24 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188 + 11 and c_birth_month in (6, 9, 10, 11) and ws_list_price between 113 and 172 and ws_wholesale_cost BETWEEN 4 AND 24 ) hot_cust limit 100 ;"
1327,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AL', 'ID', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('MD', 'MS', 'UT') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'IN', 'NY') and ws_net_profit between 50 and 250 ) )  ;"
1328,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=2002 and d_moy = 4 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'VA' and c_birth_month = 2 and ss_wholesale_cost BETWEEN 2 AND 22 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1329,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1186 and 1186 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 58 and 87 and sm_type = 'EXPRESS' and cc_class = 'large' and w_gmt_offset = -5  ;"
1330,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1221 and 1221+11 and ss_sales_price / ss_list_price BETWEEN 35 * 0.01 AND 45 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1221 and 1221+11 and ss_sales_price / ss_list_price BETWEEN 35 * 0.01 AND 45 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 83 and 87  and s_state in ('MO','SD','VA') order by s_store_name, i_item_desc limit 100 ;"
1331,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'College' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'MS', 'ND') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AR', 'OR', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('KS', 'MN', 'TX') and ws_net_profit between 50 and 250 ) )  ;"
1332,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 80 * 0.01 AND 100 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1191 and 1191 + 11  and s_state in ('AL','MA','MO'   ,'MS','NC','NE','OH','VA')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1191+ 12 and 1191 + 23  and s_state in ('AL','MA','MO'   ,'MS','NC','NE','OH','VA')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1333,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 38 and 47 and ss_wholesale_cost BETWEEN 9 AND 29 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 38 and 47 and cs_wholesale_cost BETWEEN 9 AND 29 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 9 AND 29 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 38 and 47 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 9 AND 29  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 9 AND 29  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 9 AND 29 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 7) and i_category IN ('Home', 'Jewelry', 'Women') and i_manager_id BETWEEN 38 and 47 and ss_wholesale_cost BETWEEN 9 AND 29 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 7) and i_category IN ('Home', 'Jewelry', 'Women') and ss_wholesale_cost BETWEEN 9 AND 29 and i_manager_id BETWEEN 38 and 47 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
1334,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Home' and d_year=2000 and d_moy = 3 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'GA' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 40 AND 60  ;"
1335,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1180 and 1180 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 271 and 300 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1336,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'U' and cd_education_status = 'Primary' and d_year = 2002 and s_state = 'VA' and i_category = 'Women' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1337,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2002 and i_manager_id BETWEEN 7 and 26 AND i_category IN ('Home', 'Men', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and ss_wholesale_cost BETWEEN 56 AND 66  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1966 AND 1972 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2002 and d_moy = 8 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 56 AND 66 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2002 and d_moy = 8 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 56 AND 66) tmp2 limit 100 ;"
1338,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1189 and 1189+11 and ss_sales_price / ss_list_price BETWEEN 78 * 0.01 AND 88 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1189 and 1189+11 and ss_sales_price / ss_list_price BETWEEN 78 * 0.01 AND 88 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 33 and 37  and s_state in ('CA','KS','SC') order by s_store_name, i_item_desc limit 100 ;"
1339,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1196 and 1196 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 260 and 289 and sm_type = 'TWO DAY' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1340,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('MO','MS','WA') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'W', 'S') and cd_education_status in ('2 yr Degree', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+2  and ss_list_price between 38 and 127 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+2  and ws_list_price between 38 and 127  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 9 and 9+2  and cs_list_price between 38 and 127)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1341,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Secondary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'LA', 'NC') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NC', 'OH', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'MA', 'MS') and ss_net_profit between 50 and 250 ))  ;"
1342,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Advanced Degree' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 3 and ca_state in ('MI', 'NM', 'NY') and cs_wholesale_cost BETWEEN 91 AND 96 AND i_category = 'Electronics' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1343,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Men' and d_year=1998 and d_moy = 2 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'KS' and c_birth_month = 3 and ss_wholesale_cost BETWEEN 28 AND 48  ;"
1344,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Advanced Degree' and c_current_addr_sk = ca_address_sk and d_year = 1998 and c_birth_month = 6 and ca_state in ('AK', 'MN', 'NV') and cs_wholesale_cost BETWEEN 59 AND 64 AND i_category = 'Children' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1345,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
1346,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1185 and 1185+11 and ss_list_price between 167 and 196 and c_birth_year BETWEEN 1987 AND 1993 and ss_wholesale_cost BETWEEN 83 AND 93 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1185 and 1185+11 and cs_list_price between 167 and 196 and c_birth_year BETWEEN 1987 AND 1993 and cs_wholesale_cost BETWEEN 83 AND 93 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1185 and 1185+11 and ws_list_price between 167 and 196 and c_birth_year BETWEEN 1987 AND 1993 and ws_wholesale_cost BETWEEN 83 AND 93 ) ) cool_cust  ;"
1347,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 1998  ;"
1348,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('IL','MS','NJ') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'U', 'U') and cd_education_status in ('Primary', 'Unknown') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 1 and 1+2  and ss_list_price between 163 and 252 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 1 and 1+2  and ws_list_price between 163 and 252  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 1 and 1+2  and cs_list_price between 163 and 252)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1349,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('forest', 'yellow') and i_manager_id BETWEEN 81 and 100 and ss_list_price between 38 and 52 and ca_state in ('CT','MI') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('forest', 'yellow') and i_manager_id BETWEEN 81 and 100 and ws_list_price between 38 and 52 and ca_state in ('CT','MI') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2001 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2001 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2001 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2001 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2001 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2001 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q2_q3_increase ;"
1350,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 9 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7  ;"
1351,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('mint', 'thistle') and i_manager_id BETWEEN 13 and 32 and ss_list_price between 107 and 121 and ca_state in ('KS','ND') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('mint', 'thistle') and i_manager_id BETWEEN 13 and 32 and ws_list_price between 107 and 121 and ca_state in ('KS','ND') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q2_q3_increase ;"
1352,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Clifton' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 13729 and ib_upper_bound <= 13729 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1353,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Secondary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MI', 'NM', 'NY') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'GA', 'IL') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'MS', 'NJ') and ss_net_profit between 50 and 250 ))  ;"
1354,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 46 AND 66 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 62 and 62 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'Y' and ad2.ca_state in ('WA','WV','WY') and ss_wholesale_cost BETWEEN 46 AND 66 and cd1.cd_marital_status in ('M', 'M', 'U') and cd1.cd_education_status in ('4 yr Degree', 'Secondary', '4 yr Degree') and cd2.cd_marital_status in ('M', 'M', 'U') and cd2.cd_education_status in ('4 yr Degree', 'Secondary', '4 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1999 and cs2.syear = 1999 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
1355,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Shoes') and item2.i_manager_id between 48 and 67 and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 80 and 94 and s2.ss_list_price between 80 and 94 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1356,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 3 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 3 and 3 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 3 and 3 + 2 and d3.d_year  = 2002  ;"
1357,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1221 and 1221+11 and ss_sales_price / ss_list_price BETWEEN 65 * 0.01 AND 75 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1221 and 1221+11 and ss_sales_price / ss_list_price BETWEEN 65 * 0.01 AND 75 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 60 and 64  and s_state in ('CA','KS','TX') order by s_store_name, i_item_desc limit 100 ;"
1358,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Collier County','Franklin County','Jefferson County','Kenosha County','Osceola County') and c.c_birth_month in (7, 8) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'M', 'M') and cd_education_status in ('Advanced Degree', 'Primary', 'Primary') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 4 and 4+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Women')  and ss_sales_price / ss_list_price BETWEEN 9 * 0.01 AND 19 * 0.01  and i_manager_id BETWEEN 45 and 54  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 4 ANd 4+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Women')  and i_manager_id BETWEEN 45 and 54  and ws_sales_price / ws_list_price BETWEEN 9 * 0.01 AND 19 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 4 and 4+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Women')  and i_manager_id BETWEEN 45 and 54  and cs_sales_price / cs_list_price BETWEEN 9 * 0.01 AND 19 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
1359,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1202 and 1202+11 and ss_list_price between 154 and 183 and c_birth_year BETWEEN 1930 AND 1936 and ss_wholesale_cost BETWEEN 49 AND 59 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1202 and 1202+11 and cs_list_price between 154 and 183 and c_birth_year BETWEEN 1930 AND 1936 and cs_wholesale_cost BETWEEN 49 AND 59 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1202 and 1202+11 and ws_list_price between 154 and 183 and c_birth_year BETWEEN 1930 AND 1936 and ws_wholesale_cost BETWEEN 49 AND 59 ) ) cool_cust  ;"
1360,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Electronics', 'Jewelry') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = 'Secondary' and s1.ss_list_price between 216 and 230 and s2.ss_list_price between 216 and 230 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1361,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Mount Zion' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 0 * 10000 and ib_upper_bound <= 0 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
1362,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2001 and i_manager_id BETWEEN 50 and 69 AND i_category IN ('Books', 'Home', 'Sports') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and ss_wholesale_cost BETWEEN 2 AND 12  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2001 and d_moy = 1 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 2 AND 12 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2001 and d_moy = 1 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 2 AND 12) tmp2 limit 100 ;"
1363,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2002 and i_manager_id BETWEEN 66 and 85 AND i_category IN ('Children', 'Jewelry', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and ss_wholesale_cost BETWEEN 19 AND 29  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1987 AND 1993 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2002 and d_moy = 3 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 19 AND 29 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2002 and d_moy = 3 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 19 AND 29) tmp2 limit 100 ;"
1364,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MN', 'NM', 'NY') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'KS', 'WI') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'TN', 'TX') and ss_net_profit between 50 and 250 ))  ;"
1365,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=1998 and d_moy = 1 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'SD' and c_birth_month = 1 and ss_wholesale_cost BETWEEN 9 AND 29  ;"
1366,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 65 AND 85 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 0 and 0 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('NJ','SC','VA') and ss_wholesale_cost BETWEEN 65 AND 85 and cd1.cd_marital_status in ('M', 'M', 'W') and cd1.cd_education_status in ('Secondary', 'Secondary', 'Secondary') and cd2.cd_marital_status in ('M', 'M', 'W') and cd2.cd_education_status in ('Secondary', 'Secondary', 'Secondary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
1367,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Coweta County','Penobscot County','Plymouth County','Tyrrell County','Winona County') and c.c_birth_month in (3, 9) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'S', 'M') and cd_education_status in ('Unknown', '4 yr Degree', '2 yr Degree') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 4 and 4+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Shoes')  and ss_sales_price / ss_list_price BETWEEN 53 * 0.01 AND 63 * 0.01  and i_manager_id BETWEEN 85 and 94  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 4 ANd 4+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Shoes')  and i_manager_id BETWEEN 85 and 94  and ws_sales_price / ws_list_price BETWEEN 53 * 0.01 AND 63 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 4 and 4+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Jewelry', 'Shoes')  and i_manager_id BETWEEN 85 and 94  and cs_sales_price / cs_list_price BETWEEN 53 * 0.01 AND 63 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
1368,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 55 and 64 and wr_return_amt / wr_return_quantity between 35 and 64 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AR', 'OK', 'SC', 'WI')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (39, 70) and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1369,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,max(ss_net_profit) as store_sales_profit ,max(sr_net_loss) as store_returns_loss ,max(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
1370,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KY', 'LA', 'SC') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('CA', 'IN', 'KS') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('OH', 'TN', 'WV') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1371,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'TX', 'VA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'VA', 'WA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MN', 'WV', 'WY') and ss_net_profit between 50 and 250 ))  ;"
1372,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 8 and 17 and wr_return_amt / wr_return_quantity between 271 and 300 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AL', 'FL', 'MO', 'NC')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (30, 59) and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1373,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Home' and d_year=2002 and d_moy = 8 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'TX' and c_birth_month = 4 and ss_wholesale_cost BETWEEN 42 AND 62 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1374,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 38 and 47 and wr_return_amt / wr_return_quantity between 271 and 300 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('GA', 'IA', 'OH', 'OR')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (60, 61) and c_birth_year BETWEEN 1972 AND 1978 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1375,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1193 and 1193 + 11 and c_birth_month in (1, 2, 3, 12) and ss_list_price between 196 and 255 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1193 and 1193 + 11 and c_birth_month in (1, 2, 3, 12) and cs_list_price between 196 and 255 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1193 and 1193 + 11 and c_birth_month in (1, 2, 3, 12) and ws_list_price between 196 and 255 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
1376,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('GA','MN','TX') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'M', 'M') and cd_education_status in ('Unknown', '2 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 7 and 7+2  and ss_list_price between 99 and 188 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 7 and 7+2  and ws_list_price between 99 and 188  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2002 and  d_moy between 7 and 7+2  and cs_list_price between 99 and 188)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1377,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Shoes') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 182 and 196 and s2.ss_list_price between 182 and 196  ;"
1378,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 2 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -6  ;"
1379,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'S' and  cd_education_status = '2 yr Degree' and  d_year = 2000 and  s_state = 'TN' and i_category = 'Women'  ;"
1380,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-02-13')) and ss_sold_date_sk = d_date_sk and ss_list_price between 217 and 246 and i_manager_id BETWEEN 46 and 75 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1963 AND 1969 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-02-13')) and cs_sold_date_sk = d_date_sk and cs_list_price between 217 and 246 and i_manager_id BETWEEN 46 and 75 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1963 AND 1969 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-02-13')) and ws_sold_date_sk = d_date_sk and ws_list_price between 217 and 246 and i_manager_id BETWEEN 46 and 75 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1963 AND 1969 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1381,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11 and ss_list_price between 207 and 236 and c_birth_year BETWEEN 1957 AND 1963 and ss_wholesale_cost BETWEEN 90 AND 100 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11 and cs_list_price between 207 and 236 and c_birth_year BETWEEN 1957 AND 1963 and cs_wholesale_cost BETWEEN 90 AND 100 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11 and ws_list_price between 207 and 236 and c_birth_year BETWEEN 1957 AND 1963 and ws_wholesale_cost BETWEEN 90 AND 100 ) ) cool_cust  ;"
1382,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 152 and 211 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 13 AND 16 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AR', 'IL', 'TX') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('U', 'U') and cd_education_status IN ('Primary', 'Secondary') and cd_gender = 'M' and c_birth_month = 10 and c_birth_year BETWEEN 1993 AND 1999 order by c_customer_id limit 100 ;"
1383,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1205 and 1205 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 132 and 161 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1384,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1180 and 1180 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 23 and 52 and sm_type = 'REGULAR' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1385,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 10 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 10 and 10 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 10 and 10 + 2 and d3.d_year  = 2002  ;"
1386,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
1387,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1216 and 1216 + 11 and c_birth_month in (3, 9, 11, 12) and ss_list_price between 50 and 109 and ss_wholesale_cost BETWEEN 57 AND 77 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1216 and 1216 + 11 and c_birth_month in (3, 9, 11, 12) and cs_list_price between 50 and 109 and cs_wholesale_cost BETWEEN 57 AND 77 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1216 and 1216 + 11 and c_birth_month in (3, 9, 11, 12) and ws_list_price between 50 and 109 and ws_wholesale_cost BETWEEN 57 AND 77 ) hot_cust limit 100 ;"
1388,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Music') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 112 and 126 and s2.ss_list_price between 112 and 126  ;"
1389,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-03-09','1999-04-07','1999-08-16','1999-11-12'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Electronics', 'Home') and i_manager_id BETWEEN 74 and 83 and sr_return_amt / sr_return_quantity between 106 and 135 and sr_reason_sk in (23, 28, 31, 53, 58) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-03-09','1999-04-07','1999-08-16','1999-11-12'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Electronics', 'Home') and i_manager_id BETWEEN 74 and 83 and cr_return_amount / cr_return_quantity between 106 and 135 and cr_reason_sk in (23, 28, 31, 53, 58) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-03-09','1999-04-07','1999-08-16','1999-11-12'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Electronics', 'Home') and i_manager_id BETWEEN 74 and 83 and wr_return_amt / wr_return_quantity between 106 and 135 and wr_reason_sk in (23, 28, 31, 53, 58) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1390,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IN', 'SD', 'TX') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AK', 'GA', 'NC') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IN', 'ND', 'OK') and ws_net_profit between 50 and 250 ) )  ;"
1391,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221 + 11 and c_birth_month in (1, 2, 5, 9) and ss_list_price between 35 and 94 and ss_wholesale_cost BETWEEN 62 AND 82 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221 + 11 and c_birth_month in (1, 2, 5, 9) and cs_list_price between 35 and 94 and cs_wholesale_cost BETWEEN 62 AND 82 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221 + 11 and c_birth_month in (1, 2, 5, 9) and ws_list_price between 35 and 94 and ws_wholesale_cost BETWEEN 62 AND 82 ) hot_cust limit 100 ;"
1392,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1200 and 1200 + 11 and c_birth_month in (1, 5, 6, 10) and ss_list_price between 217 and 276 and ss_wholesale_cost BETWEEN 68 AND 88 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1200 and 1200 + 11 and c_birth_month in (1, 5, 6, 10) and cs_list_price between 217 and 276 and cs_wholesale_cost BETWEEN 68 AND 88 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1200 and 1200 + 11 and c_birth_month in (1, 5, 6, 10) and ws_list_price between 217 and 276 and ws_wholesale_cost BETWEEN 68 AND 88 ) hot_cust limit 100 ;"
1393,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MN', 'OK', 'WV') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IL', 'OK', 'VA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'KY', 'VA') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1394,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Friendship' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 51986 and ib_upper_bound <= 51986 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1395,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1187 and 1187 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 271 and 300 and sm_type = 'LIBRARY' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1396,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Woodlawn' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 3 * 10000 and ib_upper_bound <= 3 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
1397,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1205 and 1205 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 77 and 106 and sm_type = 'TWO DAY' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1398,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
1399,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Books' and d_year=2000 and d_moy = 8 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'NY' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 77 AND 97  ;"
1400,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Jewelry' and i_class = 'mens watch' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 6 and d_year = 2002 and wholesale_cost BETWEEN 21 AND 51 and c_birth_year BETWEEN 1956 AND 1969 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 21 AND 51  and s_state in ('AK','AR','GA'   ,'IA','MT','NY'   ,'PA','TN','TX'   ,'VA')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2002 and d_moy = 6)   and (select distinct d_month_seq+3   from date_dim where d_year = 2002 and d_moy = 6) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
1401,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-02-21','1999-05-10','1999-07-17','1999-10-31'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Shoes') and i_manager_id BETWEEN 60 and 69 and sr_return_amt / sr_return_quantity between 178 and 207 and sr_reason_sk in (4, 15, 25, 56, 72) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-02-21','1999-05-10','1999-07-17','1999-10-31'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Shoes') and i_manager_id BETWEEN 60 and 69 and cr_return_amount / cr_return_quantity between 178 and 207 and cr_reason_sk in (4, 15, 25, 56, 72) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-02-21','1999-05-10','1999-07-17','1999-10-31'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Children', 'Shoes') and i_manager_id BETWEEN 60 and 69 and wr_return_amt / wr_return_quantity between 178 and 207 and wr_reason_sk in (4, 15, 25, 56, 72) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1402,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 19 and 38 and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 111 and 125 and s2.ss_list_price between 111 and 125 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1403,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-07-03')) and ss_sold_date_sk = d_date_sk and ss_list_price between 38 and 67 and i_manager_id BETWEEN 70 and 99 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1955 AND 1961 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-07-03')) and cs_sold_date_sk = d_date_sk and cs_list_price between 38 and 67 and i_manager_id BETWEEN 70 and 99 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1955 AND 1961 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-07-03')) and ws_sold_date_sk = d_date_sk and ws_list_price between 38 and 67 and i_manager_id BETWEEN 70 and 99 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1955 AND 1961 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1404,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'S' and cd_education_status = 'Unknown' and d_year = 1998 and s_state = 'OK' and i_category = 'Shoes' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1405,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 1998  ;"
1406,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AL', 'AZ', 'VA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AK', 'AR', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'KS', 'MN') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1407,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AL', 'GA', 'NC') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AR', 'GA', 'IA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IA', 'MN', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1408,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 77 * 0.01 AND 97 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1179 and 1179 + 11  and s_state in ('AL','KS','MO'   ,'MT','NM','TN','VT','WI')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1179+ 12 and 1179 + 23  and s_state in ('AL','KS','MO'   ,'MT','NM','TN','VT','WI')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1409,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1213 and 1213+11 and ss_sales_price / ss_list_price BETWEEN 22 * 0.01 AND 32 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1213 and 1213+11 and ss_sales_price / ss_list_price BETWEEN 22 * 0.01 AND 32 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 56 and 60  and s_state in ('MD','TN','VA') order by s_store_name, i_item_desc limit 100 ;"
1410,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('AL','KS','WA') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('S', 'W', 'U') and cd_education_status in ('Advanced Degree', 'Advanced Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 8 and 8+2  and ss_list_price between 57 and 146 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 8 and 8+2  and ws_list_price between 57 and 146  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 8 and 8+2  and cs_list_price between 57 and 146)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1411,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'MN', 'NC') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('KY', 'MN', 'WV') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'IN', 'VA') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1412,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1218 and 1218 + 11 and c_birth_month in (4, 7, 8, 9) and ss_list_price between 241 and 300 and ss_wholesale_cost BETWEEN 63 AND 83 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1218 and 1218 + 11 and c_birth_month in (4, 7, 8, 9) and cs_list_price between 241 and 300 and cs_wholesale_cost BETWEEN 63 AND 83 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1218 and 1218 + 11 and c_birth_month in (4, 7, 8, 9) and ws_list_price between 241 and 300 and ws_wholesale_cost BETWEEN 63 AND 83 ) hot_cust limit 100 ;"
1413,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-01-05')) and ss_sold_date_sk = d_date_sk and ss_list_price between 74 and 103 and i_manager_id BETWEEN 54 and 83 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1930 AND 1936 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-01-05')) and cs_sold_date_sk = d_date_sk and cs_list_price between 74 and 103 and i_manager_id BETWEEN 54 and 83 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1930 AND 1936 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1999-01-05')) and ws_sold_date_sk = d_date_sk and ws_list_price between 74 and 103 and i_manager_id BETWEEN 54 and 83 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1930 AND 1936 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1414,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Home', 'Women') and item2.i_manager_id between 22 and 41 and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 286 and 300 and s2.ss_list_price between 286 and 300 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1415,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Children' and i_class = 'school-uniforms' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 1 and d_year = 2002 and wholesale_cost BETWEEN 14 AND 44 and c_birth_year BETWEEN 1926 AND 1939 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 14 AND 44  and s_state in ('AL','AR','ID'   ,'MD','MO','NC'   ,'NE','NH','SD'   ,'TX')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2002 and d_moy = 1)   and (select distinct d_month_seq+3   from date_dim where d_year = 2002 and d_moy = 1) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
1416,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2000-01-28','2000-04-26','2000-07-18','2000-11-08'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Men') and i_manager_id BETWEEN 30 and 39 and sr_return_amt / sr_return_quantity between 79 and 108 and sr_reason_sk in (7, 25, 26, 32, 36) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-01-28','2000-04-26','2000-07-18','2000-11-08'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Men') and i_manager_id BETWEEN 30 and 39 and cr_return_amount / cr_return_quantity between 79 and 108 and cr_reason_sk in (7, 25, 26, 32, 36) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2000-01-28','2000-04-26','2000-07-18','2000-11-08'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Men') and i_manager_id BETWEEN 30 and 39 and wr_return_amt / wr_return_quantity between 79 and 108 and wr_reason_sk in (7, 25, 26, 32, 36) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1417,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1182 and 1182 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 191 and 220 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5  ;"
1418,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('lime', 'seashell') and i_manager_id BETWEEN 59 and 78 and ss_list_price between 212 and 226 and ca_state in ('AR','CA') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('lime', 'seashell') and i_manager_id BETWEEN 59 and 78 and ws_list_price between 212 and 226 and ca_state in ('AR','CA') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year ;"
1419,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2001 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'WI'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
1420,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 7 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
1421,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and d_year = 2002 and s_state = 'IA' and i_category = 'Books' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1422,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Home' and d_year=2001 and d_moy = 12 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'TX' and c_birth_month = 5 and ss_wholesale_cost BETWEEN 80 AND 100  ;"
1423,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 3 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
1424,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Shoes' and d_year=2002 and d_moy = 5 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'ID' and c_birth_month = 10 and ss_wholesale_cost BETWEEN 57 AND 77  ;"
1425,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('maroon', 'thistle') and i_manager_id BETWEEN 51 and 70 and ss_list_price between 274 and 288 and ca_state in ('GA','HI') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('maroon', 'thistle') and i_manager_id BETWEEN 51 and 70 and ws_list_price between 274 and 288 and ca_state in ('GA','HI') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q2_q3_increase ;"
1426,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 80 * 0.01 AND 100 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1193 and 1193 + 11  and s_state in ('AL','ID','IL'   ,'KS','MD','NC','TX','WI')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1193+ 12 and 1193 + 23  and s_state in ('AL','ID','IL'   ,'KS','MD','NC','TX','WI')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1427,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = 'Unknown' and c_current_addr_sk = ca_address_sk and d_year = 2000 and c_birth_month = 6 and ca_state in ('FL', 'KY', 'OK') and cs_wholesale_cost BETWEEN 100 AND 105 AND i_category = 'Shoes' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1428,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('NE', 'PA', 'VT') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'KY', 'TN') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('KY', 'NE', 'TX') and ws_net_profit between 50 and 250 ) )  ;"
1429,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 11 and 20 and wr_return_amt / wr_return_quantity between 77 and 106 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CT', 'MO', 'NM', 'SD')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (54, 66) and c_birth_year BETWEEN 1986 AND 1992 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1430,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Home' and i_class = 'decor' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 6 and d_year = 1999 and wholesale_cost BETWEEN 70 AND 100 and c_birth_year BETWEEN 1944 AND 1957 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 70 AND 100  and s_state in ('CO','IL','KS'   ,'KY','MD','MN'   ,'NC','NJ','OH'   ,'WV')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 1999 and d_moy = 6)   and (select distinct d_month_seq+3   from date_dim where d_year = 1999 and d_moy = 6) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
1431,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1211 and 1211 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 95 and 124 and sm_type = 'REGULAR' and cc_class = 'medium' and w_gmt_offset = -5  ;"
1432,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2002 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 47 and 76 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('CO', 'GA', 'NE', 'TN')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (8, 59) and c_birth_year BETWEEN 1945 AND 1951 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1433,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 3 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 3 and 3 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 3 and 3 + 2 and d3.d_year  = 1998  ;"
1434,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1197 and 1197 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 44 and 73 and sm_type = 'OVERNIGHT' and cc_class = 'large' and w_gmt_offset = -5  ;"
1435,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1182 and 1182+11 and ss_sales_price / ss_list_price BETWEEN 73 * 0.01 AND 83 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1182 and 1182+11 and ss_sales_price / ss_list_price BETWEEN 73 * 0.01 AND 83 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 84 and 88  and s_state in ('KY','TX','WI') order by s_store_name, i_item_desc limit 100 ;"
1436,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 80 * 0.01 AND 100 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1186 and 1186 + 11  and s_state in ('FL','KS','LA'   ,'NV','OK','SD','TX','WV')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1186+ 12 and 1186 + 23  and s_state in ('FL','KS','LA'   ,'NV','OK','SD','TX','WV')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1437,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-05-16')) and ss_sold_date_sk = d_date_sk and ss_list_price between 16 and 45 and i_manager_id BETWEEN 54 and 83 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1943 AND 1949 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-05-16')) and cs_sold_date_sk = d_date_sk and cs_list_price between 16 and 45 and i_manager_id BETWEEN 54 and 83 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1943 AND 1949 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-05-16')) and ws_sold_date_sk = d_date_sk and ws_list_price between 16 and 45 and i_manager_id BETWEEN 54 and 83 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1943 AND 1949 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1438,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('CA','KS','TX') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'S', 'W') and cd_education_status in ('4 yr Degree', '2 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 10 and 10+2  and ss_list_price between 83 and 172 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 10 and 10+2  and ws_list_price between 83 and 172  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 10 and 10+2  and cs_list_price between 83 and 172)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1439,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1205 and 1205 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 77 and 106 and sm_type = 'TWO DAY' and cc_class = 'large' and w_gmt_offset = -5  ;"
1440,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 90 and 99 and wr_return_amt / wr_return_quantity between 95 and 124 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('MO', 'MT', 'NE', 'UT')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (18, 43) and c_birth_year BETWEEN 1934 AND 1940 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1441,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'M' and  cd_education_status = 'Advanced Degree' and  d_year = 2001 and  s_state = 'MT' and i_category = 'Jewelry'  ;"
1442,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'F' and cd_education_status = '4 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 1999 and c_birth_month = 2 and ca_state in ('GA', 'TN', 'TX') and cs_wholesale_cost BETWEEN 81 AND 86 AND i_category = 'Books' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1443,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 39 and 48 and wr_return_amt / wr_return_quantity between 170 and 199 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('GA', 'IN', 'NE', 'SD')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (12, 54) and c_birth_year BETWEEN 1981 AND 1987 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1444,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188+11 and ss_list_price between 47 and 76 and c_birth_year BETWEEN 1937 AND 1943 and ss_wholesale_cost BETWEEN 62 AND 72 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188+11 and cs_list_price between 47 and 76 and c_birth_year BETWEEN 1937 AND 1943 and cs_wholesale_cost BETWEEN 62 AND 72 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188+11 and ws_list_price between 47 and 76 and c_birth_year BETWEEN 1937 AND 1943 and ws_wholesale_cost BETWEEN 62 AND 72 ) ) cool_cust  ;"
1445,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Women' and i_class = 'fragrances' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 2 and d_year = 2000 and wholesale_cost BETWEEN 18 AND 48 and c_birth_year BETWEEN 1937 AND 1950 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 18 AND 48  and s_state in ('CA','IL','KS'   ,'KY','MN','MS'   ,'MT','OH','SD'   ,'VA')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 2)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 2) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
1446,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1190 and 1190 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 58 and 87 and sm_type = 'EXPRESS' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1447,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1198 and 1198 + 11 and c_birth_month in (1, 6, 10, 11) and ss_list_price between 213 and 272 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1198 and 1198 + 11 and c_birth_month in (1, 6, 10, 11) and cs_list_price between 213 and 272 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1198 and 1198 + 11 and c_birth_month in (1, 6, 10, 11) and ws_list_price between 213 and 272 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
1448,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('IL','ME','MN') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'M', 'M') and cd_education_status in ('Advanced Degree', 'Advanced Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 10 and 10+2  and ss_list_price between 211 and 300 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 10 and 10+2  and ws_list_price between 211 and 300  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 10 and 10+2  and cs_list_price between 211 and 300)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1449,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'OK', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'KS', 'MO') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'MI', 'NE') and ss_net_profit between 50 and 250 ))  ;"
1450,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Electronics' and i_class = 'automotive' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 12 and d_year = 2000 and wholesale_cost BETWEEN 36 AND 66 and c_birth_year BETWEEN 1965 AND 1978 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 36 AND 66  and s_state in ('ID','LA','MI'   ,'MT','NC','NE'   ,'OH','SC','TX'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 12)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 12) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
1451,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-05-25')) and ss_sold_date_sk = d_date_sk and ss_list_price between 194 and 223 and i_manager_id BETWEEN 68 and 97 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1956 AND 1962 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-05-25')) and cs_sold_date_sk = d_date_sk and cs_list_price between 194 and 223 and i_manager_id BETWEEN 68 and 97 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1956 AND 1962 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-05-25')) and ws_sold_date_sk = d_date_sk and ws_list_price between 194 and 223 and i_manager_id BETWEEN 68 and 97 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1956 AND 1962 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1452,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MO', 'TX', 'VA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('WA', 'WV', 'WY') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('GA', 'MN', 'TX') and ws_net_profit between 50 and 250 ) )  ;"
1453,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189+11 and ss_list_price between 207 and 236 and c_birth_year BETWEEN 1934 AND 1940 and ss_wholesale_cost BETWEEN 6 AND 16 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189+11 and cs_list_price between 207 and 236 and c_birth_year BETWEEN 1934 AND 1940 and cs_wholesale_cost BETWEEN 6 AND 16 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1189 and 1189+11 and ws_list_price between 207 and 236 and c_birth_year BETWEEN 1934 AND 1940 and ws_wholesale_cost BETWEEN 6 AND 16 ) ) cool_cust  ;"
1454,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2001 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Home', 'Shoes', 'Sports') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and ss_wholesale_cost BETWEEN 47 AND 57  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1972 AND 1978 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2001 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 47 AND 57 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2001 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 47 AND 57) tmp2 limit 100 ;"
1455,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'MD', 'NC') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IN', 'MN', 'TN') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MN', 'PA', 'WI') and ss_net_profit between 50 and 250 ))  ;"
1456,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Oakland' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 47744 and ib_upper_bound <= 47744 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1457,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Secondary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'MS', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'NJ', 'NY') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'MO', 'TX') and ss_net_profit between 50 and 250 ))  ;"
1458,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Books' and d_year=2000 and d_moy = 8 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'OK' and c_birth_month = 6 and ss_wholesale_cost BETWEEN 80 AND 100  ;"
1459,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2000 and d_moy = 12 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'WI' and c_birth_month = 9 and ss_wholesale_cost BETWEEN 66 AND 86 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1460,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1209 and 1209+11 and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1209 and 1209+11 and ss_sales_price / ss_list_price BETWEEN 90 * 0.01 AND 100 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 77 and 81  and s_state in ('CO','GA','TN') order by s_store_name, i_item_desc limit 100 ;"
1461,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=1999 and d_moy = 2 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'WV' and c_birth_month = 4 and ss_wholesale_cost BETWEEN 48 AND 68 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1462,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('burnished', 'dodger') and i_manager_id BETWEEN 4 and 23 and ss_list_price between 75 and 89 and ca_state in ('SD','VA') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('burnished', 'dodger') and i_manager_id BETWEEN 4 and 23 and ws_list_price between 75 and 89 and ca_state in ('SD','VA') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year ;"
1463,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Books' and d_year=2000 and d_moy = 8 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'NY' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 77 AND 97 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1464,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 10 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
1465,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IN', 'NC', 'NE') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('KY', 'MS', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('MO', 'NJ', 'NY') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1466,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1998-02-22','1998-06-21','1998-08-16','1998-11-20'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Sports') and i_manager_id BETWEEN 45 and 54 and sr_return_amt / sr_return_quantity between 183 and 212 and sr_reason_sk in (21, 26, 33, 67, 74) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-02-22','1998-06-21','1998-08-16','1998-11-20'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Sports') and i_manager_id BETWEEN 45 and 54 and cr_return_amount / cr_return_quantity between 183 and 212 and cr_reason_sk in (21, 26, 33, 67, 74) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-02-22','1998-06-21','1998-08-16','1998-11-20'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Sports') and i_manager_id BETWEEN 45 and 54 and wr_return_amt / wr_return_quantity between 183 and 212 and wr_reason_sk in (21, 26, 33, 67, 74) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1467,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'Primary' and d_year = 1999 and s_state = 'IN' and i_category = 'Home' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1468,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and d_year = 2001 and s_state = 'NC' and i_category = 'Home' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1469,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and d_year = 2000 and s_state = 'GA' and i_category = 'Electronics' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1470,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and d_year = 2002 and s_state = 'KS' and i_category = 'Children' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1471,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Primary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'ME', 'VA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KY', 'TX', 'VA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NE', 'OH', 'PA') and ss_net_profit between 50 and 250 ))  ;"
1472,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1179 and 1179 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 107 and 136 and sm_type = 'REGULAR' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1473,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'S' and cd_education_status = 'Unknown' and d_year = 2000 and s_state = 'OK' and i_category = 'Home' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1474,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('lemon', 'tomato') and i_manager_id BETWEEN 63 and 82 and ss_list_price between 252 and 266 and ca_state in ('KS','SD') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('lemon', 'tomato') and i_manager_id BETWEEN 63 and 82 and ws_list_price between 252 and 266 and ca_state in ('KS','SD') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2002 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2002 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2002 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2002 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2002 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2002 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year ;"
1475,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('MN','WV','WY') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'U', 'M') and cd_education_status in ('Advanced Degree', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 4 and 4+2  and ss_list_price between 211 and 300 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 4 and 4+2  and ws_list_price between 211 and 300  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 4 and 4+2  and cs_list_price between 211 and 300)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1476,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Anderson County','Baldwin County','Cassia County','Dawson County','Granite County') and c.c_birth_month in (2, 7) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('D', 'M', 'M') and cd_education_status in ('Unknown', 'Unknown', 'Unknown') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 and 8+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and ss_sales_price / ss_list_price BETWEEN 18 * 0.01 AND 28 * 0.01  and i_manager_id BETWEEN 87 and 96  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 ANd 8+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and i_manager_id BETWEEN 87 and 96  and ws_sales_price / ws_list_price BETWEEN 18 * 0.01 AND 28 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2000 and  d_moy between 8 and 8+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Children', 'Home')  and i_manager_id BETWEEN 87 and 96  and cs_sales_price / cs_list_price BETWEEN 18 * 0.01 AND 28 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
1477,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Home' and d_year=2002 and d_moy = 8 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'TX' and c_birth_month = 4 and ss_wholesale_cost BETWEEN 42 AND 62  ;"
1478,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188+11 and ss_list_price between 260 and 289 and c_birth_year BETWEEN 1942 AND 1948 and ss_wholesale_cost BETWEEN 55 AND 65 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188+11 and cs_list_price between 260 and 289 and c_birth_year BETWEEN 1942 AND 1948 and cs_wholesale_cost BETWEEN 55 AND 65 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188+11 and ws_list_price between 260 and 289 and c_birth_year BETWEEN 1942 AND 1948 and ws_wholesale_cost BETWEEN 55 AND 65 ) ) cool_cust  ;"
1479,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 65 * 0.01 AND 85 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1205 and 1205 + 11  and s_state in ('AR','CA','IN'   ,'KY','MS','NM','NY','TN')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1205+ 12 and 1205 + 23  and s_state in ('AR','CA','IN'   ,'KY','MS','NM','NY','TN')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1480,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1178 and 1178 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 96 and 125 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1481,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1223 and 1223+11 and ss_sales_price / ss_list_price BETWEEN 78 * 0.01 AND 88 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1223 and 1223+11 and ss_sales_price / ss_list_price BETWEEN 78 * 0.01 AND 88 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 62 and 66  and s_state in ('AL','GA','NC') order by s_store_name, i_item_desc limit 100 ;"
1482,dsb,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2002 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'IL'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
1483,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Unknown' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MN', 'NM', 'NY') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'KS', 'WI') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MO', 'TN', 'TX') and ss_net_profit between 50 and 250 ))  ;"
1484,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1198 and 1198 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 229 and 258 and sm_type = 'NEXT DAY' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1485,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('lavender', 'orange') and i_manager_id BETWEEN 12 and 31 and ss_list_price between 286 and 300 and ca_state in ('PA','WI') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('lavender', 'orange') and i_manager_id BETWEEN 12 and 31 and ws_list_price between 286 and 300 and ca_state in ('PA','WI') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2002 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2002 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2002 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2002 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2002 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2002 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q2_q3_increase ;"
1486,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 5 * 0.01 AND 25 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1189 and 1189 + 11  and s_state in ('IL','MO','MS'   ,'OK','TX','VA','WA','WV')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1189+ 12 and 1189 + 23  and s_state in ('IL','MO','MS'   ,'OK','TX','VA','WA','WV')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1487,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1198 and 1198 + 11 and c_birth_month in (2, 4, 7, 12) and ss_list_price between 241 and 300 and ss_wholesale_cost BETWEEN 65 AND 85 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1198 and 1198 + 11 and c_birth_month in (2, 4, 7, 12) and cs_list_price between 241 and 300 and cs_wholesale_cost BETWEEN 65 AND 85 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1198 and 1198 + 11 and c_birth_month in (2, 4, 7, 12) and ws_list_price between 241 and 300 and ws_wholesale_cost BETWEEN 65 AND 85 ) hot_cust limit 100 ;"
1488,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1208 and 1208+11 and ss_list_price between 153 and 182 and c_birth_year BETWEEN 1942 AND 1948 and ss_wholesale_cost BETWEEN 61 AND 71 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1208 and 1208+11 and cs_list_price between 153 and 182 and c_birth_year BETWEEN 1942 AND 1948 and cs_wholesale_cost BETWEEN 61 AND 71 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1208 and 1208+11 and ws_list_price between 153 and 182 and c_birth_year BETWEEN 1942 AND 1948 and ws_wholesale_cost BETWEEN 61 AND 71 ) ) cool_cust  ;"
1489,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 6 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
1490,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Ashland County','Daggett County','Haines Borough','Iron County','Klamath County') and c.c_birth_month in (5, 9) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'S', 'S') and cd_education_status in ('Secondary', '2 yr Degree', '4 yr Degree') and cd_gender = 'M' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 9 and 9+3 and  ss_item_sk = i_item_sk and  i_category in ('Children', 'Electronics', 'Music')  and ss_sales_price / ss_list_price BETWEEN 14 * 0.01 AND 24 * 0.01  and i_manager_id BETWEEN 15 and 24  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 9 ANd 9+3 and  ws_item_sk = i_item_sk and  i_category in ('Children', 'Electronics', 'Music')  and i_manager_id BETWEEN 15 and 24  and ws_sales_price / ws_list_price BETWEEN 14 * 0.01 AND 24 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 9 and 9+3 and  cs_item_sk = i_item_sk and  i_category in ('Children', 'Electronics', 'Music')  and i_manager_id BETWEEN 15 and 24  and cs_sales_price / cs_list_price BETWEEN 14 * 0.01 AND 24 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
1491,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 38 and 57 AND i_category IN ('Books', 'Children', 'Jewelry') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 67 AND 77  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1993 AND 1999 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 1999 and d_moy = 8 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 67 AND 77 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 1999 and d_moy = 8 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 67 AND 77) tmp2 limit 100 ;"
1492,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1201 and 1201+11 and ss_list_price between 185 and 214 and c_birth_year BETWEEN 1980 AND 1986 and ss_wholesale_cost BETWEEN 61 AND 71 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1201 and 1201+11 and cs_list_price between 185 and 214 and c_birth_year BETWEEN 1980 AND 1986 and cs_wholesale_cost BETWEEN 61 AND 71 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1201 and 1201+11 and ws_list_price between 185 and 214 and c_birth_year BETWEEN 1980 AND 1986 and ws_wholesale_cost BETWEEN 61 AND 71 ) ) cool_cust  ;"
1493,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Shoes', 'Sports') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'M' and cd_education_status = 'Secondary' and s1.ss_list_price between 4 and 18 and s2.ss_list_price between 4 and 18 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1494,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1209 and 1209 + 11 and c_birth_month in (1, 5, 9, 12) and ss_list_price between 51 and 110 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1209 and 1209 + 11 and c_birth_month in (1, 5, 9, 12) and cs_list_price between 51 and 110 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1209 and 1209 + 11 and c_birth_month in (1, 5, 9, 12) and ws_list_price between 51 and 110 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
1495,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-05-10')) and ss_sold_date_sk = d_date_sk and ss_list_price between 70 and 99 and i_manager_id BETWEEN 27 and 56 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1985 AND 1991 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-05-10')) and cs_sold_date_sk = d_date_sk and cs_list_price between 70 and 99 and i_manager_id BETWEEN 27 and 56 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1985 AND 1991 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-05-10')) and ws_sold_date_sk = d_date_sk and ws_list_price between 70 and 99 and i_manager_id BETWEEN 27 and 56 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1985 AND 1991 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1496,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Women') and item2.i_manager_id between 13 and 32 and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and s1.ss_list_price between 279 and 293 and s2.ss_list_price between 279 and 293 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1497,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Lakewood' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 37245 and ib_upper_bound <= 37245 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1498,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-05-20')) and ss_sold_date_sk = d_date_sk and ss_list_price between 182 and 211 and i_manager_id BETWEEN 71 and 100 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1950 AND 1956 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-05-20')) and cs_sold_date_sk = d_date_sk and cs_list_price between 182 and 211 and i_manager_id BETWEEN 71 and 100 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1950 AND 1956 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '1998-05-20')) and ws_sold_date_sk = d_date_sk and ws_list_price between 182 and 211 and i_manager_id BETWEEN 71 and 100 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1950 AND 1956 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1499,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('antique', 'cornflower') and i_manager_id BETWEEN 4 and 23 and ss_list_price between 153 and 167 and ca_state in ('CA','NY') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('antique', 'cornflower') and i_manager_id BETWEEN 4 and 23 and ws_list_price between 153 and 167 and ca_state in ('CA','NY') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2001 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2001 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2001 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2001 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2001 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2001 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;"
1500,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Unionville' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 8291 and ib_upper_bound <= 8291 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1501,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('AL','FL','PA') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('U', 'M', 'U') and cd_education_status in ('Advanced Degree', 'Advanced Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 1 and 1+2  and ss_list_price between 83 and 172 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 1 and 1+2  and ws_list_price between 83 and 172  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 1 and 1+2  and cs_list_price between 83 and 172)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1502,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1180 and 1180 + 11 and c_birth_month in (4, 8, 10, 12) and ss_list_price between 209 and 268 and ss_wholesale_cost BETWEEN 34 AND 54 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1180 and 1180 + 11 and c_birth_month in (4, 8, 10, 12) and cs_list_price between 209 and 268 and cs_wholesale_cost BETWEEN 34 AND 54 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1180 and 1180 + 11 and c_birth_month in (4, 8, 10, 12) and ws_list_price between 209 and 268 and ws_wholesale_cost BETWEEN 34 AND 54 ) hot_cust limit 100 ;"
1503,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Jewelry') and item2.i_manager_id between 52 and 71 and cd_marital_status = 'M' and cd_education_status = 'Primary' and s1.ss_list_price between 63 and 77 and s2.ss_list_price between 63 and 77 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1504,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1179 and 1179 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 261 and 290 and sm_type = 'EXPRESS' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1505,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Home') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'S' and cd_education_status = 'Primary' and s1.ss_list_price between 83 and 97 and s2.ss_list_price between 83 and 97  ;"
1506,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1206 and 1206 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 271 and 300 and sm_type = 'OVERNIGHT' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1507,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1211 and 1211+11 and ss_sales_price / ss_list_price BETWEEN 86 * 0.01 AND 96 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1211 and 1211+11 and ss_sales_price / ss_list_price BETWEEN 86 * 0.01 AND 96 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 46 and 50  and s_state in ('CA','NY','RI') order by s_store_name, i_item_desc limit 100 ;"
1508,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MA', 'OR', 'WY') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'SC', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('OH', 'TX', 'VA') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1509,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Home', 'Shoes') and i_manager_id BETWEEN 10 and 19 and ss_wholesale_cost BETWEEN 5 AND 25 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Books', 'Home', 'Shoes') and i_manager_id BETWEEN 10 and 19 and cs_wholesale_cost BETWEEN 5 AND 25 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 5 AND 25 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Home', 'Shoes') and i_manager_id BETWEEN 10 and 19 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 5 AND 25  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 5 AND 25  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 5 AND 25 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 19) and i_category IN ('Books', 'Home', 'Shoes') and i_manager_id BETWEEN 10 and 19 and ss_wholesale_cost BETWEEN 5 AND 25 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 19) and i_category IN ('Books', 'Home', 'Shoes') and ss_wholesale_cost BETWEEN 5 AND 25 and i_manager_id BETWEEN 10 and 19 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
1510,dsb,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =2001 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 165 and 194 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('ID', 'LA', 'NE', 'TX')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (15, 74) and c_birth_year BETWEEN 1960 AND 1966 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
1511,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'M' and  cd_education_status = '4 yr Degree' and  d_year = 2000 and  s_state = 'GA' and i_category = 'Home'  ;"
1512,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Shoes') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'W' and cd_education_status = 'Unknown' and s1.ss_list_price between 153 and 167 and s2.ss_list_price between 153 and 167  ;"
1513,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('LA','MS','NE') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'W', 'W') and cd_education_status in ('4 yr Degree', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 1 and 1+2  and ss_list_price between 211 and 300 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 1 and 1+2  and ws_list_price between 211 and 300  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 1 and 1+2  and cs_list_price between 211 and 300)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1514,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=2001 and d_moy = 10 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'IL' and c_birth_month = 8 and ss_wholesale_cost BETWEEN 36 AND 56  ;"
1515,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'NH', 'NM') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CO', 'OH', 'WV') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('OH', 'SC', 'TN') and ss_net_profit between 50 and 250 ))  ;"
1516,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 2 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 2 and 2 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 2 and 2 + 2 and d3.d_year  = 1998  ;"
1517,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,stddev_samp(ss_net_profit) as store_sales_profit ,stddev_samp(sr_net_loss) as store_returns_loss ,stddev_samp(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 1999 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
1518,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1192 and 1192 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 127 and 156 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1519,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1187 and 1187+11 and ss_sales_price / ss_list_price BETWEEN 42 * 0.01 AND 52 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1187 and 1187+11 and ss_sales_price / ss_list_price BETWEEN 42 * 0.01 AND 52 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 71 and 75  and s_state in ('CT','MI','NE') order by s_store_name, i_item_desc limit 100 ;"
1520,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Jewelry', 'Shoes') and item2.i_manager_id between 81 and 100 and cd_marital_status = 'W' and cd_education_status = 'Unknown' and s1.ss_list_price between 153 and 167 and s2.ss_list_price between 153 and 167 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1521,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Books' and d_year=2000 and d_moy = 9 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'CA' and c_birth_month = 12 and ss_wholesale_cost BETWEEN 42 AND 62 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1522,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1195 and 1195 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 238 and 267 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5  ;"
1523,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('maroon', 'wheat') and i_manager_id BETWEEN 81 and 100 and ss_list_price between 106 and 120 and ca_state in ('GA','UT') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('maroon', 'wheat') and i_manager_id BETWEEN 81 and 100 and ws_list_price between 106 and 120 and ca_state in ('GA','UT') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1998 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1998 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1998 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1998 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1998 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1998 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by web_q1_q2_increase ;"
1524,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Unknown' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 11 and  ca_state in ('GA', 'MO', 'VA')  and cs_wholesale_cost BETWEEN 86 AND 91  AND i_category = 'Children'  ;"
1525,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Advanced Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2001 and  c_birth_month = 10 and  ca_state in ('NE', 'SD', 'WV')  and cs_wholesale_cost BETWEEN 35 AND 40  AND i_category = 'Jewelry'  ;"
1526,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = 'Advanced Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 2 and  ca_state in ('MT', 'PA', 'UT')  and cs_wholesale_cost BETWEEN 1 AND 6  AND i_category = 'Sports'  ;"
1527,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'S' and  cd_education_status = '4 yr Degree' and  d_year = 2000 and  s_state = 'WI' and i_category = 'Home'  ;"
1528,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=1998 and d_moy = 6 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'OR' and c_birth_month = 12 and ss_wholesale_cost BETWEEN 38 AND 58 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1529,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'W' and  cd_education_status = 'Primary' and  d_year = 2000 and  s_state = 'IN' and i_category = 'Home'  ;"
1530,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1198 and 1198+11 and ss_list_price between 225 and 254 and c_birth_year BETWEEN 1987 AND 1993 and ss_wholesale_cost BETWEEN 31 AND 41 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1198 and 1198+11 and cs_list_price between 225 and 254 and c_birth_year BETWEEN 1987 AND 1993 and cs_wholesale_cost BETWEEN 31 AND 41 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1198 and 1198+11 and ws_list_price between 225 and 254 and c_birth_year BETWEEN 1987 AND 1993 and ws_wholesale_cost BETWEEN 31 AND 41 ) ) cool_cust  ;"
1531,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=2002 and d_moy = 10 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MN' and c_birth_month = 11 and ss_wholesale_cost BETWEEN 55 AND 75  ;"
1532,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188 + 11 and c_birth_month in (1, 2, 3, 4) and ss_list_price between 91 and 150 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188 + 11 and c_birth_month in (1, 2, 3, 4) and cs_list_price between 91 and 150 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1188 and 1188 + 11 and c_birth_month in (1, 2, 3, 4) and ws_list_price between 91 and 150 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
1533,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1194 and 1194 + 11 and c_birth_month in (4, 8, 11, 12) and ss_list_price between 162 and 221 and ss_wholesale_cost BETWEEN 39 AND 59 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1194 and 1194 + 11 and c_birth_month in (4, 8, 11, 12) and cs_list_price between 162 and 221 and cs_wholesale_cost BETWEEN 39 AND 59 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1194 and 1194 + 11 and c_birth_month in (4, 8, 11, 12) and ws_list_price between 162 and 221 and ws_wholesale_cost BETWEEN 39 AND 59 ) hot_cust limit 100 ;"
1534,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1212 and 1212+11 and ss_sales_price / ss_list_price BETWEEN 29 * 0.01 AND 39 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1212 and 1212+11 and ss_sales_price / ss_list_price BETWEEN 29 * 0.01 AND 39 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 67 and 71  and s_state in ('AL','IL','MO') order by s_store_name, i_item_desc limit 100 ;"
1535,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1202 and 1202 + 11 and c_birth_month in (2, 4, 5, 10) and ss_list_price between 29 and 88 and ss_wholesale_cost BETWEEN 51 AND 71 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1202 and 1202 + 11 and c_birth_month in (2, 4, 5, 10) and cs_list_price between 29 and 88 and cs_wholesale_cost BETWEEN 51 AND 71 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1202 and 1202 + 11 and c_birth_month in (2, 4, 5, 10) and ws_list_price between 29 and 88 and ws_wholesale_cost BETWEEN 51 AND 71 ) hot_cust limit 100 ;"
1536,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1219 and 1219+11 and ss_list_price between 271 and 300 and c_birth_year BETWEEN 1969 AND 1975 and ss_wholesale_cost BETWEEN 74 AND 84 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1219 and 1219+11 and cs_list_price between 271 and 300 and c_birth_year BETWEEN 1969 AND 1975 and cs_wholesale_cost BETWEEN 74 AND 84 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1219 and 1219+11 and ws_list_price between 271 and 300 and c_birth_year BETWEEN 1969 AND 1975 and ws_wholesale_cost BETWEEN 74 AND 84 ) ) cool_cust  ;"
1537,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = '2 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 3 and  ca_state in ('GA', 'ME', 'NC')  and cs_wholesale_cost BETWEEN 84 AND 89  AND i_category = 'Books'  ;"
1538,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 47 * 0.01 AND 67 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1190 and 1190 + 11  and s_state in ('IN','KS','NJ'   ,'NY','SC','SD','WI','WV')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1190+ 12 and 1190 + 23  and s_state in ('IN','KS','NJ'   ,'NY','SC','SD','WI','WV')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1539,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Sports' and d_year=2002 and d_moy = 10 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'TN' and c_birth_month = 9 and ss_wholesale_cost BETWEEN 72 AND 92 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1540,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=1998 and d_moy = 12 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'GA' and c_birth_month = 10 and ss_wholesale_cost BETWEEN 13 AND 33 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1541,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 35 and 54 and cd_marital_status = 'U' and cd_education_status = 'Primary' and s1.ss_list_price between 286 and 300 and s2.ss_list_price between 286 and 300  ;"
1542,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'NM', 'SC') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'WA', 'WY') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'IL', 'TX') and ss_net_profit between 50 and 250 ))  ;"
1543,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1177 and 1177+11 and ss_sales_price / ss_list_price BETWEEN 43 * 0.01 AND 53 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1177 and 1177+11 and ss_sales_price / ss_list_price BETWEEN 43 * 0.01 AND 53 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 43 and 47  and s_state in ('GA','KY','VA') order by s_store_name, i_item_desc limit 100 ;"
1544,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('KS', 'MI', 'NE') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('NE', 'OH', 'VA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'IN', 'WV') and ws_net_profit between 50 and 250 ) )  ;"
1545,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1998 and d_moy  = 9 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -7  ;"
1546,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('bisque', 'deep') and i_manager_id BETWEEN 18 and 37 and ss_list_price between 276 and 290 and ca_state in ('MS','NY') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('bisque', 'deep') and i_manager_id BETWEEN 18 and 37 and ws_list_price between 276 and 290 and ca_state in ('MS','NY') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2001 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2001 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2001 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2001 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2001 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2001 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year ;"
1547,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Hamilton' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 54315 and ib_upper_bound <= 54315 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1548,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 147 and 206 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 38 AND 41 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('CA', 'FL', 'OK') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'M') and cd_education_status IN ('Advanced Degree', '2 yr Degree') and cd_gender = 'F' and c_birth_month = 4 and c_birth_year BETWEEN 1945 AND 1951 order by c_customer_id limit 100 ;"
1549,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11 and ss_list_price between 20 and 49 and c_birth_year BETWEEN 1945 AND 1951 and ss_wholesale_cost BETWEEN 30 AND 40 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11 and cs_list_price between 20 and 49 and c_birth_year BETWEEN 1945 AND 1951 and cs_wholesale_cost BETWEEN 30 AND 40 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11 and ws_list_price between 20 and 49 and c_birth_year BETWEEN 1945 AND 1951 and ws_wholesale_cost BETWEEN 30 AND 40 ) ) cool_cust  ;"
1550,dsb,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Sports' and i_class = 'football' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 7 and d_year = 2001 and wholesale_cost BETWEEN 10 AND 40 and c_birth_year BETWEEN 1934 AND 1947 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 10 AND 40  and s_state in ('AR','CO','IL'   ,'IN','MI','NC'   ,'ND','OK','TX'   ,'WI')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2001 and d_moy = 7)   and (select distinct d_month_seq+3   from date_dim where d_year = 2001 and d_moy = 7) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
1551,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AL', 'TN', 'WA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('IL', 'KS', 'SD') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('LA', 'MO', 'OH') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1552,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Primary' and c_current_addr_sk = ca_address_sk and d_year = 2002 and c_birth_month = 9 and ca_state in ('AR', 'OR', 'TX') and cs_wholesale_cost BETWEEN 13 AND 18 AND i_category = 'Jewelry' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1553,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('CA', 'KS', 'PA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AL', 'ID', 'TX') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'MD', 'WI') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1554,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 and sr_return_amt / sr_return_quantity between 178 and 237 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 63 AND 66 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('AL', 'MA', 'MS') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('U', 'W') and cd_education_status IN ('4 yr Degree', '4 yr Degree') and cd_gender = 'M' and c_birth_month = 7 and c_birth_year BETWEEN 1951 AND 1957 order by c_customer_id limit 100 ;"
1555,dsb,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('KS', 'NH', 'NM') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CO', 'OH', 'WV') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('OH', 'SC', 'TN') and ss_net_profit between 50 and 250 ))  ;"
1556,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 and sr_return_amt / sr_return_quantity between 241 and 300 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 17 AND 20 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('KY', 'OH', 'VA') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'U') and cd_education_status IN ('Advanced Degree', 'Secondary') and cd_gender = 'M' and c_birth_month = 5 and c_birth_year BETWEEN 1939 AND 1945 order by c_customer_id limit 100 ;"
1557,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Highland Park' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 5 * 10000 and ib_upper_bound <= 5 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
1558,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Women') and item2.i_manager_id between 60 and 79 and cd_marital_status = 'M' and cd_education_status = 'Primary' and s1.ss_list_price between 194 and 208 and s2.ss_list_price between 194 and 208  ;"
1559,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1223 and 1223 + 11 and c_birth_month in (1, 5, 9, 10) and ss_list_price between 24 and 83 and ss_wholesale_cost BETWEEN 67 AND 87 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1223 and 1223 + 11 and c_birth_month in (1, 5, 9, 10) and cs_list_price between 24 and 83 and cs_wholesale_cost BETWEEN 67 AND 87 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1223 and 1223 + 11 and c_birth_month in (1, 5, 9, 10) and ws_list_price between 24 and 83 and ws_wholesale_cost BETWEEN 67 AND 87 ) hot_cust limit 100 ;"
1560,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1185 and 1185 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 271 and 300 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1561,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1212 and 1212 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 136 and 165 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1562,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 0 AND 20 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 70 and 70 + 10 and p_channel_email = 'Y' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('IL','MS','NJ') and ss_wholesale_cost BETWEEN 0 AND 20 and cd1.cd_marital_status in ('M', 'W', 'U') and cd1.cd_education_status in ('Secondary', 'Secondary', 'Advanced Degree') and cd2.cd_marital_status in ('M', 'W', 'U') and cd2.cd_education_status in ('Secondary', 'Secondary', 'Advanced Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1999 and cs2.syear = 1999 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
1563,dsb,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 7 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '0-500%' and ca_gmt_offset = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
1564,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1999 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MD', 'WI', 'WV') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('NC', 'NH', 'TN') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('IL', 'MD', 'WA') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1565,dsb,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = '4 yr Degree' and c_current_addr_sk = ca_address_sk and d_year = 1998 and c_birth_month = 4 and ca_state in ('LA', 'MS', 'NE') and cs_wholesale_cost BETWEEN 74 AND 79 AND i_category = 'Home' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
1566,dsb,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'M' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 2000 and  c_birth_month = 6 and  ca_state in ('KS', 'MO', 'NM')  and cs_wholesale_cost BETWEEN 16 AND 21  AND i_category = 'Jewelry'  ;"
1567,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('cream', 'slate') and i_manager_id BETWEEN 36 and 55 and ss_list_price between 139 and 153 and ca_state in ('IN','MI') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('cream', 'slate') and i_manager_id BETWEEN 36 and 55 and ws_list_price between 139 and 153 and ca_state in ('IN','MI') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.ca_county ;"
1568,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Mountain View' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38651 and ib_upper_bound <= 38651 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1569,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1202 and 1202+11 and ss_sales_price / ss_list_price BETWEEN 2 * 0.01 AND 12 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1202 and 1202+11 and ss_sales_price / ss_list_price BETWEEN 2 * 0.01 AND 12 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 76 and 80  and s_state in ('FL','GA','NY') order by s_store_name, i_item_desc limit 100 ;"
1570,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 1998  ;"
1571,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'F' and  cd_marital_status = 'S' and  cd_education_status = 'Unknown' and  d_year = 2002 and  s_state = 'CO' and i_category = 'Home'  ;"
1572,dsb,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('orchid', 'thistle') and i_manager_id BETWEEN 31 and 50 and ss_list_price between 214 and 228 and ca_state in ('KS','TX') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('orchid', 'thistle') and i_manager_id BETWEEN 31 and 50 and ws_list_price between 214 and 228 and ca_state in ('KS','TX') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q2_q3_increase ;"
1573,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 21 AND 41 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 71 and 71 + 10 and p_channel_email = 'Y' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('IN','MI','OH') and ss_wholesale_cost BETWEEN 21 AND 41 and cd1.cd_marital_status in ('W', 'M', 'W') and cd1.cd_education_status in ('Primary', 'Advanced Degree', 'Primary') and cd2.cd_marital_status in ('W', 'M', 'W') and cd2.cd_education_status in ('Primary', 'Advanced Degree', 'Primary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
1574,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Wilson' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 6 * 10000 and ib_upper_bound <= 6 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
1575,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'W' and cd_education_status = 'Secondary' and d_year = 1998 and s_state = 'TN' and i_category = 'Children' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1576,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_STORE_CREDIT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 and sr_return_amt / sr_return_quantity between 24 and 83 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 23 AND 26 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('GA', 'MN', 'OK') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'S') and cd_education_status IN ('Advanced Degree', 'Advanced Degree') and cd_gender = 'F' and c_birth_month = 7 and c_birth_year BETWEEN 1940 AND 1946 order by c_customer_id limit 100 ;"
1577,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1998-03-15','1998-06-01','1998-08-20','1998-10-02'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Men', 'Women') and i_manager_id BETWEEN 13 and 22 and sr_return_amt / sr_return_quantity between 202 and 231 and sr_reason_sk in (6, 17, 25, 70, 74) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-03-15','1998-06-01','1998-08-20','1998-10-02'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Men', 'Women') and i_manager_id BETWEEN 13 and 22 and cr_return_amount / cr_return_quantity between 202 and 231 and cr_reason_sk in (6, 17, 25, 70, 74) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-03-15','1998-06-01','1998-08-20','1998-10-02'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Men', 'Women') and i_manager_id BETWEEN 13 and 22 and wr_return_amt / wr_return_quantity between 202 and 231 and wr_reason_sk in (6, 17, 25, 70, 74) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1578,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1186 and 1186 + 11 and c_birth_month in (3, 4, 11, 12) and ss_list_price between 136 and 195 and ss_wholesale_cost BETWEEN 32 AND 52 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1186 and 1186 + 11 and c_birth_month in (3, 4, 11, 12) and cs_list_price between 136 and 195 and cs_wholesale_cost BETWEEN 32 AND 52 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1186 and 1186 + 11 and c_birth_month in (3, 4, 11, 12) and ws_list_price between 136 and 195 and ws_wholesale_cost BETWEEN 32 AND 52 ) hot_cust limit 100 ;"
1579,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2002 and i_manager_id BETWEEN 49 and 68 AND i_category IN ('Jewelry', 'Music', 'Shoes') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and ss_wholesale_cost BETWEEN 63 AND 73  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1979 AND 1985 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2002 and d_moy = 8 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 63 AND 73 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2002 and d_moy = 8 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 63 AND 73) tmp2 limit 100 ;"
1580,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 4 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -7  ;"
1581,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Women' and d_year=1999 and d_moy = 6 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'OK' and c_birth_month = 5 and ss_wholesale_cost BETWEEN 80 AND 100  ;"
1582,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 2002  ;"
1583,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
1584,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-06-09')) and ss_sold_date_sk = d_date_sk and ss_list_price between 75 and 104 and i_manager_id BETWEEN 8 and 37 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1937 AND 1943 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-06-09')) and cs_sold_date_sk = d_date_sk and cs_list_price between 75 and 104 and i_manager_id BETWEEN 8 and 37 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1937 AND 1943 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2002-06-09')) and ws_sold_date_sk = d_date_sk and ws_list_price between 75 and 104 and i_manager_id BETWEEN 8 and 37 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1937 AND 1943 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1585,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Macedonia' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 62936 and ib_upper_bound <= 62936 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1586,dsb,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2002 and i_manager_id BETWEEN 36 and 55 AND i_category IN ('Children', 'Jewelry', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and ss_wholesale_cost BETWEEN 83 AND 93  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1980 AND 1986 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2002 and d_moy = 11 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 83 AND 93 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2002 and d_moy = 11 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 83 AND 93) tmp2 limit 100 ;"
1587,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1223 and 1223+11 and ss_list_price between 149 and 178 and c_birth_year BETWEEN 1980 AND 1986 and ss_wholesale_cost BETWEEN 74 AND 84 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1223 and 1223+11 and cs_list_price between 149 and 178 and c_birth_year BETWEEN 1980 AND 1986 and cs_wholesale_cost BETWEEN 74 AND 84 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1223 and 1223+11 and ws_list_price between 149 and 178 and c_birth_year BETWEEN 1980 AND 1986 and ws_wholesale_cost BETWEEN 74 AND 84 ) ) cool_cust  ;"
1588,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 and i_category IN ('Children', 'Home', 'Jewelry') and i_manager_id BETWEEN 91 and 100 and ss_wholesale_cost BETWEEN 54 AND 74 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 and i_category IN ('Children', 'Home', 'Jewelry') and i_manager_id BETWEEN 91 and 100 and cs_wholesale_cost BETWEEN 54 AND 74 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 54 AND 74 and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Home', 'Jewelry') and i_manager_id BETWEEN 91 and 100 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and ss_wholesale_cost BETWEEN 54 AND 74  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 and cs_wholesale_cost BETWEEN 54 AND 74  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 54 AND 74 and d_year between 2000 and 2000 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000 + 1   and d_moy = 12   and d_dom = 23) and i_category IN ('Children', 'Home', 'Jewelry') and i_manager_id BETWEEN 91 and 100 and ss_wholesale_cost BETWEEN 54 AND 74 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 2000   and d_moy = 12   and d_dom = 23) and i_category IN ('Children', 'Home', 'Jewelry') and ss_wholesale_cost BETWEEN 54 AND 74 and i_manager_id BETWEEN 91 and 100 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
1589,dsb,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1190 and 1190 + 11 and c_birth_month in (2, 3, 9, 12) and ss_list_price between 181 and 240 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1190 and 1190 + 11 and c_birth_month in (2, 3, 9, 12) and cs_list_price between 181 and 240 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1190 and 1190 + 11 and c_birth_month in (2, 3, 9, 12) and ws_list_price between 181 and 240 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
1590,dsb,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1211 and 1211 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 95 and 124 and sm_type = 'REGULAR' and cc_class = 'medium' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
1591,dsb,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'MD', 'MS') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'IN', 'PA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'KS', 'TX') and ss_net_profit between 50 and 250 ))  ;"
1592,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Home' and d_year=2002 and d_moy = 6 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'GA' and c_birth_month = 9 and ss_wholesale_cost BETWEEN 28 AND 48 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1593,dsb,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1998 AND 1998 + 2 and i_category IN ('Children', 'Men', 'Women') and i_manager_id BETWEEN 78 and 87 and ss_wholesale_cost BETWEEN 24 AND 44 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1998 AND 1998 + 2 and i_category IN ('Children', 'Men', 'Women') and i_manager_id BETWEEN 78 and 87 and cs_wholesale_cost BETWEEN 24 AND 44 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 24 AND 44 and d3.d_year between 1998 AND 1998 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Children', 'Men', 'Women') and i_manager_id BETWEEN 78 and 87 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and ss_wholesale_cost BETWEEN 24 AND 44  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1998 and 1998 + 2 and cs_wholesale_cost BETWEEN 24 AND 44  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 24 AND 44 and d_year between 1998 and 1998 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998 + 1   and d_moy = 12   and d_dom = 21) and i_category IN ('Children', 'Men', 'Women') and i_manager_id BETWEEN 78 and 87 and ss_wholesale_cost BETWEEN 24 AND 44 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1998   and d_moy = 12   and d_dom = 21) and i_category IN ('Children', 'Men', 'Women') and ss_wholesale_cost BETWEEN 24 AND 44 and i_manager_id BETWEEN 78 and 87 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
1594,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Home') and item2.i_manager_id between 30 and 49 and cd_marital_status = 'S' and cd_education_status = 'Unknown' and s1.ss_list_price between 206 and 220 and s2.ss_list_price between 206 and 220 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1595,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Oak Ridge' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 7 * 10000 and ib_upper_bound <= 7 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
1596,dsb,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Pine Grove' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 5 * 10000 and ib_upper_bound <= 5 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
1597,dsb,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-01-11')) and ss_sold_date_sk = d_date_sk and ss_list_price between 69 and 98 and i_manager_id BETWEEN 51 and 80 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1984 AND 1990 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-01-11')) and cs_sold_date_sk = d_date_sk and cs_list_price between 69 and 98 and i_manager_id BETWEEN 51 and 80 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1984 AND 1990 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2001-01-11')) and ws_sold_date_sk = d_date_sk and ws_list_price between 69 and 98 and i_manager_id BETWEEN 51 and 80 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1984 AND 1990 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
1598,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2000 and d_moy = 7 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'TX' and c_birth_month = 2 and ss_wholesale_cost BETWEEN 56 AND 76 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1599,dsb,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1999 and 1999 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Jewelry') and item2.i_manager_id between 51 and 70 and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and s1.ss_list_price between 86 and 100 and s2.ss_list_price between 86 and 100 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
1600,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2001 and d_moy = 11 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'SD' and c_birth_month = 7 and ss_wholesale_cost BETWEEN 32 AND 52  ;"
1601,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 39 * 0.01 AND 59 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1212 and 1212 + 11  and s_state in ('IL','IN','KY'   ,'MO','MT','OK','TX','WI')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1212+ 12 and 1212 + 23  and s_state in ('IL','IN','KY'   ,'MO','MT','OK','TX','WI')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1602,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-01-24','2001-04-20','2001-08-20','2001-11-09'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 68 and 77 and sr_return_amt / sr_return_quantity between 271 and 300 and sr_reason_sk in (2, 6, 16, 26, 37) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-01-24','2001-04-20','2001-08-20','2001-11-09'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 68 and 77 and cr_return_amount / cr_return_quantity between 271 and 300 and cr_reason_sk in (2, 6, 16, 26, 37) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-01-24','2001-04-20','2001-08-20','2001-11-09'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Shoes') and i_manager_id BETWEEN 68 and 77 and wr_return_amt / wr_return_quantity between 271 and 300 and wr_reason_sk in (2, 6, 16, 26, 37) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1603,dsb,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 5 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 5 and 5 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 5 and 5 + 2 and d3.d_year  = 2000  ;"
1604,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 6 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 6 and 6 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 6 and 6 + 2 and d3.d_year  = 1998 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
1605,dsb,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Music' and d_year=1998 and d_moy = 7 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MO' and c_birth_month = 9 and ss_wholesale_cost BETWEEN 68 AND 88  ;"
1606,dsb,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 80 * 0.01 AND 100 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1200 and 1200 + 11  and s_state in ('AL','GA','KY'   ,'NH','TN','TX','VA','WI')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1200+ 12 and 1200 + 23  and s_state in ('AL','GA','KY'   ,'NH','TN','TX','VA','WI')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
1607,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 29 AND 49 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 8 and 8 + 10 and p_channel_email = 'N' and p_channel_tv = 'Y' and p_channel_radio = 'Y' and ad2.ca_state in ('MO','PA','TX') and ss_wholesale_cost BETWEEN 29 AND 49 and cd1.cd_marital_status in ('S', 'S', 'W') and cd1.cd_education_status in ('2 yr Degree', '2 yr Degree', 'Advanced Degree') and cd2.cd_marital_status in ('S', 'S', 'W') and cd2.cd_education_status in ('2 yr Degree', '2 yr Degree', 'Advanced Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
1608,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'M' and cd_education_status = 'Primary' and d_year = 1999 and s_state = 'WV' and i_category = 'Jewelry' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1609,dsb,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'College' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Secondary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('GA', 'IL', 'PA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('LA', 'MT', 'UT') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('ID', 'NE', 'TX') and ws_net_profit between 50 and 250 ) )  ;"
1610,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_STORE_CREDIT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2000 and sr_return_amt / sr_return_quantity between 235 and 294 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 65 AND 68 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('ID', 'ME', 'OK') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('M', 'S') and cd_education_status IN ('4 yr Degree', 'Secondary') and cd_gender = 'M' and c_birth_month = 7 and c_birth_year BETWEEN 1963 AND 1969 order by c_customer_id limit 100 ;"
1611,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 24 AND 44 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 84 and 84 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('IL','MT','OH') and ss_wholesale_cost BETWEEN 24 AND 44 and cd1.cd_marital_status in ('W', 'S', 'U') and cd1.cd_education_status in ('Secondary', '4 yr Degree', 'Primary') and cd2.cd_marital_status in ('W', 'S', 'U') and cd2.cd_education_status in ('Secondary', '4 yr Degree', 'Primary') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1999 and cs2.syear = 1999 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
1612,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('FL', 'MI', 'NC') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AR', 'IN', 'TN') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('MS', 'MT', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1613,dsb,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 and sr_return_amt / sr_return_quantity between 241 and 300 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 49 AND 52 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('CO', 'NM', 'TX') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('S', 'M') and cd_education_status IN ('Unknown', 'Secondary') and cd_gender = 'F' and c_birth_month = 9 and c_birth_year BETWEEN 1946 AND 1952 order by c_customer_id limit 100 ;"
1614,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1205 and 1205+11 and ss_list_price between 69 and 98 and c_birth_year BETWEEN 1987 AND 1993 and ss_wholesale_cost BETWEEN 63 AND 73 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1205 and 1205+11 and cs_list_price between 69 and 98 and c_birth_year BETWEEN 1987 AND 1993 and cs_wholesale_cost BETWEEN 63 AND 73 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1205 and 1205+11 and ws_list_price between 69 and 98 and c_birth_year BETWEEN 1987 AND 1993 and ws_wholesale_cost BETWEEN 63 AND 73 ) ) cool_cust  ;"
1615,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'W' and cd_education_status = 'Primary' and d_year = 2000 and s_state = 'IN' and i_category = 'Home' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1616,dsb,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('KS','LA','OK') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'S', 'S') and cd_education_status in ('Unknown', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 7 and 7+2  and ss_list_price between 139 and 228 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 7 and 7+2  and ws_list_price between 139 and 228  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1999 and  d_moy between 7 and 7+2  and cs_list_price between 139 and 228)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
1617,dsb,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1217 and 1217+11 and ss_list_price between 181 and 210 and c_birth_year BETWEEN 1929 AND 1935 and ss_wholesale_cost BETWEEN 43 AND 53 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1217 and 1217+11 and cs_list_price between 181 and 210 and c_birth_year BETWEEN 1929 AND 1935 and cs_wholesale_cost BETWEEN 43 AND 53 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1217 and 1217+11 and ws_list_price between 181 and 210 and c_birth_year BETWEEN 1929 AND 1935 and ws_wholesale_cost BETWEEN 43 AND 53 ) ) cool_cust  ;"
1618,dsb,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'W' and  cd_education_status = 'Secondary' and  d_year = 2002 and  s_state = 'MO' and i_category = 'Women'  ;"
1619,dsb,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 39 AND 59 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 29 and 29 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('AZ','CO','ID') and ss_wholesale_cost BETWEEN 39 AND 59 and cd1.cd_marital_status in ('M', 'S', 'S') and cd1.cd_education_status in ('Unknown', '4 yr Degree', '2 yr Degree') and cd2.cd_marital_status in ('M', 'S', 'S') and cd2.cd_education_status in ('Unknown', '4 yr Degree', '2 yr Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1998 and cs2.syear = 1998 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
1620,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Home') and item2.i_manager_id between 47 and 66 and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 97 and 111 and s2.ss_list_price between 97 and 111  ;"
1621,dsb,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=1999 and d_moy = 4 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'SC' and c_birth_month = 11 and ss_wholesale_cost BETWEEN 47 AND 67 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
1622,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2002 and d_moy  = 11 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '>10000%' and ca_gmt_offset = -7  ;"
1623,dsb,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
1624,dsb,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1178 and 1178 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 64 and 93 and sm_type = 'NEXT DAY' and cc_class = 'small' and w_gmt_offset = -5  ;"
1625,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('MT', 'NC', 'NY') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'NE', 'OK') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AR', 'OK', 'VA') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1626,dsb,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('AL', 'MO', 'NY') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('CA', 'KY', 'WI') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('NC', 'OK', 'WV') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
1627,dsb,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 8 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '1001-5000%' and ca_gmt_offset = -7  ;"
1628,dsb,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 2000 and 2000 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Children', 'Jewelry') and item2.i_manager_id between 46 and 65 and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 256 and 270 and s2.ss_list_price between 256 and 270  ;"
1629,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1998-02-16','1998-05-15','1998-09-13','1998-11-07'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Men', 'Women') and i_manager_id BETWEEN 32 and 41 and sr_return_amt / sr_return_quantity between 266 and 295 and sr_reason_sk in (2, 4, 52, 58, 68) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-02-16','1998-05-15','1998-09-13','1998-11-07'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Men', 'Women') and i_manager_id BETWEEN 32 and 41 and cr_return_amount / cr_return_quantity between 266 and 295 and cr_reason_sk in (2, 4, 52, 58, 68) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1998-02-16','1998-05-15','1998-09-13','1998-11-07'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Men', 'Women') and i_manager_id BETWEEN 32 and 41 and wr_return_amt / wr_return_quantity between 266 and 295 and wr_reason_sk in (2, 4, 52, 58, 68) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1630,dsb,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'W' and cd_education_status = 'Unknown' and d_year = 2001 and s_state = 'OH' and i_category = 'Women' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
1631,dsb,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('1999-01-02','1999-05-13','1999-08-11','1999-10-13'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Music') and i_manager_id BETWEEN 72 and 81 and sr_return_amt / sr_return_quantity between 169 and 198 and sr_reason_sk in (33, 46, 54, 65, 73) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-01-02','1999-05-13','1999-08-11','1999-10-13'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Music') and i_manager_id BETWEEN 72 and 81 and cr_return_amount / cr_return_quantity between 169 and 198 and cr_reason_sk in (33, 46, 54, 65, 73) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('1999-01-02','1999-05-13','1999-08-11','1999-10-13'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Jewelry', 'Music') and i_manager_id BETWEEN 72 and 81 and wr_return_amt / wr_return_quantity between 169 and 198 and wr_reason_sk in (33, 46, 54, 65, 73) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
1632,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1202 and 1202+11 and ss_sales_price / ss_list_price BETWEEN 8 * 0.01 AND 18 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1202 and 1202+11 and ss_sales_price / ss_list_price BETWEEN 8 * 0.01 AND 18 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 3 and 7  and s_state in ('GA','MN','TX') order by s_store_name, i_item_desc limit 100 ;"
1633,dsb,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Woodland' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 63371 and ib_upper_bound <= 63371 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
1634,dsb,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1194 and 1194+11 and ss_sales_price / ss_list_price BETWEEN 87 * 0.01 AND 97 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1194 and 1194+11 and ss_sales_price / ss_list_price BETWEEN 87 * 0.01 AND 97 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 67 and 71  and s_state in ('AL','OK','WV') order by s_store_name, i_item_desc limit 100 ;"
